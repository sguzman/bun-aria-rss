<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
xmlns:georss="http://www.georss.org/georss" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
>

<channel>
	<title>R-bloggers</title>
	<atom:link href="https://www.r-bloggers.com/feed/" rel="self" type="application/rss+xml" />
	<link>https://www.r-bloggers.com</link>
	<description>R news and tutorials contributed by hundreds of R bloggers</description>
	<lastBuildDate>Fri, 04 Nov 2022 11:31:20 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.5.11</generator>

<image>
	<url>https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=32%2C32&#038;ssl=1</url>
	<title>R-bloggers</title>
	<link>https://www.r-bloggers.com</link>
	<width>32</width>
	<height>32</height>
</image> 
<site xmlns="com-wordpress:feed-additions:1">11524731</site>	<item>
		<title>Opening a spatial subset with {sf}</title>
		<link>https://www.r-bloggers.com/2022/11/opening-a-spatial-subset-with-sf/</link>
		
		<dc:creator><![CDATA[Michael]]></dc:creator>
		<pubDate>Fri, 04 Nov 2022 11:31:20 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">http://r.iresmi.net/?p=492</guid>

					<description><![CDATA[<p>Intersecting an area of interest with a layer at opening time Days 3 and 4 of 30DayMapChallenge : « polygons » and « green » (previously). The CORINE Landcover dataset is distributed as a geopackage weighting more than 8 Go. To limit the memory used when we only work on a subset, we can clip it at opening ...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/opening-a-spatial-subset-with-sf/">Opening a spatial subset with {sf}</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://r.iresmi.net/2022/11/04/opening-a-spatial-subset-with-sf/"> r.iresmi.net</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

<blockquote class="wp-block-quote"><p>Intersecting an area of interest with a layer at opening time</p></blockquote>



<p>Days 3 and 4 of <a href="https://30daymapchallenge.com/" data-type="URL" data-id="https://30daymapchallenge.com/" rel="nofollow" target="_blank">30DayMapChallenge</a> : « polygons » and « green » (<a href="http://r.iresmi.net/tag/30daymapchallenge/" rel="nofollow" target="_blank">previously</a>).</p>



<p>The <a href="https://land.copernicus.eu/pan-european/corine-land-cover/clc2018" rel="nofollow" target="_blank">CORINE Landcover dataset</a> is distributed as a geopackage weighting more than 8 Go. To limit the memory used when we only work on a subset, we can clip it at opening time. Here we will map the Cyprus Island :</p>



<pre>library(dplyr)
library(ggplot2)
library(stringr)
library(sf)
library(rnaturalearth)
library(glue)

# Using the contour of Cyprus (enlarged) from naturalearth to clip
bb &lt;- ne_countries(scale = &quot;medium&quot;, country = &quot;cyprus&quot;, returnclass = &quot;sf&quot;) %&gt;% 
  st_transform(&quot;EPSG:3035&quot;) %&gt;% 
  st_buffer(90000) %&gt;% 
  pull(geometry) %&gt;% 
  st_as_text()

# Corine Land Cover 
# download from https://land.copernicus.eu/pan-european/corine-land-cover/clc2018
# (registration required)
# passing the bounding area
cyprus_clc &lt;- read_sf(&quot;data/U2018_CLC2018_V2020_20u1.gpkg&quot;, query = glue(&quot;
  SELECT * 
  FROM U2018_CLC2018_V2020_20u1
  WHERE st_intersects(Shape, st_polygonfromtext('{bb}'))&quot;))

legend_colors &lt;- list(&quot;TRUE&quot;  = &quot;mediumaquamarine&quot;,
                      &quot;FALSE&quot; = &quot;grey90&quot;)

legend_labs &lt;- list(&quot;TRUE&quot;  = &quot;forest&quot;,
                    &quot;FALSE&quot; = &quot;other&quot;)

# exclude sea (code 523)
# and classify on forest (codes 3xx)
cyprus_clc %&gt;% 
  filter(Code_18 != &quot;523&quot;) %&gt;% 
  ggplot() +
  geom_sf(aes(fill = str_detect(Code_18, &quot;^3&quot;),
              color = str_detect(Code_18, &quot;^3&quot;))) +
  scale_fill_manual(name= &quot;type&quot;,
                    values = legend_colors,
                    labels = legend_labs) +
  scale_color_manual(name = &quot;type&quot;,
                     values = legend_colors,
                     labels = legend_labs) +
  labs(title = &quot;Cyprus&quot;,
       subtitle = &quot;Landcover&quot;,
       caption = glue(&quot;data: Copernicus CLC 2018
                      projection LAEA
                      r.iresmi.net {Sys.Date()}&quot;)) +
  theme_minimal() +
  theme(legend.position = &quot;bottom&quot;,
               plot.caption = element_text(size = 7))

ggsave(&quot;cyprus.png&quot;, width = 20, height = 12.36, units = &quot;cm&quot;, scale = 1.1, type = &quot;cairo&quot;)
</pre>



<figure class="wp-block-image size-large"><img loading="lazy" src="https://i1.wp.com/r.iresmi.net/wp-content/uploads/2022/11/cyprus-1024x633.png?w=450" alt="" class="wp-image-493" srcset_temp="https://i1.wp.com/r.iresmi.net/wp-content/uploads/2022/11/cyprus-1024x633.png?w=450 1024w, http://r.iresmi.net/wp-content/uploads/2022/11/cyprus-300x185.png 300w, http://r.iresmi.net/wp-content/uploads/2022/11/cyprus-768x474.png 768w, http://r.iresmi.net/wp-content/uploads/2022/11/cyprus-1536x949.png 1536w, http://r.iresmi.net/wp-content/uploads/2022/11/cyprus-2048x1265.png 2048w, http://r.iresmi.net/wp-content/uploads/2022/11/cyprus-1200x741.png 1200w, http://r.iresmi.net/wp-content/uploads/2022/11/cyprus-1980x1223.png 1980w" sizes="(max-width: 1024px) 100vw, 1024px" data-recalc-dims="1" /><figcaption>Cyprus landcover</figcaption></figure>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://r.iresmi.net/2022/11/04/opening-a-spatial-subset-with-sf/"> r.iresmi.net</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/opening-a-spatial-subset-with-sf/">Opening a spatial subset with {sf}</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334302</post-id>	</item>
		<item>
		<title>Introducing yahoofinancer</title>
		<link>https://www.r-bloggers.com/2022/11/introducing-yahoofinancer/</link>
		
		<dc:creator><![CDATA[Rsquared Academy Blog - Explore Discover Learn]]></dc:creator>
		<pubDate>Fri, 04 Nov 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://blog.rsquaredacademy.com/introducing-yahoofinancer-fetch-data-from-yahoo-finance-api/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>We are excited to announce the yahoofinancer package. The yahoofinancer R package allows the retrieval of nearly all data visible via the Yahoo Finance front-end and aims to reduce the pre-processing steps needed in analyzing such data.<br />
yahoofinanc...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/introducing-yahoofinancer/">Introducing yahoofinancer</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://blog.rsquaredacademy.com/introducing-yahoofinancer-fetch-data-from-yahoo-finance-api/"> Rsquared Academy Blog - Explore Discover Learn</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<script src="https://blog.rsquaredacademy.com/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p><img src="https://i2.wp.com/blog.rsquaredacademy.com/img/github-yfr.png?w=70%25&#038;ssl=1" style="display: block; margin: auto;" data-recalc-dims="1" /></p>
<p>We are excited to announce the <a href="https://yahoofinancer.rsquaredacademy.com/" rel="nofollow" target="_blank">yahoofinancer</a> package. The yahoofinancer R package allows the retrieval of nearly all data visible via the Yahoo Finance front-end and aims to reduce the pre-processing steps needed in analyzing such data.</p>
<p>yahoofinancer is inspired by and a port of the Python package <a href="https://yahooquery.dpguthrie.com/" rel="nofollow" target="_blank">yahooquery</a>. yahoofinancer is <strong>not</strong> affiliated, endorsed, or vetted by Yahoo, Inc. It’s an open-source tool that uses Yahoo’s publicly available APIs, and is intended for research and educational purposes.</p>
<p>With yahoofinancer, you can fetch the following data related to:</p>
<ul>
<li>company
<ul>
<li>quote</li>
<li>summary</li>
<li>statistics</li>
<li>historical data</li>
<li>profile</li>
<li>financials</li>
<li>analysis</li>
<li>options</li>
</ul></li>
<li>index
<ul>
<li>summary</li>
<li>historical data</li>
</ul></li>
<li>currency</li>
<li>market summary</li>
</ul>
<div id="installation" class="section level2">
<h2>Installation</h2>
<pre># Install release version from CRAN
install.packages(&quot;yahoofinancer&quot;)

# Install development version from GitHub
# install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;rsquaredacademy/yahoofinancer&quot;)</pre>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
</div>
<div id="ticker" class="section level2">
<h2>Ticker</h2>
<p>The <code>Ticker</code> class is the main workhorse of the package and through it we can
obtain most of the data related to a company.</p>
<div id="instantiate-ticker-class" class="section level4">
<h4>Instantiate Ticker Class</h4>
<p>We can instantiate the <code>Ticker</code> class by passing the company’s ticker symbol.
For instance, to get data for <a href="https://finance.yahoo.com/quote/AAPL/" rel="nofollow" target="_blank">Apple Inc.</a>,
pass <code>aapl</code> as the first argument to the <code>Ticker</code> class.</p>
<pre>aapl &lt;- Ticker$new(&#39;aapl&#39;)</pre>
<p>We can use the <code>validate()</code> function to validate a symbol.</p>
</div>
<div id="regular-market-price" class="section level4">
<h4>Regular Market Price</h4>
<p>Let us begin by getting the real time price of <a href="https://finance.yahoo.com/quote/AAPL/" rel="nofollow" target="_blank">Apple Inc.</a>.</p>
<pre>aapl$quote$regularMarketPrice
## [1] 138.88</pre>
</div>
<div id="summary" class="section level4">
<h4>Summary</h4>
<p>To retrieve data from the <a href="https://finance.yahoo.com/quote/AAPL/" rel="nofollow" target="_blank">Summary</a> tab, use the <code>summary_detail</code> property on the <code>Ticker</code> class.</p>
<pre>aapl$summary_detail
## $maxAge
## [1] 1
## 
## $priceHint
## [1] 2
## 
## $previousClose
## [1] 145.03
## 
## $open
## [1] 142.06
## 
## $dayLow
## [1] 138.76
## 
## $dayHigh
## [1] 142.795
## 
## $regularMarketPreviousClose
## [1] 145.03
## 
## $regularMarketOpen
## [1] 142.06
## 
## $regularMarketDayLow
## [1] 138.76
## 
## $regularMarketDayHigh
## [1] 142.795
## 
## $dividendRate
## [1] 0.92
## 
## $dividendYield
## [1] 0.0063
## 
## $exDividendDate
## [1] 1667520000
## 
## $payoutRatio
## [1] 0.1473
## 
## $fiveYearAvgDividendYield
## [1] 1
## 
## $beta
## [1] 1.246644
## 
## $trailingPE
## [1] 23.74017
## 
## $forwardPE
## [1] 20.36364
## 
## $volume
## [1] 97918516
## 
## $regularMarketVolume
## [1] 97918516
## 
## $averageVolume
## [1] 85440921
## 
## $averageVolume10days
## [1] 96881500
## 
## $averageDailyVolume10Day
## [1] 96881500
## 
## $bid
## [1] 0
## 
## $ask
## [1] 138.63
## 
## $bidSize
## [1] 800
## 
## $askSize
## [1] 1300
## 
## $marketCap
## [1] 2.307158e+12
## 
## $fiftyTwoWeekLow
## [1] 129.04
## 
## $fiftyTwoWeekHigh
## [1] 182.94
## 
## $priceToSalesTrailing12Months
## [1] 5.85086
## 
## $fiftyDayAverage
## [1] 150.0812
## 
## $twoHundredDayAverage
## [1] 156.2758
## 
## $trailingAnnualDividendRate
## [1] 0.9
## 
## $trailingAnnualDividendYield
## [1] 0.006205612
## 
## $currency
## [1] &quot;USD&quot;
## 
## $tradeable
## [1] FALSE</pre>
</div>
<div id="statistics" class="section level4">
<h4>Statistics</h4>
<p>If you are looking to retrieve data from the <a href="https://finance.yahoo.com/quote/AAPL/key-statistics?p=AAPL" rel="nofollow" target="_blank">Statistics</a> tab, use the following properties:</p>
<div id="key-statistics" class="section level5">
<h5>Key Statistics</h5>
<p>The <code>key_stats</code> property returns KPIs for a given symbol. It is available raw</p>
<pre>head(map(aapl$key_stats, &#39;raw&#39;))
## $maxAge
## NULL
## 
## $priceHint
## [1] 2
## 
## $enterpriseValue
## [1] 2.293495e+12
## 
## $forwardPE
## [1] 20.36364
## 
## $profitMargins
## [1] 0.2531
## 
## $floatShares
## [1] 15891255395</pre>
<p>or formatted</p>
<pre>head(map(aapl$key_stats, &#39;fmt&#39;))
## $maxAge
## NULL
## 
## $priceHint
## [1] &quot;2&quot;
## 
## $enterpriseValue
## [1] &quot;2.29T&quot;
## 
## $forwardPE
## [1] &quot;20.36&quot;
## 
## $profitMargins
## [1] &quot;25.31%&quot;
## 
## $floatShares
## [1] &quot;15.89B&quot;</pre>
<p>The <code>valuation_measures</code> property retrieves valuation measures for most recent
four quarters.</p>
<pre>aapl$valuation_measures
##         date enterprise_value enterprise_value_ebitda_ratio
## 1 2021-09-30     2.384485e+12                  2.384485e+12
## 2 2021-12-31     2.963725e+12                  2.963725e+12
## 3 2022-03-31     2.888888e+12                  2.888888e+12
## 4 2022-06-30     2.269030e+12                  2.269030e+12
## 5 2022-09-30     2.274841e+12                  2.274841e+12
##   enterprise_value_revenue_ratio forward_pe_ratio   market_cap     pb_ratio
## 1                   2.384485e+12     2.384485e+12 2.384485e+12 2.384485e+12
## 2                   2.963725e+12     2.963725e+12 2.963725e+12 2.963725e+12
## 3                   2.888888e+12     2.888888e+12 2.888888e+12 2.888888e+12
## 4                   2.269030e+12     2.269030e+12 2.269030e+12 2.269030e+12
## 5                   2.274841e+12     2.274841e+12 2.274841e+12 2.274841e+12
##       pe_ratio    peg_ratio     ps_ratio
## 1 2.384485e+12 2.384485e+12 2.384485e+12
## 2 2.963725e+12 2.963725e+12 2.963725e+12
## 3 2.888888e+12 2.888888e+12 2.888888e+12
## 4 2.269030e+12 2.269030e+12 2.269030e+12
## 5 2.274841e+12 2.274841e+12 2.274841e+12</pre>
</div>
</div>
<div id="historical-data" class="section level4">
<h4>Historical Data</h4>
<p>Use the <code>get_history()</code> method to retrieve historical pricing data for a given
symbol. By default, it returns YTD data.</p>
<pre>head(aapl$get_history())
##                  date    volume   high    low   open  close adj_close
## 1 2022-01-03 14:30:00 104487900 182.88 177.71 177.83 182.01  181.2599
## 2 2022-01-04 14:30:00  99310400 182.94 179.12 182.63 179.70  178.9594
## 3 2022-01-05 14:30:00  94537600 180.17 174.64 179.61 174.92  174.1992
## 4 2022-01-06 14:30:00  96904000 175.30 171.64 172.70 172.00  171.2912
## 5 2022-01-07 14:30:00  86709100 174.14 171.03 172.89 172.17  171.4605
## 6 2022-01-10 14:30:00 106765600 172.50 168.17 169.08 172.19  171.4804</pre>
<p>To get data from a specific date upto the current date, use the <code>start</code>
argument to supply the initial date. The time between data points can be
specified using the <code>interval</code> argument.</p>
<pre>aapl$get_history(start = &#39;2022-10-20&#39;, interval = &#39;1d&#39;)
##                   date    volume   high    low   open  close adj_close
## 1  2022-10-20 13:30:00  64522000 145.89 142.65 143.02 143.39    143.39
## 2  2022-10-21 13:30:00  86464700 147.85 142.65 142.87 147.27    147.27
## 3  2022-10-24 13:30:00  75981900 150.23 146.00 147.19 149.45    149.45
## 4  2022-10-25 13:30:00  74732300 152.49 149.36 150.09 152.34    152.34
## 5  2022-10-26 13:30:00  88194300 151.99 148.04 150.96 149.35    149.35
## 6  2022-10-27 13:30:00 109180200 149.05 144.13 148.07 144.80    144.80
## 7  2022-10-28 13:30:00 164762400 157.50 147.82 148.20 155.74    155.74
## 8  2022-10-31 13:30:00  97943200 154.24 151.92 153.16 153.34    153.34
## 9  2022-11-01 13:30:00  80379300 155.45 149.13 155.08 150.65    150.65
## 10 2022-11-02 13:30:00  93604600 152.17 145.00 148.95 145.03    145.03
## 11 2022-11-03 13:30:00  97572100 142.80 138.75 142.06 138.88    138.88</pre>
<p>To retrieve data between two specific dates, use both the <code>start</code> and <code>end</code>
argument. The dates should be either <code>String</code> or <code>Date</code> object in <code>yyyy-mm-dd</code>
format.</p>
<pre>aapl$get_history(start = &#39;2022-10-01&#39;, end = &#39;2022-10-14&#39;, interval = &#39;1d&#39;)
##                  date    volume   high    low   open  close adj_close
## 1 2022-10-03 13:30:00 114311700 143.07 137.69 138.21 142.45    142.45
## 2 2022-10-04 13:30:00  87830100 146.22 144.26 145.03 146.10    146.10
## 3 2022-10-05 13:30:00  79471000 147.38 143.01 144.07 146.40    146.40
## 4 2022-10-06 13:30:00  68402200 147.54 145.22 145.81 145.43    145.43
## 5 2022-10-07 13:30:00  85859100 143.10 139.45 142.54 140.09    140.09
## 6 2022-10-10 13:30:00  74899000 141.89 138.57 140.42 140.42    140.42
## 7 2022-10-11 13:30:00  77033700 141.35 138.22 139.90 138.98    138.98
## 8 2022-10-12 13:30:00  70433700 140.36 138.16 139.13 138.34    138.34
## 9 2022-10-13 13:30:00 113224000 143.59 134.37 134.99 142.99    142.99</pre>
<p>The <code>period</code> arguments allows the user to retrieve data for specific length of time.</p>
<pre>aapl$get_history(period = &#39;1mo&#39;, interval = &#39;1d&#39;)
##                   date    volume   high    low   open  close adj_close
## 1  2022-10-04 13:30:00  87830100 146.22 144.26 145.03 146.10    146.10
## 2  2022-10-05 13:30:00  79471000 147.38 143.01 144.07 146.40    146.40
## 3  2022-10-06 13:30:00  68402200 147.54 145.22 145.81 145.43    145.43
## 4  2022-10-07 13:30:00  85859100 143.10 139.45 142.54 140.09    140.09
## 5  2022-10-10 13:30:00  74899000 141.89 138.57 140.42 140.42    140.42
## 6  2022-10-11 13:30:00  77033700 141.35 138.22 139.90 138.98    138.98
## 7  2022-10-12 13:30:00  70433700 140.36 138.16 139.13 138.34    138.34
## 8  2022-10-13 13:30:00 113224000 143.59 134.37 134.99 142.99    142.99
## 9  2022-10-14 13:30:00  88512300 144.52 138.19 144.31 138.38    138.38
## 10 2022-10-17 13:30:00  85250900 142.90 140.27 141.07 142.41    142.41
## 11 2022-10-18 13:30:00  99136600 146.70 140.61 145.49 143.75    143.75
## 12 2022-10-19 13:30:00  61758300 144.95 141.50 141.69 143.86    143.86
## 13 2022-10-20 13:30:00  64522000 145.89 142.65 143.02 143.39    143.39
## 14 2022-10-21 13:30:00  86464700 147.85 142.65 142.87 147.27    147.27
## 15 2022-10-24 13:30:00  75981900 150.23 146.00 147.19 149.45    149.45
## 16 2022-10-25 13:30:00  74732300 152.49 149.36 150.09 152.34    152.34
## 17 2022-10-26 13:30:00  88194300 151.99 148.04 150.96 149.35    149.35
## 18 2022-10-27 13:30:00 109180200 149.05 144.13 148.07 144.80    144.80
## 19 2022-10-28 13:30:00 164762400 157.50 147.82 148.20 155.74    155.74
## 20 2022-10-31 13:30:00  97943200 154.24 151.92 153.16 153.34    153.34
## 21 2022-11-01 13:30:00  80379300 155.45 149.13 155.08 150.65    150.65
## 22 2022-11-02 13:30:00  93604600 152.17 145.00 148.95 145.03    145.03
## 23 2022-11-03 13:30:00  97572100 142.80 138.75 142.06 138.88    138.88</pre>
<p>Please view the <a href="https://yahoofinancer.rsquaredacademy.com/reference/ticker-class#arguments-5" rel="nofollow" target="_blank">documentation</a> to see the valid values for <code>interval</code> and <code>period</code>.</p>
</div>
<div id="profile" class="section level4">
<h4>Profile</h4>
<p>Retrieve data from the <a href="https://finance.yahoo.com/quote/AAPL/profile?p=AAPL" rel="nofollow" target="_blank">Profile</a>
tab. The <code>summary_profile</code> property returns the business summary for a given
symbol.</p>
<pre>aapl$summary_profile
## $address1
## [1] &quot;One Apple Park Way&quot;
## 
## $city
## [1] &quot;Cupertino&quot;
## 
## $state
## [1] &quot;CA&quot;
## 
## $zip
## [1] &quot;95014&quot;
## 
## $country
## [1] &quot;United States&quot;
## 
## $phone
## [1] &quot;408 996 1010&quot;
## 
## $website
## [1] &quot;https://www.apple.com&quot;
## 
## $industry
## [1] &quot;Consumer Electronics&quot;
## 
## $sector
## [1] &quot;Technology&quot;
## 
## $longBusinessSummary
## [1] &quot;Apple Inc. designs, manufactures, and markets smartphones, personal computers, tablets, wearables, and accessories worldwide. It also sells various related services. In addition, the company offers iPhone, a line of smartphones; Mac, a line of personal computers; iPad, a line of multi-purpose tablets; and wearables, home, and accessories comprising AirPods, Apple TV, Apple Watch, Beats products, and HomePod. Further, it provides AppleCare support and cloud services store services; and operates various platforms, including the App Store that allow customers to discover and download applications and digital content, such as books, music, video, games, and podcasts. Additionally, the company offers various services, such as Apple Arcade, a game subscription service; Apple Fitness+, a personalized fitness service; Apple Music, which offers users a curated listening experience with on-demand radio stations; Apple News+, a subscription news and magazine service; Apple TV+, which offers exclusive original content; Apple Card, a co-branded credit card; and Apple Pay, a cashless payment service, as well as licenses its intellectual property. The company serves consumers, and small and mid-sized businesses; and the education, enterprise, and government markets. It distributes third-party applications for its products through the App Store. The company also sells its products through its retail and online stores, and direct sales force; and third-party cellular network carriers, wholesalers, retailers, and resellers. Apple Inc. was incorporated in 1977 and is headquartered in Cupertino, California.&quot;
## 
## $fullTimeEmployees
## [1] 164000
## 
## $companyOfficers
## list()
## 
## $maxAge
## [1] 86400</pre>
<p>The <code>company_officers</code> property retrieves top executives for given symbol and
their total pay package.</p>
<pre>aapl$company_officers
##                       name age                                         title
## 1      Mr. Timothy D. Cook  60                                CEO & Director
## 2        Mr. Luca  Maestri  57                                  CFO & Sr. VP
## 3  Mr. Jeffrey E. Williams  57                       Chief Operating Officer
## 4   Ms. Katherine L. Adams  57                   Sr. VP, Gen. Counsel & Sec.
## 5     Ms. Deirdre  O&#39;Brien  54                     Sr. VP of People & Retail
## 6         Mr. Chris  Kondo  NA              Sr. Director of Corp. Accounting
## 7        Mr. James  Wilson  NA                      Chief Technology Officer
## 8          Ms. Mary  Demby  NA                     Chief Information Officer
## 9        Ms. Nancy  Paxton  NA Sr. Director of Investor Relations & Treasury
## 10       Mr. Greg  Joswiak  NA                 Sr. VP of Worldwide Marketing
##    year_born fiscal_year total_pay exercised_value unexercised_value
## 1       1961        2021  16386559               0                 0
## 2       1964        2021   5018883               0                 0
## 3       1964        2021   5017437               0                 0
## 4       1964        2021   5014533               0                 0
## 5       1967        2021   5061191               0                 0
## 6         NA          NA        NA               0                 0
## 7         NA          NA        NA               0                 0
## 8         NA          NA        NA               0                 0
## 9         NA          NA        NA               0                 0
## 10        NA          NA        NA               0                 0</pre>
</div>
<div id="financials" class="section level4">
<h4>Financials</h4>
<p>The <code>get_balance_sheet()</code> method retrieves balance sheet data for most recent
four quarters or most recent four years.</p>
<pre>aapl$get_balance_sheet(&#39;annual&#39;)
## # A tibble: 4 x 24
##   end_date          cash short~1 net_r~2 inven~3 other~4 total~5 long_~6 prope~7
##   &lt;date&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 2022-09-24 23646000000 2.47e10 6.09e10  4.95e9 2.12e10 1.35e11 1.21e11 8.42e10
## 2 2021-09-25 34940000000 2.77e10 5.15e10  6.58e9 1.41e10 1.35e11 1.28e11 4.95e10
## 3 2020-09-26 38016000000 5.29e10 3.74e10  4.06e9 1.13e10 1.44e11 1.01e11 4.53e10
## 4 2019-09-28 48844000000 5.17e10 4.58e10  4.11e9 1.24e10 1.63e11 1.05e11 3.74e10
## # ... with 15 more variables: other_assets &lt;dbl&gt;, total_assets &lt;dbl&gt;,
## #   accounts_payable &lt;dbl&gt;, short_long_term_debt &lt;dbl&gt;,
## #   other_current_liab &lt;dbl&gt;, long_term_debt &lt;dbl&gt;, other_liab &lt;dbl&gt;,
## #   total_current_liabilities &lt;dbl&gt;, total_liab &lt;dbl&gt;, common_stock &lt;dbl&gt;,
## #   retained_earnings &lt;dbl&gt;, treasury_stock &lt;dbl&gt;,
## #   other_stockholder_equity &lt;dbl&gt;, total_stockholder_equity &lt;dbl&gt;,
## #   net_tangible_assets &lt;dbl&gt;, and abbreviated variable names ...</pre>
<p>The <code>get_income_statement()</code> method retrieves income statement data for most
recent four quarters or most recent four years.</p>
<pre>aapl$get_income_statement(&#39;annual&#39;)
## # A tibble: 4 x 16
##   end_date   total_rev~1 cost_~2 gross~3 resea~4 selli~5 total~6 opera~7 total~8
##   &lt;date&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;int&gt;
## 1 2022-09-24     3.94e11 2.24e11 1.71e11 2.63e10 2.51e10 2.75e11 1.19e11 -3.34e8
## 2 2021-09-25     3.66e11 2.13e11 1.53e11 2.19e10 2.20e10 2.57e11 1.09e11  2.58e8
## 3 2020-09-26     2.75e11 1.70e11 1.05e11 1.88e10 1.99e10 2.08e11 6.63e10  8.03e8
## 4 2019-09-28     2.60e11 1.62e11 9.84e10 1.62e10 1.82e10 1.96e11 6.39e10  1.81e9
## # ... with 7 more variables: ebit &lt;dbl&gt;, interest_expense &lt;dbl&gt;,
## #   income_before_tax &lt;dbl&gt;, income_tax_expense &lt;dbl&gt;,
## #   net_income_from_continuing_ops &lt;dbl&gt;, net_income &lt;dbl&gt;,
## #   net_income_applicable_to_common_shares &lt;dbl&gt;, and abbreviated variable
## #   names 1: total_revenue, 2: cost_of_revenue, 3: gross_profit,
## #   4: research_development, 5: selling_general_administrative,
## #   6: total_operating_expenses, 7: operating_income, ...</pre>
<p>The <code>get_cash_flow()</code> method retrieves cash flow data for most recent four
quarters or most recent four years.</p>
<pre>aapl$get_cash_flow(&#39;annual&#39;)
## # A tibble: 4 x 20
##   end_date   net_inc~1 depre~2 chang~3 change~4 change~5 chang~6 chang~7 total~8
##   &lt;date&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 2022-09-24   9.98e10 1.11e10 1.00e10 -1.82e 9  9.93e 9  1.48e9 -8.39e9 1.22e11
## 2 2021-09-25   9.47e10 1.13e10 2.98e 9 -1.01e10  1.40e10 -2.64e9 -6.15e9 1.04e11
## 3 2020-09-26   5.74e10 1.11e10 6.52e 9  6.92e 9 -1.98e 9 -1.27e8  8.81e8 8.07e10
## 4 2019-09-28   5.53e10 1.25e10 5.08e 9  2.45e 8 -2.55e 9 -2.89e8 -8.96e8 6.94e10
## # ... with 11 more variables: capital_expenditures &lt;dbl&gt;, investments &lt;dbl&gt;,
## #   other_cashflows_from_investing_activities &lt;int&gt;,
## #   total_cashflows_from_investing_activities &lt;dbl&gt;, dividends_paid &lt;dbl&gt;,
## #   net_borrowings &lt;dbl&gt;, other_cashflows_from_financing_activities &lt;int&gt;,
## #   total_cash_from_financing_activities &lt;dbl&gt;, change_in_cash &lt;dbl&gt;,
## #   repurchase_of_stock &lt;dbl&gt;, issuance_of_stock &lt;int&gt;, and abbreviated
## #   variable names 1: net_income, 2: depreciation, 3: change_to_netincome, ...</pre>
</div>
<div id="analysis" class="section level4">
<h4>Analysis</h4>
<div id="earnings-estimate" class="section level5">
<h5>Earnings Estimate</h5>
<pre>aapl$earnings_trend$earnings_estimate
##         date period analyst avg_estimate low_estimate high_estimate
## 1 2022-12-31     0q      27         2.08         1.93          2.20
## 2 2023-03-31    +1q      26         1.47         1.34          1.61
## 3 2023-09-30     0y      33         6.26         5.40          6.87
## 4 2024-09-30    +1y      28         6.82         6.01          7.36
## 5       &lt;NA&gt;    +5y      NA           NA           NA            NA
## 6       &lt;NA&gt;    -5y      NA           NA           NA            NA
##   year_ago_eps
## 1         2.10
## 2         1.52
## 3         6.11
## 4         6.26
## 5           NA
## 6           NA</pre>
</div>
<div id="revenue-estimate" class="section level5">
<h5>Revenue Estimate</h5>
<pre>aapl$earnings_trend$revenue_estimate
##         date period analyst avg_estimate low_estimate high_estimate
## 1 2022-12-31     0q      23  1.27082e+11  1.21204e+11   1.32365e+11
## 2 2023-03-31    +1q      23  9.73035e+10  8.96080e+10   1.02950e+11
## 3 2023-09-30     0y      32  4.07153e+11  3.86805e+11   4.19743e+11
## 4 2024-09-30    +1y      26  4.28651e+11  4.05730e+11   4.48983e+11
## 5       &lt;NA&gt;    +5y      NA           NA           NA            NA
## 6       &lt;NA&gt;    -5y      NA           NA           NA            NA
##   year_ago_revenue
## 1               NA
## 2               NA
## 3      3.94328e+11
## 4      4.07153e+11
## 5               NA
## 6               NA</pre>
</div>
<div id="earnings-history" class="section level5">
<h5>Earnings History</h5>
<pre>aapl$earnings_history
##      quarter period eps_estimate eps_actual eps_difference surprise_percent
## 1 2021-12-31    -4q         1.89       2.10           0.21            0.111
## 2 2022-03-31    -3q         1.43       1.52           0.09            0.063
## 3 2022-06-30    -2q         1.16       1.20           0.04            0.034
## 4 2022-09-30    -1q         1.27       1.29           0.02            0.016</pre>
</div>
<div id="eps-trend" class="section level5">
<h5>EPS Trend</h5>
<pre>aapl$earnings_trend$eps_trend
##         date period current seven_days_ago thirty_days_ago sixty_days_ago
## 1 2022-12-31     0q    2.08           2.13            2.13           2.12
## 2 2023-03-31    +1q    1.47           1.52            1.53           1.52
## 3 2023-09-30     0y    6.26           6.43            6.46           6.45
## 4 2024-09-30    +1y    6.82           6.90            6.88           6.88
## 5       &lt;NA&gt;    +5y      NA             NA              NA             NA
## 6       &lt;NA&gt;    -5y      NA             NA              NA             NA
##   ninety_days_ago
## 1            2.11
## 2            1.52
## 3            6.43
## 4            6.79
## 5              NA
## 6              NA</pre>
</div>
<div id="eps-revision" class="section level5">
<h5>EPS Revision</h5>
<pre>aapl$earnings_trend$eps_revision
##         date period up_last_7_days up_last_30_days down_last_30_days
## 1 2022-12-31     0q              4               6                15
## 2 2023-03-31    +1q              4               5                13
## 3 2023-09-30     0y              3               5                24
## 4 2024-09-30    +1y              2               4                 9
## 5       &lt;NA&gt;    +5y             NA              NA                NA
## 6       &lt;NA&gt;    -5y             NA              NA                NA
##   down_last_90_days
## 1                NA
## 2                NA
## 3                NA
## 4                NA
## 5                NA
## 6                NA</pre>
</div>
<div id="growth-estimates" class="section level5">
<h5>Growth Estimates</h5>
<pre>aapl$earnings_trend$growth
##         date period      growth
## 1 2022-12-31     0q -0.01000000
## 2 2023-03-31    +1q -0.03300000
## 3 2023-09-30     0y  0.02500000
## 4 2024-09-30    +1y  0.08899999
## 5       &lt;NA&gt;    +5y  0.08890000
## 6       &lt;NA&gt;    -5y  0.22590000</pre>
</div>
</div>
<div id="options" class="section level4">
<h4>Options</h4>
<div id="option-chain" class="section level5">
<h5>Option Chain</h5>
<pre>head(aapl$option_chain)
## # A tibble: 6 x 16
##   expiration          option_type contra~1 strike curre~2 last_~3 change perce~4
##   &lt;dttm&gt;              &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1 2022-11-04 00:00:00 call        AAPL221~     70 USD        69.8      0       0
## 2 2022-11-04 00:00:00 call        AAPL221~     75 USD        64.6      0       0
## 3 2022-11-04 00:00:00 call        AAPL221~     80 USD        59.7      0       0
## 4 2022-11-04 00:00:00 call        AAPL221~     85 USD        59.6      0       0
## 5 2022-11-04 00:00:00 call        AAPL221~     90 USD        50.0      0       0
## 6 2022-11-04 00:00:00 call        AAPL221~     95 USD        44.9      0       0
## # ... with 8 more variables: open_interest &lt;int&gt;, bid &lt;dbl&gt;, ask &lt;dbl&gt;,
## #   contract_size &lt;chr&gt;, last_trade_date &lt;dttm&gt;, implied_volatility &lt;dbl&gt;,
## #   in_the_money &lt;lgl&gt;, volume &lt;int&gt;, and abbreviated variable names
## #   1: contract_symbol, 2: currency, 3: last_price, 4: percent_change</pre>
</div>
<div id="option-expiration-dates" class="section level5">
<h5>Option Expiration Dates</h5>
<pre>aapl$option_expiration_dates
##  [1] &quot;2022-11-04&quot; &quot;2022-11-11&quot; &quot;2022-11-18&quot; &quot;2022-11-25&quot; &quot;2022-12-02&quot;
##  [6] &quot;2022-12-09&quot; &quot;2022-12-16&quot; &quot;2023-01-20&quot; &quot;2023-02-17&quot; &quot;2023-03-17&quot;
## [11] &quot;2023-04-21&quot; &quot;2023-05-19&quot; &quot;2023-06-16&quot; &quot;2023-07-21&quot; &quot;2023-09-15&quot;
## [16] &quot;2024-01-19&quot; &quot;2024-03-15&quot; &quot;2024-06-21&quot; &quot;2025-01-17&quot;</pre>
</div>
<div id="option-strikes" class="section level5">
<h5>Option Strikes</h5>
<pre>aapl$option_strikes
##  [1]  30.0  35.0  40.0  45.0  50.0  55.0  60.0  65.0  70.0  75.0  80.0  85.0
## [13]  90.0  95.0 100.0 105.0 110.0 115.0 120.0 125.0 126.0 127.0 128.0 129.0
## [25] 130.0 131.0 132.0 133.0 134.0 135.0 136.0 137.0 138.0 139.0 140.0 141.0
## [37] 142.0 143.0 144.0 145.0 146.0 147.0 148.0 149.0 150.0 152.5 155.0 157.5
## [49] 160.0 162.5 165.0 167.5 170.0 172.5 175.0 177.5 180.0 185.0 190.0 195.0
## [61] 200.0 205.0 210.0 215.0 220.0 225.0 230.0 235.0 240.0 245.0 250.0 255.0
## [73] 260.0 265.0 270.0 275.0 280.0 285.0 290.0 295.0 300.0 310.0 320.0</pre>
</div>
</div>
<div id="holding-pattern" class="section level4">
<h4>Holding Pattern</h4>
<p>Data showing breakdown of owners of given symbol(s), insiders, institutions, etc.</p>
<pre>aapl$major_holders
## $maxAge
## [1] 1
## 
## $insidersPercentHeld
## [1] 0.00072
## 
## $institutionsPercentHeld
## [1] 0.60186
## 
## $institutionsFloatPercentHeld
## [1] 0.60229
## 
## $institutionsCount
## [1] 5463</pre>
<p>Top 10 owners of a given symbol.</p>
<pre>aapl$institution_ownership
##          date                  organization percent_held   position
## 1  2022-06-30    Vanguard Group, Inc. (The)           NA 1277319054
## 2  2022-06-30                Blackrock Inc.           NA 1028688317
## 3  2022-06-30       Berkshire Hathaway, Inc           NA  894802319
## 4  2022-06-30      State Street Corporation           NA  598178524
## 5  2022-06-30                      FMR, LLC           NA  344317974
## 6  2022-06-30 Geode Capital Management, LLC           NA  278256192
## 7  2022-06-30 Price (T.Rowe) Associates Inc           NA  237910783
## 8  2022-06-30                Morgan Stanley           NA  182450565
## 9  2022-06-30    Northern Trust Corporation           NA  179828922
## 10 2022-06-30   Bank of America Corporation           NA  149133915
##           value percent_change
## 1  177394076456         0.0058
## 2  142864238487         0.0010
## 3  124270150431         0.0044
## 4   83075036333        -0.0255
## 5   47818881910        -0.0207
## 6   38644221303         0.0227
## 7   33041050704         0.0207
## 8   25338735358         0.4585
## 9   24974641565        -0.0333
## 10  20711718843         0.0328</pre>
</div>
<div id="others" class="section level4">
<h4>Others</h4>
<p>Data related to historical recommendations (buy, hold, sell) for a given symbol.</p>
<pre>aapl$recommendation_trend
##   period strong_buy buy hold sell strong_sell
## 1     0m         11  21    6    0           0
## 2    -1m         13  25    6    1           0
## 3    -2m         14  25    7    1           0
## 4    -3m         13  20    8    0           0</pre>
<p>Technical indicators for given symbol.</p>
<pre>aapl$technical_insights$secReports[[1]]
## $id
## [1] &quot;0000320193-22-000108_320193&quot;
## 
## $type
## [1] &quot;Periodic Financial Reports&quot;
## 
## $title
## [1] &quot;10-K : Periodic Financial Reports&quot;
## 
## $description
## [1] &quot;Annual report pursuant to Section 13 and 15(d)&quot;
## 
## $filingDate
## [1] 1.666915e+12
## 
## $snapshotUrl
## [1] &quot;https://cdn.yahoofinance.com/prod/sec-reports-thumbnails/0000320193/000032019322000108/thumbnail.png&quot;
## 
## $formType
## [1] &quot;10-K&quot;</pre>
<p>Symbols displayed in the <strong>People Also Watch</strong> sidebar.</p>
<pre>aapl$recommendations
##   symbol    score
## 1   AMZN 0.323217
## 2   TSLA 0.303238
## 3   META 0.288718
## 4   GOOG 0.286876
## 5   NFLX 0.218178</pre>
</div>
</div>
<div id="indices" class="section level2">
<h2>Indices</h2>
<p>Use the <code>Index</code> class for getting all data related to indices from Yahoo Finance API.</p>
<div id="instantiate-index-class" class="section level4">
<h4>Instantiate Index Class</h4>
<p>We can instantiate the <code>Index</code> class by passing the index symbol. For instance,
to get data for <a href="https://finance.yahoo.com/quote/%5ENSEI?p=%5ENSEI" rel="nofollow" target="_blank">Nifty 50</a>,
pass <code>^NSEI</code> as the first argument to the <code>Index</code> class.</p>
<pre>nifty &lt;- Index$new(&#39;^NSEI&#39;)</pre>
</div>
<div id="summary-1" class="section level4">
<h4>Summary</h4>
<p>Use the <code>summary_detail</code> property to retrieve data from the <a href="https://finance.yahoo.com/quote/%5ENSEI?p=%5ENSEI" rel="nofollow" target="_blank">Summary</a> tab.</p>
<pre>nifty$summary_detail
## $language
## [1] &quot;en-US&quot;
## 
## $region
## [1] &quot;US&quot;
## 
## $quoteType
## [1] &quot;INDEX&quot;
## 
## $typeDisp
## [1] &quot;Index&quot;
## 
## $quoteSourceName
## [1] &quot;Free Realtime Quote&quot;
## 
## $triggerable
## [1] TRUE
## 
## $customPriceAlertConfidence
## [1] &quot;HIGH&quot;
## 
## $currency
## [1] &quot;INR&quot;
## 
## $tradeable
## [1] FALSE
## 
## $cryptoTradeable
## [1] FALSE
## 
## $messageBoardId
## [1] &quot;finmb_INDEXNSEI&quot;
## 
## $exchangeTimezoneName
## [1] &quot;Asia/Kolkata&quot;
## 
## $exchangeTimezoneShortName
## [1] &quot;IST&quot;
## 
## $gmtOffSetMilliseconds
## [1] 19800000
## 
## $market
## [1] &quot;in_market&quot;
## 
## $esgPopulated
## [1] FALSE
## 
## $regularMarketChangePercent
## [1] 0.1238129
## 
## $regularMarketPrice
## [1] 18075.05
## 
## $marketState
## [1] &quot;REGULAR&quot;
## 
## $exchange
## [1] &quot;NSI&quot;
## 
## $shortName
## [1] &quot;NIFTY 50&quot;
## 
## $firstTradeDateMilliseconds
## [1] 1.190001e+12
## 
## $priceHint
## [1] 2
## 
## $regularMarketChange
## [1] 22.35156
## 
## $regularMarketTime
## [1] 1667552435
## 
## $regularMarketDayHigh
## [1] 18108
## 
## $regularMarketDayRange
## [1] &quot;18017.15 - 18108.0&quot;
## 
## $regularMarketDayLow
## [1] 18017.15
## 
## $regularMarketVolume
## [1] 0
## 
## $regularMarketPreviousClose
## [1] 18052.7
## 
## $bid
## [1] 0
## 
## $ask
## [1] 0
## 
## $bidSize
## [1] 0
## 
## $askSize
## [1] 0
## 
## $fullExchangeName
## [1] &quot;NSE&quot;
## 
## $regularMarketOpen
## [1] 18053.4
## 
## $averageDailyVolume3Month
## [1] 275566
## 
## $averageDailyVolume10Day
## [1] 245930
## 
## $fiftyTwoWeekLowChange
## [1] 2891.65
## 
## $fiftyTwoWeekLowChangePercent
## [1] 0.1904481
## 
## $fiftyTwoWeekRange
## [1] &quot;15183.4 - 18350.95&quot;
## 
## $fiftyTwoWeekHighChange
## [1] -275.8984
## 
## $fiftyTwoWeekHighChangePercent
## [1] -0.01503456
## 
## $fiftyTwoWeekLow
## [1] 15183.4
## 
## $fiftyTwoWeekHigh
## [1] 18350.95
## 
## $fiftyDayAverage
## [1] 17526.7
## 
## $fiftyDayAverageChange
## [1] 548.3535
## 
## $fiftyDayAverageChangePercent
## [1] 0.03128676
## 
## $twoHundredDayAverage
## [1] 16994.76
## 
## $twoHundredDayAverageChange
## [1] 1080.293
## 
## $twoHundredDayAverageChangePercent
## [1] 0.06356624
## 
## $sourceInterval
## [1] 15
## 
## $exchangeDataDelayedBy
## [1] 15
## 
## $symbol
## [1] &quot;^NSEI&quot;</pre>
</div>
<div id="historical-data-1" class="section level4">
<h4>Historical Data</h4>
<p>Use the <code>get_history()</code> method to retrieve historical data for a given
index. By default, it returns YTD data.</p>
<pre>nifty$get_history(start = &#39;2022-10-20&#39;, interval = &#39;1d&#39;)
##                   date volume     high      low     open    close adj_close
## 1  2022-10-20 03:45:00 249600 17584.15 17421.00 17423.10 17563.95  17563.95
## 2  2022-10-21 03:45:00 277700 17670.15 17520.75 17622.85 17576.30  17576.30
## 3  2022-10-24 03:45:00  45000 17777.55 17707.40 17736.35 17730.75  17730.75
## 4  2022-10-25 03:45:00 251400 17811.50 17637.00 17808.30 17656.35  17656.35
## 5  2022-10-27 03:45:00 324600 17783.90 17654.50 17771.40 17736.95  17736.95
## 6  2022-10-28 03:45:00 250000 17838.90 17723.70 17756.40 17786.80  17786.80
## 7  2022-10-31 03:45:00 227200 18022.80 17899.90 17910.20 18012.20  18012.20
## 8  2022-11-01 03:45:00 349900 18175.80 18060.15 18130.70 18145.40  18145.40
## 9  2022-11-02 03:45:00 270900 18178.75 18048.65 18177.90 18082.85  18082.85
## 10 2022-11-03 03:45:00 213000 18106.30 17959.20 17968.35 18052.70  18052.70
## 11 2022-11-04 09:00:35      0 18108.00 18017.15 18053.40 18075.05  18075.05</pre>
<p>To get data from a specific date upto the current date, use the <code>start</code>
argument to supply the initial date. The time between data points can be
specified using the <code>interval</code> argument.</p>
<p>To retrieve data between two specific dates, use both the <code>start</code> and <code>end</code>
argument. The dates should be either <code>String</code> or <code>Date</code> object in <code>yyyy-mm-dd</code>
format.</p>
<pre>nifty$get_history(start = &#39;2022-10-01&#39;, end = &#39;2022-10-14&#39;, interval = &#39;1d&#39;)
##                  date volume     high      low     open    close adj_close
## 1 2022-10-03 03:45:00 278400 17114.65 16855.55 17102.10 16887.35  16887.35
## 2 2022-10-04 03:45:00 226000 17287.30 17117.30 17147.45 17274.30  17274.30
## 3 2022-10-06 03:45:00 265500 17428.80 17315.65 17379.25 17331.80  17331.80
## 4 2022-10-07 03:45:00 216300 17337.35 17216.95 17287.20 17314.65  17314.65
## 5 2022-10-10 03:45:00 234000 17280.15 17064.70 17094.35 17241.00  17241.00
## 6 2022-10-11 03:45:00 282600 17261.80 16950.30 17256.05 16983.55  16983.55
## 7 2022-10-12 03:45:00 256000 17142.35 16960.05 17025.55 17123.60  17123.60
## 8 2022-10-13 03:45:00 266400 17112.35 16956.95 17087.35 17014.35  17014.35</pre>
<p>The <code>period</code> arguments allows the user to retrieve data for specific length of time.</p>
<pre>nifty$get_history(period = &#39;1mo&#39;, interval = &#39;1d&#39;)
##                   date volume     high      low     open    close adj_close
## 1  2022-10-04 03:45:00 226000 17287.30 17117.30 17147.45 17274.30  17274.30
## 2  2022-10-06 03:45:00 265500 17428.80 17315.65 17379.25 17331.80  17331.80
## 3  2022-10-07 03:45:00 216300 17337.35 17216.95 17287.20 17314.65  17314.65
## 4  2022-10-10 03:45:00 234000 17280.15 17064.70 17094.35 17241.00  17241.00
## 5  2022-10-11 03:45:00 282600 17261.80 16950.30 17256.05 16983.55  16983.55
## 6  2022-10-12 03:45:00 256000 17142.35 16960.05 17025.55 17123.60  17123.60
## 7  2022-10-13 03:45:00 266400 17112.35 16956.95 17087.35 17014.35  17014.35
## 8  2022-10-14 03:45:00 227000 17348.55 17169.75 17322.30 17185.70  17185.70
## 9  2022-10-17 03:45:00 212200 17328.55 17098.55 17144.80 17311.80  17311.80
## 10 2022-10-18 03:45:00 239500 17527.80 17434.05 17438.75 17486.95  17486.95
## 11 2022-10-19 03:45:00 210500 17607.60 17472.85 17568.15 17512.25  17512.25
## 12 2022-10-20 03:45:00 249600 17584.15 17421.00 17423.10 17563.95  17563.95
## 13 2022-10-21 03:45:00 277700 17670.15 17520.75 17622.85 17576.30  17576.30
## 14 2022-10-24 03:45:00  45000 17777.55 17707.40 17736.35 17730.75  17730.75
## 15 2022-10-25 03:45:00 251400 17811.50 17637.00 17808.30 17656.35  17656.35
## 16 2022-10-27 03:45:00 324600 17783.90 17654.50 17771.40 17736.95  17736.95
## 17 2022-10-28 03:45:00 250000 17838.90 17723.70 17756.40 17786.80  17786.80
## 18 2022-10-31 03:45:00 227200 18022.80 17899.90 17910.20 18012.20  18012.20
## 19 2022-11-01 03:45:00 349900 18175.80 18060.15 18130.70 18145.40  18145.40
## 20 2022-11-02 03:45:00 270900 18178.75 18048.65 18177.90 18082.85  18082.85
## 21 2022-11-03 03:45:00 213000 18106.30 17959.20 17968.35 18052.70  18052.70
## 22 2022-11-04 09:00:36      0 18108.00 18017.15 18053.40 18074.30  18074.30</pre>
<p>Please view the <a href="https://yahoofinancer.rsquaredacademy.com/reference/index-class#arguments-2" rel="nofollow" target="_blank">documentation</a> to see the valid values for <code>interval</code> and <code>period</code>.</p>
</div>
</div>
<div id="currency" class="section level2">
<h2>Currency</h2>
<div id="summary-2" class="section level4">
<h4>Summary</h4>
<p><code>currency_summary()</code> retrieve information available via the Summary tab in
Yahoo Finance.. View the <a href="https://yahoofinancer.rsquaredacademy.com/reference/currency_summary.html" rel="nofollow" target="_blank">documentation</a> to learn more.</p>
<pre>currency_summary(from = &quot;USD&quot;, to = &quot;INR&quot;)
## $language
## [1] &quot;en-US&quot;
## 
## $region
## [1] &quot;US&quot;
## 
## $quoteType
## [1] &quot;CURRENCY&quot;
## 
## $typeDisp
## [1] &quot;Currency&quot;
## 
## $quoteSourceName
## [1] &quot;Delayed Quote&quot;
## 
## $triggerable
## [1] TRUE
## 
## $customPriceAlertConfidence
## [1] &quot;HIGH&quot;
## 
## $currency
## [1] &quot;INR&quot;
## 
## $shortName
## [1] &quot;USD/INR&quot;
## 
## $regularMarketChangePercent
## [1] -0.2913199
## 
## $regularMarketPrice
## [1] 82.485
## 
## $regularMarketChange
## [1] -0.2409973
## 
## $regularMarketDayHigh
## [1] 82.731
## 
## $regularMarketDayLow
## [1] 82.45
## 
## $regularMarketPreviousClose
## [1] 82.726
## 
## $bid
## [1] 82.48
## 
## $ask
## [1] 82.53
## 
## $regularMarketOpen
## [1] 82.731
## 
## $fiftyTwoWeekLow
## [1] 73.6975
## 
## $fiftyTwoWeekHigh
## [1] 83.386
## 
## $fiftyDayAverage
## [1] 81.12029
## 
## $twoHundredDayAverage
## [1] 78.23625
## 
## $exchange
## [1] &quot;CCY&quot;
## 
## $messageBoardId
## [1] &quot;finmb_INR_X&quot;
## 
## $exchangeTimezoneName
## [1] &quot;Europe/London&quot;
## 
## $exchangeTimezoneShortName
## [1] &quot;GMT&quot;
## 
## $gmtOffSetMilliseconds
## [1] 0
## 
## $market
## [1] &quot;ccy_market&quot;
## 
## $esgPopulated
## [1] FALSE
## 
## $marketState
## [1] &quot;REGULAR&quot;
## 
## $regularMarketTime
## [1] 1667552433
## 
## $regularMarketDayRange
## [1] &quot;82.45 - 82.731&quot;
## 
## $regularMarketVolume
## [1] 0
## 
## $bidSize
## [1] 0
## 
## $askSize
## [1] 0
## 
## $fullExchangeName
## [1] &quot;CCY&quot;
## 
## $averageDailyVolume3Month
## [1] 0
## 
## $averageDailyVolume10Day
## [1] 0
## 
## $fiftyTwoWeekLowChange
## [1] 8.787498
## 
## $fiftyTwoWeekLowChangePercent
## [1] 0.1192374
## 
## $fiftyTwoWeekRange
## [1] &quot;73.6975 - 83.386&quot;
## 
## $fiftyTwoWeekHighChange
## [1] -0.901001
## 
## $tradeable
## [1] FALSE
## 
## $cryptoTradeable
## [1] FALSE
## 
## $fiftyTwoWeekHighChangePercent
## [1] -0.01080518
## 
## $firstTradeDateMilliseconds
## [1] 1.070237e+12
## 
## $priceHint
## [1] 4
## 
## $fiftyDayAverageChange
## [1] 1.364708
## 
## $fiftyDayAverageChangePercent
## [1] 0.01682326
## 
## $twoHundredDayAverageChange
## [1] 4.248749
## 
## $twoHundredDayAverageChangePercent
## [1] 0.05430665
## 
## $sourceInterval
## [1] 15
## 
## $exchangeDataDelayedBy
## [1] 0
## 
## $symbol
## [1] &quot;USDINR=X&quot;</pre>
</div>
<div id="converter" class="section level4">
<h4>Converter</h4>
<p><code>currency_converter()</code> retrieve current conversion rate between two currencies as
well as historical rates.</p>
<pre>currency_converter(&#39;GBP&#39;, &#39;USD&#39;, &#39;2022-07-01&#39;, &#39;2022-07-10&#39;)
##                  date     high      low     open    close volume adj_close
## 1 2022-06-30 23:00:00 1.216205 1.198064 1.215998 1.216086      0  1.216086
## 2 2022-07-03 23:00:00 1.216515 1.208634 1.210580 1.210273      0  1.210273
## 3 2022-07-04 23:00:00 1.212606 1.190051 1.211402 1.211446      0  1.211446
## 4 2022-07-05 23:00:00 1.198638 1.187761 1.194957 1.194914      0  1.194914
## 5 2022-07-06 23:00:00 1.202183 1.191001 1.191895 1.192321      0  1.192321
## 6 2022-07-07 23:00:00 1.205531 1.192194 1.203196 1.202805      0  1.202805</pre>
<p>The time between data points can be specified using the <code>interval</code> argument.
The <code>period</code> arguments allows the user to retrieve data for specific length of time.</p>
<pre>currency_converter(&#39;GBP&#39;, &#39;USD&#39;, period = &#39;1mo&#39;, interval = &#39;1d&#39;)
##                   date     high      low     open    close volume adj_close
## 1  2022-10-03 23:00:00 1.144597 1.128222 1.133967 1.133414      0  1.133414
## 2  2022-10-04 23:00:00 1.149491 1.122776 1.145056 1.145134      0  1.145134
## 3  2022-10-05 23:00:00 1.138343 1.112038 1.135589 1.135538      0  1.135538
## 4  2022-10-06 23:00:00 1.122372 1.109201 1.116520 1.116208      0  1.116208
## 5  2022-10-09 23:00:00 1.111086 1.102354 1.107444 1.107273      0  1.107273
## 6  2022-10-10 23:00:00 1.117131 1.100183 1.107849 1.107641      0  1.107641
## 7  2022-10-11 23:00:00 1.109866 1.092645 1.096780 1.096780      0  1.096780
## 8  2022-10-12 23:00:00 1.136196 1.105828 1.109927 1.110556      0  1.110556
## 9  2022-10-13 23:00:00 1.135873 1.116196 1.130148 1.130391      0  1.130391
## 10 2022-10-16 23:00:00 1.143864 1.121705 1.123873 1.124417      0  1.124417
## 11 2022-10-17 23:00:00 1.141201 1.125809 1.135525 1.135396      0  1.135396
## 12 2022-10-18 23:00:00 1.134984 1.122246 1.133954 1.134430      0  1.134430
## 13 2022-10-19 23:00:00 1.133324 1.117368 1.120951 1.121101      0  1.121101
## 14 2022-10-20 23:00:00 1.129318 1.106378 1.122536 1.122146      0  1.122146
## 15 2022-10-23 23:00:00 1.137980 1.127485 1.133645 1.134469      0  1.134469
## 16 2022-10-24 23:00:00 1.149954 1.127370 1.130544 1.130774      0  1.130774
## 17 2022-10-25 23:00:00 1.162358 1.143419 1.146066 1.146224      0  1.146224
## 18 2022-10-26 23:00:00 1.164415 1.155095 1.163345 1.163819      0  1.163819
## 19 2022-10-27 23:00:00 1.160012 1.150616 1.156738 1.156604      0  1.156604
## 20 2022-10-31 00:00:00 1.161332 1.147987 1.160079 1.159595      0  1.159595
## 21 2022-11-01 00:00:00 1.156524 1.144675 1.147184 1.146815      0  1.146815
## 22 2022-11-02 00:00:00 1.152738 1.145856 1.149214 1.148950      0  1.148950
## 23 2022-11-03 00:00:00 1.142178 1.116258 1.138226 1.138433      0  1.138433
## 24 2022-11-04 08:59:42 1.124088 1.115101 1.115922 1.122322      0  1.122322</pre>
<p>View the <a href="https://yahoofinancer.rsquaredacademy.com/reference/currency_converter.html" rel="nofollow" target="_blank">documentation</a> to learn more.</p>
</div>
</div>
<div id="learning-more" class="section level2">
<h2>Learning More</h2>
<ul>
<li><a href="https://yahoofinancer.rsquaredacademy.com/" rel="nofollow" target="_blank">Documentation</a></li>
<li><a href="https://github.com/rsquaredacademy/yahoofinancer" rel="nofollow" target="_blank">GitHub</a></li>
</ul>
</div>
<div id="feedback" class="section level2">
<h2>Feedback</h2>
<p>All feedback is welcome. Issues (bugs and feature requests) can be posted to
<a href="https://github.com/rsquaredacademy/yahoofinancer/issues" rel="nofollow" target="_blank">github tracker</a>.
For help with code or other related questions, feel free to reach out to us
at <a href="mailto:pkgs@rsquaredacademy.com" class="email" rel="nofollow" target="_blank">pkgs@rsquaredacademy.com</a>.</p>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://blog.rsquaredacademy.com/introducing-yahoofinancer-fetch-data-from-yahoo-finance-api/"> Rsquared Academy Blog - Explore Discover Learn</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/introducing-yahoofinancer/">Introducing yahoofinancer</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334310</post-id>	</item>
		<item>
		<title>Map any region in the world with R &#8211; Part II: Obtaining the coordinates</title>
		<link>https://www.r-bloggers.com/2022/11/map-any-region-in-the-world-with-r-part-ii-obtaining-the-coordinates/</link>
		
		<dc:creator><![CDATA[R with White Dwarf]]></dc:creator>
		<pubDate>Fri, 04 Nov 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://blog.rwhitedwarf.com/post/map_any_region_with_ggplot2_part_ii/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; "> Scope of this post<br />
This is the second part of the series to create a map of any region of the world with R.<br />
We are creating maps of data showing changes over a span of time for different countries and pointing at all kinds of cities. That basically mea...</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/map-any-region-in-the-world-with-r-part-ii-obtaining-the-coordinates/">Map any region in the world with R – Part II: Obtaining the coordinates</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://blog.rwhitedwarf.com/post/map_any_region_with_ggplot2_part_ii/"> R with White Dwarf</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<h2 id="scope-of-this-post">Scope of this post</h2>
<p>This is the second part of the series to create a map of any region of the world with R.</p>
<p>We are creating maps of data showing changes over a span of time for different countries and pointing at all kinds of cities. That basically means that we need to <strong>map any region of the world with R</strong>. Today there are all kinds of packages and techniques to do that. I will share the strategy I used with <a href="https://cran.r-project.org/web/packages/ggplot2/index.html" rel="nofollow" target="_blank">ggplot2</a> and <a href="https://cran.r-project.org/web/packages/maps/index.html" rel="nofollow" target="_blank">maps</a> packages, using support of <a href="https://www.openstreetmap.org/" rel="nofollow" target="_blank">Open Street Map</a> to obtain the coordinates of cities and finally making it interactive with <a href="https://shiny.rstudio.com/" rel="nofollow" target="_blank">shiny</a>. The project is quite long for a single post, so my idea is to split it into a few smaller blog posts. So far, the list is a follows:</p>
<ol>
<li><a href="https://blog.rwhitedwarf.com/post/map_any_region_with_ggplot2_part_i/" rel="nofollow" target="_blank">The basic map</a></li>
<li><strong>Web scrapping with nominatim open street maps</strong></li>
<li>Maps with cities</li>
<li>Dynamic maps in time</li>
<li>Making a single script for fast replication</li>
<li>Making the code interactive in a shiny app</li>
</ol>
<p>The ideas is to share the how-to of one of the projects I am most proud of and, at the same time to give back to the R community in hopes that it can help somebody else.</p>
<p>I hope you all enjoy it. Feel free to leave any kind of comment and/or question at the end.</p>
<p><img class="img-zoomable" src="https://i2.wp.com/blog.rwhitedwarf.com/post/2022/map_any_region_with_ggplot2_part_I/maps_DrawingMap.png?w=578&#038;ssl=1" alt="R Maps" data-recalc-dims="1" />
</p>
<h2 id="open-street-maps-and-nominatim">Open Street Maps and Nominatim</h2>
<blockquote>
<p>A simple query</p>
<pre>library('RJSONIO')

site &lt;- (&quot;http://nominatim.openstreetmap.org/search?city=Texcoco&#038;limit=9&#038;format=json&quot;)
(result &lt;- fromJSON(site))

&gt; [[1]]
&gt; [[1]]$place_id
&gt; [1] 1177116
&gt; 
&gt; [[1]]$licence
&gt; [1] &quot;Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright&quot;
&gt; 
&gt; [[1]]$osm_type
&gt; [1] &quot;node&quot;
&gt; 
&gt; [[1]]$osm_id
&gt; [1] 336169214
&gt; 
&gt; [[1]]$boundingbox
&gt; [1] &quot;29.619&quot;       &quot;29.659&quot;       &quot;-111.0786667&quot; &quot;-111.0386667&quot;
&gt; 
&gt; [[1]]$lat
&gt; [1] &quot;29.639&quot;
&gt; 
&gt; [[1]]$lon
&gt; [1] &quot;-111.0586667&quot;
&gt; 
&gt; [[1]]$display_name
&gt; [1] &quot;Texcoco, Carbó, Sonora, México&quot;
&gt; 
&gt; [[1]]$class
&gt; [1] &quot;place&quot;
&gt; 
&gt; [[1]]$type
&gt; [1] &quot;village&quot;
&gt; 
&gt; [[1]]$importance
&gt; [1] 0.385
&gt; 
&gt; [[1]]$icon
&gt; [1] &quot;https://nominatim.openstreetmap.org/ui/mapicons/poi_place_village.p.20.png&quot;
&gt; 
&gt; 
&gt; [[2]]
&gt; [[2]]$place_id
&gt; [1] 3448536
&gt; 
&gt; [[2]]$licence
&gt; [1] &quot;Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright&quot;
&gt; 
&gt; [[2]]$osm_type
&gt; [1] &quot;node&quot;
&gt; 
&gt; [[2]]$osm_id
&gt; [1] 458633446
&gt; 
&gt; [[2]]$boundingbox
&gt; [1] &quot;16.551667&quot;  &quot;16.591667&quot;  &quot;-97.053333&quot; &quot;-97.013333&quot;
&gt; 
&gt; [[2]]$lat
&gt; [1] &quot;16.571667&quot;
&gt; 
&gt; [[2]]$lon
&gt; [1] &quot;-97.033333&quot;
&gt; 
&gt; [[2]]$display_name
&gt; [1] &quot;Texcoco, Santa María Sola, Oaxaca, México&quot;
&gt; 
&gt; [[2]]$class
&gt; [1] &quot;place&quot;
&gt; 
&gt; [[2]]$type
&gt; [1] &quot;hamlet&quot;
&gt; 
&gt; [[2]]$importance
&gt; [1] 0.36
&gt; 
&gt; [[2]]$icon
&gt; [1] &quot;https://nominatim.openstreetmap.org/ui/mapicons/poi_place_village.p.20.png&quot;
</pre>
</blockquote>
<p>We start with <a href="https://www.openstreetmap.org/" rel="nofollow" target="_blank">Open Street Map</a> and its API <a href="https://nominatim.openstreetmap.org/ui/about.html" rel="nofollow" target="_blank">nominatim</a>. In the piece of code above we can see how to perform a simple query for one city. It is basically one long string containing first the url of nominatim and at the end the search details: here we start the search with city using <code>?city=Texcoco</code>, in this case I aimed for a city with only a few results. Next we are limiting the amount of results to 9 with <code>&limit=9</code> and finally requesting the results in format JSON.</p>
<p>We could basically copy the string that we are passing to <code>site</code> and paste it in the web browser to see the results directly there. Feel free to change the city <code>Texcoco</code> to any other city, and play a bit more with the rest of the parameters. Particularly have a look at what happens when you remove the <code>&format=json</code> part or when you exchange <code>json</code> for any other abstract string like <code>csv</code> or other non-recognized format.</p>
<blockquote>
<p>A more specific query</p>
<pre>city &lt;- 'San%20Francisco'
state &lt;- '&#038;state=California'
country &lt;- '&#038;countrycodes=US'
start.nominatim &lt;- &quot;http://nominatim.openstreetmap.org/search?city=&quot;
end.nominatim &lt;- &quot;&#038;format=json&quot;

site &lt;- paste0(start.nominatim, city, country, state, end.nominatim)
(result &lt;- fromJSON(site))

&gt; [[1]]
&gt; [[1]]$place_id
&gt; [1] 297054975
&gt; 
&gt; [[1]]$licence
&gt; [1] &quot;Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright&quot;
&gt; 
&gt; [[1]]$osm_type
&gt; [1] &quot;relation&quot;
&gt; 
&gt; [[1]]$osm_id
&gt; [1] 111968
&gt; 
&gt; [[1]]$boundingbox
&gt; [1] &quot;37.6403143&quot;  &quot;37.929811&quot;   &quot;-123.173825&quot; &quot;-122.281479&quot;
&gt; 
&gt; [[1]]$lat
&gt; [1] &quot;37.7790262&quot;
&gt; 
&gt; [[1]]$lon
&gt; [1] &quot;-122.419906&quot;
&gt; 
&gt; [[1]]$display_name
&gt; [1] &quot;San Francisco, CAL Fire Northern Region, California, United States&quot;
&gt; 
&gt; [[1]]$class
&gt; [1] &quot;boundary&quot;
&gt; 
&gt; [[1]]$type
&gt; [1] &quot;administrative&quot;
&gt; 
&gt; [[1]]$importance
&gt; [1] 1.035131
&gt; 
&gt; [[1]]$icon
&gt; [1] &quot;https://nominatim.openstreetmap.org/ui/mapicons/poi_boundary_administrative.p.20.png&quot;
</pre>
</blockquote>
<p>If you explore OSM and nominatim a bit you will see that we can add search arguments using <code>&</code> followed by the argument we want (i.e., <code>state</code>), the symbol equal <code>=</code> and the argument. In my example above you can see how we are specifying the State and Country of our query. Additionally it is important to know how to pass spaces in a name, for example, San Francisco will be passed as <code>San%20Francisco</code>.</p>
<p>With this basic information in mind and knowing that the package <code>RJSONIO</code> helps us to retrieve the data from the JSON api into an R-friendly format, we can easily prepare a function to search for any city quickly, provided a few extra details like a region, state or county, and especially important, the country (try searching for cities like London or Prague without providing a country, you might be surprised of how many cities exist in the world with such names).</p>
<pre>coords_from_city &lt;- function(City,
                             CountryTwoLetter,
                             Region = NULL,
                             State = NULL,
                             County = NULL){
    require('RJSONIO')
    CityCoded &lt;- gsub(' ','%20',City) #remove space for URLs
    CountryCoded &lt;- paste(&quot;&#038;countrycodes=&quot;, CountryTwoLetter, sep = '')
    extras &lt;- c(state = State, region = Region, county = County)
    extrasCoded &lt;- ''
    if(!is.null(extras)) {
        for(i in 1:length(extras)){
            if(extras[i] != '' &#038;&#038; !is.na(extras[i]) &#038;&#038; !grepl(&quot;^\\s*$&quot;, extras[i])){
                valCoded &lt;- gsub(' ', '%20', extras[i])
                extrasCoded &lt;- paste0(extrasCoded, '&#038;', names(extras)[i], '=', valCoded)
            }
        }
    }
    ## get data
    url &lt;- paste(
        &quot;http://nominatim.openstreetmap.org/search?city=&quot;
      , CityCoded
      , CountryCoded
      , extrasCoded
      , &quot;&#038;format=json&quot;
      , sep=&quot;&quot;)
    x &lt;- fromJSON(url)
    ## retrieve coords
    if(is.vector(x)){
            message(paste('Found', x[[1]]$display_name))
            lon &lt;- x[[1]]$lon
            lat &lt;- x[[1]]$lat
            osm_name &lt;- x[[1]]$display_name
            coords &lt;- data.frame('lon' = lon, 'lat' = lat, 'osm_name' = osm_name)
    }
    ## When x is not a vector
    else{
        message(paste('No results found for', City, CountryTwoLetter))
        coords &lt;- data.frame('lon' = NA, 'lat' = NA)
    }
    ## return a df
    coords
}
</pre>
<p>An important detail to know is that often, providing values to either <code>state</code> or <code>region</code> parameters returns similar results, this is particularly useful in countries where no states are used or other forms of organization are present. However, when the country has “States”, you cannot pass the name of a State to the parameter <code>Region</code>.</p>
<p>The function returns a data frame that we will use later to create a table with all of our results. Since we are interested in creating maps, we only need the coordinates expressed in latitude and longitude parameters. In case the query is not found, it fills the values with <code>NA</code>’s, which later we’ll use to keep track of what was found and what wasn’t. We are also keeping the values inside <code>osm_name</code> which provides enough information to tell the user useful details regarding the search results, including the country of the city found, and other details like state or region.</p>
<p><img class="img-zoomable" src="https://i1.wp.com/blog.rwhitedwarf.com/post/2022/map_any_region_with_ggplot2_part_II/maps_coords_from_city.png?w=578&#038;ssl=1" alt="Function coords_from_city() in detail" data-recalc-dims="1" />
</p>
<p>An important point to consider in <code>coords_from_city</code> is that it will return only the top result from the query. It means that the more information you provide, the more accurate your result will be. For our project it worked well because for big countries we were always collecting enough info about regions and states, while for smaller countries often the options were too small. But if you use the function it is important to know that if you provide a city name like <code>Springfield</code>, <code>Country = 'US'</code> and give no info about State and County, the function will retrieve only the top result from the search and discard the remaining options.</p>
<h2 id="keeping-the-info-in-a-database">Keeping the info in a database</h2>
<p>The function <code>coords_from_city</code> could be enough if we need to retrieve info about a few cities; we could make a for loop, retrieve all the coords we need and sore them in a data frame to later save as csv, <code>Rdata</code> or any format we choose. The same is true when we are searching for hundreds or thousands of cities but with data increasing the searching time also increases. If, for any reason, the R session breaks, the information would be lost and we will have to start all over again from row 1. Therefore, we are going to send every single result to a database. In that way, no matter when we stop the process or how this happens, the data is safely stored outside of R.</p>
<pre>webscrap_to_sqlite &lt;- function(db.name,
                               dat,
                               col.city = 'City',
                               col.country = 'Country',
                               region = NULL,
                               state = NULL,
                               county = NULL)
{
    require(RSQLite)
    df_len &lt;- nrow(dat)
    ## Connect to db and table
    con &lt;- dbConnect(drv=SQLite(), dbname=db.name)
    dbExecute(conn = con,
                &quot;CREATE TABLE IF NOT EXISTS orgs
                    (ID INTEGER UNIQUE,
                     City TEXT, osm_name TEXT,
                     lon REAL,lat REAL)&quot;)
    ## -- Iteration to web-scrap data -- ##
    ccount &lt;- 0
    ## For loop to webscrapping
    for(i in 1:df_len){
        rg &lt;- ifelse(is.null(region), '', dat[[region]][i])
        st &lt;- ifelse(is.null(state), '', dat[[state]][i])
        ct &lt;- ifelse(is.null(county), '', dat[[county]][i])
        print(paste('Entry', i))
        ## Do the webscrap
        coords &lt;- coords_from_city(dat[[col.city]][i],
                                   dat[[col.country]][i],
                                   Region = rg, State = st, County = ct)
        ## DB send query ONLY if coords were found
        if(is.na(coords$lon[1])){
            ccount &lt;- ccount + 1
        }
        else{
            sq &lt;- dbExecute(con, 'INSERT OR IGNORE INTO orgs
                             (ID, City, osm_name, lon, lat)
                             VALUES (?, ?, ?, ?, ?);',
                        list(dat[['ID']][i], dat[[col.city]][i],
                             coords$osm_name, coords$lon[1], coords$lat[1]))
        }
        print(paste('Completed', (i/df_len)*100, '%'))
    }
    ## Close db
    dbDisconnect(con)
    message(paste(&quot;WEB SCRAP FOR COORDINATES SEARCH FINISHED.&quot;,
                ccount, &quot;ENTRIES NOT FOUND&quot;))
}
</pre>
<p>For storing the data I have chosen to use <a href="https://www.sqlite.org/index.html" rel="nofollow" target="_blank">SQLite</a> through the R package <a href="https://rsqlite.r-dbi.org/" rel="nofollow" target="_blank">RSQLite</a>. If you are not familiar with SQL databases I recommend you to start with a general google search and then come back to the documentation of SQLite and the R package. I chose SQLite because we needed to have something light and portable that would allow us to move the information easily from country to country rather than a centralized database where we could store everything, but a very similar approach can be applied using other types of SQL databases.</p>
<p>The function <code>dbConnect()</code> generates the SQLite file if it does not exist yet. Then we give SQLite the order to create the tables <code>orgs</code> if doesn’t exist yet, and the structure for such table. Next we search for the coordinates of the entries one by one using <code>coords_from_city()</code> and finally we send it to the database. In that way we could stop the process at any time and continue later by simply retrieving the table <code>orgs</code> from the database, compare it with our original data and move forward from what is missing. For that, the column <code>ID</code> is critical, it is the column that allows us to link an entry between the original data, the R data.frame and the SQL table.</p>
<p><img class="img-zoomable" src="https://i0.wp.com/blog.rwhitedwarf.com/post/2022/map_any_region_with_ggplot2_part_II/maps_webscrap_to_sqlite.png?w=578&#038;ssl=1" alt="Function webscrap_to_sqlite() in detail" data-recalc-dims="1" />
</p>
<p>Our function also has a variable <code>ccount</code> that counts each time an entry was not found. In that way, once the query is finished it will print the amount of entries that were not found. The reasons for not finding an entry can be many, among the most common ones that I encountered are the following:</p>
<ul>
<li>Wrong spelling of the City name or excess of info (i.e., value “Prague, District 3” when the city name is simply “Prague”).</li>
<li>Wrong spelling of the State, Region and/or County name.</li>
<li>The given City is simply not in the database of Open Street Maps (it happened specially for very small villages).</li>
<li>Breaks of the internet connection. This one is particularly important because sometimes running the query a second or third time would find cities that were not found the first time.</li>
</ul>
<p>To read the data back to R from SQL we simply need to make a connection to the database, read the table, and close the connection. The function <code>combine_df_sql</code> takes care of that and at the same time joins our original data to the data stored in the database by the ID and the city name. This was important for the project because we wanted to keep the coordinates of the cities separated from the rest of the information due to some internal practical reasons. But I think that keeping all the data in SQL at once can facilitate many things. Among others, you could identify when a particular city was already found in the past and retrieve the coordinates from the database directly rather than making a connection to nominatim. I did that for a few countries and it reduces the querying time considerably. For the present post I decided to show the separated version of data in order to provide more tools to the reader.</p>
<pre>combine_df_sql &lt;- function(db.file, original.data){
    require(dplyr)
    require(RSQLite)
    if(is.character(original.data)){
        if(grepl('.csv', original.data, fixed = T)){
            df &lt;- read.csv(original.data)
        }
        else{
            stop(&quot;Incorrect file format for data&quot;)
        }
    }
    else if(is.data.frame(original.data)){
        df &lt;- original.data
    }
    else{
        stop(&quot;Incorrect data format&quot;)
    }
    con &lt;- dbConnect(drv=RSQLite::SQLite(), dbname = db.file)
    db &lt;- dbReadTable(con, &quot;orgs&quot;)
    dbDisconnect(con)
    result &lt;- left_join(df, db, by = c('ID', 'City'))
    return(result)
}
</pre>
<p>Another detail of our function is the ability to read either from the <code>csv</code> file or from a <code>data.frame</code>. Since we were working mainly with csv files and I used data frames for the unit tests, these 2 formats were enough. Feel free to modify or extend the function for the data formats that you might need.</p>
<h2 id="missing-data">Missing data</h2>
<p>As mentioned above, sometimes the results from the query would be incomplete and a second or third run were necessary but with a fewer rows. Some others I just needed to stop the query and continue later from where we left. And yet some other times the data was incomplete or wrong and this could be solved later with the data owner. The 3 scenarios required me to read the csv file to R, then the table from the database and compare them to filter the missing values. So I crafted the function <code>compare_db_data</code> to compare the database (db) to the original data.</p>
<pre>compare_db_data &lt;- function(db.file, dat){
    require(dplyr)
    require(RSQLite)
    if(is.character(dat)){
        if(grepl('.csv', dat, fixed = T)){
            df &lt;- read.csv(dat)
        }
        else{
            stop(&quot;Incorrect file format for data&quot;)
        }
    }
    else if(is.data.frame(dat)){
        df &lt;- dat
    }
    else{
        stop(&quot;Incorrect data format&quot;)
    }
    con &lt;- dbConnect(drv=RSQLite::SQLite(), dbname = db.file)
    db &lt;- dbReadTable(con, &quot;orgs&quot;)
    dbDisconnect(con)
    filtered &lt;- filter(df, !(as.character(ID) %in%
                              as.character(db$ID)))
    filtered
}
</pre>
<p>As mentioned earlier, sometimes Open Street Maps would simply not have registered certain “cities” (in fact it happened only with really small villages or populations). For that the function <code>add_coords_manually</code> would take a csv file with a particular structure to add the missing data. The csv file must have the following columns:</p>
<ul>
<li><code>ID</code> column named exactly like that and containing the same ID as the original data.</li>
<li>A column containing the name of the city</li>
<li>Columns containing the Latitude and Longitude were we want to point at the city</li>
<li>A value for <code>osm_name</code>. This could be left empty or we can provide the value we want in this slot. What is important is to have the column present in the csv file.</li>
</ul>
<p>Then, as in previous function, we pass to <code>add_coords_manually</code> the name of the csv file with the complementary information, the name of the SQLite database and the names of the columns where we have the values for <code>city</code> names, <code>osm_name</code>, <code>lat</code> and <code>long</code>, all as strings. The rest of the function is self descriptive, provided basic knowledge of SQL syntax.</p>
<pre>add_coords_manually &lt;- function(csv_file, db.name,
                                city, osm_name, lat, lon){
    require(tidyverse)
    require(RSQLite)
    csv_dat &lt;- read_csv(csv_file)
    csv_len &lt;- length(csv_dat$ID)
    con &lt;- dbConnect(drv=RSQLite::SQLite(), dbname=db.name)
    for(i in 1:csv_len){
        dbSendQuery(con, 'INSERT OR IGNORE INTO orgs
                      (ID, City, osm_name, lon, lat)
                      VALUES (?, ?, ?, ?, ?);',
                    list(csv_dat[['ID']][i],
                         csv_dat[[city]][i],
                         csv_dat[[osm_name]][i],
                         csv_dat[[lat]][i],
                         csv_dat[[lon]][i]))
    }
    dbDisconnect(con)
    print(paste(csv_len, 'inserted'))
}
</pre>
<h2 id="next-steps">Next steps</h2>
<p>If you are new to R you could probably already had noticed that one of the strengths of R that I’m using a lot here is its use of functions. The first maps that we created were done writing scripts with a few hundreds of lines. Those gave us the basis to craft the necessary functions and so, the rest of the maps were possible using just a few lines. Some of the scripts for the web scrapping of the coordinates consist of less than 10 lines of code. That is possible using the functions above and a few others created for special or particular cases. I will not share absolutely everything but I want to give an idea of how to make the process more efficient. You can always create more functions for your particular cases or modify my proposed functions to adapt to your particular situation.</p>
<p>And speaking of extensibility, just while writting this blog I found out about the package <a href="https://github.com/r-tmap/tmaptools" rel="nofollow" target="_blank">tmaptools</a> which contains the function <a href="https://www.rdocumentation.org/packages/tmap/versions/1.6-1/topics/geocode_OSM" rel="nofollow" target="_blank">geocode_OSM</a> which uses nominatim to retrieve the coordinates of the searched point. The function has a more user friendly searching format and more possibilities for the return value, while my <code>coords_from_city()</code> option stays quite stiff and still with the original format that it was envisioned a few years ago when I created it. If you are truly interested in the topic I invite you to check the package. Myself I have been busy maintaining the code and creating maps that I found little time to do any improvements to the original project. But that’s exactly my main task right now so, if I do any changes to the functions presented here using the <a href="https://github.com/r-tmap/tmaptools" rel="nofollow" target="_blank">tmaptools</a> package you can be sure that I will create a short post to share it as well.</p>
<p>Then, once we got the coordinates of our target cities and we know how to make the basic map, the next step is to add the cities to the base map. In the next post I will show you how I did that and a function to make the process faster and efficient.</p>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://blog.rwhitedwarf.com/post/map_any_region_with_ggplot2_part_ii/"> R with White Dwarf</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/map-any-region-in-the-world-with-r-part-ii-obtaining-the-coordinates/">Map any region in the world with R – Part II: Obtaining the coordinates</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334300</post-id>	</item>
		<item>
		<title>&#8216;CGAL&#8217; meets &#8216;R6&#8217;: the &#8216;cgalMeshes&#8217; package</title>
		<link>https://www.r-bloggers.com/2022/11/cgal-meets-r6-the-cgalmeshes-package/</link>
		
		<dc:creator><![CDATA[Stéphane Laurent]]></dc:creator>
		<pubDate>Thu, 03 Nov 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://laustep.github.io/stlahblog/posts/cgalMeshes.html</guid>

					<description><![CDATA[<p>My new package<br />
        cgalMeshes (not on CRAN<br />
        yet) deals with 3D meshes. All algorithms implemented in this package<br />
        are performed by the C++ library<br />
        CGAL.</p>
<p>        I already wrapped some CGA...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/cgal-meets-r6-the-cgalmeshes-package/">‘CGAL’ meets ‘R6’: the ‘cgalMeshes’ package</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://laustep.github.io/stlahblog/posts/cgalMeshes.html"> Saturn Elephant</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<div class="container-fluid">
  <div class="main col-sm-12">
    <div class="content">
      <p>
        My new package
        <a href="https://github.com/stla/cgalMeshes" rel="nofollow" target="_blank">cgalMeshes</a> (not on CRAN
        yet) deals with 3D meshes. All algorithms implemented in this package
        are performed by the C++ library
        <a href="https://www.cgal.org/" rel="nofollow" target="_blank">CGAL</a>.
      </p>
      <p>
        I already wrapped some <strong>CGAL</strong> stuff in some other
        packages. But these packages have been archived by CRAN because there
        were some warnings from the <strong>CGAL</strong> library, and I can’t
        fix them. So I didn’t implement the algorithms which throw some
        CRAN-unacceptable warnings in <strong>cgalMeshes</strong>, and hopefully
        this package will remain on CRAN.
      </p>
      <p>
        Moreover this package is different: the meshes are represented by a
        <strong>R6</strong> class, called <code>cgalMesh</code>. This is more
        convenient for the user, and once a mesh is instantiated, it stays in
        memory, whereas the mesh was reprocessed at each operation with the
        other packages.
      </p>
      <p>
        Let’s have a quick look at <strong>cgalMeshes</strong>. Recall that the
        <strong>R6</strong> class representing a mesh is called
        <code>cgalMesh</code>. So to create a <strong>R6</strong> object from
        this class, one has to use the <code>new</code> method. This method
        allows to instantiate a mesh from a file, a <strong>rgl</strong> mesh,
        or from a matrix of vertices and a list of faces.
      </p>
      <p>
        I have the Stanford dragon in a mesh file. Let’s create a new
        <code>cgalMesh</code> object from this file:
      </p>
      <div class="sourceCode" id="cb1">
        <pre>library(cgalMeshes)
dragon &lt;- cgalMesh$new(&quot;StanfordDragon.off&quot;)
dragon
## Mesh with 100239 vertices and 200379 faces.</pre>
      </div>
      <p>
        Let’s plot it. We first do a <strong>rgl</strong> mesh from
        <code>dragon</code> with the <code>getMesh</code> method:
      </p>
      <div class="sourceCode" id="cb2">
        <pre>rglDragon &lt;- dragon$getMesh()</pre>
      </div>
      <p>And now we plot the Stanford dragon:</p>
      <div class="sourceCode" id="cb3">
        <pre>library(rgl)
open3d(windowRect = 50 + c(0, 0, 512, 512))
view3d(-30, 0, zoom = 0.7)
shade3d(rglDragon, color = &quot;darkgreen&quot;)</pre>
      </div>
      <p>
        <img
          src="https://i0.wp.com/laustep.github.io/stlahblog/posts/figures/StanfordDragon.png?w=578&#038;ssl=1"
          style="width: 75%"
        data-recalc-dims="1" />
      </p>
      <p>We can check whether the mesh is triangle and closed:</p>
      <div class="sourceCode" id="cb4">
        <pre>dragon$isTriangle()
## [1] TRUE
dragon$isClosed()
## [1] FALSE</pre>
      </div>
      <p>
        I don’t know why this mesh is not closed. If it were closed, we could
        get its volume by running <code>dragon$volume</code>:
      </p>
      <div class="sourceCode" id="cb5">
        <pre>dragon$volume()
## Error in .CppObject$volume(...): The mesh is not closed.</pre>
      </div>
      <p>
        Let’s do something more funny now. We will compute the geodesic
        distances between a source vertex on the mesh and all other vertices,
        and we will plot the dragon after assigning to each vertex a color
        corresponding to its geodesic distance from the source vertex. The
        geodesic distance between two vertices is the length of the shortest
        path between these two vertices which lies on the surface of the mesh.
      </p>
      <p>We will take the rightmost vertex for the source vertex:</p>
      <div class="sourceCode" id="cb6">
        <pre>vertices &lt;- dragon$vertices()
index &lt;- which.max(vertices[, 1L])</pre>
      </div>
      <p>
        And we call the <code>geoDists</code> method to get the estimated
        geodesic distances:
      </p>
      <div class="sourceCode" id="cb7">
        <pre>geoDists &lt;- dragon$geoDists(index)</pre>
      </div>
      <p>
        Now we define a coloring function, which associates a color of the
        <code>viridisLite::plasma</code> palette to each number in
        <span class="math inline">\((0, 1)\)</span>:
      </p>
      <div class="sourceCode" id="cb8">
        <pre>fcolor &lt;- colorRamp(viridisLite::plasma(200L))</pre>
      </div>
      <p>Then we associate a color to each vertex:</p>
      <div class="sourceCode" id="cb9">
        <pre>colors &lt;- fcolor(geoDists / max(geoDists))</pre>
      </div>
      <p>
        The <code>colors</code> object is a matrix, one row for each vertex, and
        the columns provide the RGB coding of the color. We use the
        <code>rgb</code> function to get hexadecimal colors:
      </p>
      <div class="sourceCode" id="cb10">
        <pre>colors &lt;- rgb(
  colors[, 1L], colors[, 2L], colors[, 3L], maxColorValue = 255
)</pre>
      </div>
      <p>Now we can add these colors to the <strong>rgl</strong> mesh:</p>
      <div class="sourceCode" id="cb11">
        <pre>rglDragon[[&quot;material&quot;]] &lt;- list(&quot;color&quot; = colors)</pre>
      </div>
      <p>And here is the result:</p>
      <div class="sourceCode" id="cb12">
        <pre>open3d(windowRect = 50 + c(0, 0, 512, 512))
view3d(-30, 0, zoom = 0.7)
shade3d(rglDragon)</pre>
      </div>
      <p>
        <img
          src="https://i1.wp.com/laustep.github.io/stlahblog/posts/figures/StanfordDragon_colors.png?w=578&#038;ssl=1"
          style="width: 75%"
        data-recalc-dims="1" />
      </p>
      <p>
        More images on
        <a href="https://github.com/stla/cgalMeshes" rel="nofollow" target="_blank">the Github repo</a>.
      </p>
    </div>
  </div>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://laustep.github.io/stlahblog/posts/cgalMeshes.html"> Saturn Elephant</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/cgal-meets-r6-the-cgalmeshes-package/">‘CGAL’ meets ‘R6’: the ‘cgalMeshes’ package</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334242</post-id>	</item>
		<item>
		<title>My air travel carbon footprint</title>
		<link>https://www.r-bloggers.com/2022/11/my-air-travel-carbon-footprint/</link>
		
		<dc:creator><![CDATA[Michael]]></dc:creator>
		<pubDate>Wed, 02 Nov 2022 17:28:30 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">http://r.iresmi.net/?p=483</guid>

					<description><![CDATA[<p>I shouldn’t have…</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/my-air-travel-carbon-footprint/">My air travel carbon footprint</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://r.iresmi.net/2022/11/02/my-air-travel-carbon-footprint/"> r.iresmi.net</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

<p><a href="https://en.wikipedia.org/wiki/Flight_shame" rel="nofollow" target="_blank">I shouldn’t have</a>…</p>



<pre>library(tidyverse)
library(sf)
library(glue)
library(rnaturalearth)
library(units)

# grams of carbon dioxide-equivalents per passenger kilometer
# https://en.wikipedia.org/wiki/Fuel_economy_in_aircraft
co2_eq &lt;- set_units(88, g/km)

# countries map from Naturalearth
countries &lt;- ne_countries(scale = &quot;small&quot;, returnclass = &quot;sf&quot;)

# airport code and coordinates to geolocate itineraries
airport &lt;- read_csv(&quot;https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat&quot;,
                    col_names = c(&quot;airport&quot;,
                                  &quot;name&quot;,
                                  &quot;city&quot;,
                                  &quot;country&quot;,
                                  &quot;iata&quot;,
                                  &quot;icao&quot;,
                                  &quot;latitude&quot;,
                                  &quot;longitude&quot;,
                                  &quot;altitude&quot;,
                                  &quot;timezone&quot;,
                                  &quot;dst&quot;,
                                  &quot;tz&quot;,
                                  &quot;type&quot;,
                                  &quot;source&quot;)) %&gt;% 
  # Add Kai Tak, missig from the airport data
  add_row(iata = &quot;HKGX&quot;,
          name = &quot;Kai Tak&quot;, 
          city = &quot;Hong Kong&quot;,
          latitude = 22.328611,
          longitude = 114.194167)

# itineraries
flight &lt;- read_delim(&quot;from-to
LYS-LHR
LHR-LYS
LYS-BOD
LYS-BOD
LYS-BOD
LYS-BOD
BOD-LYS
BOD-LYS
BOD-LYS
LYS-BOD
BOD-LYS
BOD-LGW
LHR-JNB
CPT-JNB
JNB-LHR
LHR-ORY
BOD-ORY
CDG-HKGX
HKGX-PER
SYD-HKGX
HKGX-CDG
ORY-CAY
CAY-BEL
BEL-BSB
BSB-MAO
MAO-VVI
VVI-LPB
LPB-MAO
MAO-BEL
BEL-CAY
CAY-XAU
XAU-CAY
CAY-XAU
XAU-CAY
CAY-XAU
XAU-CAY
CAY-ORY
NCE-MXP
MXP-NCE
CDG-CAY
CAY-MPY
MPY-CAY
CAY-CDG
CDG-HKG
HKG-SYD
SYD-HKG
HKG-SYD
TLN-ORY
CDG-CPH
CPH-ORY
ORY-TLN
CDG-YYZ
YYZ-SFO
SFO-YYZ
YYZ-CDG
ORY-TLN
TLN-ORY
LYS-AMS
AMS-SHJ
SHJ-KTM
KTM-SHJ
SHJ-AMS
AMS-LYS
CDG-AUH
AUH-MCT
MCT-KTM
KTM-PKR
PKR-KTM
KTM-MCT
MCT-AUH
AUH-CDG
GVA-FCO
FCO-GVA
CDG-RUN
RUN-CDG
GVA-KEF
KEF-GVA
CDG-ARN
ARN-KRN
KRN-ARN
ARN-CDG
CDG-RUN
RUN-CDG&quot;, delim = &quot;-&quot;)

# geolocate
flight_geo &lt;- flight %&gt;% 
  left_join(airport, by = c(&quot;from&quot; = &quot;iata&quot;)) %&gt;% 
  left_join(airport, by = c(&quot;to&quot; = &quot;iata&quot;), suffix = c(&quot;_from&quot;, &quot;_to&quot;))

# create lines
flight_lines &lt;- flight_geo %&gt;% 
  mutate(line = glue(&quot;LINESTRING ({longitude_from} {latitude_from}, {longitude_to} {latitude_to})&quot;)) %&gt;% 
  st_as_sf(wkt = &quot;line&quot;, crs = &quot;EPSG:4326&quot;)

# create great circles and compute costs
flight_geo_gc &lt;- flight_lines %&gt;% 
  st_segmentize(set_units(100, km)) %&gt;% 
  mutate(distance = set_units(st_length(line), km),
         co2 = set_units(distance * co2_eq, t))

# totals
total_flight &lt;- flight_geo_gc %&gt;% 
  st_drop_geometry() %&gt;% 
  summarise(total_distance = sum(distance, na.rm = TRUE),
            total_co2 = sum(co2, na.rm = TRUE))

# map
ggplot() +
  geom_sf(data = countries, fill = &quot;lightgrey&quot;, color = &quot;lightgrey&quot;) +
  geom_sf(data = flight_geo_gc, color = &quot;red&quot;) + 
  # geom_sf(data = flight_lines, color = &quot;blue&quot;) + 
  labs(title = &quot;My air travel carbon footprint 1993-2020&quot;,
       subtitle = glue(&quot;{round(total_flight$total_distance, -2)} km - {round(total_flight$total_co2, 1)} teqCO₂&quot;)) +
  theme_minimal()
</pre>



<figure class="wp-block-image size-full"><img loading="lazy" src="https://i1.wp.com/r.iresmi.net/wp-content/uploads/2022/11/air_travel.png?w=450" alt="Flygskam" class="wp-image-484" srcset_temp="https://i1.wp.com/r.iresmi.net/wp-content/uploads/2022/11/air_travel.png?w=450 800w, http://r.iresmi.net/wp-content/uploads/2022/11/air_travel-300x225.png 300w, http://r.iresmi.net/wp-content/uploads/2022/11/air_travel-768x576.png 768w" sizes="(max-width: 800px) 100vw, 800px" data-recalc-dims="1" /><figcaption>Flygskam</figcaption></figure>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://r.iresmi.net/2022/11/02/my-air-travel-carbon-footprint/"> r.iresmi.net</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/my-air-travel-carbon-footprint/">My air travel carbon footprint</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334205</post-id>	</item>
		<item>
		<title>Building a TidyModels classification model from scratch and deploying with Vetiver</title>
		<link>https://www.r-bloggers.com/2022/11/building-a-tidymodels-classification-model-from-scratch-and-deploying-with-vetiver/</link>
		
		<dc:creator><![CDATA[Gary Hutson]]></dc:creator>
		<pubDate>Wed, 02 Nov 2022 15:09:23 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://hutsons-hacks.info/?p=15040</guid>

					<description><![CDATA[<p>The awesome TidyModels team have been working hard to populate the tidymodels package and make it even easier to get your foot in the door when it comes to development of models in R. I have been planning this workshop for a long time with my good old colleagues at ...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/building-a-tidymodels-classification-model-from-scratch-and-deploying-with-vetiver/">Building a TidyModels classification model from scratch and deploying with Vetiver</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://hutsons-hacks.info/building-a-tidymodels-classification-model-from-scratch-and-deploying-with-vetiver"> R Blogs – Hutsons-hacks</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

<figure class="wp-block-image size-full"><img loading="lazy" width="200" height="200" src="https://i1.wp.com/hutsons-hacks.info/wp-content/uploads/2022/11/TidyModels.gif?resize=200%2C200&#038;ssl=1" alt="" class="wp-image-15048" data-recalc-dims="1"/></figure>



<p>The awesome TidyModels team have been working hard to populate the tidymodels package and make it even easier to get your foot in the door when it comes to development of models in R. </p>



<p>I have been planning this workshop for a long time with my good old colleagues at the NHS-R Community, and we thought it apt to do this workshop in the run up to the awesome NHS-R Conference 2022, which sadly I cannot make this year due to work commitments.</p>



<h2>What did the workshop cover? </h2>



<p>In the workshop we went over many concepts relating to machine learning, with the focus being on: </p>



<ul><li>Load in data from the <a href="https://cran.r-project.org/web/packages/MLDataR/vignettes/MLDataR.html" rel="nofollow" target="_blank">MLDataR</a> library</li><li>Explaratory data analysis</li><li>Create a <a href="https://recipes.tidymodels.org/" rel="nofollow" target="_blank">recipe</a> for model training</li><li>Build a <a href="https://www.tidyverse.org/blog/2018/11/parsnip-0-0-1/" rel="nofollow" target="_blank">Parsnip</a> baseline regression model and then compare to a cutting edge algorithm (XGBoost)</li><li>Hyperparameter tune with <a href="https://dials.tidymodels.org/" rel="nofollow" target="_blank">dials</a> and fit seperate models</li><li>Evaluate your model with <a href="https://cran.r-project.org/web/packages/ConfusionTableR/vignettes/ConfusionTableR.html" rel="nofollow" target="_blank">ConfusionTableR</a></li><li>Visualise and save your model results</li><li>Serialise model</li><li>Build inference script to pass production data through model</li><li>Deploy your model with <a href="https://vetiver.rstudio.com/" rel="nofollow" target="_blank">Vetiver</a> (a new package for MLOps) which creates a <a href="https://www.rplumber.io/" rel="nofollow" target="_blank">Plumber API</a> and docs for deploying to other services, such as a Dockerfile</li></ul>



<p>This was structured as a code along workshop and it was interesting dealing and fault fixing issues on the spot.</p>



<h2>Can I follow along with the workshop? </h2>



<p>The workshop can be followed along below: </p>



<figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
<iframe loading="lazy" class="youtube-player" width="450" src="https://www.youtube.com/embed/CEh-jeQdOqA?version=3&#038;rel=1&#038;%23038;showsearch=0&#038;%23038;showinfo=1&#038;%23038;iv_load_policy=1&#038;%23038;fs=1&#038;%23038;hl=en-GB&#038;%23038;autohide=2&#038;%23038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe>
</div></figure>



<p>This contains the full two hour tutorial and active workshop ran on behalf of the NHS-R Community. </p>



<h2>Where can I get the code? </h2>



<p>The code can be obtained by accessing the supporting GitHub, please make sure you give it a star:</p>



<ul><li>The associated GitHub repository can be found here: <a rel="nofollow" href="https://github.com/StatsGary/NHS_R_Comm_Build_TM_from_scratch" target="_blank">https://github.com/StatsGary/NHS_R_Comm_Build_TM_from_scratch </a></li><li>Associated resources:<ul><li>Building a classification model from scratch and deploying with Plumber: <a href="https://youtu.be/PtD5hgHM-DY" rel="nofollow" target="_blank">https://youtu.be/PtD5hgHM-DY</a></li><li>TidyModels webinar on building TidyModels models: <a href="https://www.youtube.com/watch?v=hxRx7ozLNKw" rel="nofollow" target="_blank">https://www.youtube.com/watch?v=hxRx7ozLNKw</a></li><li>Deploying Plumber web service as a Docker micro-service: <a href="https://youtu.be/JK6VLAKRjO4" rel="nofollow" target="_blank">https://youtu.be/JK6VLAKRjO4</a></li><li>Advanced Modelling with Caret in R: <a href="https://www.youtube.com/watch?v=9uLiSTc-MUs" rel="nofollow" target="_blank">https://www.youtube.com/watch?v=9uLiSTc-MUs</a></li><li>Introduction to Docker and R: <a href="https://github.com/StatsGary/NHS_R_Community_Intro_to_Docker" rel="nofollow" target="_blank">https://github.com/StatsGary/</a><a href="https://github.com/StatsGary/NHS_R_Community_Intro_to_Docker" rel="nofollow" target="_blank">NHS_R_Community_Intro_to_Docker</a></li><li><a href="https://www.youtube.com/watch?v=9zcUlgLySZo&#038;list=PL37zlCA8GQdo-mObS7U6ViJduy9CyC5aI&#038;index=15&#038;t=322s" rel="nofollow" target="_blank">Assessing classification model with ConfusionTableR and outputting matrix to database</a> – this will show you how to use the Confusion Matrix object of R and then be able to store the results into a database with ConfusionTableR.</li></ul></li></ul>



<h2>Closing thoughts</h2>



<p>I really enjoyed this interactive session and it has had good to have an opportunity to feedback. This session has already attracted interest from the TidyModels team at R-Studio (now Posit) and from members of the group:</p>



<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Excellent workshop today on building a TidyModels from scratch, was incredibly helpful as a newbie to modelling in R! Thanks <a href="https://twitter.com/StatsGary?ref_src=twsrc%5Etfw" rel="nofollow" target="_blank">@StatsGary</a> <a href="https://twitter.com/NHSrCommunity?ref_src=twsrc%5Etfw" rel="nofollow" target="_blank">@NHSrCommunity</a> <img src="https://i0.wp.com/s.w.org/images/core/emoji/14.0.0/72x72/1f601.png?w=578&#038;ssl=1" alt="&#x1f601;" class="wp-smiley" style="height: 1em; max-height: 1em;" data-recalc-dims="1" /> <a href="https://t.co/WWQqRRSivI" rel="nofollow" target="_blank">pic.twitter.com/WWQqRRSivI</a></p>— Craig (@Craig4Epi) <a href="https://twitter.com/Craig4Epi/status/1587486946439614464?ref_src=twsrc%5Etfw" rel="nofollow" target="_blank">November 1, 2022</a></blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://hutsons-hacks.info/building-a-tidymodels-classification-model-from-scratch-and-deploying-with-vetiver"> R Blogs – Hutsons-hacks</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/building-a-tidymodels-classification-model-from-scratch-and-deploying-with-vetiver/">Building a TidyModels classification model from scratch and deploying with Vetiver</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334186</post-id>	</item>
		<item>
		<title>Extract POIs from a Suunto watch</title>
		<link>https://www.r-bloggers.com/2022/11/extract-pois-from-a-suunto-watch/</link>
		
		<dc:creator><![CDATA[Michael]]></dc:creator>
		<pubDate>Wed, 02 Nov 2022 09:56:47 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">http://r.iresmi.net/?p=474</guid>

					<description><![CDATA[<p>The Suunto watches (Spartan, Suunto 9,…) can record waypoints (or POIs) but although they can be visualized in the Suunto app (or on the watch), they cannot be exported to be used with other tools. It used to be possible to access them from the Movescount website but it was discontinued ...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/extract-pois-from-a-suunto-watch/">Extract POIs from a Suunto watch</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://r.iresmi.net/2022/11/02/extract-pois-from-a-suunto-watch/"> r.iresmi.net</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

<p>The Suunto watches (Spartan, Suunto 9,…) can record waypoints (or <acronym title="points of interest">POIs</acronym>) but although they can be visualized in the Suunto app (or on the watch), they cannot be exported to be used with other tools. It used to be possible to access them from the Movescount website but it was discontinued a few month ago.</p>



<p>So we have to use <a href="https://forum.suunto.com/post/40800" rel="nofollow" target="_blank">some black magic tricks</a> to extract them :</p>



<blockquote class="wp-block-quote"><ul><li>Make sure Suunto app has storage permission.</li><li>Go to settings and tap many times the version number. Logging will start.</li><li>Go to home , pull to refresh the feed</li><li>Wait a bit</li><li>Go again to settings tap many times the version it will stop logging</li><li>On your Android internal storage there will be a folder called stt</li></ul></blockquote>



<p>Actually, with the current app version, we get an SQLite database in :</p>



<pre>android &gt; data &gt; com.stt.android.suunto &gt; files &gt; stt-dump &gt; amer_app.db</pre>



<p>Now it’s just a matter of copying the file (via USB, bluetooth, <em>etc.</em>) to a PC, connecting to the database and finding where the POIs are stored (in a table called… <em>pois</em>) ; we can use <a href="https://www.qgis.org/" rel="nofollow" target="_blank">QGIS</a> or <a href="https://www.r-project.org/" rel="nofollow" target="_blank">R</a> for that…</p>



<p>With R, we can select this year POIs (dates are stored as UNIX timestamp) and export them as GeoJSON :</p>



<pre>library(RSQLite)
library(dplyr)
library(lubridate)
library(sf)
library(leaflet)

cnx &lt;- dbConnect(SQLite(), &quot;~/amer_app.db&quot;)

poi &lt;- dbGetQuery(cnx, &quot;SELECT * FROM pois&quot;) %&gt;% 
  filter(creation &gt;= format(ymd(&quot;2022-01-01&quot;), &quot;%s&quot;)) %&gt;% 
  st_as_sf(coords = c(&quot;longitude&quot;, &quot;latitude&quot;), crs = &quot;EPSG:4326&quot;)

poi %&gt;% 
  st_write(&quot;~/pois.geojson&quot;)</pre>



<p>Or we can easily map them :</p>



<pre>poi %&gt;% 
  leaflet() %&gt;% 
  addCircleMarkers() %&gt;% 
  addTiles()</pre>



<figure class="wp-block-image size-full"><img loading="lazy" src="https://i0.wp.com/r.iresmi.net/wp-content/uploads/2022/11/Capture-du-2022-11-02-10-31-00.png?w=450" alt="" class="wp-image-476" srcset_temp="https://i0.wp.com/r.iresmi.net/wp-content/uploads/2022/11/Capture-du-2022-11-02-10-31-00.png?w=450 713w, http://r.iresmi.net/wp-content/uploads/2022/11/Capture-du-2022-11-02-10-31-00-300x191.png 300w" sizes="(max-width: 713px) 100vw, 713px" data-recalc-dims="1" /></figure>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://r.iresmi.net/2022/11/02/extract-pois-from-a-suunto-watch/"> r.iresmi.net</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/extract-pois-from-a-suunto-watch/">Extract POIs from a Suunto watch</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334183</post-id>	</item>
		<item>
		<title>A web application for forecasting in Python, R, Ruby, C#, JavaScript, PHP, Go, Rust, Java, MATLAB, etc.</title>
		<link>https://www.r-bloggers.com/2022/11/a-web-application-for-forecasting-in-python-r-ruby-c-javascript-php-go-rust-java-matlab-etc/</link>
		
		<dc:creator><![CDATA[T. Moudiki]]></dc:creator>
		<pubDate>Wed, 02 Nov 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://thierrymoudiki.github.io//blog/2022/11/02/python/r/forecasting/misc/forecasting-api</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; "> A Forecasting API, with examples</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/a-web-application-for-forecasting-in-python-r-ruby-c-javascript-php-go-rust-java-matlab-etc/">A web application for forecasting in Python, R, Ruby, C#, JavaScript, PHP, Go, Rust, Java, MATLAB, etc.</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://thierrymoudiki.github.io//blog/2022/11/02/python/r/forecasting/misc/forecasting-api"> T. Moudiki's Webpage - R</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<p><strong>Content</strong></p>

<ul>
  <li> 0 &#8211; Intro </li>
  <li> 1 &#8211; Create an account </li>
  <li> 2 &#8211; Get a token for authentication </li>
  <li> 3 &#8211; Requests for forecasts </li>
  <li> 4 &#8211; On model calibration and cross-validation </li>
</ul>

<h2 id="0---intro">0 &#8211; Intro</h2>

<p>In this post, I’ll describe an (work-in-progress) Application Programming Interface (API) for time series forecasting. An API is a system that can receive requests from your computer, to carry out given tasks on given resources, and return a response. This type of system is programming-language-agnostic. That means: it can be used with Python, JavaScript, PHP, R, Go, C#, Ruby, Rust, Java, MATLAB, Julia, and any other programming language speaking http. And therefore, it could be relatively easily integrated into existing workflows for uncertainty forecasting. I’ve used the following tools for building it:</p>

<ul>
  <li> Python&#8217;s <a href="https://flask.palletsprojects.com/en/2.2.x/" rel="nofollow" target="_blank">Flask</a> for backend development </li>
  <li>  <a href="https://bootswatch.com/" rel="nofollow" target="_blank">Bootswatch</a> for the HTML/CSS theme </li>
  <li>  <a href="https://plotly.com/python/" rel="nofollow" target="_blank">Plotly</a> for interactive graphs </li>
  <li>  <a href="https://www.sqlalchemy.org/" rel="nofollow" target="_blank">SQLAlchemy</a>| <a href="https://www.postgresql.org/" rel="nofollow" target="_blank">PostgreSQL</a>  for database management </li>
  <li>  <a href="https://swagger.io/" rel="nofollow" target="_blank">Swagger</a> for API documentation </li>
  <li>  Salesforce&#8217;s <a href="https://www.heroku.com/" rel="nofollow" target="_blank">Heroku</a> (Cloud Application Platform) for deploying the application </li>
</ul>

<p><strong>The application is here:</strong></p>

<p><a href="https://techtonique2.herokuapp.com/" rel="nofollow" target="_blank">https://techtonique2.herokuapp.com/</a></p>

<p><img src="https://i1.wp.com/thierrymoudiki.github.io/images/2022-11-02/2022-11-02-image1.png?w=578&#038;ssl=1" alt="app's homepage" class="img-responsive" data-recalc-dims="1" /></p>

<p>In the homepage (“/”), you can plot a time series by uploading a csv file, and pushing the button “Plot!”. Some examples of input files are stored on GitHub, at <a href="https://github.com/Techtonique/datasets/tree/main/time_series/univariate" rel="nofollow" target="_blank">https://github.com/Techtonique/datasets/tree/main/time_series/univariate</a>. Hover your cursor over the graph to see the options available, like downloading as png, zooming in and out, etc. Let’s describe the API now.</p>

<h2 id="1---create-an-account">1 &#8211; Create an account:</h2>

<p>In order to sign up, you can use your username or an email address. A valid email address is preferable, because usernames  duplicates aren’t authorized in the database. You don’t want to spend your precious time trying to figure out which username hasn’t been registered yet! In addition, without a valid email address, you won’t be notified for changes and improvements in the API (e.g new forecasting models added, bugs fixes…).</p>

<p><strong>Using  <code>curl</code></strong></p>

<pre>curl -X POST -H &quot;Content-Type: application/json&quot; -d '{&quot;username&quot;:&quot;tester_curl@example.com&quot;,&quot;password&quot;:&quot;pwd&quot;}' https://techtonique2.herokuapp.com/api/users
</pre>

<p>If you want to translate these commands from <code>curl</code> to your favorite programming language (Python, JavaScript, PHP, R, Go, C#, Ruby, Rust, Elixir, Java, MATLAB, Dart, CFML, Ansible URI, Strest), you can simply use the following website: <a href="https://curlconverter.com/" rel="nofollow" target="_blank">https://curlconverter.com/</a>. Of course, it’s important to <a href="https://www.lifewire.com/strong-password-examples-2483118" rel="nofollow" target="_blank">choose a better password</a>!</p>

<p><strong>Using  Python</strong></p>

<p>In the near future, there will be a user-friendly Python package encapsulating these steps.</p>

<pre>import requests

headers = {
    # Already added when you pass json=
    # 'Content-Type': 'application/json',
}

json_data = {
    'username': 'tester_py@example.com',
    'password': 'pwd',
}

response = requests.post('https://techtonique2.herokuapp.com/api/users', headers=headers, json=json_data)
</pre>

<p><strong>Using  R</strong></p>

<p>In the near future, there will be a user-friendly R package encapsulating these steps.</p>

<pre>require(httr)

headers = c(
  `Content-Type` = 'application/json'
)

data = '{&quot;username&quot;:&quot;tester_r@example.com&quot;,&quot;password&quot;:&quot;pwd&quot;}'

res &lt;- httr::POST(url = 'https://techtonique2.herokuapp.com/api/users', 
                  httr::add_headers(.headers=headers), body = data)

print(res)
</pre>

<p>Now that you have an account, you’ll need a token to obtain time series forecasts. 
The username and password could be used for that purpose, but it’s better to avoid 
sending them in every request. In any case, make sure that you’re always sending 
requests to <code>https://</code> and not <code>http://</code>.</p>

<h2 id="2---get-a-token-for-authentication">2 - Get a token for authentication</h2>

<p><strong>Using  <code>curl</code></strong></p>

<pre>curl -u tester_curl@example.com:pwd -X GET https://techtonique2.herokuapp.com/api/token 
</pre>

<p>If you want to translate these commands from <code>curl</code> to your favorite programming language (Python, JavaScript, PHP, R, Go, C#, Ruby, Rust, Elixir, Java, MATLAB, Dart, CFML, Ansible URI, Strest), you can simply use the following website: <a href="https://curlconverter.com/" rel="nofollow" target="_blank">https://curlconverter.com/</a>.</p>

<p><strong>Using  Python</strong></p>

<p>In the near future, there will be a user-friendly Python package encapsulating these steps.</p>

<pre>response_token = requests.get('https://techtonique2.herokuapp.com/api/token', 
auth=('tester_py@example.com', 'pwd'))

token = response_token.json()['token']

print(&quot;\n&quot;)
print(f&quot;token: {token}&quot;)
</pre>

<p><strong>Using  R</strong></p>

<p>In the near future, there will be a user-friendly R package encapsulating these steps.</p>

<pre>res_token &lt;- httr::GET(url = 'https://techtonique2.herokuapp.com/api/token', 
                 httr::authenticate('tester_r@example.com', 'python22orpython33'))

print(res_token)

(token &lt;- httr::content(res_token)$token)
</pre>

<h2 id="3---requests-for-forecasts">3 - Requests for forecasts</h2>

<p>We want to obtain 10 months-ahead forecasts 
for the number of accidental Deaths in the US from 1973 to 1978
, and 
a confidence level of 95% for prediction intervals. The forecasting method is 
Theta from [1] and [2], winner of the M3 competition.</p>

<p>The token from section 2 (valid for 5 minutes)
will be used here for authentication. You should read <a href="https://techtonique2.herokuapp.com/apidocs/" rel="nofollow" target="_blank">the API’s  documentation</a> to understand each forecasting model’s parameters.</p>

<p><strong>Using  <code>curl</code></strong></p>

<pre>curl -u eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpOCsOC8-I:x -F 'file=@/Users/t/Documents/datasets/time_series/univariate/USAccDeaths.csv' &quot;https://techtonique2.herokuapp.com/api/theta?h=10&level=95&quot;
</pre>
<p>If you want to translate these commands from <code>curl</code> to your favorite programming language (Python, JavaScript, PHP, R, Go, C#, Ruby, Rust, Elixir, Java, MATLAB, Dart, CFML, Ansible URI, Strest), you can simply use the following website: <a href="https://curlconverter.com/" rel="nofollow" target="_blank">https://curlconverter.com/</a>.</p>

<p><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpOCsOC8-I</code> is a simplified example of the type of token which can be obtained in step 2. The csv file sent in the request must be stored on your computer. Examples of such files can be found <a href="https://github.com/Techtonique/datasets/tree/main/time_series/univariate" rel="nofollow" target="_blank">here</a>.</p>

<p><strong>Using  Python</strong></p>

<p>In the near future, there will be a user-friendly Python package encapsulating these steps.</p>

<pre>params = {
    'h': '10',
    'level': '95',
}


files = {
    'file': open('./USAccDeaths.csv', 'rb') # File available at https://github.com/Techtonique/datasets/tree/main/time_series/univariate
}

response_forecast = requests.post('https://techtonique2.herokuapp.com/api/theta', 
files=files, params=params, auth=(token, 'x'))

print(response_forecast.json())

</pre>

<p><strong>Using  R</strong></p>

<p>In the near future, there will be a user-friendly R package encapsulating these steps.</p>

<pre>params = list(
  `h` = '10', # horizon
  `level` = '95' # level of confidence for prediction intervals
)

files = list(
  `file` = upload_file('./USAccDeaths.csv') # File available at https://github.com/Techtonique/datasets/tree/main/time_series/univariate
)

ptm &lt;- proc.time()[3]
res_forecast &lt;- httr::POST(url = 'https://techtonique2.herokuapp.com/api/theta', 
                           query = params, body = files, encode = 'multipart', 
                           httr::authenticate(token, 'x'))
proc.time()[3] - ptm

list_res &lt;- httr::content(res_forecast)

# Plot results

# 1 - Results From R package forecast -----

require(forecast)

(forecast_object_R &lt;- forecast::thetaf(USAccDeaths, h=10, level = 95))


# 2 - Results From a Python implementation (in the API) -----

h &lt;- length(list_res$ranges)

forecast_object_api &lt;- list()
forecast_object_api$mean &lt;- forecast_object_api$upper &lt;- forecast_object_api$lower &lt;- ts(rep(0, h), 
                                                                             start = start(forecast_object_R$mean),
                                                                             frequency = frequency(forecast_object_R$x))

for (i in 1:h)
{
  forecast_object_api$mean[i] &lt;- list_res$averages[[i]][[2]]
  forecast_object_api$lower[i] &lt;- list_res$ranges[[i]][[2]]
  forecast_object_api$upper[i] &lt;- list_res$ranges[[i]][[3]]
}

forecast_object_api$x &lt;- forecast_object_R$x
forecast_object_api$method &lt;- paste0(forecast_object_R$method, &quot; (API)&quot;)
forecast_object_api$level &lt;- forecast_object_R$level
forecast_object_api &lt;- structure(forecast_object_api, class = &quot;forecast&quot;)

print(forecast_object_api)
print(forecast_object_R)

# graphs

par(mfrow=c(1, 2))
plot(forecast_object_R)
plot(forecast_object_api)
</pre>
<p><img src="https://i2.wp.com/thierrymoudiki.github.io/images/2022-11-02/2022-11-02-image2.png?w=578&#038;ssl=1" alt="api responses" class="img-responsive" data-recalc-dims="1" /></p>

<h2 id="4---on-model-calibration-and-cross-validation">4 - On model calibration and cross-validation</h2>

<p>Each model <a href="https://techtonique2.herokuapp.com/apidocs/" rel="nofollow" target="_blank">in the API</a> has 2 additional parameters that we haven’t discussed yet:</p>

<ul>
  <li><code>start_training</code>: Start training index for cross-validation</li>
  <li><code>n_training</code>: Size of training set window for cross-validation</li>
</ul>

<p>Both of these parameters are to be used in a loop, in your favorite programming language, 
when you want to compare models’ performance, or tune their hyperparameters (model calibration). 
You’d code a loop (with 3-seconds delays between each API call in the loop, because you’re nice!) in which:</p>

<ul>
  <li><code>start_training</code> is incremented of 1 at each iteration, and <code>n_training</code>
  remains constant. 
  </li>
  <li> <code>n_training</code> is incremented of 1 at each iteration, and <code>start_training</code>
  remains constant. 
  </li>
</ul>

<p>More on this (cross-validation and model calibration) in a future post. Stay tuned.</p>

<hr />

<p>[1] Assimakopoulos, V., & Nikolopoulos, K. (2000). The theta model: a decomposition approach to forecasting. International journal of forecasting, 16(4), 521-530.</p>

<p>[2] Hyndman, R. J., & Billah, B. (2003). Unmasking the Theta method. International Journal of Forecasting, 19(2), 287-290.</p>


<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://thierrymoudiki.github.io//blog/2022/11/02/python/r/forecasting/misc/forecasting-api"> T. Moudiki's Webpage - R</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/a-web-application-for-forecasting-in-python-r-ruby-c-javascript-php-go-rust-java-matlab-etc/">A web application for forecasting in Python, R, Ruby, C#, JavaScript, PHP, Go, Rust, Java, MATLAB, etc.</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334188</post-id>	</item>
		<item>
		<title>365 Data Science courses free until November 21</title>
		<link>https://www.r-bloggers.com/2022/11/365-data-science-courses-free-until-november-21/</link>
		
		<dc:creator><![CDATA[Sofia Cohen]]></dc:creator>
		<pubDate>Tue, 01 Nov 2022 19:04:51 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://r-posts.com/?p=9935</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; "> The initiative presents a risk-free way to break into data science and an opportunity to upskill for free The online educational platform 365 Data Science launches its #21DaysFREE campaign, providing 100% free unlimited access to all its content for three weeks. From November 1 to 21, you can take courses from renowned instructors, complete ...</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/365-data-science-courses-free-until-november-21/">365 Data Science courses free until November 21</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://r-posts.com/365-data-science-courses-free-until-november-21/"> R-posts.com</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<strong><span style="font-size: 18pt">The initiative presents a risk-free way to break into data science and an opportunity to upskill for free</span><br />
<br />
</strong>
<em>The online educational platform <a href="https://bit.ly/3sovFyN" rel="nofollow" target="_blank">365 Data Science</a> launches its <a href="https://bit.ly/3sovFyN" rel="nofollow" target="_blank">#21DaysFREE</a> campaign, providing 100% free unlimited access to all its content for three weeks. From November 1 to 21, you can t</em><em>ake courses from renowned instructors, complete exams, and earn industry-recognized certificates.<br />
<br />
</em><a href="https://bit.ly/3sovFyN" rel="nofollow" target="_blank"><img data-attachment-id="9938" data-permalink="http://r-posts.com/365-data-science-courses-free-until-november-21/04-all-courses-free_echo_1920x1080px/" data-orig-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?fit=1920%2C1080" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="04. All courses free_echo_1920x1080px" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?fit=450%2C253" data-large-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?fit=450%2C253" loading="lazy" src="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?resize=617%2C347" alt="" width="450" class="alignnone  wp-image-9938" srcset_temp="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?resize=450%2C253 450w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?resize=768%2C432 768w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?resize=1536%2C864 1536w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?w=1920 1920w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/04.-All-courses-free_echo_1920x1080px.jpg?w=1320 1320w" sizes="(max-width: 617px) 100vw, 617px" data-recalc-dims="1" /></a><br />
<br />
<span style="font-size: 18pt">About the Platform</span></p>

365 Data Science has helped over 2 million students worldwide gain skills and knowledge in data science, analytics, and business intelligence.

The program offers an all-encompassing framework for studying data science—whether you’re starting from scratch or looking to upgrade your skills. Students learn with self-paced video lessons and a myriad of exercises and real-world examples. Moreover, 365’s new gamified platform makes the learning journey engaging and rewarding.

Providing a theoretical foundation for all data-related disciplines- <em><a href="https://365datascience.com/courses/probability/" rel="nofollow" target="_blank">Probability</a>, <a href="https://365datascience.com/courses/statistics/" rel="nofollow" target="_blank">Statistics</a></em>, and <a href="https://365datascience.com/courses/mathematics/" rel="nofollow" target="_blank"><em>Mathematics</em></a>, the program also offers a comprehensive <a href="https://365datascience.com/courses/introduction-to-r-programming/" rel="nofollow" target="_blank">introduction to R programming</a>, <a href="https://365datascience.com/courses/introduction-to-r-programming/" rel="nofollow" target="_blank">statistics in R</a>, and courses on <a href="https://365datascience.com/courses/data-visualization/" rel="nofollow" target="_blank">data visualization in R</a>.<br />
<br />
<em> <a href="https://365datascience.com/courses/data-visualization/" rel="nofollow" target="_blank"><img data-attachment-id="9937" data-permalink="http://r-posts.com/365-data-science-courses-free-until-november-21/09-visuals-for-press-release_courses_1920x1080px_4/" data-orig-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?fit=1920%2C1080" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="09. Visuals for press release_courses_1920x1080px_4" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?fit=450%2C253" data-large-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?fit=450%2C253" loading="lazy" src="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?resize=626%2C352" alt="" width="450" class="alignnone  wp-image-9937" srcset_temp="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?resize=450%2C253 450w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?resize=768%2C432 768w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?resize=1536%2C864 1536w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?w=1920 1920w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_courses_1920x1080px_4.jpg?w=1320 1320w" sizes="(max-width: 626px) 100vw, 626px" data-recalc-dims="1" /></a><br />
<br />
</em><span style="font-size: 18pt">#21DaysFREE Campaign<br />
<br />
</span>

Until November 21, you can take as many courses as you want and add new tools to your analytics skill set for free. The platform unlocks all 195 hours of video lessons, hundreds of practical exercises, career tracks, exams, and the opportunity to earn industry-recognized certificates.

“Starting a career in data science requires devotion and determination. Our mission is to give everyone a chance to get familiar with the field and help them succeed professionally,” says Ned Krastev, CEO of 365 Data Science.

This isn’t 365’s first free initiative. The idea of providing unlimited access to all courses was born during the 2020 COVID-19 lockdowns.

“We felt it was the right time to open our platform,” adds Ned. “We tried to help people who had lost their jobs or wanted to switch careers to make a transition into data science and analytics.”

The free access initiative drove unprecedented levels of engagement, which inspired the 365 team to turn it into a yearly endeavor. Their 2021 campaign, in just one month, generated 80,000 new students (aspiring data scientists and analytics specialists) from 200 countries, who viewed 7.5 million minutes of educational content and earned 35,000 certificates.<br />
<br />


While 21 days is not enough to become a fully-fledged professional, the #21DaysFREE initiative provides a risk-free way to familiarize yourself with the industry and lay the foundations of a successful career. Join the program and start for free at <em> <a href="https://bit.ly/3sovFyN" rel="nofollow" target="_blank">365 Data Science</a>. </em>

<em> <br />
<br />
</em>

<img data-attachment-id="9936" data-permalink="http://r-posts.com/365-data-science-courses-free-until-november-21/09-visuals-for-press-release_certificate_1920x1080px_2/" data-orig-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?fit=1920%2C1080" data-orig-size="1920,1080" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="09. Visuals for press release_certificate_1920x1080px_2" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?fit=450%2C253" data-large-file="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?fit=450%2C253" loading="lazy" src="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?resize=646%2C363" alt="" width="450" class="alignnone  wp-image-9936" srcset_temp="https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?resize=450%2C253 450w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?resize=768%2C432 768w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?resize=1536%2C864 1536w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?w=1920 1920w, https://i0.wp.com/r-posts.com/wp-content/uploads/2022/10/09.-Visuals-for-press-release_certificate_1920x1080px_2.jpg?w=1320 1320w" sizes="(max-width: 646px) 100vw, 646px" data-recalc-dims="1" />

<em> </em><hr style="border-top:black solid 1px" /><a href="http://r-posts.com/365-data-science-courses-free-until-november-21/" rel="nofollow" target="_blank">365 Data Science courses free until November 21</a> was first posted on November 1, 2022 at 7:04 pm.<br />
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://r-posts.com/365-data-science-courses-free-until-november-21/"> R-posts.com</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/365-data-science-courses-free-until-november-21/">365 Data Science courses free until November 21</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334118</post-id>	</item>
		<item>
		<title>Bayesian multilevel modeling in R with brms workshop</title>
		<link>https://www.r-bloggers.com/2022/11/bayesian-multilevel-modeling-in-r-with-brms-workshop/</link>
		
		<dc:creator><![CDATA[Dariia Mykhailyshyna]]></dc:creator>
		<pubDate>Tue, 01 Nov 2022 19:04:31 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://r-posts.com/?p=9939</guid>

					<description><![CDATA[<p>Learn how to use Bayesian multilevel modeling in R, while contributing to charity! Join our workshop on Bayesian multilevel modeling in R with brms that is a part of our workshops for Ukraine series.  Here’s some more info:  Title: Bayesian multilevel modeling in R with brms Date: Thursday, November 10...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/bayesian-multilevel-modeling-in-r-with-brms-workshop/">Bayesian multilevel modeling in R with brms workshop</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://r-posts.com/bayesian-multilevel-modeling-in-r-with-brms-workshop/"> R-posts.com</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<span style="font-weight: 400">Learn how to use Bayesian multilevel modeling in R, while contributing to charity! Join our workshop on </span><span style="font-weight: 400">Bayesian multilevel modeling in R with brms</span><span style="font-weight: 400"> that is a part of our workshops for Ukraine series. </span>
<br /></p>

<b>Here’s some more info: </b>

<br />

<b>Title: </b><span style="font-weight: 400">Bayesian multilevel modeling in R with brms<br />
<br />
</span><b>Date: </b><span style="font-weight: 400">Thursday, November 10th, 18:00 – 20:00 CET (Rome, Berlin, Paris timezone)</span>

<b><br />
Speaker:</b> <span style="font-weight: 400">Paul Bürkner </span><span style="font-weight: 400">is a statistician currently working as a Junior Research Group Leader at the Cluster of Excellence SimTech at the University of Stuttgart (Germany). He is interested in a wide range of research topics most of which involve the development, evaluation, implementation, or application of Bayesian methods.  He is the author of the R package brms and member of the Stan Development Team. Previously, Paul studied Psychology and Mathematics at the Universities of Münster and Hagen (Germany) and did his PhD in Münster about optimal design and Bayesian data analysis. He has also worked as a Postdoctoral researcher at the Department of Computer Science at Aalto University (Finland).</span>

<b><br />
Description: </b><span style="font-weight: 400">The workshop will be about Bayesian multilevel models and their implementation in R using the package brms. At start there will be a short introduction to multilevel modeling and to Bayesian statistics in general followed by an introduction to Stan, which is an incredibly flexible language to fit open-ended Bayesian models. I will then explain how to access Stan using just basic R formula syntax via the brms package. It supports a wide range of response distributions and modeling options such as splines, autocorrelation, or censoring all in a multilevel context. A lot of post-processing and plotting methods are implemented as well. Some examples from Psychology and Medicine will be discussed.</span>

<b><br />
Minimal registration fee: </b><span style="font-weight: 400">20 euro (or 20 USD or 750 UAH)</span>

<br />
<br />

<b>How can I register?</b>

<br />

<ul>
    <li style="font-weight: 400"><span style="font-weight: 400">Go to </span><a href="https://bit.ly/3wvwMA6" rel="nofollow" target="_blank"><span style="font-weight: 400">https://bit.ly/3wvwMA6</span></a><span style="font-weight: 400"> or  </span><a href="https://bit.ly/3PFxtNA" rel="nofollow" target="_blank"><span style="font-weight: 400">https://bit.ly/3PFxtNA</span></a><span style="font-weight: 400"> and donate</span><b> at least 20 euro</b><span style="font-weight: 400">. </span><span style="font-weight: 400">Feel free to donate more if you can, all proceeds go directly to support Ukraine.</span></li>
    <li style="font-weight: 400"><span style="font-weight: 400">Save your donation receipt (after the donation is processed, there is an option to enter your email address on the website to which the donation receipt is sent)</span></li>
    <li style="font-weight: 400"><span style="font-weight: 400">Fill in the </span><a href="https://docs.google.com/forms/d/e/1FAIpQLScYf9tIVNe073eNQBccwKgMpdSB2937HXCVpn63HlssxNy6_g/viewform" rel="nofollow" target="_blank"><span style="font-weight: 400">registration form</span></a><span style="font-weight: 400">, attaching a screenshot of a donation receipt (please attach the screenshot of the donation receipt that was emailed to you rather than the page you see after donation).</span></li>
</ul>

<br />

<span style="font-weight: 400">If you are not personally interested in attending, you can also contribute by sponsoring a participation of a student, who will then be able to participate for free. If you choose to sponsor a student, all proceeds will also go directly to organisations working in Ukraine. You can either sponsor a particular student or you can leave it up to us so that we can allocate the sponsored place to students who have signed up for the waiting list.</span>

<br />
<br />

<b>How can I sponsor a student?</b>

<ul>
    <li style="font-weight: 400"><span style="font-weight: 400">Go to </span><a href="https://bit.ly/3wvwMA6" rel="nofollow" target="_blank"><span style="font-weight: 400">https://bit.ly/3wvwMA6</span></a><span style="font-weight: 400"> or </span><a href="https://bit.ly/3PFxtNA" rel="nofollow" target="_blank"><span style="font-weight: 400">https://bit.ly/3PFxtNA</span></a><span style="font-weight: 400"> and donate </span><b>at least 20 euro </b><span style="font-weight: 400">(or 17 GBP or 20 USD or 750 UAH). </span><span style="font-weight: 400">Feel free to donate more if you can, all proceeds go to support Ukraine!</span></li>
    <li style="font-weight: 400"><span style="font-weight: 400">Save your donation receipt (after the donation is processed, there is an option to enter your email address on the website to which the donation receipt is sent)</span></li>
    <li style="font-weight: 400"><span style="font-weight: 400">Fill in the </span><a href="https://docs.google.com/forms/d/e/1FAIpQLSeZ29Tsa2cj8vq9Z-VQUkKs4xIfPpdQKpFASRHV9Y5csL-OOg/viewform" rel="nofollow" target="_blank"><span style="font-weight: 400">sponsorship form</span></a><span style="font-weight: 400">, attaching the screenshot of the donation receipt (please attach the screenshot of the donation receipt that was emailed to you rather than the page you see after the donation). You can indicate whether you want to sponsor a particular student or we can allocate this spot ourselves to the students from the waiting list. You can also indicate whether you prefer us to prioritize students from developing countries when assigning place(s) that you sponsored.</span></li>
</ul>

<br />

<span style="font-weight: 400">If you are a university student and cannot afford the registration fee, you can also sign up for the </span><b>waiting list</b> <a href="https://docs.google.com/forms/d/e/1FAIpQLSc2pKmxDK2qf2Ws_HDQDxZa41kvLsOePTWDvRcbE6cTUFPEHg/viewform" rel="nofollow" target="_blank"><span style="font-weight: 400">here</span></a><span style="font-weight: 400">. (Note that you are not guaranteed to participate by signing up for the waiting list).</span>

<br />
<br />

<span style="font-weight: 400">You can also find more information about this workshop series,  a schedule of our future workshops as well as a list of our past workshops which you can get the recordings &#038; materials of </span><a href="http://bit.ly/3wBeY4S" rel="nofollow" target="_blank"><span style="font-weight: 400">here</span></a><span style="font-weight: 400">.</span>

<br />

<span style="font-weight: 400">Looking forward to seeing you during the workshop!</span><hr style="border-top:black solid 1px" /><a href="http://r-posts.com/bayesian-multilevel-modeling-in-r-with-brms-workshop/" rel="nofollow" target="_blank">Bayesian multilevel modeling in R with brms workshop</a> was first posted on November 1, 2022 at 7:04 pm.<br />
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://r-posts.com/bayesian-multilevel-modeling-in-r-with-brms-workshop/"> R-posts.com</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/bayesian-multilevel-modeling-in-r-with-brms-workshop/">Bayesian multilevel modeling in R with brms workshop</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334120</post-id>	</item>
		<item>
		<title>How do I count thee?  Let me count the ways?</title>
		<link>https://www.r-bloggers.com/2022/11/how-do-i-count-thee-let-me-count-the-ways/</link>
		
		<dc:creator><![CDATA[Jerry Tuttle]]></dc:creator>
		<pubDate>Tue, 01 Nov 2022 19:04:11 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://r-posts.com/?p=9934</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; "> How do I count thee? Let me count the ways? by Jerry Tuttle    In Major League Baseball, a player who hits 50 home runs in a single season has hit a lot of home runs. Suppose I want to count the number of 50 homer seasons by team, and also the number ...</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/how-do-i-count-thee-let-me-count-the-ways/">How do I count thee?  Let me count the ways?</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://r-posts.com/how-do-i-count-thee-let-me-count-the-ways/"> R-posts.com</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<code>How do I count thee?  Let me count the ways?</code>


by Jerry Tuttle   





  In Major League Baseball, a player who hits 50 home runs in a single season
  has hit a lot of home runs. Suppose I want to count the number of 50 homer
  seasons by team, and also the number of 50 homer seasons by New York Yankees.
  (I will count Maris and Mantle in 1961 as two.) Here is the data including Aaron Judge’s 62 in 2022
 :


<div class="separator" style="clear: both"><a href="https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEit4h2l6DfUxIpVzuNtzbp9mqugdXOkE3QrNlHnjQhIb21PiaOqDI1f6S6COOamIYSig0xt35pCZZiFMG52nSmltI9LVvPEQjEMZtOo4vP_tsHj_ryqAKMTs8PpVNvyayg0vvP_4deI9qit2Qd_ltWaa3tSOFG2aUX6rtvrDjr2UARmqs_4quAUfutJ/s752/50.JPG?ssl=1" style="padding: 1em 0;text-align: center" rel="nofollow" target="_blank"><img alt="" border="0" height="600" data-original-height="752" data-original-width="224" src="https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEit4h2l6DfUxIpVzuNtzbp9mqugdXOkE3QrNlHnjQhIb21PiaOqDI1f6S6COOamIYSig0xt35pCZZiFMG52nSmltI9LVvPEQjEMZtOo4vP_tsHj_ryqAKMTs8PpVNvyayg0vvP_4deI9qit2Qd_ltWaa3tSOFG2aUX6rtvrDjr2UARmqs_4quAUfutJ/s600/50.JPG?fit=660%2C600&#038;ssl=1" data-recalc-dims="1" /></a></div>

You would think base R would have a count function such as count(df$Team) and
count(df$Team == “NYY”) but this gives the error “could not find function
‘count&#8217;”. Base R does not have a count function.



Base R has at last four ways to perform a count:


  1. The table function will count items in a vector.   
  table(df$Team) presents results horizontally, and data.frame(table(df$Team))
  presents results vertically.    table(df$Team == “NYY”) displays results 37
  false and 10 true, while table(df$Team == “NYY”)[2] just displays the result 10 true.



  2. The sum function can be used to count the number of rows meeting a
  condition.    sum(df$Team == “NYY”) displays the result 10. Here
  df$Team == “NYY” is creating a logical vector, and sum is summing the number
  of true = 1.



  3. Similar to sum, nrow(df[df$Team == “NYY”, ]) counts the number of rows
  meeting the NYY condition.



  4. The length function counts the number of elements in an R object.
     length(which(df$Team == “NYY”)) , length(df$Team[df$Team ==
  “NYY”]) , and length(grep(“NYY”, df[ , “Team”])) are all ways that will count
  the 10 Yankees.



  The more direct solution to counting uses the count function in the dplyr
  library. Note that dplyr’s count function applies to a data frame or tibble,
  but not to a vector. After loading library(dplyr) ,


1. df %>% count(Team) lists the count for each team.


  2. df %>% filter(Team = “NYY”) lists each Yankee, and you can see there are
  10.



  3. df %>% count(Team == “NYY”) displays 37 false and 10 true, while df %>%
  filter(Team == “NYY”) %>% count() just displays the 10 true.



  The following is a bar chart of the results by team for teams with at least 1
  50 homer season:




<div class="separator" style="clear: both">
  <a href="https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxHDYU4cmCrCRN0f__ztC9WKBVp0EGSy8s6h7mbbe6hgA0rjC4shpIzY2P0aJ3cmvnvNHiDwKUthpWvYEWJZblScM0jitWhiokAY7liixSHiKEMbuIux1TPncxSUkIF1Q2YxSxa47Ef_JIfvlNVWMxu3MLDy68sAh1CGCQ8uoFMnzgSQ1CdSsaRC7f/s824/50.JPG?ssl=1" style="padding: 1em 0;text-align: center" rel="nofollow" target="_blank"><img alt="" border="0" data-original-height="743" data-original-width="450" src="https://i0.wp.com/blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxHDYU4cmCrCRN0f__ztC9WKBVp0EGSy8s6h7mbbe6hgA0rjC4shpIzY2P0aJ3cmvnvNHiDwKUthpWvYEWJZblScM0jitWhiokAY7liixSHiKEMbuIux1TPncxSUkIF1Q2YxSxa47Ef_JIfvlNVWMxu3MLDy68sAh1CGCQ8uoFMnzgSQ1CdSsaRC7f/s320/50.JPG?w=320&#038;ssl=1" data-recalc-dims="1" /></a>
</div>

Finally, “How do I count thee? Let me count the ways?” is of course adapted from
Elizabeth Barrett Browning’s poem “How do I <b>love</b> thee? Let me count the
ways?” But in her poem, just how would we count the number of times “love” is
mentioned? The tidytext library makes counting words fairly easy, and the answer
is ten, the same number of 50 homer Yankee seasons. Coincidence?

The following is all the R code. Happy counting!

<pre>

  library(dplyr) 

  library(ggplot2) 

  library(tidytext) 




  df &lt;- data.frame(

     Player=c('Ruth','Ruth','Ruth','Ruth','Wilson','Foxx','Greenberg','Foxx','Kiner','Mize','Kiner','Mays','Mantle','Maris',
  'Mantle','Mays','Foster','Fielder','Belle','McGwire','Anderson','McGwire','Griffey','McGwire','Sosa','Griffey',
  'Vaughn','McGwire','Sosa','Sosa','Bonds','Sosa','Gonzalez','Rodriguez','Rodriguez','Thome','Jones','Howard','Ortiz',
  'Rodriguez','Fielder','Bautista','Davis','Stanton','Judge','Alonso','Judge'),
  

     Year=c(1920,1921,1927,1928,1930,1932,1938,1938,1947,1947,1949,1955,1956,1961,1961,1965,1977,1990,1995,1996,1996,1997,1997,
  1998,1998,1998,1998,1999,1999,2000,2001,2001,2001,2001,2002,2002,2005,2006,2006,2007,2007,2010,2013,2017,2017,2019,2022),
  


     Homers=c(54,59,60,54,56,58,58,50,51,51,54,51,52,61,54,52,52,51,50,52,50,58,56,70,66,56,50,65,63,50,73,64,57,52,57,52,51,
  58,54,54,50,54,53,59,52,53,62), 

     Team=c('NYY','NYY','NYY','NYY','CHC','PHA','DET','BOS','PIT','NYG','PIT','NYG','NYY','NYY','NYY','SF','CIN','DET','CLE',
  'OAK','BAL','OAK/SLC','SEA','SLC','CHC','SEA','SD','SLC','CHC','CHC','SF','CHC','ARI','TEX','TEX','CLE','ATL','PHP',
  'BOR','NYY','MIL','TOR','BAL','MIA','NYY','NYM','NYY'))


head(df)

# base R ways to count:


  table(df$Team)    # shows results horizontally 

  data.frame(table(df$Team))    #shows results vertically 

  table(df$Team == &quot;NYY&quot;)    # displays 37 false and 10 true
  

  table(df$Team == &quot;NYY&quot;)[2]


sum(df$Team == &quot;NYY&quot;)    # displays the result 10.


  nrow(df[df$Team == &quot;NYY&quot;, ])    # counts the number of rows
  meeting the NYY condition.



  length(which(df$Team == &quot;NYY&quot;))     # which returns a vector of
  indices which are true 

  length(df$Team[df$Team == &quot;NYY&quot;]) 

  length(grep(&quot;NYY&quot;, df[ , &quot;Team&quot;]))     # grep returns a vector
  of indices that match the pattern


# dplyr R ways to count; remember to load library(dplyr):

df %&gt;% count(Team)    # lists the count for each team.


  df %&gt;% filter(Team == &quot;NYY&quot;)    # lists each Yankee, and you
  can see there are 10.



  df %&gt;% count(Team == &quot;NYY&quot;)    # displays 37 false and 10 true,
  while 
 df %&gt;% filter(Team == &quot;NYY&quot;) %&gt;% count()    #
  just displays the 10 true.



  # barplot of all teams with at least 1 50 homer season; remember to load
  library(ggplot2)



  df %&gt;% 

      group_by(Team) %&gt;% 

      summarise(count = n()) %&gt;% 

      ggplot(aes(x=reorder(Team, count), y=count, fill=Team)) +
  

      geom_bar(stat = 'identity') + 

      ggtitle(&quot;Count of 50 Homer Seasons&quot;) + 

      xlab(&quot;Team&quot;) + 

      scale_y_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10)) + 

      coord_flip() + 

      theme(plot.title = element_text(face=&quot;bold&quot;, size=18)) +
  

      theme(axis.title.y = element_text(face=&quot;bold&quot;)) + 

      theme(axis.title.x = element_blank()) + 

      theme(axis.text.x = element_text(size=12, face=&quot;bold&quot;),
  

      axis.text.y = element_text(size=12, face=&quot;bold&quot;)) + 

      theme(legend.position=&quot;none&quot;) 




  # count number of times &quot;love&quot; is mentioned in Browning's poem; remember to
  load library(tidytext)



  textfile &lt;- c(&quot;How do I love thee? Let me count the ways.&quot;, 

  &quot;I love thee to the depth and breadth and height&quot;, 

  &quot;My soul can reach, when feeling out of sight&quot;, 

  &quot;For the ends of being and ideal grace.&quot;, 

  &quot;I love thee to the level of every day's&quot;, 

  &quot;Most quiet need, by sun and candle-light.&quot;, 

  &quot;I love thee freely, as men strive for right.&quot;, 

  &quot;I love thee purely, as they turn from praise.&quot;, 

  &quot;I love thee with the passion put to use&quot;, &lt;br 

  &quot;In my old griefs, and with my childhood's faith.&quot;, 

  &quot;I love thee with a love I seemed to lose&quot;, 

  &quot;With my lost saints. I love thee with the breath,&quot;, &lt;br 

  &quot;Smiles, tears, of all my life; and, if God choose,&quot;, 

  &quot;I shall but love thee better after death.&quot;) 




  df&lt;-data.frame(line=1:length(textfile), text=textfile) &lt;br &lt;br 

  df_words % unnest_tokens(word, text) &lt;br 

  cleaned_words % anti_join(get_stopwords()) 

  cleaned_words %&gt;% count(word, sort = TRUE) %&gt;% head(6) 

  cleaned_words %&gt;% filter(word == &quot;love&quot;) %&gt;% count() 


</pre><hr style="border-top:black solid 1px" /><a href="http://r-posts.com/how-do-i-count-thee-let-me-count-the-ways/" rel="nofollow" target="_blank">How do I count thee?  Let me count the ways?</a> was first posted on November 1, 2022 at 7:04 pm.<br />
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://r-posts.com/how-do-i-count-thee-let-me-count-the-ways/"> R-posts.com</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/how-do-i-count-thee-let-me-count-the-ways/">How do I count thee?  Let me count the ways?</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334122</post-id>	</item>
		<item>
		<title>XLConnect 1.0.6</title>
		<link>https://www.r-bloggers.com/2022/11/xlconnect-1-0-6/</link>
		
		<dc:creator><![CDATA[Mirai Solutions]]></dc:creator>
		<pubDate>Tue, 01 Nov 2022 10:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://mirai-solutions.ch/news/2022/11/01/XLConnect-1.0.6/</guid>

					<description><![CDATA[<p>XLConnect 1.0.6 now available from CRAN and from our GitHub repository.</p>
<p>We are pleased to announce the release of XLConnect 1.0.6. This release is mainly a maintenance release and comes with the following changes:</p>
<p>  Add overwriteFormulaCells pa...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/xlconnect-1-0-6/">XLConnect 1.0.6</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://mirai-solutions.ch/news/2022/11/01/XLConnect-1.0.6/"> Mirai Solutions</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<p><strong>XLConnect 1.0.6</strong> now available from <a href="https://cran.r-project.org/package=XLConnect" rel="nofollow" target="_blank">CRAN</a> and from our <a href="https://github.com/miraisolutions/xlconnect/tree/1.0.6" rel="nofollow" target="_blank">GitHub</a> repository.<br />
<a href="https://cran.r-project.org/package=XLConnect" rel="nofollow" target="_blank"><img src="https://www.r-pkg.org/badges/version/XLConnect" alt="CRAN_Status_Badge" /></a> <a href="http://depsy.org/package/r/XLConnect" rel="nofollow" target="_blank"><img src="http://depsy.org/api/package/cran/XLConnect/badge.svg" alt="Research software impact" /></a> <a href="http://www.rdocumentation.org/packages/XLConnect" rel="nofollow" target="_blank"><img src="http://api.rdocumentation.org/badges/version/XLConnect" alt="Rdoc" /></a></p>

<span id="more-334106"></span>

<p>We are pleased to announce the release of <strong>XLConnect 1.0.6</strong>. This release is mainly a maintenance release and comes with the following changes:</p>

<ul>
  <li>Add <code>overwriteFormulaCells</code> parameter to <code>writeNamedRegion</code>, <code>appendNamedRegion</code>, <code>writeWorkSheet</code> (<a href="https://github.com/miraisolutions/xlconnect/issues/173" rel="nofollow" target="_blank">#173</a>)</li>
  <li>Fix setForceFormulaRecalculation / getForceFormulaRecalculation for R >= 4.2.0 (<a href="https://github.com/miraisolutions/xlconnect/issues/170" rel="nofollow" target="_blank">#170</a>)</li>
  <li>Fix building of vignettes (<a href="https://github.com/miraisolutions/xlconnect/issues/154" rel="nofollow" target="_blank">#154</a>)</li>
  <li>Fix java version parsing (<a href="https://github.com/miraisolutions/xlconnect/issues/156" rel="nofollow" target="_blank">#156</a>)</li>
  <li>Remove java version compatibility upper limit (<a href="https://github.com/miraisolutions/xlconnect/issues/165" rel="nofollow" target="_blank">#165</a>)</li>
  <li>Upgrade to <a href="http://poi.apache.org/" rel="nofollow" target="_blank">Apache POI</a> 5.2.3</li>
</ul>

<p>While the addition of the <code>overwriteFormulaCells</code> parameter seems like a new implementation, it is actually an adjustment due to updates in the underlying <a href="http://poi.apache.org/" rel="nofollow" target="_blank">Apache POI</a>:</p>

<ul>
  <li>Since XLConnect 1.0.0, formula cells in excel are not overwritten anymore automatically when populating them.</li>
  <li>With the new XLConnect 1.0.6, the default behaviour for <code>appendNamedRegion</code>, <code>writeNamedRegion</code> and <code>writeWorksheet</code> will once again overwrite formula cells.</li>
  <li>If you don’t want to overwrite such formula cells, specify <code>overwriteFormulaCells</code> as <code>FALSE</code> when calling said functions.</li>
</ul>
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://mirai-solutions.ch/news/2022/11/01/XLConnect-1.0.6/"> Mirai Solutions</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/11/xlconnect-1-0-6/">XLConnect 1.0.6</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334106</post-id>	</item>
		<item>
		<title>A Footnote in History</title>
		<link>https://www.r-bloggers.com/2022/10/a-footnote-in-history/</link>
		
		<dc:creator><![CDATA[Category R on Quantum Jitter]]></dc:creator>
		<pubDate>Tue, 01 Nov 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.quantumjitter.com/project/footnote/</guid>

					<description><![CDATA[<p>Producing a journal-quality table requires fine-grained and reproducible control over presentation. Surgical targeting of footnotes, capable of adapting to changes in the underlying data, is one example.<br />
This post briefly explores the shifts in the ...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/a-footnote-in-history/">A Footnote in History</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.quantumjitter.com/project/footnote/"> Category R on Quantum Jitter</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<script src="https://www.quantumjitter.com/project/footnote/index_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="https://www.quantumjitter.com/project/footnote/index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<p><img src="https://i1.wp.com/www.quantumjitter.com/project/footnote/feature.gif?w=578&#038;ssl=1" alt="" data-recalc-dims="1"></p>
<p>Producing a journal-quality table requires fine-grained and reproducible control over presentation. Surgical targeting of footnotes, capable of adapting to changes in the underlying data, is one example.</p>
<p>This post briefly explores the shifts in the nature of employment whilst at the same time visiting the grammar of tables 
<a href="https://gt.rstudio.com/" rel="nofollow" target="_blank">gt</a>: The natural companion to the grammar of graphics 
<a href="https://ggplot2.tidyverse.org/" rel="nofollow" target="_blank">ggplot2</a>.</p>
<pre>library(tidyverse)
library(readxl)
library(gt)
library(kableExtra)
</pre><p>Tables are rendered across all 
<a href="https://www.quantumjitter.com/project/" rel="nofollow" target="_blank">projects</a> on this site; as a minimum at the end to summarise an auto-generated overview of the R packages and functions used. For these tables, 
<a href="https://github.com/haozhu233/kableExtra" rel="nofollow" target="_blank">kableExtra</a> has been the go-to solution which requires simply piping the data frame into <code>kbl()</code>.</p>
<p>In 
<a href="https://www.quantumjitter.com/project/planning/" rel="nofollow" target="_blank">Digging Deep</a>, the 
<a href="https://rstudio.github.io/DT/" rel="nofollow" target="_blank">DT package</a> is used to produce a <strong>reactable</strong> table; one with sortable and searchable columns. DT is intended as an R interface to the DataTables library, but reactivity is not yet supported in gt.</p>
<p>As a guiding principle, RStudio – soon to be 
<a href="https://posit.co/" rel="nofollow" target="_blank">Posit</a> – packages are my first port of call. This provides a confidence in cross-package consistency, longevity and an investment in development and support. Hence 
<a href="https://gt.rstudio.com/" rel="nofollow" target="_blank">gt</a> will be the go-to package for the static table further down.</p>
<p>As the intent is to present a summary in the style of the Financial Times, we’ll need a suitable custom 
<a href="https://registry.origami.ft.com/components/o-colors@6.4.2" rel="nofollow" target="_blank">colour palette</a>.</p>
<pre>theme_set(theme_bw())

cols &lt;- c(
  &quot;#FFF1E5&quot;, &quot;#F2DFCE&quot;,
  &quot;#333333&quot;, &quot;#800D33&quot;,
  &quot;#C00000&quot;, &quot;#00994D&quot;
) |&gt;
  fct_inorder()

tibble(x = 1:6, y = 1) |&gt;
  ggplot(aes(x, y, fill = cols)) +
  geom_col() +
  geom_label(aes(label = cols), 
             nudge_y = -0.1, fill = &quot;white&quot;) +
  annotate(
    &quot;label&quot;,
    x = 3.5, y = 0.5,
    label = &quot;Financial Times&quot;,
    fill = &quot;white&quot;,
    alpha = 0.8,
    size = 6
  ) +
  scale_fill_manual(values = as.character(cols)) +
  theme_void() +
  theme(legend.position = &quot;none&quot;)
</pre><img src="https://i2.wp.com/www.quantumjitter.com/project/footnote/index.markdown_strict_files/figure-markdown_strict/theme-1.png?w=450&#038;ssl=1" data-recalc-dims="1" />
<p>The labour market data are sourced from the 
<a href="https://www.nomisweb.co.uk/datasets/aps168/reports/employment-by-occupation?compare=K02000001" rel="nofollow" target="_blank">Office for National Statistics</a>.</p>
<pre>read_data &lt;- function(x) {
  read_xlsx(
    x,
    skip = 12,
    col_names = c(
      &quot;occupation&quot;,
      &quot;persons&quot;
    ),
    col_types = c(
      &quot;text&quot;,
      &quot;numeric&quot;,
      &quot;skip&quot;,
      &quot;skip&quot;,
      &quot;skip&quot;,
      &quot;skip&quot;,
      &quot;skip&quot;
    )
  )
} |&gt; 
  mutate(year = x |&gt; str_remove(&quot;.xlsx&quot;) |&gt; as.integer())

pop_df &lt;- list(&quot;2004.xlsx&quot;, &quot;2021.xlsx&quot;) |&gt; 
  map_dfr(read_data)
</pre><p>There’s a hierarchy to the data, so I’ll extract the lowest level and then slice off the top and bottom occupations based on their percentage change over time.</p>
<pre>change_df &lt;- pop_df |&gt; 
  filter(str_starts(occupation, &quot;\\d{4} &quot;)) |&gt; 
  pivot_wider(names_from = year, values_from = persons) |&gt; 
  separate(occupation, into = c(&quot;soc&quot;, &quot;occupation&quot;), sep = 5) |&gt; 
  mutate(change = `2021` / `2004` - 1) |&gt; 
  arrange(desc(change)) |&gt; 
  mutate(group = if_else(row_number() &lt;= 10, &quot;Risers&quot;, &quot;Fallers&quot;)) |&gt; 
  slice(c(1:10, (n()-10):n())) |&gt; 
  relocate(group)
</pre><p>The handling of footnotes is a particularly nice feature in 
<a href="https://gt.rstudio.com/" rel="nofollow" target="_blank">gt</a>: The package automatically assigns, and maintains the order of, the superscripted numbers (could also be symbols) to ensure they flow naturally. And targeting offers a high degree of control and reproducibility.</p>
<p>For example, two entries in the table below use the abbreviation <em>n.e.c.</em>. The footnote may be targeted at rows which <em>contain that string</em> rather than having to manually identify the rows. And once added, any subsequent footnotes would be renumbered to maintain the flow. So, if I were to change the source datasets to different years or countries, all references to <em>n.e.c.</em> would be automagically found and appropriately footnoted.</p>
<pre>gt_tbl &lt;- change_df |&gt;
  gt(rowname_col = c(&quot;occupation&quot;), groupname_col = &quot;group&quot;) |&gt;
  tab_header(title = &quot;UK Employment by Occupation&quot;) |&gt; 
  fmt_number(
    columns = starts_with(&quot;2&quot;),
    decimals = 0
  ) |&gt;
  fmt_percent(
    columns = starts_with(&quot;c&quot;),
    decimals = 0,
    force_sign = TRUE
  ) |&gt;
  sub_missing() |&gt;
  tab_spanner(
    label = &quot;Year&quot;,
    columns = starts_with(&quot;2&quot;)
  ) |&gt; 
  tab_style(
    style = cell_text(transform = &quot;capitalize&quot;),
    locations = cells_column_labels(!starts_with(&quot;s&quot;))
  ) |&gt; 
  tab_style(
    style = cell_text(transform = &quot;uppercase&quot;),
    locations = cells_column_labels(&quot;soc&quot;)
  ) |&gt; 
  tab_footnote(
    footnote = &quot;Not elsewhere classified&quot;,
    locations = cells_stub(rows = contains(&quot;n.e.c.&quot;))
  ) |&gt;
  tab_footnote(
    footnote = &quot;Count of all persons&quot;,
    locations = cells_column_spanners()
  ) |&gt;
  tab_footnote(
    footnote = &quot;Standard Occupational Classification 2020&quot;,
    locations = cells_column_labels(columns = &quot;soc&quot;)
  ) |&gt;
  tab_footnote(
    footnote = &quot;Top & bottom 10 occupations ordered by percent change&quot;,
    locations = cells_row_groups(groups = c(&quot;Risers&quot;, &quot;Fallers&quot;))
  ) |&gt;
  tab_footnote(
    footnote = &quot;Figures suppressed as statistically unreliable&quot;,
    locations = cells_body(
      columns = c(change, `2021`),
      rows = is.na(change)
    )
  ) |&gt;
  tab_source_note(source_note = &quot;Source: Office for National Statistics (ONS)&quot;)

gt_tbl |&gt; 
  opt_stylize(style = 6, color = &quot;gray&quot;, add_row_striping = TRUE) |&gt; 
  gtsave(&quot;styled.png&quot;)
</pre><p><img src="https://i1.wp.com/www.quantumjitter.com/project/footnote/styled.png?w=578&#038;ssl=1" alt="" data-recalc-dims="1"></p>
<p>The above table uses one of the in-built style theme options. It looks clean and polished. But sometimes the table to be published needs a high degree of customisation to match, for example, a specific branding. 
<a href="https://gt.rstudio.com/" rel="nofollow" target="_blank">gt</a> offers this as we’ll demonstrate by attempting to replicate the style employed by the 
<a href="https://markets.ft.com/data/" rel="nofollow" target="_blank">market data in the Financial Times</a>.</p>
<pre>gt_ft &lt;- gt_tbl |&gt; 
  tab_options(
    table.border.top.color = &quot;#FFF1E5&quot;,
    table.border.bottom.color = &quot;#FFF1E5&quot;,
    table.background.color = &quot;#FFF1E5&quot;,
    table.font.size = 8,
    table.font.color = &quot;#262A33&quot;,
    row.striping.include_table_body = TRUE,
    row.striping.include_stub = TRUE,
    row.striping.background_color = &quot;#F2DFCE&quot;,
    heading.background.color = &quot;#FFF1E5&quot;,
    row_group.background.color = &quot;#FFF1E5&quot;
  ) |&gt; 
  opt_vertical_padding(scale = 1.3) |&gt; 
  tab_header(title = html(&quot;UK Employment by Occupation  &quot;, 
                          local_image(&quot;logo.png&quot;, height = 15))) |&gt; 
  tab_style(
    style = list(
      cell_text(font = &quot;Financier Display&quot;, size = px(15), align = &quot;left&quot;),
      cell_borders(sides = &quot;bottom&quot;, weight = px(3), color = &quot;#262A33&quot;)
      ),
    locations = cells_title()
  ) |&gt;
  tab_style(
    style = cell_text(size = 14),
    locations = cells_row_groups()
  ) |&gt; 
  tab_style(
    style = cell_text(color = &quot;#800D33&quot;, weight = &quot;bold&quot;),
    locations = cells_stub()
  ) |&gt; 
  tab_style(
    style = cell_text(weight = &quot;bold&quot;),
    locations = list(cells_column_labels(), 
                     cells_column_spanners(), 
                     cells_row_groups(), 
                     cells_title())
  ) |&gt; 
  tab_style(
    style = cell_borders(style = &quot;hidden&quot;),
    locations = list(cells_body(),
                     cells_row_groups(),
                     cells_stub())
  ) |&gt;
  tab_style(
    style = cell_text(color = &quot;#00994D&quot;, weight = &quot;bold&quot;),
    locations = cells_body(
      columns = change,
      rows = change &gt;= 0
    )
  ) |&gt; 
  tab_style(
    style = cell_text(color = &quot;#C00000&quot;, weight = &quot;bold&quot;),
    locations = cells_body(
      columns = change,
      rows = change &lt; 0
    )
  ) |&gt; 
  tab_style(
    style = cell_text(color = &quot;grey40&quot;, size = px(6)),
    locations = list(cells_footnotes(), cells_source_notes())
  )

gt_ft |&gt; gtsave(&quot;ft.png&quot;, zoom = 5)
</pre><p><img src="https://i1.wp.com/www.quantumjitter.com/project/footnote/ft.png?w=578&#038;ssl=1" alt="" data-recalc-dims="1"></p>




<h2 id="r-toolbox">R Toolbox
  <a href="https://www.quantumjitter.com/project/footnote/#r-toolbox" rel="nofollow" target="_blank"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Summarising below the packages and functions used in this post enables me to separately create a 
<a href="https://www.quantumjitter.com/project/box" rel="nofollow" target="_blank">toolbox visualisation</a> summarising the usage of packages and functions across all posts.</p>
<table>
 <thead>
  <tr>
   <th style="text-align:left;"> Package </th>
   <th style="text-align:left;"> Function </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> base </td>
   <td style="text-align:left;"> as.character[1];  as.integer[1];  c[8];  conflicts[1];  cumsum[1];  function[2];  is.na[1];  list[5];  search[1];  sum[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> dplyr </td>
   <td style="text-align:left;"> filter[6];  arrange[3];  desc[3];  group_by[1];  if_else[4];  mutate[7];  n[1];  relocate[1];  row_number[1];  slice[1];  summarise[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> forcats </td>
   <td style="text-align:left;"> fct_inorder[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ggplot2 </td>
   <td style="text-align:left;"> aes[2];  annotate[1];  geom_col[1];  geom_label[1];  ggplot[1];  scale_fill_manual[1];  theme[1];  theme_bw[1];  theme_set[1];  theme_void[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> gt </td>
   <td style="text-align:left;"> cell_borders[2];  cell_text[9];  cells_body[4];  cells_column_labels[4];  cells_column_spanners[2];  cells_footnotes[1];  cells_row_groups[4];  cells_source_notes[1];  cells_stub[3];  cells_title[2];  fmt_number[1];  fmt_percent[1];  gt[1];  gtsave[2];  html[1];  local_image[1];  opt_stylize[1];  opt_vertical_padding[1];  px[3];  sub_missing[1];  tab_footnote[5];  tab_header[2];  tab_options[1];  tab_source_note[1];  tab_spanner[1];  tab_style[10] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> kableExtra </td>
   <td style="text-align:left;"> kbl[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> purrr </td>
   <td style="text-align:left;"> map[1];  map_dfr[1];  map2_dfr[1];  possibly[1];  set_names[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> readr </td>
   <td style="text-align:left;"> read_lines[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> readxl </td>
   <td style="text-align:left;"> read_xlsx[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> stringr </td>
   <td style="text-align:left;"> str_c[5];  str_count[1];  str_detect[2];  str_remove[3];  str_remove_all[1];  str_starts[2] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tibble </td>
   <td style="text-align:left;"> as_tibble[1];  tibble[3];  enframe[1] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> tidyr </td>
   <td style="text-align:left;"> pivot_wider[1];  separate[1];  unnest[1] </td>
  </tr>
</tbody>
</table>




<h2 id="attribution">Attribution
  <a href="https://www.quantumjitter.com/project/footnote/#attribution" rel="nofollow" target="_blank"><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 0h24v24H0z" fill="currentColor"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg></a>
</h2>
<p>Contains public sector information licensed under the 
<a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="nofollow" target="_blank">Open Government Licence v3.0</a>.</p>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.quantumjitter.com/project/footnote/"> Category R on Quantum Jitter</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/a-footnote-in-history/">A Footnote in History</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334108</post-id>	</item>
		<item>
		<title>Modeling the secular trend in a cluster randomized trial using very flexible models</title>
		<link>https://www.r-bloggers.com/2022/10/modeling-the-secular-trend-in-a-cluster-randomized-trial-using-very-flexible-models/</link>
		
		<dc:creator><![CDATA[Keith Goldfeld]]></dc:creator>
		<pubDate>Tue, 01 Nov 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.rdatagen.net/post/2022-11-01-modeling-secular-trend-in-crt-using-gam/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>A key challenge - maybe the key challenge - of a stepped wedge clinical trial design is the threat of confounding by time. This is a cross-over design where the unit of randomization is a group or cluster, where each cluster begins in the control st...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/modeling-the-secular-trend-in-a-cluster-randomized-trial-using-very-flexible-models/">Modeling the secular trend in a cluster randomized trial using very flexible models</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.rdatagen.net/post/2022-11-01-modeling-secular-trend-in-crt-using-gam/"> ouR data generation</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>



<p>A key challenge &#8211; maybe <em>the</em> key challenge &#8211; of a <a href="https://www.rdatagen.net/post/alternatives-to-stepped-wedge-designs/" rel="nofollow" target="_blank">stepped wedge clinical trial design</a> is the threat of confounding by time. This is a cross-over design where the unit of randomization is a group or cluster, where each cluster begins in the control state and transitions to the intervention. It is the transition point that is randomized. Since outcomes could be changing over time regardless of the intervention, it is important to model the time trends when conducting the efficacy analysis. The question is <em>how</em> we choose to model time, and I am going to suggest that we might want to use a very flexible model, such as a cubic spline or a generalized additive model (GAM).</p>
<p>I am not going to talk more about stepped wedge designs here (if you want more background <a href="https://academic.oup.com/ije/article/49/3/1043/5835358" rel="nofollow" target="_blank">this paper</a> would be a fine place to start), but will briefly describe a flexible way to model time trends. And I am going to simplify a bit to assume that we are talking about a cluster randomized trial (CRT), where clusters are randomized to treatment or control only. Confounding by time is not really an issue here, since treatment and control are implemented in parallel across different clusters, but we still might want to model time to get more efficient estimates of the treatment effect. I will consider the flexible modeling approaches for stepped wedge designs in a future post.</p>
<div id="simulating-the-data-the-data-generation-process" class="section level3">
<h3>Simulating the data (the data generation process)</h3>
<p>As I typically do, I will frame this discussion around a simulated data set, which I will describe in some detail. Before we start, here are the libraries I use to generate and present the data:</p>
<pre>library(simstudy)
library(ggplot2)
library(cowplot)
library(data.table)
library(mgcv)
library(lme4)
library(splines)</pre>
<p>The simulated data will include 48 clusters over 20 time periods. 24 will be randomized to the control arm, 24 to the intervention. For each cluster and period, there are 30 individuals. The figure shows the cluster averages at each time point <span class="math inline">\(k\)</span> for one randomly generated data set:</p>
<p><img src="https://i1.wp.com/www.rdatagen.net/post/2022-11-01-modeling-secular-trend-in-crt-using-gam/index.en_files/figure-html/figure1-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></p>
<p>The data generation process that underlies this plot is:</p>
<p><span class="math display">\[
Y_{ijk} \sim N(\mu =100 + b^0_{j} + b^1_{jk} &#8211; 0.1k^2 + 5A_j, \sigma^2 = 9)
\]</span></p>
<p><span class="math inline">\(Y_{ijk}\)</span> is the outcome measurement for individual <span class="math inline">\(i\)</span> in cluster <span class="math inline">\(j\)</span> at period <span class="math inline">\(k\)</span>. In this case, <span class="math inline">\(k \in \{0, \dots, 19\}\)</span>. There is an increasing decline in <span class="math inline">\(Y\)</span> over time (based on the quadratic term <span class="math inline">\(k^2\)</span>). <span class="math inline">\(A_j\)</span> is a treatment indicator for cluster <span class="math inline">\(j\)</span>, and <span class="math inline">\(A \in \{0 ,1\}\)</span>, and the treatment effect is <span class="math inline">\(5\)</span>.</p>
<p><span class="math inline">\(b_{0j}\)</span> is a cluster-level random intercept for cluster <span class="math inline">\(j\)</span>, <span class="math inline">\(b^0_{j} \sim N(\mu = 0, \sigma^2 = 6)\)</span>. <span class="math inline">\(b^1_{jk}\)</span> is a cluster-specific time period effect for each time period <span class="math inline">\(k\)</span>; the vector of cluster-time effects <span class="math inline">\(\mathbf{b^1_j} \sim N(0, \Sigma)\)</span>, where <span class="math inline">\(\Sigma = DRD\)</span> is a <span class="math inline">\(20 \times 20\)</span> covariance matrix based on a diagonal matrix <span class="math inline">\(D\)</span> and an auto-regressive correlation structure <span class="math inline">\(R\)</span>:</p>
<p><span class="math display">\[ D = 16 * I_{20 \times 20}\]</span>
and</p>
<p><span class="math display">\[ R =\begin{bmatrix}
1 &#038; \rho &#038; \rho^2 &#038; \dots &#038; \rho^{19} \\
\rho &#038; 1 &#038; \rho &#038; \dots &#038; \rho^{18} \\
\rho^2 &#038; \rho &#038; 1 &#038; \dots &#038; \rho^{17} \\
\vdots &#038; \vdots &#038; \vdots &#038; \vdots &#038; \vdots \\
\rho^{19} &#038; \rho^{18} &#038; \rho^{17} &#038; \dots &#038; 1 \\
\end{bmatrix}, \ \ \rho = 0.7 \]</span></p>
<p>The <code>simstudy</code> definitions establish <span class="math inline">\(b^0\)</span>, <span class="math inline">\(A\)</span>, <span class="math inline">\(D\)</span>, and <span class="math inline">\(Y\)</span>. The vector <span class="math inline">\(\mathbf{b^1}\)</span> is created separately in the actual data generation process using <code>addCorGen</code>, using <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = 16\)</span>. Here are the initial definitions:</p>
<pre>def &lt;- defData(varname = &quot;b0&quot;, formula = 0, variance = 6)
def &lt;- defData(def, varname = &quot;A&quot;, formula = &quot;1;1&quot;, dist = &quot;trtAssign&quot;)
def &lt;- defData(def, varname = &quot;mu&quot;, formula = 0, dist = &quot;nonrandom&quot;)
def &lt;- defData(def, varname = &quot;s2&quot;, formula = 16, dist = &quot;nonrandom&quot;)

defOut &lt;- defDataAdd(varname = &quot;y&quot;, 
  formula = &quot;100 + b0 + b1k - 0.1 * k^2 + 5*A&quot;, 
  variance = 9)</pre>
<p>I’ve wrapped the data generation process inside a function so that I can use it in a replication study at the end of the post. The function adds a normalized version of time and ensures that the site variable is a factor, both adjustments needed for modeling.</p>
<pre>s_generate &lt;- function() {
  
  d &lt;- genData(48, def, id = &quot;site&quot;)
  d &lt;- addPeriods(d, 20, &quot;site&quot;, perName = &quot;k&quot;)
  
  d &lt;- addCorGen(dtOld = d, idvar = &quot;site&quot;, nvars = 20, 
                 rho = .7, corstr = &quot;ar1&quot;,
                 dist = &quot;normal&quot;, param1 = &quot;mu&quot;, param2 = &quot;s2&quot;, cnames = &quot;b1k&quot;)
  
  d &lt;- genCluster(d, &quot;timeID&quot;, numIndsVar = 30, level1ID = &quot;id&quot;)
  d &lt;- addColumns(defOut, d)
  
  d[, normk := (k - min(k))/(max(k) - min(k))]
  d[, site := as.factor(site)]
  
  d[]
}

set.seed(123)
dd &lt;- s_generate()</pre>
</div>
<div id="some-modeling-options" class="section level3">
<h3>Some modeling options</h3>
<p>If we are interested in accounting for the secular (or time) trend when estimating the treatment effect, we have a number of different options. We can assume there is no structure to the pattern of time, we can impose an extreme form of structure, or we can try to find a flexible middle ground.</p>
<div id="time-without-structure" class="section level4">
<h4>Time without structure</h4>
<p>In stepped wedge designs - it is quite common to assume little if no structure in time trends. In the context of a CRT this could be set up by including a time-specific effect for each period <span class="math inline">\(k\)</span>, as in this model for an outcome <span class="math inline">\(Y_{ijk}\)</span> for individual <span class="math inline">\(i\)</span> in group <span class="math inline">\(j\)</span>:</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0 + \gamma_k + \delta A_j + b_j +e_{ijk}
\]</span></p>
<p>where <span class="math inline">\(A_j\)</span> is an indicator for treatment <span class="math inline">\(j\)</span>, and is set to 1 if cluster <span class="math inline">\(j\)</span> has been randomized to the intervention. <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(b_j\)</span> are the intercept and random intercept, respectively. <span class="math inline">\(\delta\)</span> is the effect size parameter. <span class="math inline">\(\gamma_k\)</span> is the time-specific effect for period <span class="math inline">\(k\)</span>. This is a totally reasonable approach to take, but if <span class="math inline">\(k\)</span> starts to get quite large, we would need to need estimate large number of parameters (<span class="math inline">\(K\)</span> period parameters, to be more precise), which is not always desirable, so we won’t take this approach here.</p>
</div>
<div id="time-with-over-simplified-structure" class="section level4">
<h4>Time with over-simplified structure</h4>
<p>An alternative approach is to model time in a linear fashion as</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0 + \gamma k + \delta A_j  + b_j + e_{ijk}
\]</span></p>
<p>where we have a single parameter <span class="math inline">\(\gamma\)</span> instead of <span class="math inline">\(K\)</span> period parameters. Here is an estimate of the treatment effect <span class="math inline">\(\delta\)</span> using a mixed effects model assuming a common linear time trend:</p>
<pre>linear &lt;- lmer(y ~ A + k + ( 1  | site) , data = dd)
summary(linear)$coefficients[&quot;A&quot;, c(&quot;Estimate&quot;, &quot;Std. Error&quot;)]
##   Estimate Std. Error 
##       6.23       0.85</pre>
<p>The linear model gets around the problem of a large number parameters, but it imposes a very strong assumption that the outcome <span class="math inline">\(Y\)</span> changes linearly over time (and in this case at the same rate for each cluster). This is unlikely to be the case. We could fit a quadratic model like</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0  + \gamma_0 k + \gamma_1 k^2 + \delta A_j + b_j  + e_{ijk}
\]</span></p>
<p>but the assumption is still quite strong. We could also fit a mixed effects model with a random slope <span class="math inline">\(b_{1j}\)</span> as well:</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0  + \gamma k + \delta A_j + b_{0j} + b_{1j} k  + e_{ijk}
\]</span></p>
<p>But, if the temporal trend is not linear, there is no reason to think this would be the best approach.</p>
</div>
<div id="mixed-effects-model-with-fixed-cubic-spline-and-random-intercept" class="section level4">
<h4>Mixed effects model with <em>fixed</em> cubic spline and random intercept</h4>
<p>We can introduce some flexibility into the model by using a <a href="https://datascienceplus.com/cubic-and-smoothing-splines-in-r/" rel="nofollow" target="_blank">cubic spline</a>, which is constructed using a piece-wise cubic polynomial defined by specific points (knots) along the x-axis.</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0 + cs(k) + \delta A_j + b_j  + e_{ijk}
\]</span></p>
<p>The cubic spline model is fit in <code>R</code> using the function <code>bs</code> in the <code>splines</code> package. In order to get more stable estimates, I’ve standardized the time measurement before using it in the model. In this case, the effect size estimate and standard error are the same as the linear model.</p>
<pre>fix_cs &lt;- lmer(y ~ A + bs(normk) + ( 1  | site) , data = dd)
summary(fix_cs)$coefficients[&quot;A&quot;, c(&quot;Estimate&quot;, &quot;Std. Error&quot;)]
##   Estimate Std. Error 
##       6.23       0.85</pre>
</div>
<div id="mixed-effects-model-with-random-cubic-spline" class="section level4">
<h4>Mixed effects model with <em>random</em> cubic spline</h4>
<p>There is no reason to believe that each cluster shares the same time trend, as assumed in the first two models estimated here. So now we introduce additional flexibility by fitting random cubic spline for each cluster.</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0 + \delta A_j + b_j + cs_j(k) + e_{ijk}
\]</span></p>
<p>The only difference between the fixed cubic spline model estimation is that the <code>bs</code> function appears in random effect portion of the model. The effect size estimate is slightly more biased than the previous estimates but has slightly less uncertainty.</p>
<pre>ran_cs &lt;- lmer(y ~ A + ( bs(normk) | site) , data = dd)
summary(ran_cs)$coefficients[&quot;A&quot;, c(&quot;Estimate&quot;, &quot;Std. Error&quot;)]
##   Estimate Std. Error 
##      6.546      0.799</pre>
</div>
<div id="generalized-additive-model-with-site-specific-smoothing" class="section level4">
<h4>Generalized additive model with site-specific smoothing</h4>
<p>Another flexible modeling approach is the <a href="https://m-clark.github.io/generalized-additive-models/" rel="nofollow" target="_blank">generalized additive model</a>, which provides potentially even more flexibility than the spline models and can provide protections against over fitting. The underlying flexibility of the GAM is due to the wide range of basis functions that are available for the construction of the curve. I recommend taking a look the <a href="https://m-clark.github.io/generalized-additive-models/" rel="nofollow" target="_blank">link</a> for a nice introduction.</p>
<p>In this case, the model includes cluster-specific curves <span class="math inline">\(f_j(k)\)</span>:</p>
<p><span class="math display">\[
Y_{ijk} = \beta_0 + \delta A_j + f_j(k) + e_{ijk}
\]</span></p>
<p>We estimate the model using the <code>gamm</code> function in the <code>mgcv</code> package. By setting the <code>bs</code> argument to “fs” in the smoothing function <code>s</code>, we will get estimated cluster-specific curves. “fs” refers to a special smooth factor interaction basis, where the interaction in this case is between site and time <span class="math inline">\(k\)</span>.</p>
<pre>gam &lt;- gamm(y ~ A + s(k, site, bs = &quot;fs&quot;, k = 5), data = dd, method=&quot;REML&quot;)
cbind(summary(gam$gam)$p.coeff, summary(gam$gam)$se)[2,]
## [1] 6.204 0.863</pre>
<p>The figure below shows the predicted site-specific curves for each of the estimated models. The rigidity of the linear and fixed cubic spline models is pretty clear. And in at least this particular case, the two flexible methods appear to generate quite similar predicted curves.</p>
<p><img src="https://i2.wp.com/www.rdatagen.net/post/2022-11-01-modeling-secular-trend-in-crt-using-gam/index.en_files/figure-html/figure2-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></p>
<p>The next figure shows the individual-level outcomes and the predicted curves for a small number of sites. It is clear that the curves for the less flexible methods are biased. The similarity of the flexible models is particularly evident here.</p>
<p><img src="https://i1.wp.com/www.rdatagen.net/post/2022-11-01-modeling-secular-trend-in-crt-using-gam/index.en_files/figure-html/figure3-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></p>
</div>
</div>
<div id="evaluating-bias-and-variance-of-treatment-effect-estimate" class="section level3">
<h3>Evaluating bias and variance of treatment effect estimate</h3>
<p>The results from a single data set are interesting, but we really need to understand how well the models perform over a large number of data sets. How do the model estimates of the true treatment effect (<span class="math inline">\(\delta = 5\)</span>) compare when considering bias, variance, and coverage of the 95% confidence interval?</p>
<p>The replication process requires generating data and then fitting the models. The data generation uses the data definitions and data generating function provided earlier in the post. In this case, we will use 1000 data sets.</p>
<pre>replicate &lt;- function(){
  
  dd &lt;- s_generate()
  
  linear &lt;- lmer(y ~ A + k + ( 1  | site) , data = dd)
  est.lin &lt;- summary(linear)$coefficients[&quot;A&quot;, c(&quot;Estimate&quot;, &quot;Std. Error&quot;)]
  
  fix_cs &lt;- lmer(y ~ A + bs(normk) + ( 1  | site) , data = dd)
  est.fcs &lt;- summary(fix_cs)$coefficients[&quot;A&quot;, c(&quot;Estimate&quot;, &quot;Std. Error&quot;)]
  
  ran_cs &lt;- lmer(y ~ A + ( bs(normk) | site) , data = dd)
  est.rcs &lt;- summary(ran_cs)$coefficients[&quot;A&quot;, c(&quot;Estimate&quot;, &quot;Std. Error&quot;)]
  
  gam &lt;- gamm(y ~ A + s(k, site, bs = &quot;fs&quot;, k = 5), data = dd, method=&quot;REML&quot;)
  est.gam &lt;- cbind(summary(gam$gam)$p.coeff, summary(gam$gam)$se)[2,]
  
  dres &lt;- data.table(t(est.lin), t(est.fcs), t(est.rcs), t(est.gam))
  setnames(dres, 
    c(&quot;d.lin&quot;, &quot;se.lin&quot;, &quot;d.fcs&quot;, &quot;se.fcs&quot;, &quot;d.rcs&quot;, &quot;se.rcs&quot;, &quot;d.gam&quot;, &quot;se.gam&quot;)
  )
  
  dres[]
}

res &lt;- rbindlist(pblapply(1:1000, function(x) replicate()))</pre>
<p>Each replication provides the point estimate of the treatment effect as well as the estimate of the standard error. Here is a sampling of the results:</p>
<pre>res
##       d.lin se.lin d.fcs se.fcs d.rcs se.rcs d.gam se.gam
##    1:  4.53  0.847  4.53  0.847  4.73  0.805  4.55  0.850
##    2:  3.68  0.911  3.68  0.911  3.68  0.873  3.77  0.908
##    3:  3.34  0.734  3.34  0.734  3.33  0.685  3.36  0.729
##    4:  4.95  0.690  4.95  0.690  5.07  0.680  4.89  0.688
##    5:  5.75  0.865  5.75  0.865  5.67  0.776  5.81  0.868
##   ---                                                    
##  996:  5.27  1.001  5.27  1.001  5.17  0.974  5.35  1.008
##  997:  5.94  0.842  5.94  0.842  6.10  0.818  5.89  0.839
##  998:  4.92  0.910  4.92  0.910  4.91  0.876  4.94  0.916
##  999:  4.72  0.799  4.72  0.799  4.41  0.696  4.71  0.786
## 1000:  4.56  0.887  4.56  0.887  4.74  0.852  4.54  0.888</pre>
<p>The average of the point estimates across all replications provides an estimate of the bias for each model. The four approaches are relatively unbiased, and this includes the less flexible approaches that didn’t seem to do so well at prediction on the individual level. The random cubic spline seems to have slightly less bias:</p>
<pre>res[, .(lin = mean(d.lin), fcs = mean(d.fcs), rcs = mean(d.rcs), gam = mean(d.gam))] - 5
##       lin    fcs    rcs    gam
## 1: 0.0314 0.0314 0.0206 0.0304</pre>
<p>A comparison of the observed standard errors suggests that the random cubic spline model is slightly more variable than the other three modeling approaches, suggesting a bias-variance trade-off.</p>
<pre>res[, .(lin = sd(d.lin), fcs = sd(d.fcs), rcs = sd(d.rcs), gam = sd(d.gam))]
##     lin  fcs   rcs   gam
## 1: 0.92 0.92 0.941 0.919</pre>
<p>And while all four methods underestimate the uncertainty, on average, the random cubic spline model most severely underestimated the standard errors:</p>
<pre>res[, .(lin = mean(se.lin), fcs = mean(se.fcs), rcs = mean(se.rcs), gam = mean(se.gam))]
##      lin   fcs  rcs   gam
## 1: 0.907 0.907 0.87 0.908</pre>
<p>Consistent with the disparities in variance estimates, the random cubic splines did not perform as well with respect to the coverage rates of the 95% confidence intervals:</p>
<pre>coverage &lt;- function(est, se) {
  rmin &lt;- est - 1.96 * se
  rmax &lt;- est + 1.96 * se
  
  mean(rmin &lt; 5 &#038; rmax &gt; 5)
}

res[, .(lin = coverage(d.lin, se.lin), fcs = coverage(d.fcs, se.fcs),
        rcs = coverage(d.rcs, se.rcs), gam = coverage(d.gam, se.gam))]
##      lin   fcs   rcs  gam
## 1: 0.944 0.944 0.924 0.94</pre>
<p>It will be interesting to see how the bias-variance trade-off plays out in the context of a stepped wedge design, particularly if the outcomes are binary. Will the less flexible methods continue to perform as well as the GAM model, and will the cubic spline model continue to underestimate the standard errors? More to come.</p>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.rdatagen.net/post/2022-11-01-modeling-secular-trend-in-crt-using-gam/"> ouR data generation</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/modeling-the-secular-trend-in-a-cluster-randomized-trial-using-very-flexible-models/">Modeling the secular trend in a cluster randomized trial using very flexible models</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334104</post-id>	</item>
		<item>
		<title>Modeling the Extinction of Species with SVM-Kernel</title>
		<link>https://www.r-bloggers.com/2022/10/modeling-the-extinction-of-species-with-svm-kernel/</link>
		
		<dc:creator><![CDATA[Selcuk Disci]]></dc:creator>
		<pubDate>Mon, 31 Oct 2022 09:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">http://datageeek.com/?p=4886</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; "> In the last article, we analyzed carbon emissions and the effects that created them. This time I want to look into another important environmental issue, animal biodiversity; by animals, I mean mammals, birds, fish, reptiles, and amphibians. The metric we are going to be interested in is the living planet ...</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/modeling-the-extinction-of-species-with-svm-kernel/">Modeling the Extinction of Species with SVM-Kernel</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/"> DataGeeek</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

<p>In the last article, we analyzed carbon emissions and the effects that created them. This time I want to look into another important environmental issue, animal biodiversity; by animals, I mean mammals, birds, fish, reptiles, and amphibians.</p>



<p>The metric we are going to be interested in is the <a href="https://ourworldindata.org/living-planet-index-decline#the-living-planet-index-tells-us-that-studied-animal-populations-have-seen-an-average-relative-decline-of-69-since-1970" rel="nofollow" target="_blank"><em>living planet index</em></a> which measures the change in the number of 31,831 populations across 5,230 species relative to the year 1970. The explanatory variables we will take, are annual carbon emissions per capita(<strong><em>co2</em></strong>), annual gross domestic product per capita(<strong><em>gdp</em></strong>), and regions(<em><strong>region</strong></em>).</p>



<p>First, we will compare the living planet index(<em><strong>lpi</strong></em>) by region. To do that, we will create our datasets; because we do that by regions, we will summarize the <em><strong>co2</strong></em> and <em><strong>gdp</strong></em> variables by the relative region.</p>


<pre>
library(tidyverse)
library(tidymodels)
library(DALEX)
library(DALEXtra)
library(janitor)
library(plotly)
library(bbplot)
library(scales)
library(countrycode)
library(glue)
  
df_co &lt;- read_csv(&quot;https://raw.githubusercontent.com/mesdi/blog/main/co-emissions-per-capita.csv&quot;)
df_gdp &lt;- read_csv(&quot;https://raw.githubusercontent.com/mesdi/blog/main/gdp-per-capita-worldbank.csv&quot;)
df_lpi &lt;- read_csv(&quot;https://raw.githubusercontent.com/mesdi/blog/main/global-living-planet-index.csv&quot;)
  
#Building the main dataset 
df_co_gdp &lt;- 
  df_gdp %&gt;% 
  left_join(df_co) %&gt;% 
  clean_names() %&gt;% 
  #continent names
  mutate(region = countrycode(sourcevar = entity,
                              origin = &quot;country.name&quot;,
                              destination = &quot;region&quot;)) %&gt;% 
  select(
    year,
    region,
    co2= annual_co2_emissions_per_capita,
    gdp= gdp_per_capita_ppp_constant_2017_international) %&gt;% 
  na.omit() %&gt;%
  #adjusting the region values for merging with the LPI data frame
  mutate(
    region = str_replace(region, &quot;&&quot;, &quot;and&quot;),
    region=case_when(
    region==&quot;South Asia&quot; | region == &quot;East Asia and Pacific&quot; ~ &quot;Asia and Pacific&quot;,
    region==&quot;Middle East and North Africa&quot; | region == &quot;Sub-Saharan Africa&quot; ~ &quot;Africa&quot;,
    TRUE ~ region
  )) %&gt;% 
  #summing the co2 and gdp values by the region, separately
  group_by(region,year) %&gt;% 
  summarise(co2= sum(co2),
            gdp= sum(gdp))


df_tidy &lt;- 
  df_lpi %&gt;% 
  left_join(df_co_gdp) %&gt;% 
  na.omit() 


#Comparing the regions by plotting
p &lt;- 
  df_tidy %&gt;% 
  ggplot(aes(x= year, 
             y=lpi, 
             color=region,
             group=region,
             #text variable for hoverinfo
             text = glue(&quot;{number(round(lpi), suffix='%')}\n{year}&quot;)))+
  geom_line()+
  #the reference line
  geom_line(aes(y=100,color=&quot;red&quot;))+ 
  geom_point()+
  #region texts
  geom_text(data = df_tidy %&gt;% 
              group_by(region) %&gt;% 
              filter(year==round(median(year))),
            aes(x= year, y= lpi,label=region),
            show.legend = FALSE,
            nudge_y = 4.2
  )+
  #the reference line text
  geom_text(aes(x = 1994, 
                y=105, color= &quot;red&quot;,
                label = &quot;The reference line(1970 = %100)&quot;))+ 
  scale_y_continuous(breaks = pretty_breaks(),
                     labels = label_percent(scale = 1))+
  labs(title = &quot;Living Planet Index&quot;)+
  bbc_style() +
  theme(legend.position = &quot;none&quot;, #removes the legend keys
        plot.title = element_text(hjust = 0.5))

#plotly for interactive plotting
ggplotly(p, tooltip = c(&quot;text&quot;)) %&gt;% 
  #removes the reference line info
  style(hoverinfo = &quot;none&quot;,traces = 6)
</pre>


<figure class="wp-block-image size-large"><a href="https://rpubs.com/Selcuk/963709" rel="nofollow" target="_blank"><img data-attachment-id="4896" data-permalink="https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/compare/" data-orig-file="https://datageeek.files.wordpress.com/2022/10/compare.png" data-orig-size="1242,641" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="compare" data-image-description="" data-image-caption="" data-medium-file="https://datageeek.files.wordpress.com/2022/10/compare.png?w=300" data-large-file="https://datageeek.files.wordpress.com/2022/10/compare.png?w=578" src="https://datageeek.files.wordpress.com/2022/10/compare.png?w=578" alt="" class="wp-image-4896" srcset_temp="https://datageeek.files.wordpress.com/2022/10/compare.png?w=578 750w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=150 150w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=300 300w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=768 768w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=1024 1024w, https://datageeek.files.wordpress.com/2022/10/compare.png 1242w" sizes="(max-width: 750px) 100vw, 750px" data-recalc-dims="1" /></a></figure>



<p>When we look at the regions, it seems they are all under their 1970-year values. We will now examine the underlying reasons for this. To do that, we will first model the data with a <em><a rel="nofollow" href="https://www.jstatsoft.org/article/view/v011i09" target="_blank">support vector machine with kernel-based algorithms</a></em>.</p>


<pre>
#Preprocessing the data
df_rec &lt;- 
  recipe(lpi ~ ., data = df_train) %&gt;% 
  step_dummy(all_nominal_predictors(), one_hot = TRUE) %&gt;% 
  #all numeric predictors should be in the same unit
  step_normalize(all_numeric_predictors())


#Modeling with svm with kernel-based algorithms
df_spec &lt;- 
  svm_linear() %&gt;% 
  set_engine(&quot;kernlab&quot;) %&gt;% 
  set_mode(&quot;regression&quot;)

df_wf &lt;- 
  workflow() %&gt;% 
  add_recipe(df_rec) %&gt;% 
  add_model(df_spec)

#cross-validation for resamples
set.seed(12345)
df_folds &lt;- vfold_cv(df_train, strata = region)

#Resampling for the accuracy metrics
set.seed(234)
df_rs &lt;- 
  df_wf %&gt;% 
  fit_resamples(resamples = df_folds)

#computes the accuracy metrics  
collect_metrics(df_rs)
# A tibble: 2 x 6
#  .metric .estimator  mean     n std_err .config       
#  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;         
#1 rmse    standard   4.32     10 0.387   Preprocessor1~
#2 rsq     standard   0.980    10 0.00528 Preprocessor1~

#fits the best model to the training set
#and evaluate it with the testing set.
final_fit &lt;- last_fit(df_wf, df_split)

collect_metrics(final_fit)
# A tibble: 2 x 4
#  .metric .estimator .estimate .config             
#  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
#1 rmse    standard       7.27  Preprocessor1_Model1
#2 rsq     standard       0.963 Preprocessor1_Model1
</pre>


<p>The above accuracy results look fine to step forward with that model. Now, we can compute and draw <a rel="nofollow" href="https://www.tmwr.org/explain.html#:~:text=one%20way%20to%20compute%20variable%20importance%20is%20to%20permute%20the%20features%20(breiman%202001a).%20we%20can%20permute%20or%20shuffle%20the%20values%20of%20a%20feature%2C%20predict%20from%20the%20model%2C%20and%20then%20measure%20how%20much%20worse%20the%20model%20fits%20the%20data%20compared%20to%20before%20shuffling." target="_blank"><em>permutation-based variable importance</em></a> scores.</p>


<pre>
#Permutation-based variable importance

#Creating a preprocessed dataframe of the train dataset
imp_data &lt;- 
  df_rec %&gt;%
  prep() %&gt;%
  bake(new_data = NULL)

 
#building the explainer-object
explainer_svm &lt;- 
  explain_tidymodels(
    df_spec %&gt;% 
      fit(lpi ~ ., data = imp_data),
    data = imp_data %&gt;% select(-lpi), 
    y = df_train$lpi,
    verbose = FALSE
  )


set.seed(1983)
#calculates the variable-importance measure
vip_svm &lt;- 
  model_parts( 
    explainer = explainer_svm, 
    loss_function = loss_root_mean_square, 
    B = 100, #the number of permutations
    type = &quot;difference&quot;,
    label =&quot;&quot;
  )

#Plotting ranking of the importance of explanatory variables
plot(vip_svm) +
  ggtitle(&quot;Mean variable-importance over 100 permutations&quot;, &quot;&quot;)+
  theme(plot.title = element_text(hjust = 0.5))
</pre>


<figure class="wp-block-image size-large"><a href="https://datageeek.files.wordpress.com/2022/10/vip.jpeg" rel="nofollow" target="_blank"><img data-attachment-id="4915" data-permalink="https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/vip-3/" data-orig-file="https://datageeek.files.wordpress.com/2022/10/vip.jpeg" data-orig-size="857,422" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="vip" data-image-description="" data-image-caption="" data-medium-file="https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=300" data-large-file="https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=750" src="https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=578" alt="" class="wp-image-4915" srcset_temp="https://datageeek.files.wordpress.com/2022/10/vip.jpeg 857w, https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=150 150w, https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=300 300w, https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=768 768w" sizes="(max-width: 857px) 100vw, 857px" data-recalc-dims="1" /></a></figure>



<p>The interesting thing we can extract from the above plot is that the carbon emission variable(<em><strong>co2</strong></em>) is a very weak effect on the LPI index. Instead of it, Europe and Latin America regions, and the <em><strong>gdp</strong></em> variables look to have far the most dominant effects on the index.</p>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/"> DataGeeek</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/modeling-the-extinction-of-species-with-svm-kernel/">Modeling the Extinction of Species with SVM-Kernel</a>]]></content:encoded>
					
		
		<enclosure url="https://datageeek.files.wordpress.com/2022/10/compare.png" length="0" type="" />
<enclosure url="https://1.gravatar.com/avatar/dd0a7657961ed7886ce99eb9cb685c67?s=96&#038;d=identicon&#038;r=G" length="0" type="" />
<enclosure url="https://datageeek.files.wordpress.com/2022/10/compare.png?w=750" length="0" type="" />
<enclosure url="https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=857" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334069</post-id>	</item>
		<item>
		<title>How to deal with annoying medium sized data inside a Shiny app</title>
		<link>https://www.r-bloggers.com/2022/10/how-to-deal-with-annoying-medium-sized-data-inside-a-shiny-app/</link>
		
		<dc:creator><![CDATA[Econometrics and Free Software]]></dc:creator>
		<pubDate>Mon, 31 Oct 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.brodrigues.co/blog/2022-10-31-optim_shiny/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>This blog post is taken from a chapter of my ebook on building reproducible analytical pipelines, which you can<br />
read here<br />
If you want to follow along, you can start by downloading the data I use<br />
here.<br />
This is a smaller dataset made from the one yo...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/how-to-deal-with-annoying-medium-sized-data-inside-a-shiny-app/">How to deal with annoying medium sized data inside a Shiny app</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.brodrigues.co/blog/2022-10-31-optim_shiny/"> Econometrics and Free Software</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<div style="text-align:center;">
<p><video width="450" controls>
<source src="https://www.brodrigues.co/img/deja_vu.mp4" type="video/mp4">
</video></p>
</div>
<p><em>This blog post is taken from a chapter of my ebook on building reproducible analytical pipelines, which you can
read <a href="https://rap4mads.eu/" rel="nofollow" target="_blank">here</a></em></p>
<p>If you want to follow along, you can start by downloading the data I use
<a href="https://mega.nz/file/l1IxHYIT#mZkeQOVpMc9XymMNtDY687sHEZHoIvDcUOm-4AwK6OI" rel="nofollow" target="_blank">here</a>.
This is a smaller dataset made from the one you can get
<a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/HG7NV7" rel="nofollow" target="_blank">here</a>.</p>
<p>Uncompressed it’ll be a 2.4GB file. Not big data in any sense, but big enough to be annoying to
handle without the use of some optimization strategies (I’ve seen such data described as medium
sized data before.).</p>
<p>One such strategy is only letting the computations run once the user gives the green light by
clicking on an action button. The next obvious strategy is to use packages that are optimized for
speed. It turns out that the functions we have seen until now (note from the author: <em>the functions
we have seen until now</em> if you’re on of my students that’s sitting in the course where I teach
this), from packages like <code>{dplyr}</code> and the like, are not the fastest. Their ease of use and
expressiveness come at a speed cost. So we will need to switch to something faster. We will do the
same to read in the data.</p>
<p>This faster solution is the <code>{arrow}</code> package, which is an interface to the
<a href="https://arrow.apache.org/faq/" rel="nofollow" target="_blank">Arrow software developed by Apache</a>.</p>
<p>The final strategy is to enable caching in the app.</p>
<p>So first, install the <code>{arrow}</code> package by running <code>install.packages(&quot;arrow&quot;)</code>. This will compile
<code>libarrow</code> from source on Linux and might take some time, so perhaps go grab a coffee. One other
operating systems, I guess that a binary version gets installed.</p>
<p>Before building the app, let me perform a very simple benchmark. The script below reads in the data,
then performs some aggregations. This is done using standard <code>{tidyverse}</code> functions, but also
using <code>{arrow}</code>:</p>
<pre>start_tidy &lt;- Sys.time()
  # {vroom} is able to read in larger files than {readr}
  # I could not get this file into R using readr::read_csv
  # my RAM would get maxed out
  air &lt;- vroom::vroom(&quot;data/combined&quot;)

  mean_dep_delay &lt;- air |&gt;
    dplyr::group_by(Year, Month, DayofMonth) |&gt;
    dplyr::summarise(mean_delay = mean(DepDelay, na.rm = TRUE))
end_tidy &lt;- Sys.time()

time_tidy &lt;- end_tidy - start_tidy


start_arrow &lt;- Sys.time()
  air &lt;- arrow::open_dataset(&quot;data/combined&quot;, format = &quot;csv&quot;)

  mean_dep_delay &lt;- air |&gt;
    dplyr::group_by(Year, Month, DayofMonth) |&gt;
    dplyr::summarise(mean_delay = mean(DepDelay, na.rm = TRUE))
end_arrow &lt;- Sys.time()

end_tidy - start_tidy
end_arrow - start_arrow</pre>
<p>The “tidy” approach took 17 seconds, while the arrow approach took 6 seconds. This is an impressive
improvement, but put yourself in the shoes of a user who has to wait 6 seconds for each query. That
would get very annoying, very quickly. So the other strategy that we will use is to provide some visual
cue that computations are running, and then we will go one step further and use caching of results
in the Shiny app.</p>
<p>But before we continue, you may be confused by the code above. After all, I told you before that
functions from <code>{dplyr}</code> and the like were not the fastest, and yet, I am using them in the arrow
approach as well, and they now run almost 3 times as fast. What’s going on? What’s happening here,
is that the <code>air</code> object that we read using <code>arrow::open_dataset</code> is not a dataframe, but an <code>arrow</code>
dataset. These are special, and work in a different way. But that’s not what’s important: what’s important
is that the <code>{dplyr}</code> api can be used to work with these <code>arrow</code> datasets. This means that functions
from <code>{dplyr}</code> change the way they work depending on the type of the object their dealing with.
If it’s a good old regular data frame, some C++ code gets called to perform the computations. If it’s
an <code>arrow</code> dataset, <code>libarrow</code> and its black magic get called instead to perform the computations.
If you’re familiar with the concept of
<a href="https://en.wikipedia.org/wiki/Polymorphism_(computer_science)" rel="nofollow" target="_blank">polymorphism</a> this is it
(think of <code>+</code> in Python: <code>1+1</code> returns <code>2</code>, <code>&quot;a&quot;+&quot;b&quot;</code> returns <code>&quot;a+b&quot;</code>. A different computation
gets performed depending on the type of the function’s inputs).</p>
<p>Let’s now build a basic version of the app, only
using <code>{arrow}</code> functions for speed. This is the global file:</p>
<pre>library(arrow)
library(dplyr)
library(rlang)
library(DT)

air &lt;- arrow::open_dataset(&quot;data/combined&quot;, format = &quot;csv&quot;)</pre>
<p>The ui will be quite simple:</p>
<pre>ui &lt;- function(request){
  fluidPage(

    titlePanel(&quot;Air On Time data&quot;),

    sidebarLayout(

      sidebarPanel(
        selectizeInput(&quot;group_by_selected&quot;, &quot;Variables to group by:&quot;,
                       choices = c(&quot;Year&quot;, &quot;Month&quot;, &quot;DayofMonth&quot;, &quot;Origin&quot;, &quot;Dest&quot;),
                       multiple = TRUE,
                       selected = c(&quot;Year&quot;, &quot;Month&quot;),
                       options = list(
                         plugins = list(&quot;remove_button&quot;),
                         create = TRUE,
                         persist = FALSE # keep created choices in dropdown
                       )
                       ),
        hr(),
        selectizeInput(&quot;var_to_average&quot;, &quot;Select variable to average by groups:&quot;,
                       choices = c(&quot;ArrDelay&quot;, &quot;DepDelay&quot;, &quot;Distance&quot;),
                       multiple = FALSE,
                       selected = &quot;DepDelay&quot;,
                       ),
        hr(),
        actionButton(inputId = &quot;run_aggregation&quot;,
                     label = &quot;Click here to run aggregation&quot;),
        hr(),
        bookmarkButton()
      ),

      mainPanel(
        DTOutput(&quot;result&quot;)
      )
    )
  )

}</pre>
<p>And finally the server:</p>
<pre>server &lt;- function(session, input, output) {

  # Numbers get crunched only when the user clicks on the action button
  grouped_data &lt;- eventReactive(input$run_aggregation, {
    air %&gt;%
      group_by(!!!syms(input$group_by_selected)) %&gt;%
      summarise(result = mean(!!sym(input$var_to_average),
                              na.rm = TRUE)) %&gt;%
      as.data.frame()
  })

  output$result &lt;- renderDT({
    grouped_data()
  })

}</pre>
<p>Because <code>group_by()</code> and <code>mean()</code> expect bare variable names, I convert them from strings to
symbols using <code>rlang::syms()</code> and <code>rlang::sym()</code>. The difference between the two is that
<code>rlang::syms()</code> is required when a list of strings gets passed down to the function (remember
that the user must select several variables to group by), and this is also why <code>!!!</code> are needed
(to unquote the list of symbols). Finally, the computed data must be converted back to a
data frame using <code>as.data.frame()</code>. This is actually when the computations happen. <code>{arrow}</code> collects
all the aggregations but does not perform anything until absolutely required. Let’s see the app
in action:</p>
<div style="text-align:center;">
<video width="450" controls>
<source src="https://www.brodrigues.co/img/shiny_3.mp4" type="video/mp4">
</video>
</div>
<p>As you can see, in terms of User Experience (UX) this is quite poor. When the user clicks on the button
nothing seems to be going on for several seconds, until the table appears. Then, when the user
changes some options and clicks again on the action button, it looks like the app is crashing.</p>
<p>Let’s add some visual cues to indicate to the user that something is happening when the button gets
clicked. For this, we are going to use the <code>{shinycssloaders}</code> package:</p>
<pre>install.packages(&quot;shinycssloaders&quot;)</pre>
<p>and simply change the ui to this (and don’t forget to load <code>{shinycssloaders}</code> in the global script!):</p>
<pre>ui &lt;- function(request){
  fluidPage(

    titlePanel(&quot;Air On Time data&quot;),

    sidebarLayout(

      sidebarPanel(
        selectizeInput(&quot;group_by_selected&quot;, &quot;Variables to group by:&quot;,
                       choices = c(&quot;Year&quot;, &quot;Month&quot;, &quot;DayofMonth&quot;, &quot;Origin&quot;, &quot;Dest&quot;),
                       multiple = TRUE,
                       selected = c(&quot;Year&quot;, &quot;Month&quot;),
                       options = list(
                         plugins = list(&quot;remove_button&quot;),
                         create = TRUE,
                         persist = FALSE # keep created choices in dropdown
                       )
                       ),
        hr(),
        selectizeInput(&quot;var_to_average&quot;, &quot;Select variable to average by groups:&quot;,
                       choices = c(&quot;ArrDelay&quot;, &quot;DepDelay&quot;, &quot;Distance&quot;),
                       multiple = FALSE,
                       selected = &quot;DepDelay&quot;,
                       ),
        hr(),
        actionButton(inputId = &quot;run_aggregation&quot;,
                     label = &quot;Click here to run aggregation&quot;),
        hr(),
        bookmarkButton()
      ),

      mainPanel(
        # We add a tabsetPanel with two tabs. The first tab show the plot made using ggplot
        # the second tab shows the plot using g2r
        DTOutput(&quot;result&quot;) |&gt;
          withSpinner()
      )
    )
  )

}</pre>
<p>The only difference with before is that now the <code>DTOutput()</code> right at the end gets passed down
to <code>withSpinner()</code>. There are several spinners that you can choose, but let’s simply use the
default one. This is how the app looks now:</p>
<div style="text-align:center;">
<video width="450" controls>
<source src="https://www.brodrigues.co/img/shiny_4.mp4" type="video/mp4">
</video>
</div>
<p>Now the user gets a visual cue that something is happening. This makes waiting more bearable,
but even better than waiting with a spinner is no waiting at all. For this, we are going to enable caching
of results. There are several ways that you can cache results inside your app. You can enable
the cache on a per-user and per-session basis, or only on a per-user basis. But I think that
in our case here, the ideal caching strategy is to keep the cache persistent, and available
across sessions. This means that each computation done by any user will get cached and available
to any other user. In order to achieve this, you simply have to install the <code>{cachem}</code> packages
add the following lines to the global script:</p>
<pre>shinyOptions(cache = cachem::cache_disk(&quot;./app-cache&quot;,
                                        max_age = Inf))</pre>
<p>By setting the <code>max_age</code> argument to <code>Inf</code>, the cache will never get pruned. The maximum size
of the cache, by default is 1GB. You can of course increase it.</p>
<p>Now, you must also edit the server file like so:</p>
<pre>server &lt;- function(session, input, output) {

  # Numbers get crunched only when the user clicks on the action button
  grouped_data &lt;- reactive({
    air %&gt;%
      group_by(!!!syms(input$group_by_selected)) %&gt;%
      summarise(result = mean(!!sym(input$var_to_average),
                              na.rm = TRUE)) %&gt;%
      as.data.frame()
  }) %&gt;%
    bindCache(input$group_by_selected,
              input$var_to_average) %&gt;%
    bindEvent(input$run_aggregation)

  output$result &lt;- renderDT({
    grouped_data()
  })

}</pre>
<p>We’ve had to change <code>eventReactive()</code> to <code>reactive()</code>, just like in the app where we don’t use an
action button to run computations (note of the author: in the ebook, there is an example of an app
with this action button. This is what I’m referring to here). Then, we pass the reactive object to
<code>bindCache()</code>. <code>bindCache()</code> also takes the <code>inputs</code> as arguments. These are used to generate cache
keys to retrieve the correct objects from cache. Finally, we pass all this to <code>bindEvent()</code>. This
function takes the input referencing the action button. This is how we can now bind the
computations to the button once again. Let’s test our app now. You will notice that the first time
we choose certain options, the computations will take time, as before. But if we perform the same
computations again, then the results will be shown instantly:</p>
<div style="text-align:center;">
<video width="450" controls>
<source src="https://www.brodrigues.co/img/shiny_5.mp4" type="video/mp4">
</video>
</div>
<p>As you can see, once I go back to a computation that was done in the past, the table appears
instantly. At the end of the video I open a terminal and navigate to the directory of the app,
and show you the cache. There are several <code>.Rds</code> objects, these are the final data frames that
get computed by the app. If the user wants to rerun a previous computation, the correct data frame
gets retrieved, making it look like the computation happened instantly, and with another added
benefit: as discussed above, the cache is persistent between sessions, so even if the user
closes the browser and comes back later, the cache is still there, and other users will also
benefit from the cache.</p>
<p>
Hope you enjoyed! If you found this blog post useful, you might want to follow
me on <a href="https://fosstodon.org/@brodriguesco" rel="nofollow" target="_blank">Mastodon</a> or <a href="https://www.twitter.com/brodriguesco" rel="nofollow" target="_blank">twitter</a> for blog post updates and
<a href="https://www.buymeacoffee.com/brodriguesco" rel="nofollow" target="_blank">buy me an espresso</a> or <a href="https://www.paypal.me/brodriguesco" rel="nofollow" target="_blank">paypal.me</a>, or buy my ebook on <a href="https://leanpub.com/modern_tidyverse" rel="nofollow" target="_blank">Leanpub</a>.
You can also watch my videos on <a href="https://www.youtube.com/c/BrunoRodrigues1988/" rel="nofollow" target="_blank">youtube</a>.
So much content for you to consoom!
</p>
<style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#ffffff !important;background-color:#272b30 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 22px !important;letter-spacing:0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#82518c !important;}</style>
<p>
<link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><a class="bmc-button" href="https://www.buymeacoffee.com/brodriguesco" rel="nofollow" target="_blank"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me an Espresso"><span style="margin-left:5px">Buy me an Espresso</span></a>
</p>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.brodrigues.co/blog/2022-10-31-optim_shiny/"> Econometrics and Free Software</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/how-to-deal-with-annoying-medium-sized-data-inside-a-shiny-app/">How to deal with annoying medium sized data inside a Shiny app</a>]]></content:encoded>
					
		
		<enclosure url="https://www.brodrigues.co/img/deja_vu.mp4" length="547899" type="video/mp4" />
<enclosure url="https://www.brodrigues.co/img/shiny_3.mp4" length="1931067" type="video/mp4" />
<enclosure url="https://www.brodrigues.co/img/shiny_4.mp4" length="947312" type="video/mp4" />
<enclosure url="https://www.brodrigues.co/img/shiny_5.mp4" length="4317053" type="video/mp4" />

		<post-id xmlns="com-wordpress:feed-additions:1">334049</post-id>	</item>
		<item>
		<title>Getting acquainted with Mastodon &#8212; Instances</title>
		<link>https://www.r-bloggers.com/2022/10/getting-acquainted-with-mastodon-instances/</link>
		
		<dc:creator><![CDATA[Karsten W.]]></dc:creator>
		<pubDate>Sun, 30 Oct 2022 22:55:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">http://www.r-bloggers.com/?guid=2fb944fb525ac470fe93f8d91bd3c890</guid>

					<description><![CDATA[<p>Elon Musk has to buy Twitter after all. I took this as an opportunity to look at Mastodon at the weekend, a decentralised alternative. TL/DR: super!</p>
<p>What I had to understand first was the concept of an “instance”. My first impression is that you can compare a Mastodon server ...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/getting-acquainted-with-mastodon-instances/">Getting acquainted with Mastodon — Instances</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="http://factbased.blogspot.com/2022/10/getting-acquainted-with-mastodon.html"> factbased</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<p>Elon Musk has to buy Twitter after all. I took this as an opportunity to look at Mastodon at the weekend, a decentralised alternative. TL/DR: super!</p>

<p>What I had to understand first was the concept of an “instance”. My first impression is that you can compare a Mastodon server to an email server. Imagine that in order to write emails, you would have to create an account with one single company in the US and agree to their terms-of-service. Every email you send would go through that company. Not a good idea. That just seems wrong. Fortunately, emails work differently. I can create an account with a server of my choice, in Germany for example with Posteo.de, web.de or gmx.de. And I can send my messages anywhere, to any email server in the world.</p>

<p>This decentralised approach now also works with short messages. Via Mastodon. I can choose my server, or my instance as it is now called. But my messages can be read by all Mastodon users, no matter which instance they use. I find that convincing.</p>

<p>Which instance is the right one for me? Who offers me a Mastodon account now? </p>

<p>My research this weekend revealed <a href="https://github.com/kweinert/msocial/blob/main/inst/extdata/instances.txt" rel="nofollow" target="_blank">55 potential providers</a>. I collected these manually, I did not find a central overview of providers. (EDIT: As is sometimes the case, after writing this I found the link to the
<a href="https://mastodon.fediverse.observer/list" rel="nofollow" target="_blank">Fediverse Observer</a>. There is even an API there. I&#39;ll take a closer look at that another time).</p>

<p>Using the Mastodon API, it is possible to retrieve information from any server. This is easily done via the <code>msocial</code> package that I just uploaded to Github. It uses the new pipe operator introduced with R 4.0. The <code>remotes</code> package is needed for installation, the packages <code>data.table</code> and <code>knitr</code> are needed for this vignette. </p>

<pre>#install.packages(&quot;remotes&quot;)
#remotes::install_github(&quot;https://github.com/kweinert/msocial&quot;)
library(msocial)
library(data.table)
library(knitr)
</pre>

<p>The information is retrieved from the instances as follows.</p>

<pre>stats &lt;- get_instances() |&gt;
lapply(get_instance_stats) |&gt;
rbindlist()
</pre>

<p>The code is actually only given for transparency reasons. The result is much more important: </p>

<table><thead>
<tr>
<th align="left">instance</th>
<th align="left">registration</th>
<th align="right">user_count</th>
<th align="right">status_count</th>
<th align="left">country_code</th>
</tr>
</thead><tbody>
<tr>
<td align="left"><a href="https://mastodon.social/" rel="nofollow" target="_blank">https://mastodon.social</a></td>
<td align="left">TRUE</td>
<td align="right">814812</td>
<td align="right">39787754</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.cloud/" rel="nofollow" target="_blank">https://mastodon.cloud</a></td>
<td align="left">TRUE</td>
<td align="right">220222</td>
<td align="right">4424023</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://mstdn.social/" rel="nofollow" target="_blank">https://mstdn.social</a></td>
<td align="left">TRUE</td>
<td align="right">76258</td>
<td align="right">5503036</td>
<td align="left">IN</td>
</tr>
<tr>
<td align="left"><a href="https://fosstodon.org/" rel="nofollow" target="_blank">https://fosstodon.org</a></td>
<td align="left">TRUE</td>
<td align="right">24187</td>
<td align="right">1031281</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.xyz/" rel="nofollow" target="_blank">https://mastodon.xyz</a></td>
<td align="left">FALSE</td>
<td align="right">23870</td>
<td align="right">1749182</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.technology/" rel="nofollow" target="_blank">https://mastodon.technology</a></td>
<td align="left">FALSE</td>
<td align="right">23837</td>
<td align="right">1334756</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://mstdn.io/" rel="nofollow" target="_blank">https://mstdn.io</a></td>
<td align="left">FALSE</td>
<td align="right">18173</td>
<td align="right">2549736</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://qoto.org/" rel="nofollow" target="_blank">https://qoto.org</a></td>
<td align="left">TRUE</td>
<td align="right">17741</td>
<td align="right">821107</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://social.tchncs.de/" rel="nofollow" target="_blank">https://social.tchncs.de</a></td>
<td align="left">TRUE</td>
<td align="right">17621</td>
<td align="right">1648232</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://pixelfed.de/" rel="nofollow" target="_blank">https://pixelfed.de</a></td>
<td align="left">TRUE</td>
<td align="right">13569</td>
<td align="right">99447</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://octodon.social/" rel="nofollow" target="_blank">https://octodon.social</a></td>
<td align="left">FALSE</td>
<td align="right">11923</td>
<td align="right">2117274</td>
<td align="left">NA</td>
</tr>
<tr>
<td align="left"><a href="https://chaos.social/" rel="nofollow" target="_blank">https://chaos.social</a></td>
<td align="left">FALSE</td>
<td align="right">9198</td>
<td align="right">3025391</td>
<td align="left">IN</td>
</tr>
<tr>
<td align="left"><a href="https://det.social/" rel="nofollow" target="_blank">https://det.social</a></td>
<td align="left">TRUE</td>
<td align="right">8053</td>
<td align="right">35106</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.fun/" rel="nofollow" target="_blank">https://mastodon.fun</a></td>
<td align="left">TRUE</td>
<td align="right">7709</td>
<td align="right">761778</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://norden.social/" rel="nofollow" target="_blank">https://norden.social</a></td>
<td align="left">TRUE</td>
<td align="right">6258</td>
<td align="right">424112</td>
<td align="left">GR</td>
</tr>
<tr>
<td align="left"><a href="https://hostux.social/" rel="nofollow" target="_blank">https://hostux.social</a></td>
<td align="left">TRUE</td>
<td align="right">5584</td>
<td align="right">365994</td>
<td align="left">LU</td>
</tr>
<tr>
<td align="left"><a href="https://meow.social/" rel="nofollow" target="_blank">https://meow.social</a></td>
<td align="left">TRUE</td>
<td align="right">5329</td>
<td align="right">620144</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://vis.social/" rel="nofollow" target="_blank">https://vis.social</a></td>
<td align="left">TRUE</td>
<td align="right">5181</td>
<td align="right">67908</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://scholar.social/" rel="nofollow" target="_blank">https://scholar.social</a></td>
<td align="left">FALSE</td>
<td align="right">5144</td>
<td align="right">299049</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://climatejustice.social/" rel="nofollow" target="_blank">https://climatejustice.social</a></td>
<td align="left">FALSE</td>
<td align="right">4312</td>
<td align="right">66041</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://aus.social/" rel="nofollow" target="_blank">https://aus.social</a></td>
<td align="left">TRUE</td>
<td align="right">4209</td>
<td align="right">234313</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://linuxrocks.online/" rel="nofollow" target="_blank">https://linuxrocks.online</a></td>
<td align="left">TRUE</td>
<td align="right">3845</td>
<td align="right">185353</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://social.targaryen.house/" rel="nofollow" target="_blank">https://social.targaryen.house</a></td>
<td align="left">FALSE</td>
<td align="right">3807</td>
<td align="right">109173</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://sueden.social/" rel="nofollow" target="_blank">https://sueden.social</a></td>
<td align="left">TRUE</td>
<td align="right">2730</td>
<td align="right">14666</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.partipirate.org/" rel="nofollow" target="_blank">https://mastodon.partipirate.org</a></td>
<td align="left">TRUE</td>
<td align="right">2417</td>
<td align="right">31210</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://oc.todon.fr/" rel="nofollow" target="_blank">https://oc.todon.fr</a></td>
<td align="left">TRUE</td>
<td align="right">2377</td>
<td align="right">116484</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.gougere.fr/" rel="nofollow" target="_blank">https://mastodon.gougere.fr</a></td>
<td align="left">TRUE</td>
<td align="right">1809</td>
<td align="right">207780</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://awoo.space/" rel="nofollow" target="_blank">https://awoo.space</a></td>
<td align="left">FALSE</td>
<td align="right">1743</td>
<td align="right">615982</td>
<td align="left">NL</td>
</tr>
<tr>
<td align="left"><a href="https://aleph.land/" rel="nofollow" target="_blank">https://aleph.land</a></td>
<td align="left">TRUE</td>
<td align="right">1542</td>
<td align="right">215486</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://animalliberation.social/" rel="nofollow" target="_blank">https://animalliberation.social</a></td>
<td align="left">TRUE</td>
<td align="right">1182</td>
<td align="right">3023</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://dresden.network/" rel="nofollow" target="_blank">https://dresden.network</a></td>
<td align="left">TRUE</td>
<td align="right">1141</td>
<td align="right">46729</td>
<td align="left">NA</td>
</tr>
<tr>
<td align="left"><a href="https://icosahedron.website/" rel="nofollow" target="_blank">https://icosahedron.website</a></td>
<td align="left">FALSE</td>
<td align="right">818</td>
<td align="right">374745</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://im-in.space/" rel="nofollow" target="_blank">https://im-in.space</a></td>
<td align="left">TRUE</td>
<td align="right">788</td>
<td align="right">65204</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://graz.social/" rel="nofollow" target="_blank">https://graz.social</a></td>
<td align="left">TRUE</td>
<td align="right">712</td>
<td align="right">24131</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://maly.io/" rel="nofollow" target="_blank">https://maly.io</a></td>
<td align="left">TRUE</td>
<td align="right">653</td>
<td align="right">133470</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://bonn.social/" rel="nofollow" target="_blank">https://Bonn.social</a></td>
<td align="left">TRUE</td>
<td align="right">597</td>
<td align="right">114461</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://scicomm.xyz/" rel="nofollow" target="_blank">https://scicomm.xyz</a></td>
<td align="left">TRUE</td>
<td align="right">563</td>
<td align="right">18918</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://xoxo.zone/" rel="nofollow" target="_blank">https://xoxo.zone</a></td>
<td align="left">FALSE</td>
<td align="right">497</td>
<td align="right">59844</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://oldbytes.space/" rel="nofollow" target="_blank">https://oldbytes.space</a></td>
<td align="left">TRUE</td>
<td align="right">382</td>
<td align="right">96653</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://berlin.social/" rel="nofollow" target="_blank">https://berlin.social</a></td>
<td align="left">TRUE</td>
<td align="right">346</td>
<td align="right">5423</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://functional.cafe/" rel="nofollow" target="_blank">https://functional.cafe</a></td>
<td align="left">TRUE</td>
<td align="right">321</td>
<td align="right">132400</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://social.wxcafe.net/" rel="nofollow" target="_blank">https://social.wxcafe.net</a></td>
<td align="left">TRUE</td>
<td align="right">289</td>
<td align="right">148851</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://fediscience.org/" rel="nofollow" target="_blank">https://fediscience.org</a></td>
<td align="left">TRUE</td>
<td align="right">289</td>
<td align="right">11322</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://mst3k.interlinked.me/" rel="nofollow" target="_blank">https://mst3k.interlinked.me</a></td>
<td align="left">TRUE</td>
<td align="right">228</td>
<td align="right">343658</td>
<td align="left">CA</td>
</tr>
<tr>
<td align="left"><a href="https://eupublic.social/" rel="nofollow" target="_blank">https://eupublic.social</a></td>
<td align="left">TRUE</td>
<td align="right">137</td>
<td align="right">19777</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://masto.raildecake.fr/" rel="nofollow" target="_blank">https://masto.raildecake.fr</a></td>
<td align="left">FALSE</td>
<td align="right">136</td>
<td align="right">5736</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://dads.cool/" rel="nofollow" target="_blank">https://dads.cool</a></td>
<td align="left">TRUE</td>
<td align="right">84</td>
<td align="right">309546</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://feuerwehr.social/" rel="nofollow" target="_blank">https://feuerwehr.social</a></td>
<td align="left">TRUE</td>
<td align="right">72</td>
<td align="right">1173</td>
<td align="left">UA</td>
</tr>
<tr>
<td align="left"><a href="https://eupolicy.social/" rel="nofollow" target="_blank">https://eupolicy.social</a></td>
<td align="left">TRUE</td>
<td align="right">65</td>
<td align="right">622</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.indie.host/" rel="nofollow" target="_blank">https://mastodon.indie.host</a></td>
<td align="left">TRUE</td>
<td align="right">24</td>
<td align="right">11558</td>
<td align="left">DE</td>
</tr>
<tr>
<td align="left"><a href="https://mastodon.land/" rel="nofollow" target="_blank">https://mastodon.land</a></td>
<td align="left">TRUE</td>
<td align="right">13</td>
<td align="right">4683</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://social.imirhil.fr/" rel="nofollow" target="_blank">https://social.imirhil.fr</a></td>
<td align="left">FALSE</td>
<td align="right">3</td>
<td align="right">47042</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://social.diskseven.com/" rel="nofollow" target="_blank">https://social.diskseven.com</a></td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">75273</td>
<td align="left">GB</td>
</tr>
<tr>
<td align="left"><a href="https://share.elouworld.org/" rel="nofollow" target="_blank">https://share.elouworld.org</a></td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">1988</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://social.lkw.tf/" rel="nofollow" target="_blank">https://social.lkw.tf</a></td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="left">FR</td>
</tr>
<tr>
<td align="left"><a href="https://social.ballpointcarrot.net/" rel="nofollow" target="_blank">https://social.ballpointcarrot.net</a></td>
<td align="left">FALSE</td>
<td align="right">1</td>
<td align="right">409</td>
<td align="left">US</td>
</tr>
<tr>
<td align="left"><a href="https://manx.social/" rel="nofollow" target="_blank">https://manx.social</a></td>
<td align="left">TRUE</td>
<td align="right">1</td>
<td align="right">59</td>
<td align="left">CA</td>
</tr>
</tbody></table>

<p>The largest instances contain “mastodon” in their address and are rather generic communities. Other names suggest a technical / open source software focus (fosstodon, linuxrocks.online, functional.cafe). There are politically oriented communities (mastodon.partipirate.org, eupublic.social). Other servers have a geographical focus (graz.social, bonn.social, berlin.social, dresden.network, norden.social, sueden.social, aus.social). </p>

<p>I find qoto.org interesting, which also integrates other services like Gitlab and a group concept.</p>

<p>Some interesting communities are closed, e.g. scholar.social or chaos.social.</p>

<p>I can&#39;t really make sense of the country codes. To find out the countries, I used the packages <code>iptools</code> and <code>rgeolocate</code>:</p>

<pre>get_instance_countrycode &lt;- function(instance) {
    stopifnot(length(instance)==1) # not vectorized
    ip &lt;- iptools::hostname_to_ip(gsub(&quot;^https://&quot;, &quot;&quot;, instance))[[1]]
    if(length(ip)&gt;1) ip &lt;- ip[1]
    if(ip==&quot;Not resolved&quot;) return(NA)
    fn &lt;- system.file(&quot;extdata&quot;,&quot;GeoLite2-Country.mmdb&quot;, package = &quot;rgeolocate&quot;)
    rgeolocate::maxmind(ip, fn)[,&quot;country_code&quot;]
}
</pre>

<p>I don&#39;t really trust the results. For example, aus.social claims to be hosted in Australia.</p>

<pre>table(stats$country_code)

## 
## CA DE FR GB GR IN LU NL UA US 
##  2 17  9  7  1  2  1  1  1 14
</pre>

<p>I decided on <code>berlin.social</code>. Then the local timeline makes sense for me. I have also already found some R users and am now following them. I have also already found two interesting toots that will occupy me in depth in the short to medium term. All in all, a good start.</p>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://factbased.blogspot.com/2022/10/getting-acquainted-with-mastodon.html"> factbased</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/getting-acquainted-with-mastodon-instances/">Getting acquainted with Mastodon — Instances</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334062</post-id>	</item>
		<item>
		<title>Some Recent Developments in Mixture Cure Model Methodology for Survival Analysis</title>
		<link>https://www.r-bloggers.com/2022/10/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/</link>
		
		<dc:creator><![CDATA[YoungStatS]]></dc:creator>
		<pubDate>Sun, 30 Oct 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>Abstract<br />
The mixture cure model in survival analysis has received large and growing attention in the last few decades. Here we present an overview drawing together early results and some recent new developments, and pointing out areas where further...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/">Some Recent Developments in Mixture Cure Model Methodology for Survival Analysis</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/"> YoungStatS</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>



<div id="abstract" class="section level2">
<h2>Abstract</h2>
<p>The mixture cure model in survival analysis has received large and growing attention in the last few decades. Here we present an overview drawing together early results and some recent new developments, and pointing out areas where further work is needed.</p>
</div>
<div id="introduction-the-mixture-cure-model" class="section level2">
<h2>Introduction: the Mixture Cure Model</h2>
<p>In certain clinical trials or observational studies, either prospective or based on historically accumulated data, individuals are or have been <em>followed up</em> for a period of time and their status at some endpoint reported. See for example the <span class="citation">National Cancer Institute (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-SEER2019" role="doc-biblioref" rel="nofollow" target="_blank">2019</a>)</span> (Surveillance, Epidemiology, and End Results, US National Cancer Institute) data base, which contains a massive amount of data with extended followup on a wide range of cancers — an important source for historical data. In another context, in <span class="citation">Liu et al. (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-Liu2018" role="doc-biblioref" rel="nofollow" target="_blank">2018</a>)</span>, the times of occurrence of four endpoints (overall survival, disease-specific survival, disease-free interval, or progression-free interval) for 11,160 patients across 33 cancer types were obtained from follow-up data files, with a view to making recommendations to clinicians regarding their patient’s status.</p>
<p>The data confronting the statistician consists of observations like this, on the time to the occurrence of some event such as death, or the recurrence of a disease, etc. For definiteness, suppose we are analysing overall survival, and the measurement is the life-lengths of a sample of individuals. A particular characteristic of this kind of data is that it is commonly <em>right-censored</em>. This happens when an individual’s complete lifetime is not observed, either because s/he left the study early for some reason, or was still alive at the end of the study (and all real-life studies must be terminated at some finite time). The censored observations must be taken into account in any analysis; to ignore them would introduce bias, in that, typically, some of the longer lifetimes would have been ignored.</p>
<p>Methods for the analysis of such survival data have long been known. See for example <span class="citation">Kalbfleisch and Prentice (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-kalbfleischprentice1981" role="doc-biblioref" rel="nofollow" target="_blank">1981</a>)</span>. A good place to start is simply to look at the data, literally, in the form of the <em>Kaplan-Meier Estimator</em> (KME, <span class="citation">Kaplan and Meier (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-kaplanmeier1958" role="doc-biblioref" rel="nofollow" target="_blank">1958</a>)</span>), which is a nonparametric estimator of the survival function (the tail, or complement, of the distribution describing the lifetimes) which takes into account the censoring. An example KME plot is the first thing we see when looking at the current Wikipedia entry for the KME.</p>
<p>Notable about this example and many others we can see in the literature is that the survivor function is <em>improper</em>; it does not reach zero at its right endpoint. Equivalently, in such cases, the KME as a cdf has total mass less than 1. This is so for all of the data sets in <span class="citation">Liu et al. (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-Liu2018" role="doc-biblioref" rel="nofollow" target="_blank">2018</a>)</span>, and we give other examples below.</p>
<p>A KME which levels off or “plateaus” at its right hand end because the largest or perhaps a number of the largest lifetimes are censored may indicate the presence of a proportion of individuals in the population who will not suffer the event, no matter how long they are followed up. We refer to them as “cured of” or “immune to” the event, and methods are now well developed to deal with this kind of data, generally known as <em>cure model</em> methods. As well as providing significant extra information beyond that of a standard survival analysis, ignoring the presence of cures in an analysis can lead to biased and misleading conclusions, sometimes with profound consequences for diagnostic prognostications and evaluations. Various versions of cure models have been formulated over the years but here we concentrate on a version which seems easiest to us to formulate, analyse and interpret: the <em>mixture cure models</em>.</p>
</div>
<div id="boags-data" class="section level2">
<h2>Boag’s Data</h2>
<p>The first recognition of the need for and implementation of a cure model seems to have been by <span class="citation">Boag (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-boag" role="doc-biblioref" rel="nofollow" target="_blank">1949</a>)</span>. He collected data from a number of centres in England, for various sites of the disease and treatment methods, and noticed that, while the distributions of life-lengths (measured from the beginning of treatment) of those dying appeared to follow quite well a lognormal distribution, “<em>a large group of patients … were still alive and symptom-free</em> (at the limits of his followup). <em>In this instance we should conclude that a proportion of the patients was permanently cured by the treatment</em>”.</p>
<p>Accordingly, he proposed a model in which “<em>A proportion, <span class="math inline">\(c\)</span>, of all patients treated is permanently cured. Patients in the remaining fraction <span class="math inline">\((1- c)\)</span> are liable to die of cancer if they do not previously die from other causes.</em>” He went on to fit by maximum likelihood a lognormal distribution with mass at infinity – a mixture cure model – to followup data on 121 women with breast cancer, finding a significant “cured” proportion in the data.</p>
<p>Fig. 2.1 shows the KME of the survival distribution with 95% confidence intervals, and a Weibull mixture distribution fitted, for Boag’s 121 breast cancer patients. The KME jumps only at uncensored (death) times, remaining constant at censored times. For this data it clearly levels off at a value less than 1, consistent with Boag’s observation of a possible cured component, with a tendency to remain constant at lifetimes greater than 90 months, except for one late death at 120.6 months. The length of the level stretch at the righthand end of the KME is indicative of the amount of followup in the data.</p>
<p><img src="https://i1.wp.com/youngstats.github.io/post/2022-10-30-some-recent-developments-in-mixture-cure-methodology-for-survival-analysis_files/Figure1.png?w=578&#038;ssl=1" data-recalc-dims="1" /></p>
<p>Figure 2.1: <em>KME for Boag Breast Cancer Data with Fitted Weibull Mixture Distribution</em>.</p>
<p>The KME in Fig. 2.1 is very typical of the kind that can be seen in much of the medical literature. It displays clearly the main issues we want to address:</p>
<p><span class="math inline">\(\bullet\)</span> has the KME levelled off at a value <em>significantly</em> less than 1 thereby indicating the possible presence of immunes in the population? and</p>
<p><span class="math inline">\(\bullet\)</span> has the KME levelled off <em>sufficiently</em> for us to be confident of this?</p>
<p>Since the prospect of a cure is surely the hope of many or most medical procedures, the importance of Boag’s insight can hardly be overstated. Following his groundbreaking paper a number of researchers followed up with various aspects and analyses of the model, but the first systematic treatment of what is now called the long term survivor or cure mixture model seems to have been in <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span>. That book combines nonparametric and parametric theoretical formulations and proofs with many practical applications and examples of the model.</p>
<p>There has been an upsurge in interest in the model since the 1990s, with many applications areas explored, especially in medical statistics, and some substantial theoretical advances made. Correspondingly, computational facilities have improved tremendously, and with modern capabilities a wide variety of parametric models of censored data with long term survivors can now be fitted routinely with the statistical package R.</p>
<p>More recent work of the present authors concerns some aspects left unresolved in <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span>, as well as some quite new points of view, which we discuss below.</p>
</div>
<div id="notation-assumptions-and-distributions" class="section level2">
<h2>Notation, Assumptions and Distributions</h2>
<p>A tractable and reasonably realistic model for the data is an independent and identically distributed (iid) censoring model with right censoring. In it, a sample of size <span class="math inline">\(n\)</span> consists of observations on the sequence of iid 2-vectors <span class="math inline">\(\big(T_i=T_i^*\wedge U_i, C_i={\bf 1}(T_i^*\le U_i);\, 1\le i\le n\big)\)</span> where the <span class="math inline">\(T_i\)</span> represent the censored survival times and the <span class="math inline">\(C_i\)</span> are the censor indicators. The <span class="math inline">\(T_i^*\)</span> with continuous cumulative distribution function (cdf) <span class="math inline">\(F^*\)</span> on <span class="math inline">\([0,\infty)\)</span> represent the times of occurrence of the event under study. The <span class="math inline">\(U_i\)</span>, iid with continuous cdf <span class="math inline">\(G\)</span> on <span class="math inline">\([0,\infty)\)</span>, are censoring random variables, independent of the <span class="math inline">\(T_i^*\)</span>. In a sample from a population containing long-term survivors we observe the censored random variables <span class="math inline">\(T_i=T_i^*\wedge U_i\)</span>, these being potential lifetimes censored at a limit of follow-up represented for individual <span class="math inline">\(i\)</span> by the random variable <span class="math inline">\(U_i\)</span> with censor indicators <span class="math inline">\(C_i={\bf 1}(T_i^*\le U_i)\)</span>.</p>
<p>In the general mixture cure model, the censoring distribution <span class="math inline">\(G\)</span> of the <span class="math inline">\(U_i\)</span> is always assumed proper (total mass 1), but the distribution <span class="math inline">\(F^*\)</span> of the <span class="math inline">\(T_i^*\)</span> may be improper, with mass <span class="math inline">\(1-p\)</span>, <span class="math inline">\(0\le p<1\)</span>, at infinity. We assume <span class="math inline">\(F^*\)</span>to be of the form <span class="math display">\[\begin{equation}    \label{FandF0}
    F^*(t)=pF(t),
\end{equation}\]</span> where <span class="math inline">\(0<p\le 1\)</span> and <span class="math inline">\(F\)</span> is a proper distribution. <span class="math inline">\(F\)</span> is the distribution of the lifetimes of susceptible individuals in the population; only these can experience the event of interest and have a potentially uncensored failure time. The remainder are immune to the event of interest or cured of it. The presence of cured subjects is signalled by a value of <span class="math inline">\(p<1\)</span>, in which case the distribution <span class="math inline">\(F^*\)</span> is improper, with total mass <span class="math inline">\(p\)</span>. Then <span class="math inline">\(1-p\)</span> is the proportion of immune or cured individuals in the population.</p>
<p>We do not know whether a particular censored lifetime in the sample is from a cured or immune individual (uncensored lifetimes are obviously not from immunes); but observations on cured or immune individuals are always censored; those on susceptibles may or may not be according as the corresponding <span class="math inline">\(T_i^*>U_i\)</span> or not.</p>
</div>
<div id="data-display-the-kaplan-meier-estimator" class="section level2">
<h2>Data Display: the Kaplan-Meier Estimator</h2>
<p>The KME is a highly informative data display which shows clearly in visual form the features we want to investigate. To define it, denote the ordered sample lifetimes as <span class="math inline">\(T_n^{(1)}< T_n^{(2)}< \cdots <T_n^{(n)}\)</span>, with associated censor indicators <span class="math inline">\(C_n^{(1)}, C_n^{(2)}, \ldots, C_n^{(n)}\)</span>. Let <span class="math inline">\(M(n)=T_n^{(n)}=\max_{1\leq i\leq n}T_i\)</span> be the largest survival time and let <span class="math inline">\(M_u(n)\)</span> be the largest observed <em>uncensored</em> survival time. An explicit definition of the KME is <span class="math display">\[
F_n(t):= 1-\prod_{1\le i\le n: \, T_n^{(i)} \le t}^n \big(1- \frac{C_n^{(i)}}{n-i+1} \big),
\ {\rm  for}\ 0<t\le M(n),
\]</span></p>
<p>with <span class="math inline">\(\hat F_n(0):=0\)</span> and <span class="math inline">\(\hat F_n(t):=\hat F_n(M(n))\)</span> for <span class="math inline">\(t> M(n)\)</span>. In (4.1), <span class="math inline">\(n-i+1\)</span> is the number of subjects “at risk” at times just prior to <span class="math inline">\(T_n^{(i)}\)</span>. Recall we assume <span class="math inline">\(F^*\)</span> and <span class="math inline">\(G\)</span> are continuous so there are no tied survival times in the data with probability 1. Let <span class="math inline">\(\hat p_n:= \hat F_n(M(n))\)</span> be the value of the KME at its right extreme.</p>
<p>In a sample we observe data values <span class="math inline">\((t_i, c_i)_{1\le i\le n}\)</span> for <span class="math inline">\((T_i,C_i)_{1\le i\le n}\)</span>, order them as <span class="math inline">\(t_n^{(1)}< t_n^{(2)}< \cdots <t_n^{(n)}\)</span>, and define associated censor indicators <span class="math inline">\(c_n^{(1)}, c_n^{(2)}, \ldots, c_n^{(n)}\)</span>. Then <span class="math inline">\(t_n^{(n)}=\max_{1\leq i\leq n}t_i\)</span> is the largest observed survival time. The sample KME is the same function with observed data values substituted for the random quantities, and we obtain a sample estimate of <span class="math inline">\(\hat p_n\)</span> by substituting appropriately in (4.2).</p>
<p>A nonparametric estimate of the population proportion dying is given by the maximum value of the KME, that is, <span class="math inline">\(\hat p_n\)</span> as defined by (4.2), and its complement is the estimated cure proportion, which as can be seen in Fig. 2.1 for Boag’s data is 0.30 with a 95% confidence interval (CI) of <span class="math inline">\([0.19, 0.48]\)</span>. This interval excludes 0, in general agreement with Boag’s observation of a possible cured component. This confidence interval assessment though indicative is not strictly correct usage, however, as the restriction of <span class="math inline">\(p\)</span> to <span class="math inline">\([0,1]\)</span> should be taken into account, as should the fact that <span class="math inline">\(\hat p_n\)</span> is calculated from the KME at a random (not deterministic) time.</p>
<p>When a parametric mixture model such as the Weibull is fitted, a rigorous test for <span class="math inline">\(H_0: p=1\)</span> (no immunes present) is available (see Section 5.3, p.109, of <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span>), and a nonparametric test using <span class="math inline">\(\hat p_n\)</span> is outlined in Section 4.2, p.76, p.109, of <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span> (with percentage points in Table A.1 of the book), but we still do not have complete understanding of the distribution of <span class="math inline">\(\hat p_n\)</span> under the null hypothesis <span class="math inline">\(H_0\)</span>.</p>
<p>The KME contains further evidence about the existence of a cured component. We see in Fig.2.1 a tendency for the KME to remain constant at lifetimes greater than 90 months, except for one late death at 120.6 months. The length of the level stretch at the righthand end of the KME is indicative of the amount of followup in the data. A statistic <span class="math inline">\(Q_n\)</span> is suggested in <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span> for assessing “sufficient followup”.</p>
</div>
<div id="recent-research" class="section level2">
<h2>Recent Research</h2>
<p>These ideas are related to the magnitudes of the largest survival time observed, and the largest <em>uncensored</em> survival time observed, and the numbers of observations in the two time intervals defined by these. A key structural result obtained in <span class="citation">Maller, Resnick, and Shemehsavar (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-MRS2020" role="doc-biblioref" rel="nofollow" target="_blank">2020</a>)</span> is that, conditional on the value of the largest uncensored survival time, and knowing the number of censored observations exceeding this time, the sample partitions into two independent subsamples, each subsample having the distribution of an iid sample of censored survival times, of reduced size, from truncated random variables. This result provides valuable insight and intuition into the construction of samples of censored survival data, and facilitates the calculation of explicit finite sample formulae, for example, for the joint distribution of the largest and the largest <em>uncensored</em> survival time observed, and for <span class="math inline">\(Q_n\)</span>. Further, the asymptotic distributions of these statistics can then be worked out under conditions related to those familiar from extreme value theory. Our recent research is very much in this line. See <span class="citation">Escobar-Bach et al. (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-emvz2020" role="doc-biblioref" rel="nofollow" target="_blank">2020</a>)</span> (adjusting for insufficient follow-up), <span class="citation">Maller and Resnick (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-MR2020" role="doc-biblioref" rel="nofollow" target="_blank">2020</a>)</span> (extremes of censored and uncensored lifetimes), <span class="citation">Maller, Resnick, and Shemehsavar (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-MRS2020" role="doc-biblioref" rel="nofollow" target="_blank">2020</a>)</span> (splitting the sample at the largest uncensored observation, testing for sufficient followup, estimating the probability of being cured).</p>
</div>
<div id="conclusion-take-away-points" class="section level2">
<h2>Conclusion: Take-Away Points</h2>
<p><span class="math inline">\(\bullet\)</span> It’s very common in survival analysis to encounter a KME which has levelled off at a value less than 1. This may indicate the presence of immune or cured individuals in the population — but not always — even in the absence of cures, it’s possible for the right extreme of the KME to be less than 1 just by chance.</p>
<p><span class="math inline">\(\bullet\)</span> A significance test is available for the hypothesis <span class="math inline">\(H_0: p=1\)</span> when a well-fitting parametric model has been found for the data. A wide variety of models can be fitted routinely with R. These cover a class of generalised F models and, as a submodel, an extended generalised gamma model, which between them include as submodels most of the usual survival distributions such as the exponential, Weibull, lognormal, Gumbel, log-logistic, Burr, etc.</p>
<p><span class="math inline">\(\bullet\)</span> A nonparametric test for <span class="math inline">\(H_0: p=1\)</span> is available too, but at present we have to rely on simulated, tabulated, percentage points for the distribution.</p>
<p><span class="math inline">\(\bullet\)</span> An important point is whether the KME has levelled off <em>sufficiently</em> at its right endpoint. The <span class="math inline">\(Q_n\)</span> statistic has been developed to measure and test for this.</p>
<p><span class="math inline">\(\bullet\)</span> We’ve confined our discussion to the one-sample case. In practice, we usually have one or more groups (treatment groups, or otherwise), and/or covariates, and want to examine the effects of these. Much of <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span> is concerned with methods for handling this.</p>
<p><span class="math inline">\(\bullet\)</span> We’ve also confined our discussion to medical data and survival analysis. But the methodology applies to many other kinds of time-to-event data. A wide variety of examples can be found in a web search. <span class="citation">Maller and Zhou (<a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/#ref-mallerzhoubook1996" role="doc-biblioref" rel="nofollow" target="_blank">1996</a>)</span> use much criminological data (time to re-arrest of a released prisoner, etc.) to illustrate the methods.</p>
<p><span class="math inline">\(\bullet\)</span> Ignoring the possible presence of cured, immune or long-term survivors in a population not only risks losing valuable information but can result in bias and misleading conclusions. An important point is that including the possibility of long-term survivors in <em>any</em> survival analysis can do no damage; if their presence is allowed for but found not to be significant, no harm is done (but keeping in mind the risks of overfitting).</p>
<p><span class="math inline">\(\bullet\)</span> The mixture cure model can be regarded as a special case of a competing risks analysis where death or failure of an individual may be due to a number of possible causes. The issue of sufficient followup is clearly relevant in this context, but has not been addressed at all, to our knowledge.</p>
</div>
<div id="about-the-authors" class="section level2">
<h2>About the authors</h2>
<p><strong>Ross Maller</strong>, Research School of Finance, Actuarial Studies &#038; Statistics, Australian National University</p>
<p><strong>Sidney Resnick</strong>, School of Operations Research and Information Engineering, Cornell University</p>
<p><strong>Soudabeh Shemehsavar</strong> (corresponding author), College of Science, Health, Engineering and Education, Murdoch University, Perth, Western Australia and School of Mathematics, Statistics &#038; Computer Sciences, University of Tehran, Soudabeh.Shemehsavar(at)murdoch.edu.au</p>
<p><strong>Muzhi Zhao</strong>, Research School of Finance, Actuarial Studies &#038; Statistics, Australian National University</p>
<div id="bibliography" class="section level3 unnumbered">
<h3>Bibliography</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-boag" class="csl-entry">
Boag, J. W. 1949. <span>“Maximum Likelihood Estimates of the Proportion of Patients Cured by Cancer Therapy.”</span> <em>J. Roy. Stat. Soc. (B)</em> 11: 15.
</div>
<div id="ref-emvz2020" class="csl-entry">
Escobar-Bach, M., R. Maller, I. Van Keilegom, and M. Zhao. 2020. <span>“Estimation of the Cure Rate for Distributions in the <span>G</span>umbel Maximum Domain of Attraction Under Insufficient Follow-up.”</span> <em>Biometrika</em>.
</div>
<div id="ref-kalbfleischprentice1981" class="csl-entry">
Kalbfleisch, J. D., and R. L. Prentice. 1981. <span>“Estimation of the Average Hazard Ratio.”</span> <em>Biometrika</em> 68(1): 105–12.
</div>
<div id="ref-kaplanmeier1958" class="csl-entry">
Kaplan, E. L., and P. Meier. 1958. <span>“Nonparametric Estimation from Incomplete Observations.”</span> <em>J. Amer. Statist. Assoc.</em> 53: 457–81.
</div>
<div id="ref-Liu2018" class="csl-entry">
Liu, J., T. Lichtenberg, K. A. Hoadley, L. M. Poisson, A. J. Lazar, A. D. Cherniack, A. J. Kovatich, et al. 2018. <span>“An Integrated TCGA Pan-Cancer Clinical Data Resource to Drive High-Quality Survival Outcome Analytics.”</span> <em>Cell</em> 173: 400–416.
</div>
<div id="ref-MR2020" class="csl-entry">
Maller, R., and S. Resnick. 2020. <span>“Extremes of Censored and Uncensored Lifetimes in Survival Data.”</span> <em>Extremes</em> to appear.
</div>
<div id="ref-MRS2020" class="csl-entry">
Maller, R., S. Resnick, and S. Shemehsavar. 2020. <span>“Splitting the Sample at the Largest Uncensored Observation.”</span> <em>Submitted</em>.
</div>
<div id="ref-mallerzhoubook1996" class="csl-entry">
Maller, R., and X. Zhou. 1996. <span>“Survival Analysis with Long Term Survivors.”</span> <em>Wiley, Chichester</em>.
</div>
<div id="ref-SEER2019" class="csl-entry">
National Cancer Institute, DCCPS. 2019. <span>“Surveillance, Epidemiology, and End Results (SEER) Program Research Data (1975-2016).”</span> <em>Surveillance, Epidemiology, and End Results (SEER) Program (Www.seer.cancer.gov) Research Data (1975-2016)</em>.
</div>
</div>
</div>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://youngstats.github.io/post/2022/10/30/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/"> YoungStatS</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/some-recent-developments-in-mixture-cure-model-methodology-for-survival-analysis/">Some Recent Developments in Mixture Cure Model Methodology for Survival Analysis</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334071</post-id>	</item>
		<item>
		<title>A Linux Live USB as a statistical programming dev environment</title>
		<link>https://www.r-bloggers.com/2022/10/a-linux-live-usb-as-a-statistical-programming-dev-environment/</link>
		
		<dc:creator><![CDATA[Econometrics and Free Software]]></dc:creator>
		<pubDate>Sat, 29 Oct 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.brodrigues.co/blog/2022-10-29-mkusb_minp/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>This blog post is divided in two parts: in the first part I’ll show you how<br />
to create a Linux Live USB with persistent storage that can be used as<br />
development environment, and in the second part I’ll show you the easiest<br />
way to set up RStudio and ...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/a-linux-live-usb-as-a-statistical-programming-dev-environment/">A Linux Live USB as a statistical programming dev environment</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.brodrigues.co/blog/2022-10-29-mkusb_minp/"> Econometrics and Free Software</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<div style="text-align:center;">
<p><video width="450" controls>
<source src="https://www.brodrigues.co/img/tux_usb_ubuntu_startup.mp4" type="video/mp4">
</video></p>
</div>
<p>This blog post is divided in two parts: in the first part I’ll show you how
to create a Linux Live USB with persistent storage that can be used as
development environment, and in the second part I’ll show you the easiest
way to set up RStudio and R in Ubuntu.</p>
<div id="making-your-own-portable-development-environment-based-on-ubuntu-or-debian" class="section level2">
<h2>Making your own, portable, development environment based on Ubuntu or Debian</h2>
<p>I’m currently teaching a course at the University of Luxembourg, which
focuses on setting up reproducible analytical pipelines (if you’re
interested, you can find the course notes <a href="https://rap4mads.eu/" rel="nofollow" target="_blank">here</a>).</p>
<p>The problem is that my work laptop runs Windows, and I didn’t want to teach
on Windows since I make heavy use of the command line. Plus I don’t have
admin rights on this machine, so installing what I needed would have been a pain.
I also don’t have a personal laptop, so I use my wife’s laptop. However, the
laptop is completely full of pictures of our kids, so I couldn’t install what I needed…
This is when I thought about making a persistent live USB with Kubuntu on it
(Kubuntu is a variant of Ubuntu with KDE as the desktop manager instead of Gnome)
with all the software I needed (R, Quarto, RStudio basically). It works quite well, and
was also quite easy to do. But what is a live USB anyways?
A live USB is a full Linux installation on a USB stick, that you can use to test
different Linux distributions or even to install said distribution on computers.</p>
<p>The first step is to get a USB stick. Those are quite cheap nowadays, but you’ll
need at least one with 8GB of space, and ideally USB 3 (you probably can’t find
any USB 2 these days anyways). I’ve bought a 32GB one for 10€.</p>
<p>Then, we need to install Ubuntu on it. I’ll be using Kubuntu 22.04, which is an LTS
release. I would always recommend an LTS release for something like crafting
a development environment. So if you’re reading this in the future, and there’s a new
LTS (could be 24.04, 26.04, etc), you’d need to get that one.</p>
<p>Creating a live USB is quite simple, but the issue if you create a live USB using the standard
methods is that whatever you do on it once you’re logged in while get erased after rebooting. A
persistent live USB, I’m sure you’ve guessed it, keeps your changes even after rebooting, which
means that you basically end up with a portable development environment. Note however that only
Ubuntu (and variants) or Debian can be used to create persistent live USBs.</p>
<p>You can create persistent live USB from another Linux distro, Windows or macOS.</p>
<p>If you’re already running Ubuntu on your pc, you might want to take a look at <a href="https://help.ubuntu.com/community/mkusb#Persistent_live_systems" rel="nofollow" target="_blank">this
page</a>. You’ll need to install a
tool called <code>mkusb</code>. If you’re not running Ubuntu, but find this tool in your distribution’s
package manager, I guess you’re good to go as well. In my case, I’m running opensuse tumbleweed,
and could not find this program in the opensuse’s repositories. So I’ve used this
<a href="https://help.ubuntu.com/community/mkusb/minp" rel="nofollow" target="_blank">guide</a> that shows how to achieve the same thing
using a very simple to use shell script which you can get
<a href="https://help.ubuntu.com/community/mkusb/minp?action=AttachFile&#038;do=view&#038; rel=" target="_blank">here</a>
called <code>mkusb-minp</code>. So in my case, I simply
had to stick the USB stick in my computer, find out where it was mounted by running <code>df</code> in bash
(in my case it was in <code>/dev/sdd</code>), download Kubuntu’s iso image and run the following in my
terminal:</p>
<pre>sudo ./mkusb-minp -p kubuntu-22.04.1-desktop-amd64.iso /dev/sdX</pre>
<p>(<code>/dev/sdX</code>: replace the X by the right letter, for me it was <code>/dev/sdd</code>)</p>
<p>If you’re using Windows, you can install <a href="https://rufus.ie/en/#" rel="nofollow" target="_blank">Rufus</a> to create
a persistent live USB.</p>
<p>It would seem that for macOS the process is a bit more involved, but I’ve found this
<a href="https://sebay.github.io/posts/create-live-persistent-ubuntu-usb-on-mac/" rel="nofollow" target="_blank">blog post</a>
that explains the process.</p>
<p>Once the process is finished, you can boot into your live USB key. For this, you might
need to press <code>delete</code> or <code>F2</code> when your computer starts booting to access the
<a href="https://www.computerhope.com/jargon/b/boot_menu.htm" rel="nofollow" target="_blank">boot menu</a>.
You can then choose to boot from your USB device.</p>
<p>Wait a bit and at some point you should see a prompt asking you if you want to
try or install Ubuntu. Choose <code>Try Ubuntu</code>:</p>
<div style="text-align:center;">
<p><img src="https://i2.wp.com/www.brodrigues.co/img/try_ubuntu.png?w=578&#038;ssl=1" data-recalc-dims="1"></p>
</div>
<p>And then wait some minutes. Yes booting takes some time because you’re loading an entire
operating system from a USB stick (hence why it’s a good idea to go with a USB 3 stick).
After some time you should see a new window:</p>
<div style="text-align:center;">
<p><img src="https://i1.wp.com/www.brodrigues.co/img/try_ubuntu2.png?w=578&#038;ssl=1" data-recalc-dims="1"></p>
</div>
<p>Once again, try Ubuntu, wait a bit, and that’s it you’re inside your dev environment!</p>
</div>
<div id="setting-up-r-and-rstudio" class="section level2">
<h2>Setting up R and RStudio</h2>
<p>Now that you’re inside your dev environment, you actually need to start adding some
tools. Let’s start by adding R. The easiest way that I found is to use the
<a href="https://eddelbuettel.github.io/r2u/" rel="nofollow" target="_blank">r2u project</a> by
<a href="https://github.com/eddelbuettel" rel="nofollow" target="_blank">Dirk Eddelbuettel</a>. If you’re on Ubuntu 22.04,
run <a href="https://github.com/eddelbuettel/r2u/blob/master/inst/scripts/add_cranapt_jammy.sh" rel="nofollow" target="_blank">this script</a>,
as explained in the tutorial. This will add the required repositories that will install
binary versions of R packages in mere seconds. The script will also
add a repository to install the most recent version of R, so once the script is done running,
install R and the <code>{tidyverse}</code> (or any other package) with the following command:</p>
<pre>sudo apt install --no-install-recommends r-base r-cran-tidyverse</pre>
<p>You can then install other packages from R using <code>install.packages(&quot;package_name&quot;)</code> as usual,
and this will also make use of the <code>r2u</code> repositories.</p>
<p>All that’s missing now is RStudio (if you use RStudio). Surprisingly, when I set up my live USB
two weeks ago, the current version of RStudio for Ubuntu would not install. This is apparently
fixed with the daily versions which you can get <a href="https://dailies.rstudio.com/" rel="nofollow" target="_blank">here</a>. But
before that, do try to install the stable version. If you’re reading this sometime in the future,
maybe the issue I encountered has been fixed. Download RStudio from
<a href="https://www.rstudio.com/products/rstudio/download/#download" rel="nofollow" target="_blank">here</a>, and then double click on the
downloaded <code>.deb</code> package. If you see this message:</p>
<pre>The following packages have unmet dependencies:
 rstudio : Depends: libssl1.0.0 but it is not installable or
                    libssl1.0.2 but it is not installable or
                    libssl1.1 but it is not installable
           Recommends: r-base (&gt;= 3.0.1) but it is not going to be installed
E: Unable to correct problems, you have held broken packages.</pre>
<p>then this means that the problem has not been fixed. In that case, run the following line to
repair everything:</p>
<pre>sudo apt-get update --fix-missing</pre>
<p>This should put you back into a clean state. So to continue, install a daily build from the link above.
Simply click on the Ubuntu 22 button to download the daily. Unfortunately daily builds can be unstable
and are usually used for testing purposes. So hopefully Posit will fix this soon.</p>
<p>Of course, if you’re using the
<a href="https://www.brodrigues.co/blog/2019-05-19-spacemacs/" rel="nofollow" target="_blank">greatest IDE ever made</a> instead of RStudio,
you won’t have this issue.</p>
<p>You can now keep installing things, for example <a href="https://quarto.org/docs/get-started/" rel="nofollow" target="_blank">Quarto</a>, or
Python, or, or, or… there are no limits, and performance, as you would have noticed is great, because
the operating system has access to all the resources from your machine. A persistent live USB is a
great solution if you need a portable dev environment and don’t want/can’t use Docker for example.</p>
<p>
Hope you enjoyed! If you found this blog post useful, you might want to follow
me on <a href="https://fosstodon.org/@brodriguesco" rel="nofollow" target="_blank">Mastodon</a> or <a href="https://www.twitter.com/brodriguesco" rel="nofollow" target="_blank">twitter</a> for blog post updates and
<a href="https://www.buymeacoffee.com/brodriguesco" rel="nofollow" target="_blank">buy me an espresso</a> or <a href="https://www.paypal.me/brodriguesco" rel="nofollow" target="_blank">paypal.me</a>, or buy my ebook on <a href="https://leanpub.com/modern_tidyverse" rel="nofollow" target="_blank">Leanpub</a>.
You can also watch my videos on <a href="https://www.youtube.com/c/BrunoRodrigues1988/" rel="nofollow" target="_blank">youtube</a>.
So much content for you to consoom!
</p>
<style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#ffffff !important;background-color:#272b30 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 22px !important;letter-spacing:0.6px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#82518c !important;}</style>
<p>
<link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet"><a class="bmc-button" href="https://www.buymeacoffee.com/brodriguesco" rel="nofollow" target="_blank"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me an Espresso"><span style="margin-left:5px">Buy me an Espresso</span></a>
</p>
</div>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.brodrigues.co/blog/2022-10-29-mkusb_minp/"> Econometrics and Free Software</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/a-linux-live-usb-as-a-statistical-programming-dev-environment/">A Linux Live USB as a statistical programming dev environment</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">334015</post-id>	</item>
		<item>
		<title>Fantasy Football Weekly Cheat Sheet: Week 8 (2022)</title>
		<link>https://www.r-bloggers.com/2022/10/fantasy-football-weekly-cheat-sheet-week-8-2022/</link>
		
		<dc:creator><![CDATA[Michael Griebe]]></dc:creator>
		<pubDate>Fri, 28 Oct 2022 22:31:54 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://fantasyfootballanalytics.net/?p=197729</guid>

					<description><![CDATA[<p>Week 8 Cheat Sheet and Fantasy Football Projection Roundup now available.<br />
The post Fantasy Football Weekly Cheat Sheet: Week 8 (2022) appeared first on Fantasy Football Analytics.</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/fantasy-football-weekly-cheat-sheet-week-8-2022/">Fantasy Football Weekly Cheat Sheet: Week 8 (2022)</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://fantasyfootballanalytics.net/2022/10/fantasy-football-weekly-cheat-sheet-week-8-2022.html"> R Archives - Fantasy Football Analytics</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<iframe loading="lazy" src="https://fantasyfootballanalytics.net/wp-content/uploads/2022/10/Roundup-2022-W8.html" height="6750px" width="450">
Week 8 Cheat Sheet and Fantasy Football Projection Roundup now available.
</iframe><p>The post <a rel="nofollow" href="https://fantasyfootballanalytics.net/2022/10/fantasy-football-weekly-cheat-sheet-week-8-2022.html" target="_blank">Fantasy Football Weekly Cheat Sheet: Week 8 (2022)</a> appeared first on <a rel="nofollow" href="https://fantasyfootballanalytics.net/" target="_blank">Fantasy Football Analytics</a>.</p>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://fantasyfootballanalytics.net/2022/10/fantasy-football-weekly-cheat-sheet-week-8-2022.html"> R Archives - Fantasy Football Analytics</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/fantasy-football-weekly-cheat-sheet-week-8-2022/">Fantasy Football Weekly Cheat Sheet: Week 8 (2022)</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">333999</post-id>	</item>
		<item>
		<title>RObservations #40 : Packaging My Route Map Code! Introducting mapBliss.</title>
		<link>https://www.r-bloggers.com/2022/10/robservations-40-packaging-my-route-map-code-introducting-mapbliss/</link>
		
		<dc:creator><![CDATA[Benjamin Smith]]></dc:creator>
		<pubDate>Fri, 28 Oct 2022 04:31:11 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">http://bensstats.wordpress.com/?p=1703</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; "> Introduction Around last year I started blogging about Atlas.co and how its possible to imitate their product in R with a some readily available packages and the MapBox API. Recently I managed to take some time and refine and organize the code I had to make the package I ...</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/robservations-40-packaging-my-route-map-code-introducting-mapbliss/">RObservations #40 : Packaging My Route Map Code! Introducting mapBliss.</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/"> r – bensstats</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

<figure class="wp-block-image size-large"><img data-attachment-id="1713" data-permalink="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/robservations-40/" data-orig-file="https://bensstats.files.wordpress.com/2022/10/robservations-40.png" data-orig-size="1366,768" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="robservations-40" data-image-description="" data-image-caption="" data-medium-file="https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=300" data-large-file="https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=730" src="https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=578" alt="" class="wp-image-1713" srcset_temp="https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=578 1024w, https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=150 150w, https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=300 300w, https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=768 768w, https://bensstats.files.wordpress.com/2022/10/robservations-40.png 1366w" sizes="(max-width: 1024px) 100vw, 1024px" data-recalc-dims="1" /></figure>



<h1>Introduction</h1>



<p>Around <a href="https://bensstats.wordpress.com/2021/10/21/robservations-15-i-reverse-engineered-atlas-co-well-some-of-it/" rel="nofollow" target="_blank">last year</a> I started blogging about <a href="https://atlas.co/products/map" rel="nofollow" target="_blank">Atlas.co</a> and how its possible to imitate their product in R with a some readily available packages and the <a href="https://bensstats.wordpress.com/2021/10/25/robservations-16-using-the-mapbox-api-with-leaflet/" rel="nofollow" target="_blank">MapBox API</a>. Recently I managed to take some time and refine and organize the code I had to make the package I call <code>mapBliss</code>.</p>



<p>I’m really happy with the package so far because it pretty much offers almost all the features for making the type of maps that you can find on Atlas.co and similar sites. In this blog I share some of the features available, basic usage and potential next steps for the development of the <code>mapBliss</code> package.</p>



<h1>Features</h1>



<p>The <code>mapBliss</code> package allows users to to use their custom made MapBox templates and plot car, bike, walking and flight trips over them. It is also possible to get a city view without any trip plotted as well.</p>



<p>As of the time of this blog, there are are five functions. Four of them are used for plotting maps and one of them is used for rendering the maps created as .svg files.</p>



<p>The functions created are:</p>



<ul>
<li> <code>plot_route()</code><span style="font-size:revert;color:initial;"> – for plotting car, bike and walking trips.</span> </li>



<li> <code>plot_flights()</code><span style="font-size:revert;color:initial;"> – for plotting flights.</span> </li>



<li> <code>plot_hybrid_route()</code><span style="font-size:revert;color:initial;"> – for plotting a combination of flights and car, bike and walking trips.</span> </li>



<li> <code>plot_city_view()</code><span style="font-size:revert;color:initial;"> – for plotting city maps.</span> </li>



<li> <code>save_map_svg()</code><span style="font-size:revert;color:initial;"> – for saving the maps you created as print quality .svg files.</span> </li>
</ul>



<h1>Basic Usage</h1>



<p>I structured these functions so that they are pretty straight forward to use while allowing for some flexibility with styling. To get started with basic usage, all that’s needed is for you to supply the relevant locations for the plot functions and a file name for when you want to save your visuals with <code>save_map_svg()</code>.</p>



<p>Since I wrote about in previous blogs for how to <a href="https://bensstats.wordpress.com/2021/10/21/robservations-15-i-reverse-engineered-atlas-co-well-some-of-it/" rel="nofollow" target="_blank">plot routes</a> and <a href="https://bensstats.wordpress.com/2021/11/16/robservations-17-plotting-flight-paths-on-leaflet-maps/" rel="nofollow" target="_blank">flight paths</a> and the usage for those functions have not changed significantly, I will not write about them here. The <code>plot_city_view()</code> function is also pretty straight forward, so for a use case example I’ll use what I think is the most novel function – <code>plot_hybrid_route()</code>.</p>



<p>Suppose you are interested in plotting a flight from Nashville TN, to Seattle, followed by a road trip down to the San Diego ending with a return flight to Nashville. The code to do this is:</p>


<pre>
# devtools::install_github(&quot;benyamindsmith/mapBliss&quot;)

library(mapBliss)

plot_hybrid_route(addresses=c(&quot;Nashville&quot;,
                              &quot;Seattle&quot;,
                              &quot;San Diego&quot;,
                              &quot;Nashville&quot;),
                            how = c(&quot;flight&quot;,&quot;car&quot;,&quot;flight&quot;))

</pre>


<figure class="wp-block-image size-large"><img data-attachment-id="1710" data-permalink="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/image_2022-10-28_002440178/" data-orig-file="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png" data-orig-size="1001,665" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="image_2022-10-28_002440178" data-image-description="" data-image-caption="" data-medium-file="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=300" data-large-file="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=730" src="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=578" alt="" class="wp-image-1710" srcset_temp="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png 1001w, https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=150 150w, https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=300 300w, https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=768 768w" sizes="(max-width: 1001px) 100vw, 1001px" data-recalc-dims="1" /></figure>



<p>This is pretty good. But the default templating doesn’t look the greatest. With a custom MapBox template you can make it look alot better! To learn how to make your own custom MapBox template check out this video here:</p>



<figure class="wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-4-3 wp-has-aspect-ratio"><div class="wp-block-embed__wrapper">
<div class="jetpack-video-wrapper"><iframe class="youtube-player" width="450" src="https://www.youtube.com/embed/tTw358pE6qk?version=3&#038;rel=1&#038;%23038;showsearch=0&#038;%23038;showinfo=1&#038;%23038;iv_load_policy=1&#038;%23038;fs=1&#038;%23038;hl=en&#038;%23038;autohide=2&#038;%23038;wmode=transparent" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation"></iframe></div>
</div></figure>



<p>With this as well as playing around with some of the default arguments in <code>plot_hybrid_route()</code> we can get quite a nice looking map:</p>


<pre>
viz&lt;-plot_hybrid_route(addresses=c(&quot;Nashville&quot;,
                              &quot;Seattle&quot;,
                              &quot;San Diego&quot;,
                              &quot;Nashville&quot;),
                            how = c(&quot;flight&quot;,&quot;car&quot;,&quot;flight&quot;),
                  font=&quot;Brush Script MT&quot;,
                  font_size = &quot;18px&quot;,
                  text_indent = &quot;45px&quot;,
                  mapBoxTemplate = &quot;https://api.mapbox.com/styles/v1/benyamindsmith/ckv64zmgy1awy14ofg33zmszz/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiYmVueWFtaW5kc21pdGgiLCJhIjoiY2tiMDR3NXpzMDU3bjJ1cXVqNmx3ODhudyJ9.KffbwvHgcIn1GL1DV4uUBQ&quot;,
                  zoomControl = c(10, 10, -10, -10)
                  )

viz

</pre>


<figure class="wp-block-image size-large"><img data-attachment-id="1711" data-permalink="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/image_2022-10-28_002522508/" data-orig-file="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png" data-orig-size="1024,669" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="image_2022-10-28_002522508" data-image-description="" data-image-caption="" data-medium-file="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=300" data-large-file="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=730" src="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=578" alt="" class="wp-image-1711" srcset_temp="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png 1024w, https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=150 150w, https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=300 300w, https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px" data-recalc-dims="1" /></figure>



<p>Now that we have a beautiful map, if we want to save the visual as an .svg file for printing of all size we can use the <code>save_map_svg()</code> function. Take your saved image to your favorite online printer and enjoy art that would’ve costed you up to $250.00 USD + shipping for a fraction of price.</p>


<pre>
save_map_svg(viz=viz,
             svg_name = &quot;Pacific Highway 2021.svg&quot;,
             zoom=3)


## [1] &quot;Pacific Highway 2021.svg written in F:/&quot;
</pre>



<p>Taking this to <a href="https://www.canva.com/" rel="nofollow" target="_blank">Canva</a> and playing around with some templating I was able to design this poster with minimal effort.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="1708" data-permalink="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/image-26/" data-orig-file="https://bensstats.files.wordpress.com/2022/10/image.png" data-orig-size="1003,683" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://bensstats.files.wordpress.com/2022/10/image.png?w=300" data-large-file="https://bensstats.files.wordpress.com/2022/10/image.png?w=730" src="https://bensstats.files.wordpress.com/2022/10/image.png?w=578" alt="" class="wp-image-1708" srcset_temp="https://bensstats.files.wordpress.com/2022/10/image.png 1003w, https://bensstats.files.wordpress.com/2022/10/image.png?w=150 150w, https://bensstats.files.wordpress.com/2022/10/image.png?w=300 300w, https://bensstats.files.wordpress.com/2022/10/image.png?w=768 768w" sizes="(max-width: 1003px) 100vw, 1003px" data-recalc-dims="1" /></figure>



<p>And the cost to order this as a poster is much cheaper.</p>



<figure class="wp-block-image size-large"><img data-attachment-id="1709" data-permalink="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/image-1-11/" data-orig-file="https://bensstats.files.wordpress.com/2022/10/image-1.png" data-orig-size="424,850" data-comments-opened="1" data-image-meta="{"aperture":"0","credit":"","camera":"","caption":"","created_timestamp":"0","copyright":"","focal_length":"0","iso":"0","shutter_speed":"0","title":"","orientation":"0"}" data-image-title="image-1" data-image-description="" data-image-caption="" data-medium-file="https://bensstats.files.wordpress.com/2022/10/image-1.png?w=150" data-large-file="https://bensstats.files.wordpress.com/2022/10/image-1.png?w=578" src="https://bensstats.files.wordpress.com/2022/10/image-1.png?w=578" alt="" class="wp-image-1709" srcset_temp="https://bensstats.files.wordpress.com/2022/10/image-1.png 424w, https://bensstats.files.wordpress.com/2022/10/image-1.png?w=75 75w, https://bensstats.files.wordpress.com/2022/10/image-1.png?w=150 150w" sizes="(max-width: 424px) 100vw, 424px" data-recalc-dims="1" /></figure>



<h1>Dependencies</h1>



<p>It goes without saying that <code>mapBliss</code> was built with many of the pre-existing packages on CRAN. They are (to date):</p>



<ul>
<li> <a style="font-size:revert;" href="https://dplyr.tidyverse.org/" rel="nofollow" target="_blank">dplyr</a> </li>



<li> <a style="font-size:revert;" href="https://purrr.tidyverse.org/" rel="nofollow" target="_blank">purrr</a> </li>



<li> <a style="font-size:revert;" href="https://magrittr.tidyverse.org/" rel="nofollow" target="_blank">magrittr</a> </li>



<li> <a style="font-size:revert;" href="https://tibble.tidyverse.org/" rel="nofollow" target="_blank">tibble</a> </li>



<li> <a style="font-size:revert;" href="https://rlang.r-lib.org/" rel="nofollow" target="_blank">rlang</a> </li>



<li> <a style="font-size:revert;" href="https://r-spatial.github.io/sf/" rel="nofollow" target="_blank">sf</a> </li>



<li> <a style="font-size:revert;" href="http://uribo.github.io/rpkg_showcase/spatial/geosphere.html" rel="nofollow" target="_blank">geosphere</a> </li>



<li> <a style="font-size:revert;" href="https://jessecambon.github.io/tidygeocoder/" rel="nofollow" target="_blank">tidygeocoder</a> </li>



<li> <a style="font-size:revert;" href="https://rstudio.github.io/leaflet/" rel="nofollow" target="_blank">leaflet</a> </li>



<li> <a style="font-size:revert;" href="https://github.com/riatelab/osrm" rel="nofollow" target="_blank">osrm</a> </li>



<li> <a style="font-size:revert;" href="https://wch.github.io/webshot/articles/intro.html" rel="nofollow" target="_blank">webshot</a> </li>



<li> <a style="font-size:revert;" href="https://github.com/ramnathv/htmlwidgets" rel="nofollow" target="_blank">htmlwidgets</a> </li>



<li> <a style="font-size:revert;" href="https://github.com/ropensci/magick" rel="nofollow" target="_blank">magick</a> </li>
</ul>



<p>Thank you to all the authors and maintainers of these packages whom made it possible for this package to come into existence.</p>



<h1>Next Steps</h1>



<p>This package is pretty good for making artistic maps, but there are some features which are presently lacking that I would be nice to have:</p>



<ul>
<li> <span style="font-size:revert;color:initial;">Better package documentation. The package documentation is complete, however I’m sure there is room to improve it.</span> </li>



<li> <span style="font-size:revert;color:initial;">Template design. Right now maps which are created with mapBliss are just html widgets that are screenshoted and converted to .svg files. The next step would be having the ability to take these .svg files and place them in a frame template that would allow for the user to put a title and text similar to whats available on Atlas.co.</span> </li>



<li> <span style="font-size:revert;color:initial;">A GUI. Presently, the features in mapBliss are only available to the R-saavy. It would be cool to make this tool available to the general public. A intuitive approach would be to build a Shiny app, but, as expected, this takes alot of work and time investment. For a front end application, some alterations in the package code will likely need to be implemented so as to allow users to freely change and alter the maps they create like how it is done on Atlas.co.</span> </li>
</ul>



<h1>Share your Maps!</h1>



<p>One of the wonderful things about putting this package in the open is enabling other R users to create their own beautiful maps of their journeys. With the MapBox API, number of possible templates and designs are endless. I have only made a few (which can be viewed on <a href="https://github.com/benyamindsmith/mapBliss" rel="nofollow" target="_blank">Github</a>). If you do use this package and make a map. Please post in the comments of this blog the link to the visual you made!</p>



<h1>Conclusion</h1>



<p><code>mapBliss</code> in its present form is pretty much ready for submission to CRAN. I haven’t done it yet because its presently not a priority. For now, I am really happy with the progress I have made with this package and am happy with the form it is in now.</p>



<p>If you have any other ideas of what you would possibly want, feel free to open a <a href="https://github.com/benyamindsmith/mapBliss/issues" rel="nofollow" target="_blank">Github issue</a> on the repository and let me know!</p>



<p>Let me know what you think of the <code>mapBliss</code> package! Thank you for reading!</p>



<a href="https://www.paypal.com/donate?hosted_button_id=VXHW35EX7HXPC" rel="nofollow" target="_blank">
<img src="https://viatesting.files.wordpress.com/2020/03/paypal-donate-button.png?fit=578%2C150" height="150"  data-recalc-dims="1"></a>



<div class="is-layout-flow wp-block-group alignfull has-text-color has-background" style="background-color:#0f1c18;color:#e2e2e2;"><div class="wp-block-group__inner-container">
<div class="wp-block-jetpack-layout-grid alignfull margin-bottom-none column1-desktop-grid__span-8 column1-desktop-grid__start-2 column1-desktop-grid__row-1 column1-tablet-grid__span-8 column1-tablet-grid__row-1 column1-mobile-grid__span-4 column1-mobile-grid__row-1 wp-block-jetpack-layout-gutter__nowrap wp-block-jetpack-layout-gutter__huge">
<div class="wp-block-jetpack-layout-grid-column wp-block-jetpack-layout-grid__padding-none">
<h2 class="margin-bottom-half has-text-color" style="color:#ffffff;font-size:50px;">Want to see more of my content? </h2>



<p class="margin-top-half margin-bottom-none" style="font-size:18px;">Be sure to subscribe and never miss an update!</p>
</div>
</div>



<div class="is-layout-flex wp-container-5 wp-block-columns">
<div class="is-layout-flow wp-block-column" style="flex-basis:100%;">
<div class="is-layout-flex wp-container-3 wp-block-columns">
<div class="is-layout-flow wp-block-column">
<div class="wp-block-jetpack-subscriptions wp-block-jetpack-subscriptions__supports-newline"><div class="jetpack_subscription_widget">
			<div class="wp-block-jetpack-subscriptions__container">
			<form action="https://r-bloggers.com/phplist/?p=subscribe&#038;id=1" method="post" target="popupwindow">
								<p id="subscribe-email">
					<label
						id="subscribe-field-label"
						for="subscribe-field"
						class="screen-reader-text"
					>
						Email Address:					</label>

					<input
							type="email"
							name="email"
							class="has-ffffff-border-color"
							style="font-size: 16px; padding: 15px 23px 15px 23px; border-radius: 0px; border-width: 1px; border-color: #FFFFFF; border-style: solid;"
							placeholder="Email Address"
							value=""
							id="subscribe-field"
						/>				</p>

				<p id="subscribe-submit"
									>
					<input type="hidden" name="action" value="subscribe"/>
					<input type="hidden" name="blog_id" value="178464293"/>
					<input type="hidden" name="source" value="https://bensstats.wordpress.com/tag/r/feed/"/>
					<input type="hidden" name="sub-type" value="widget"/>
					<input type="hidden" name="redirect_fragment" value="subscribe-blog"/>
					<input type="hidden" id="_wpnonce" name="_wpnonce" value="a94c894908" />					<button type="submit"
													class="wp-block-button__link has-ffffff-border-color"
																			style="background: #0babf0; font-size: 16px; padding: 15px 23px 15px 23px; margin: 0px; margin-left: 10px; border-radius: 0px; border-width: 1px; border-color: #FFFFFF; border-style: solid;"
											>
						Subscribe					</button>
				</p>
			</form>
						</div>
			
</div></div>



<div class="is-layout-flex wp-block-buttons">
<div class="wp-block-button is-style-fill"><a class="wp-block-button__link has-background-color has-secondary-background-color has-text-color has-background" href="https://www.youtube.com/channel/UCDOEA0M2D0FuTMFzJIGZEFg" rel="nofollow" target="_blank">YouTube</a></div>



<div class="wp-block-button is-style-fill"><a class="wp-block-button__link has-background" href="https://www.facebook.com/bensstats" style="background-color:#0e97d1;" rel="nofollow" target="_blank">Facebook</a></div>



<div class="wp-block-button is-style-fill"><a class="wp-block-button__link has-secondary-color has-background-background-color has-text-color has-background" href="https://www.patreon.com/bensstats" rel="nofollow" target="_blank">Patreon</a></div>
</div>
</div>
</div>
</div>
</div>
</div></div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://bensstats.wordpress.com/2022/10/28/robservations-40-packaging-my-route-map-code-introducting-mapbliss/"> r – bensstats</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/robservations-40-packaging-my-route-map-code-introducting-mapbliss/">RObservations #40 : Packaging My Route Map Code! Introducting mapBliss.</a>]]></content:encoded>
					
		
		<enclosure url="https://bensstats.files.wordpress.com/2022/10/robservations-40.png" length="0" type="" />
<enclosure url="https://2.gravatar.com/avatar/e9b9552dc7a34b7db0f1c809bf6c5164?s=96&#038;d=identicon&#038;r=G" length="0" type="" />
<enclosure url="https://bensstats.files.wordpress.com/2022/10/robservations-40.png?w=1024" length="0" type="" />
<enclosure url="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002440178.png?w=1001" length="0" type="" />
<enclosure url="https://bensstats.files.wordpress.com/2022/10/image_2022-10-28_002522508.png?w=1024" length="0" type="" />
<enclosure url="https://bensstats.files.wordpress.com/2022/10/image.png?w=1003" length="0" type="" />
<enclosure url="https://bensstats.files.wordpress.com/2022/10/image-1.png?w=424" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">333970</post-id>	</item>
		<item>
		<title>Register for the Government &#038; Public Sector R Conference</title>
		<link>https://www.r-bloggers.com/2022/10/register-for-the-government-public-sector-r-conference/</link>
		
		<dc:creator><![CDATA[RStudio &#124; Open source &#38; professional software for data science teams on RStudio]]></dc:creator>
		<pubDate>Fri, 28 Oct 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.rstudio.com/blog/r-in-gov-2022/</guid>

					<description><![CDATA[<p>RStudio is proud to be sponsoring Lander Analytics’s annual gathering, the Government &#038; Public Sector R Conference. For the fifth time, Lander Analytics is bringing world-class data scientists together to share cutting-edge research and presentatio...</p>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/register-for-the-government-public-sector-r-conference/">Register for the Government & Public Sector R Conference</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.rstudio.com/blog/r-in-gov-2022/"> RStudio | Open source &amp; professional software for data science teams on RStudio</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
<p>RStudio is proud to be sponsoring <a href="http://landeranalytics.com/" target="_blank" rel="nofollow">Lander Analytics</a>’s annual gathering, the <a href="http://rstats.ai/gov" target="_blank" rel="nofollow">Government &#038; Public Sector R Conference</a>. For the fifth time, Lander Analytics is bringing world-class data scientists together to share cutting-edge research and presentations in Washington, D.C., and virtually around the world.</p>
<h2 id="what-should-i-expect">What should I expect?</h2>
<p>Three insightful days focusing on the work done in government, non-governmental organizations, defense, and the public sector. Content will range from exciting case studies on making proprietary data accessible, to innovative applications of tools like <a href="https://vetiver.rstudio.com/" target="_blank" rel="nofollow">vetiver</a>
, to best practices for wrangling unwieldy data.</p>
<p>Join the conference at <a href="https://www.georgetown.edu/?utm_source=rstatsai" target="_blank" rel="nofollow">Georgetown University</a> or online.</p>
<ul>
<li><a href="https://rstats.ai/gov/#workshops" target="_blank" rel="nofollow">Workshops</a> will be held on November 30th.</li>
<li>Talks will be held on December 1st-2nd. Browse the <a href="https://rstats.ai/gov/#agenda" target="_blank" rel="nofollow">agenda</a> and list of <a href="https://rstats.ai/gov/#speakers" target="_blank" rel="nofollow">speakers</a>on the website.</li>
</ul>
<h2 id="how-can-i-sign-up">How can I sign up?</h2>
<p>In-person and virtual tickets are available. <a href="https://rstats.ai/tickets" target="_blank" rel="nofollow">Click here to purchase tickets</a>, and use the promo code <strong>RSRGOV</strong> to receive 25% off!</p>
<h2 id="where-can-i-learn-more">Where can I learn more?</h2>
<p>Visit <a href="https://rstats.ai/gov/" target="_blank" rel="nofollow"><a href="https://rstats.ai/gov/" rel="nofollow" target="_blank">https://rstats.ai/gov/</a></a> to learn more about the conference, and follow <a href="https://twitter.com/rstatsai" target="_blank" rel="nofollow">@rstatsai on Twitter.</a> Add to the discussion by using the hashtags #rstatsgov and #rstats.</p>
<p>We can’t wait to see you there!</p>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.rstudio.com/blog/r-in-gov-2022/"> RStudio | Open source &amp; professional software for data science teams on RStudio</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/register-for-the-government-public-sector-r-conference/">Register for the Government & Public Sector R Conference</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">333987</post-id>	</item>
		<item>
		<title>Top 5 Shiny UI Add-On Packages</title>
		<link>https://www.r-bloggers.com/2022/10/top-5-shiny-ui-add-on-packages/</link>
		
		<dc:creator><![CDATA[The Jumping Rivers Blog]]></dc:creator>
		<pubDate>Thu, 27 Oct 2022 23:59:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.jumpingrivers.com/blog/r-shiny-extensions-ui/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>	     	There are a growing number of Shiny users across the world, and with<br />
many users comes an increasing number of open-source “add-on” packages<br />
that extend the functionality of Shiny, both in terms of...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/top-5-shiny-ui-add-on-packages/">Top 5 Shiny UI Add-On Packages</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.jumpingrivers.com/blog/r-shiny-extensions-ui/"> The Jumping Rivers Blog</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>

	       <p>
	       <a href = "https://www.jumpingrivers.com/blog/r-shiny-extensions-ui/">
	          <img src="https://i0.wp.com/www.jumpingrivers.com/blog/r-shiny-extensions-ui/featured.png?w=400&#038;ssl=1" style="width:400px" class="image-center" style="display: block; margin: auto;" data-recalc-dims="1" />
	       </a>
	       </p>
	     	<p>There are a growing number of Shiny users across the world, and with
many users comes an increasing number of open-source “add-on” packages
that extend the functionality of Shiny, both in terms of the front end
and the back end of an app.</p>
<p>This blog will highlight 5 UI add-on packages that can massively improve
your user experience and also just add a bit of flair to your app. Each
package will have an associated example app (some more inspired than
others) that I’ve created where you can actually see the UI component in
action. All code for example apps can be found <a href="https://github.com/jumpingrivers/blog/tree/main/blogs/" rel="nofollow" target="_blank">on our
GitHub</a>.</p>



<hr />
<p>
  Do you require help building a Shiny app? Would you like someone to take over the maintenance burden?
	If so, check out
	our 
	<a href="https://www.jumpingrivers.com/consultancy/shiny-dash-flask-dashboard-consultancy/?utm_source=blog&#038;utm_medium=banner&#038;utm_campaign=2022-r-shiny-extensions-ui" rel="nofollow" target="_blank">Shiny and Dash</a> 
	services.
	</p>
<hr />


<h2 id="shinycssloadershttpsgithubcomdaattalishinycssloaders"><a href="https://github.com/daattali/shinycssloaders" rel="nofollow" target="_blank">{shinycssloaders}</a></h2>
<p>If you have graphs or other outputs in your app that are slow to render
and re-render, it can be frustrating for the user if it looks like
nothing is changing after they’ve changed an input or pressed a button
to re-render. Adding a spinner to indicate the plot is re-rendering
makes it clear to the user what is going on and can make that waiting
time a bit more bearable!</p>
<p>While the {shinycssloaders} package does not speed up your plot
rendering (although if you <em>do</em> need help with speeding up a Shiny app,
<a href="https://www.jumpingrivers.com/consultancy/shiny-dash-flask-dashboard-consultancy/" rel="nofollow" target="_blank">we can
help</a>),
it does let you very easily add loading spinners to any specific output
in your Shiny app.</p>
<p>All you need to do is wrap your Shiny output in the <code>withSpinner()</code>
function! You can also modify the spinner with the <code>type</code>, <code>color</code>, and
<code>size</code> arguments.</p>
<pre># in the UI
withSpinner(plotOutput(&quot;my_plot&quot;))
</pre><p>In my example app:</p>
<p><img src="https://i2.wp.com/www.jumpingrivers.com/blog/r-shiny-extensions-ui/gifs/shinycssloaders.gif?w=578&#038;ssl=1" alt="A gif of a plot being re-generated with a shinycssloader showingduring rendering." data-recalc-dims="1"></p>
<h2 id="waiterhttpsgithubcomjohncoenewaiter"><a href="https://github.com/JohnCoene/waiter" rel="nofollow" target="_blank">{waiter}</a></h2>
<p>{shinycssloaders} is very useful if you have one or more slow outputs
that need to be rendered or re-rendered, but what if just loading up
your app at start up is slow? For example, if you’re pulling new data
from an API or a database every time you load the app. This is where the
{waiter} package comes in handy!</p>
<p>{waiter} allows you to create a loading screen that covers the entire
app until some specific bit of code has finished running. You just need
to tell it when to show (<code>waiter_show()</code>) and when to hide
(<code>waiter_hide()</code>) the waiter loading screen. Note that you’ll need to
activate the waiter functionality by including the <code>useWaiter()</code> command
in your UI.</p>
<p>The basic syntax is:</p>
<pre># in the UI
useWaiter()

# in the server
waiter_show()

  # code that takes a while to run

waiter_hide()
</pre><p>In my example app:</p>
<p><img src="https://i0.wp.com/www.jumpingrivers.com/blog/r-shiny-extensions-ui/gifs/waiter.gif?w=578&#038;ssl=1" alt="A gif of a an app being refreshed with a loading screen created by thewaiter package." data-recalc-dims="1"></p>
<h2 id="rclipboardhttpsgithubcomsbihorelrclipboard--tippyhttpsgithubcomjohncoenetippy"><a href="https://github.com/sbihorel/rclipboard" rel="nofollow" target="_blank">{rclipboard}</a> &#038; <a href="https://github.com/JohnCoene/tippy" rel="nofollow" target="_blank">{tippy}</a></h2>
<p>If your app needs to generate any kind of text that would then need to
be used elsewhere, e.g. a URL or a uniquely identifying string, then a
“Copy to clipboard” button can easily be added with the {rclipboard}
package. The main function from {rclipboard} is <code>rclipButton()</code> which
creates a clickable button that lets you copy whatever is passed to the
<code>clipText</code> argument. There are no associated <code>render*()</code> or <code>*Output()</code>
functions, so you can create your clipboard button and then render it
with <code>renderUI()</code> and display it with <code>uiOutput()</code>. You will also need
to activate the copy to clipboard functionality by including the
<code>rclipboardSetup()</code> command in your UI.</p>
<p>A basic button could be created like this:</p>
<pre># in the UI
rclipboardSetup(),
uiOutput(&quot;clip_button&quot;)

# in the server
renderUI({
  rclipButton(
    &quot;clip_button&quot;,
    &quot;Copy to clipboard&quot;,
    clipText = &quot;Text to be copied&quot;,
    icon = icon(&quot;clipboard&quot;)
  )
})
</pre><p>However, when you press this button there is no feedback to the user
that anything has actually been copied. This is where the {tippy}
package comes in. {tippy} allows you to add tooltips to UI elements in
your app that appear at a certain trigger such as hover or click.
Tooltips are an effective way to provide help or feedback to the user
and improve their experience using the app.</p>
<p>All you need to do is call the <code>tippy_this()</code> function on the input ID
of your UI component. If we have a clipboard button with ID
<code>clip_button</code> as above, we could add a tooltip that says “String
copied!” whenever the button is clicked.</p>
<pre># in the UI
tippy_this(
  &quot;clip_button&quot;,
  tooltip = &quot;String copied!&quot;,
  trigger = &quot;click&quot;
)
</pre><p>In my example app:</p>
<p><img src="https://i0.wp.com/www.jumpingrivers.com/blog/r-shiny-extensions-ui/gifs/rclipboard_tippy.gif?w=578&#038;ssl=1" alt="A gif of a random string being copied to clipboard with tooltip pop-upand then being pasted." data-recalc-dims="1"></p>
<h2 id="shinyglidehttpsgithubcomjubashinyglide"><a href="https://github.com/juba/shinyglide" rel="nofollow" target="_blank">{shinyglide}</a></h2>
<p>{shinyglide} lets you create a carousel-like window that allows the user
to move between different screens in a chronological order using “Next”
and “Back” buttons. It’s a nice way to add a pop-up to guide your user
through some action, either for collecting inputs for your app, or
demoing how to use the app, or just as an embedded presentation.</p>
<p>There is a lot of flexibility when using {shinyglide}, but a basic
series of screens could be constructed like this:</p>
<pre># in the UI
glide(
  screen(
    # content on the first screen
  ),
  screen(
    # content on second screen
  )
)
</pre><p>A nice feature is that you can easily add a condition that needs to be
met until the user can move on to the next page, e.g., the user needs to
provide some input. This is done with the <code>next_condition</code> argument in
the <code>screen()</code> function.</p>
<p>In my example app:</p>
<p><img src="https://i2.wp.com/www.jumpingrivers.com/blog/r-shiny-extensions-ui/gifs/shinyglide.gif?w=578&#038;ssl=1" alt="A gif of three shinyglide screens being moved between using Next andBack buttons." data-recalc-dims="1"></p>
<h2 id="sortablehttpsgithubcomrstudiosortable"><a href="https://github.com/rstudio/sortable" rel="nofollow" target="_blank">{sortable}</a></h2>
<p>Last but not least is {sortable}, which is a package that enables
drag-and-drop behaviour in your Shiny apps. This means that the user can
perform actions such as rearranging plots in a grid, or include/exclude
elements by dragging them in and out of a specific panel.</p>
<p>The basic syntax of {sortable} is:</p>
<pre>sortable_js(&quot;element_id&quot;)
</pre><p>where <code>&quot;element_id&quot;</code> is the ID of the div containing the elements you
wish to be drag-and-drop-able.</p>
<p>In my example app:</p>
<p><img src="https://i0.wp.com/www.jumpingrivers.com/blog/r-shiny-extensions-ui/gifs/sortable.gif?w=578&#038;ssl=1" alt="A gif of four plots in a grid where two are swapped by using drag anddrop with the cursor." data-recalc-dims="1"></p>
<h2 id="further-resources">Further resources</h2>
<p>If you want to explore even more packages that extend the Shiny
framework, I would highly recommend checking out this curated list of
Shiny extension packages:</p>
<ul>
<li><a href="https://github.com/nanxstats/awesome-shiny-extensions" rel="nofollow" target="_blank">Awesome Shiny
Extensions</a></li>
</ul>
 
	      <p>
	      For updates and revisions to this article, see the <a href = "https://www.jumpingrivers.com/blog/r-shiny-extensions-ui/">original post</a>
	      </p>		
      
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.jumpingrivers.com/blog/r-shiny-extensions-ui/"> The Jumping Rivers Blog</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/top-5-shiny-ui-add-on-packages/">Top 5 Shiny UI Add-On Packages</a>]]></content:encoded>
					
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">333921</post-id>	</item>
		<item>
		<title>Who’s best in class? Comparing forecasting models with a Predictive Analytics Cube (PAC)</title>
		<link>https://www.r-bloggers.com/2022/10/whos-best-in-class-comparing-forecasting-models-with-a-predictive-analytics-cube-pac/</link>
		
		<dc:creator><![CDATA[INWT-Blog-RBloggers]]></dc:creator>
		<pubDate>Thu, 27 Oct 2022 16:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://www.inwt-statistics.com/read-blog/predictive-analytics-cube-mvp-en.html</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">                     The problem of (comparable) forecasting Over the last years, time series forecasting has become a subfield of Data Science where well established statistical and econometric methods mingle with modern ML techniques. However, solid s...</div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/whos-best-in-class-comparing-forecasting-models-with-a-predictive-analytics-cube-pac/">Who’s best in class? Comparing forecasting models with a Predictive Analytics Cube (PAC)</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://www.inwt-statistics.com/read-blog/predictive-analytics-cube-mvp-en.html"> INWT-Blog-RBloggers</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>
 <div class="ce_text  block">                   <h2>The problem of (comparable) forecasting</h2> <p>Over the last years, time series forecasting has become a subfield of Data Science where well established statistical and econometric methods mingle with modern ML techniques. However, solid standards with regard to data partitioning or comparable model evaluation have not been established yet.</p> <p>Forecasting is central to our work at INWT. We use it for a wide range of applications including predicting sales, staff planning and air quality monitoring. When announcements of shiny, new forecasting methods pop up in our timelines, we are faced with the challenge to separate the wheat from the chaff &#8211; <a href="https://medium.com/geekculture/is-facebooks-prophet-the-time-series-messiah-or-just-a-very-naughty-boy-8b71b136bc8c" rel="nofollow" target="_blank">does this new method really deliver on its promises</a>? Or rather, does it deliver when applied practically in a controlled environment and on data chosen by us? What exactly are the strengths and weaknesses of this particular forecasting method? To answer these questions, we decided to build our own <strong>Predictive Analytics Cube (PAC)</strong>.</p> <p>The purpose of our PAC is to <strong>build an infrastructure of data, methods, predictions and reports that allows fast comparison of methods regarding their predictive power based on standardized evaluation</strong>. We want our PAC to help us make quick and better informed model class selection decisions when faced with a specific forecasting problem. Which method looks most promising for instance, for a low frequency time series with strong seasonality and trend? And when a new method enters the forecasting arena: how well does it perform on a well known dataset, and how does it compare to other methods? We want our PAC to give us a legitimate and sophisticated answer to the question “Which method is best in class?”. And if the answer turns out to be ambiguous, that’s fine.</p> <p>We decided to build our own PAC, to have a tailored solution to our goals at INWT and to be able to deliver high quality, state-of-the-art solutions to our customers. We want to be able to extend it easily with new methods and data. Hence we chose not to fork similar projects, like the impressive <a href="https://forecastingdata.org/" rel="nofollow" target="_blank">Monash Time Series Forecasting Repository</a> or the innovative <a href="https://tylerjpike.github.io/OOS/index.html" rel="nofollow" target="_blank">Out-of-sample time series forecasting</a> package, but take these projects as inspiration and guidance.</p>         </div> <div class="ce_text  block">                   <h2>Building our own PAC</h2> <p>In our first, minimal version of the PAC we include four models and three univariate time series. As of now, we limit the PAC to univariate forecasting and future values are exclusively predicted using the past values of a time series. Let’s take a look under the hood of the cube to see how we wove the data, methods and reports together.</p> <h3>Architecture</h3> <p>Two R packages that we developed build the backbone of our PAC. <strong>PacModel</strong> queries the training data from a MariaDB database and hands it over to the models. Models run on the training data and send their insample predictions as well as their out of sample predictions back to the database. <strong>PacReport</strong> then queries these forecasts and produces an extensive html report via rmarkdown.</p> <p> </p> <p><img loading="lazy" style="display: block; margin-left: auto; margin-right: auto;" src="https://i2.wp.com/www.inwt-statistics.com/files/INWT/images_blog/PAC/PAC_architecture_en.png?resize=450%2C304&#038;ssl=1" alt="" width="450" height="304"  data-recalc-dims="1"></p> <p style="text-align: center;"><sup><em>Current PAC architecture</em></sup></p>         </div> <div class="ce_text  block">                   <h2>Datasets</h2> <table style="border-collapse: collapse; width: 100%; height: 64px;"> <tbody> <tr style="height: 16px;"> <td style="width: 23.5727%; height: 16px;"><strong>Time Series</strong></td> <td style="width: 38.0241%; height: 16px;"><strong>Info</strong></td> <td style="width: 14.6521%; height: 16px;"><strong>Observations (Frequency)</strong></td> <td style="width: 23.7511%; height: 16px;"><strong>Source</strong></td> </tr> <tr style="height: 16px;"> <td style="width: 23.5727%; height: 16px;">Real gross domestic product (GDP) of Germany in price-adjusted million euros (base year 2010)</td> <td style="width: 38.0241%; height: 16px;">Not seasonally adjusted. <img src="https://i0.wp.com/www.inwt-statistics.com/files/INWT/images_blog/PAC/PAC_BIP.png?w=300&#038;ssl=1" alt=""  data-recalc-dims="1"></td> <td style="width: 14.6521%; height: 16px;">121 (quarterly)</td> <td style="width: 23.7511%; height: 16px;">Eurostat, <a style="font-size: 16px;" href="https://fred.stlouisfed.org/series/CLVMNACNSAB1GQDE" rel="nofollow" target="_blank"> Real Gross Domestic Product for Germany</a> [CLVMNACNSAB1GQDE], retrieved from FRED, Federal Reserve Bank of St. Louis.</td> </tr> <tr style="height: 16px;"> <td style="width: 23.5727%; height: 16px;">Electricity Demand in New South Wales (NSW) Australia</td> <td style="width: 38.0241%; height: 16px;">Data was aggregated on a daily level. <img src="https://i2.wp.com/www.inwt-statistics.com/files/INWT/images_blog/PAC/PAC_electricity.png?w=300&#038;ssl=1" alt=""  data-recalc-dims="1"></td> <td style="width: 14.6521%; height: 16px;">4807 (daily)</td> <td style="width: 23.7511%; height: 16px;">Godahewa, Rakshitha, Bergmeir, Christoph, Webb, Geoff, Hyndman, Rob, &#038; Montero-Manso, Pablo. (2021). <a style="font-size: 16px;" href="https://doi.org/10.5281/zenodo.4659727" rel="nofollow" target="_blank">Australian Electricity Demand Dataset</a> (Version 1) [Data set]. Zenodo.</td> </tr> <tr style="height: 16px;"> <td style="width: 23.5727%; height: 16px;">Solar power production in Megawatts (MW) in Australia</td> <td style="width: 38.0241%; height: 16px;">Data was aggregated on a daily level to remove the zero-value periods at night. <img src="https://i0.wp.com/www.inwt-statistics.com/files/INWT/images_blog/PAC/PAC_solar.png?w=300&#038;ssl=1" alt=""  data-recalc-dims="1"></td> <td style="width: 14.6521%; height: 16px;">343 (daily)</td> <td style="width: 23.7511%; height: 16px;">Godahewa, Rakshitha, Bergmeir, Christoph, Webb, Geoff, Abolghasemi, Mahdi, Hyndman, Rob, &#038; Montero-Manso, Pablo. (2020). <a style="font-size: 16px;" href="https://doi.org/10.5281/zenodo.4656027" rel="nofollow" target="_blank">Solar Power Dataset</a> (4 Seconds Observations) (Version 2) [Data set]. Zenodo.</td> </tr> </tbody> </table>         </div> <div class="ce_text  block">                   <h3>Models</h3> <table style="border-collapse: collapse; width: 100%; height: 80px;"> <tbody> <tr style="height: 16px;"> <td style="width: 33.3333%; height: 16px;"><strong>Model</strong></td> <td style="width: 33.3333%; height: 16px;"><strong>R Package::Function</strong></td> <td style="width: 33.3333%; height: 16px;"><strong>Info</strong></td> </tr> <tr style="height: 16px;"> <td style="width: 33.3333%; height: 16px;">ARIMA</td> <td style="width: 33.3333%; height: 16px;">forecast::auto.arima()</td> <td style="width: 33.3333%; height: 16px;">The function uses a variation of the Hyndman-Khandakar algorithm, which combines unit root tests, minimisation of the AIC and MLE to obtain an (seasonal) ARIMA model.</td> </tr> <tr style="height: 16px;"> <td style="width: 33.3333%; height: 16px;">ARIMA W/ XGBOOST ERRORS</td> <td style="width: 33.3333%; height: 16px;">forecast::auto.arima() and xgboost::xgb.train()</td> <td style="width: 33.3333%; height: 16px;">Like the previous ARIMA model, but additionally uses boosting to improve residuals on exogenous regressors.</td> </tr> <tr style="height: 16px;"> <td style="width: 33.3333%; height: 16px;">ETS</td> <td style="width: 33.3333%; height: 16px;">forecast::ets()</td> <td style="width: 33.3333%; height: 16px;">An exponential smoothing state space model that is similar to ARIMA models in that a prediction is a weighted sum of past observations, but the model explicitly uses an exponentially decreasing weight for past observations. Potential trend or seasonality are estimated automatically, as well as the error, trend and season type.</td> </tr> <tr style="height: 16px;"> <td style="width: 33.3333%; height: 16px;">PROPHET</td> <td style="width: 33.3333%; height: 16px;">prophet::prophet()</td> <td style="width: 33.3333%; height: 16px;">Developed by Facebook, Prophet is based on an additive model where non-linear trends are fit with yearly, weekly, and daily seasonality, plus holiday effects. Potential changepoints are selected automatically.</td> </tr> </tbody> </table>         </div> <div class="ce_text  block">                   <h2>Evaluation</h2> <p>We evaluate our models primarily on the basis of their out of sample (oos) performance. To divide the data into training and test data, we chose a rolling origin setup, in which the “size of the forecast horizon is fixed, but the forecast origin changes over the time series [&#8230;], thus effectively creating multiple test periods for evaluation.” (<a href="https://arxiv.org/pdf/2203.10716.pdf" rel="nofollow" target="_blank">Hewamalage et al. 2022</a>) Furthermore, we decided to increase the training data window by one more datapoint with every model run. This approach is also called time series cross-validation (tsCV) (<a href="https://otexts.com/fpp3/tscv.html" rel="nofollow" target="_blank">Hyndman, R.J., Athanasopoulos, G., 2021</a>) &#8211; a temporal order preserving version of cross-validation. For now, we limit ourselves to 1-step-ahead predictions, but plan to implement flexible forecast horizons in the future.</p> <p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://i1.wp.com/www.inwt-statistics.com/files/INWT/images_blog/PAC/PAC_eval.png?w=578&#038;ssl=1" alt="" data-recalc-dims="1"></p> <p style="text-align: center;"><sup><em>An expanding window, rolling origin oos setup. Blue dots represent training data points, red dots represent test data. Picture taken from <a href="https://arxiv.org/pdf/2203.10716.pdf" rel="nofollow" target="_blank">Hewamalage et al. 2022</a>.</em></sup></p> <p>In order to detect potential problems with overfitting, we additionally measure <strong>in sample performance</strong> for each model and dataset. To this end, we snapshot the smallest training data window and the biggest training data window for each dataset and evaluate the predictions for these data points. This expanding window, rolling origin oos structure combined with our overfit monitoring provides us with a <strong>realistic setup that fits our usual business cases</strong>: Available input data increases over time while frequent model recalibration for optimal forecasting performance is both desirable and viable.</p> <p>To achieve our goal of easy compatibility between methods, we decided to use one method across all datasets as a <strong>baseline</strong>: an <strong>exponential smoothing state space model (ETS)</strong>. This model delivers pretty good “rule of thumb” forecasts &#8211; without any tuning effort at all as the methodology is fully automatic. Our ETS model considers a potential trend or seasonality and conveniently chooses error, trend and season type automatically (either additive or multiplicative). We chose it as our baseline because of its relative simplicity and good “out of the box” performance.</p> <p>For high level judgments about the predictive power of our different PAC forecasting models, we primarily use <strong>relative measures</strong>, i.e. ratios of some error measure for the forecasting model divided by that of our ETS benchmark model. Eligible relative measures are for example the Relative Mean Absolute Error (RelMae) or the Relative Root Mean Squared Error (RelRMSE). These relative measures are awesome for being easily interpretable (ratios < 1 stand for a model performance better than baseline on that error measure, > 1 for worse performance) while being conveniently scaled by the benchmark errors on a series level. In other words: For a given dataset, relative measures provide performance statistics comparable across all sorts of models. We are aware of the problems relative measures may cause when presented with a series containing trend or unit root (<a href="https://arxiv.org/pdf/2203.10716.pdf" rel="nofollow" target="_blank">Hewamalage et al. 2022</a>, pp.44). Luckily, these problems mainly become relevant for longer forecast horizons, which we don’t use at the moment. We decided therefore to postpone tackling them until we actually extend our PAC beyond one step ahead predictions. Also, when examining and testing a specific model of our PAC in-depth, we understand that using multiple evaluation measures is needed and looking at relative measures alone won’t do the job.</p> <p><img style="display: block; margin-left: auto; margin-right: auto;" src="https://i1.wp.com/www.inwt-statistics.com/files/INWT/images_blog/PAC/PAC_rel_mae.png?w=450&#038;ssl=1" alt=""  data-recalc-dims="1"></p> <p style="text-align: center;"><sup><em>Model performance on predicting time series Real GDP Germany, measured by Relative MAE</em></sup></p>         </div> <div class="ce_text  block">                   <h2>Lessons learned and tasks ahead</h2> <p>Our PAC is still in its early stages &#8211; it may be considered a minimal viable product. Yet it already provides an <strong>easily extendable framework to compare forecasting model performance</strong> across different datasets. Even to reach this stage entailed quite a few challenges. One challenge we certainly underestimated is the <strong>tradeoff between automation and fine tuning</strong>. On the one hand, we want to see how a model works “out of the box” with as little configuration as possible when confronted with different data scenarios. On the other hand, we might not treat a model fairly when knowingly running it with too little configuration. In fact, putting a model in production with very little configuration and fine tuning is not a realistic business scenario for us. Models get fine tuned before they are deployed &#8211; but we want our PAC to provide a realistic hint beforehand to what a model’s forecasting capability is.</p> <p>Another point of discussion when designing our PAC was to find a <strong>sensible baseline model</strong> that would work across several different time series. This choice is not trivial if you want the baseline to be somewhat naive and flexible to handle seasonality, trend and unit roots at the same time. Within our four initial PAC models, ETS seemed to be the most naive yet sufficiently flexible to qualify as a benchmark. So after a long discussion we opted for ETS as a benchmark knowing that, as the PAC grows, we might have to revise our decision later.</p> <p>Our project board is full of ideas on how to extend and enhance our PAC from here on. These are a few possible extensions we’re currently considering:</p> <ul class="ce_list"> <li>incorporate exogenous time varying variables which may affect the target series,</li> <li>make forecast horizons flexible to allow for n-step-ahead predictions,</li> <li>integrate Python models into our otherwise R package supported architecture,</li> <li>introduce CI/CD automation (via Jenkins) to carry out a rerun of models and reports when a new model or a new dataset was added to the PAC,</li> <li>turn our standardized html report into a vue.js dashboard,</li> <li>add new models and datasets.</li> </ul> <p>In any case, this is just the beginning of our PAC. Stay tuned for in-depth analysis of new models and other insights into comparable forecasting.</p>         </div> 
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://www.inwt-statistics.com/read-blog/predictive-analytics-cube-mvp-en.html"> INWT-Blog-RBloggers</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/whos-best-in-class-comparing-forecasting-models-with-a-predictive-analytics-cube-pac/">Who’s best in class? Comparing forecasting models with a Predictive Analytics Cube (PAC)</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">333959</post-id>	</item>
		<item>
		<title>Graphical modeling of stochastic processes driven by correlated noise</title>
		<link>https://www.r-bloggers.com/2022/10/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/</link>
		
		<dc:creator><![CDATA[YoungStatS]]></dc:creator>
		<pubDate>Thu, 27 Oct 2022 00:00:00 +0000</pubDate>
				<category><![CDATA[R bloggers]]></category>
		<guid isPermaLink="false">https://youngstats.github.io/post/2022/10/27/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/</guid>

					<description><![CDATA[<div style = "width:60%; display: inline-block; float:left; ">
<p>Complex systems are difficult to understand. We need good tools to study the interactions that define such systems. In this blog post, we describe how the framework in paper Mogensen and Hansen (2022) provides such a tool. This summary of the paper...</p></div>
<div style = "width: 40%; display: inline-block; float:right;"></div>
<div style="clear: both;"></div>
<strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/">Graphical modeling of stochastic processes driven by correlated noise</a>]]></description>
										<content:encoded><![CDATA[<!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://youngstats.github.io/post/2022/10/27/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/"> YoungStatS</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div>



<p><img src="https://i1.wp.com/youngstats.github.io/post/2022-10-28-graphical-modeling-of-stochastic-processes-driven-by-correlated-noise_files/image1.png?w=578&#038;ssl=1" data-recalc-dims="1" /></p>
<p>Complex systems are difficult to understand. We need good tools to study the interactions that define such systems. In this blog post, we describe how the framework in paper <span class="citation">Mogensen and Hansen (<a href="https://youngstats.github.io/post/2022/10/27/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/#ref-mogensen2022graphical" role="doc-biblioref" rel="nofollow" target="_blank">2022</a>)</span> provides such a tool. This summary of the paper is meant to be accessible for readers with some background in statistics or other quantitative sciences. We couldn’t help but include some more specific comments intended for those readers that are familiar with graphical models in statistics. These comments are enclosed in double parentheses: ((comment)).</p>
<p>We will use the following example as an illustration of the main ideas. Assume that we observe a herd of <span class="math inline">\(n\)</span> animals moving together on a plane, that is, in a two-dimensional space (or rather on a plain!). We assume that there exists an abstract center of the herd which at each time point is at <span class="math inline">\((0,0)\)</span>. This means that all individual movement is relative to this reference point. Paper <span class="citation">Niu, Blackwell, and Skarin (<a href="https://youngstats.github.io/post/2022/10/27/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/#ref-niu2016modeling" role="doc-biblioref" rel="nofollow" target="_blank">2016</a>)</span> describes a similar, though possibly more realistic, model of animal movement. See the gif for an example of animal movement of a small herd, <span class="math inline">\(n = 3\)</span>.</p>
<p><img src="https://i0.wp.com/youngstats.github.io/post/2022-10-28-graphical-modeling-of-stochastic-processes-driven-by-correlated-noise_files/herd.gif?w=578&#038;ssl=1" data-recalc-dims="1" /></p>
<p>Our paper studies the use of graphs as means of representing dependence in how a set of processes evolve. In the example, how the animal movements interact. We essentially assume that there are two different ways that the animals and their movements interact: an asymmetrical dependence and a symmetric dependence. The asymmetric dependence may be thought of as one animal reacting to the movement of another animal, e.g., a young animal following a parent. The symmetric dependence may be thought of as two animals responding in similar ways to external stimulus, e.g., an obstacle on the ground. We can model the location of each animal as a two-dimensional stochastic process such that the joint locations of the <span class="math inline">\(n\)</span> animals are described by a <span class="math inline">\(2n\)</span>-dimensional process, e.g., using a stochastic differential equation,</p>
<p><span class="math display">\[
\mathrm{d}Z_t = MZ_t \mathrm{d}t + D \mathrm{d} W_t
\]</span></p>
<p>where <span class="math inline">\(Z_t = (Z_t^{1},Z_t^{2},\ldots, Z_t^{n})^T\)</span> and <span class="math inline">\(Z_t^i = (X_t^{i},Y_t^{i})\)</span> is the location in two-dimensional space of animal <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span> (recall that this is the location relative to the center of the herd). The matrix <span class="math inline">\(M\)</span> encodes the asymmetric dependence and the matrix <span class="math inline">\(D\)</span> encodes the symmetric dependence in the system.</p>
<p>Let’s say that <span class="math inline">\(n = 3\)</span> and that <span class="math display">\[
    M = \left(\begin{array}{ccc} M_{11} &#038; M_{12} &#038; M_{13} \\ 0 &#038; M_{22} &#038; 0 \\
    0 &#038; 0
    &#038;
    M_{33}
    \end{array}\right), \ \ \ \ \   D = \left(\begin{array}{ccc} D_{11} &#038; 0 &#038; 0
    \\ 0 &#038; D_{22} &#038; D_{23} \\0 &#038; D_{33}
    &#038;
    D_{33}
    \end{array}\right).
    \]</span></p>
<p>The submatrices of <span class="math inline">\(M\)</span>, <span class="math inline">\(M_{ij}\)</span>, and of <span class="math inline">\(D\)</span>, <span class="math inline">\(D_{ij}\)</span>, are <span class="math inline">\(2\times 2\)</span>-matrices. We define a graph in terms of the matrices M and D. It has nodes <span class="math inline">\(1, \ldots, n\)</span>, it has a directed edge <span class="math inline">\(i\rightarrow j\)</span> if <span class="math inline">\(M_{ji}\)</span> may be nonzero, and it has a blunt edge if <span class="math inline">\((DD^T)_{ij}\)</span>, <span class="math inline">\(i\neq j\)</span>, may be nonzero. The graph encodes the sparsity patterns of the matrices, and we see that the sparsity of the above matrices is encoded by the graph <strong>G1</strong>. The simulated movement data in the gif was generated from a system with the above sparsity in matrices <span class="math inline">\(M\)</span> and <span class="math inline">\(D\)</span>.</p>
<p>We say that this kind of graph is a <em>directed correlation graph</em> (cDG). The blunt edges represent symmetric dependence and the directed edges represent asymmetric dependence. ((We note that the blunt edges do not represent marginalization, but specifically correlation in the noise processes driving the model – for stochastic processes this is not the same as partial observation)). To aid our understanding of this kind of graph, we can construct an <em>unrolled version</em> (graph <strong>G2</strong>). In graph <strong>G1</strong>, each node (circle) represents an entire two-dimensional process, i.e., the movement of one animal. In graph <strong>G2</strong>, each node represents the location of an animal at a single point in time, that is, <strong>G2</strong> represents a discretized version of the movement process. The <span class="math inline">\(\varepsilon\)</span>-variables represent external stimulus creating dependence between noise processes.</p>
<p>A cDG is more useful than it may look at first glance! If we want to predict the immediate movement of Animal <span class="math inline">\(j\)</span>, say, in the herd, the cDG tells us that we only need to know the position of all animals with an arrow pointing into Animal <span class="math inline">\(j\)</span>. Moreover, the immediate movement correlates only with the immediate movements of all animals connected to Animal <span class="math inline">\(j\)</span> via a blunt edge. Suppose now that there is no arrow from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>, but that we also do not observe the entire herd. Will Animal <span class="math inline">\(i\)</span> then be predictive of the immediate movements of Animal <span class="math inline">\(j\)</span> given the position of all other observed animals? We show a key result, known as the global Markov property, to help answer this question. From the cDG one can use a purely graphical algorithm (just computations using the graph) to check conditions that are sufficient for Animal <span class="math inline">\(i\)</span> not to be predictive given the other observed animals. ((the graphical criterion is known as <span class="math inline">\(\delta\)</span>&#8211; or <span class="math inline">\(\mu\)</span>-separation and is an adaptation of <span class="math inline">\(d\)</span>-separation)). In summary, we can learn, from the graph alone, probabilistic facts about which groups of animals can be ignored when predicting immediate movement of other animals. This is quite useful.</p>
<p>Having established a useful link between the evolution of the stochastic differential equation model above and its associated graph, the paper investigates the properties of the graphs. When we have two graphs on the same node set (i.e., only the edges differ), a natural question is whether they represent the same dependence structure. In the animal movement example, we may think of each possible graph on three nodes as encoding a certain set of movement (in)dependences. If we are to learn graphs from observation of animal movement, then we need to understand which graphs encode the same set of movement (in)dependences. The paper characterizes this kind of equivalence. Finally, the paper shows that determining Markov equivalence of two directed correlation graphs is computationally hard (it is coNP-complete).</p>
<p>This work was supported by VILLUM FONDEN (research grant 13358).</p>
<div id="about-the-authors" class="section level2">
<h2>About the authors</h2>
<p><strong>Søren Wengel Mogensen</strong>, Department of Mathematical Sciences, University of Copenhagen, Copenhagen, Denmark; Section for Cognitive Systems, Technical University of Denmark, Kgs. Lyngby, Denmark; Department of Automatic Control, Lund University, Lund, Sweden</p>
<p><strong>Niels Richard Hansen</strong>, Department of Mathematical Sciences, University of Copenhagen, Copenhagen, Denmark</p>
<div id="bibliography" class="section level3 unnumbered">
<h3>Bibliography</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-mogensen2022graphical" class="csl-entry">
Mogensen, Søren Wengel, and Niels Richard Hansen. 2022. <span>“Graphical Modeling of Stochastic Processes Driven by Correlated Noise.”</span> <em>Bernoulli</em> 28 (4): 3023–50.
</div>
<div id="ref-niu2016modeling" class="csl-entry">
Niu, Mu, Paul G Blackwell, and Anna Skarin. 2016. <span>“Modeling Interdependent Animal Movement in Continuous Time.”</span> <em>Biometrics</em> 72 (2): 315–24.
</div>
</div>
</div>
</div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://youngstats.github.io/post/2022/10/27/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/"> YoungStatS</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="http://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div><strong>Continue reading</strong>: <a href="https://www.r-bloggers.com/2022/10/graphical-modeling-of-stochastic-processes-driven-by-correlated-noise/">Graphical modeling of stochastic processes driven by correlated noise</a>]]></content:encoded>
					
		
		<enclosure url="" length="0" type="" />

		<post-id xmlns="com-wordpress:feed-additions:1">333964</post-id>	</item>
	</channel>
</rss>
