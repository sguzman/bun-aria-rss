<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>The Mathematica Journal</title>
	<atom:link href="https://www.mathematica-journal.com/feed/" rel="self" type="application/rss+xml" />
	<link>https://www.mathematica-journal.com</link>
	<description>Just another wordpress.wolfram.com site</description>
	<lastBuildDate>Thu, 16 Dec 2021 22:34:58 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.7.2</generator>
	<item>
		<title>Selected Financial Applications</title>
		<link>https://www.mathematica-journal.com/2021/12/16/selected-financial-applications/</link>
		<comments>https://www.mathematica-journal.com/2021/12/16/selected-financial-applications/#respond</comments>
		<pubDate>Thu, 16 Dec 2021 20:31:45 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 23]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=62624</guid>
		<description><![CDATA[This article shows how to use some of Mathematica’s built-in financial functions and define new functions useful for the practical analysis of real-world financial data. The main topics covered are linear programming and its application in bond portfolio management, conditional value-at-risk minimization, introductory time-series analysis, simulation, bootstrapping, robust equity portfolio optimization and artificial intelligence. 1. [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<p>This article shows how to use some of Mathematica<span class="special-character CloseCurlyQuote">’</span>s built-in financial functions and define new functions useful for the practical analysis of real-world financial data. The main topics covered are linear programming and its application in bond portfolio management, conditional value-at-risk minimization, introductory time-series analysis, simulation, bootstrapping, robust equity portfolio optimization and artificial intelligence.<span id="more-62624"></span></p>
<h3>1. Introduction</h3>
<p>Our main objective is to apply the Wolfram Language to solve financial models. We do not explain financial concepts or any mathematical background related to the financial applications introduced in this article. Nor do we introduce Mathematica. Wellin [<a href="#Wellin">1</a>] gives a good introduction to programming in Mathematica. Mathematical background related to the models discussed here can be found in standard textbooks, including the ones cited.</p>
<p>First, we define three supporting functions used in the rest of this article.</p>
<h4><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_1.gif" alt="" width="118" height="14" /></h4>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_2.gif" alt="" width="101" height="14" /> function downloads historical stock returns given its four arguments:</p>
<p><span class="special-character Bullet">•</span> a list of one or more ticker symbols<br />
<span class="special-character Bullet">•</span> the start date as a date object<br />
<span class="special-character Bullet">•</span> the end date as a date object<br />
<span class="special-character Bullet">•</span> the period as the frequency of data</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_1.gif" alt="" width="580" height="158" /></p>
<h4><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_3.gif" alt="" width="84" height="14" /></h4>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_4.gif" alt="" width="72" height="13" /> function computes 11 basic descriptive statistics given a list or a matrix of returns as its input argument.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_2.gif" alt="" width="580" height="187" /></p>
<h4><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_5.gif" alt="" width="126" height="14" /></h4>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_6.gif" alt="" width="108" height="14" /> function was taken from Stack Exchange Network (<a href="https://mathematica.stackexchange.com/questions/194234/plot-of-histogram-similar-to-output-from-risk" target="_blank">https://mathematica.stackexchange.com/questions/194234/plot-of-histogram-similar-to-output-from-risk</a>) and modified. The function takes a vector of numerical data and returns a histogram with a handle on each side. You can drag these two thin vertical gray lines to vary the percentage of data within two values.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_3.gif" alt="" width="580" height="428" /></p>
<h4>Example</h4>
<p>For example, this downloads monthly historical stock returns for Boeing Company (BA), Apple Inc. (AAPL) and NVIDIA Corporation (NVDA) for the period May 1, 2000, to May 30, 2019, and computes descriptive statistics. We chose returns of the Boeing Company for the histogram. Drag the handles at the far ends of the histogram (the thin vertical lines) to see the percentage of values that lie within two values.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_4.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_5.gif" alt="" width="461" height="77" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_1.gif" alt="" width="411" height="534" /></p>
<p>The article is organized as follows:</p>
<p><span class="special-character Bullet">•</span> Section 2 introduces linear programming and applies it to bond portfolio management.</p>
<p><span class="special-character Bullet">•</span> Section 3 discusses mean-conditional value-at-risk portfolio optimization.</p>
<p><span class="special-character Bullet">•</span> Section 4 shows how to use built-in functions for introductory financial time-series analysis.</p>
<p><span class="special-character Bullet">•</span> Section 5 describes how simulation can be used in capital budgeting.</p>
<p><span class="special-character Bullet">•</span> Section 6 applies bootstrapping to risk management and financial planning.</p>
<p><span class="special-character Bullet">•</span> Section 7 describes robust equity portfolio optimization.</p>
<p><span class="special-character Bullet">•</span> Section 8 introduces functions useful for machine learning.</p>
<p><span class="special-character Bullet">•</span> Finally, the last section concludes the discussion.</p>
<h3>2. Linear Programming and Applications</h3>
<p>In this section, we illustrate a few applications of linear programming to financial problems similar to those in Cornu<span class="special-character EAcute">é</span>jols, Pe<span class="special-character NTilde">ñ</span>a and T<span class="special-character UDoubleDot">ü</span>t<span class="special-character UDoubleDot">ü</span>nc<span class="special-character UDoubleDot">ü</span> [<a href="#Cornuejols-Pena">2</a>]. A linear program is an optimization problem whose purpose is to minimize or maximize a linear objective function subject to linear constraints. We first decide the decision variables, objective function and constraints. Then we find the values of the decision variables to optimize the objective function.</p>
<p>For vectors <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_7.gif" alt="" width="34" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_8.gif" alt="" width="37" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_9.gif" alt="" width="36" height="12" /> and matrices <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_10.gif" alt="" width="50" height="14" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_11.gif" alt="" width="48" height="12" />, we can specify a general linear program in the following form:</p>
<p><img style="vertical-align: middle;" title="minimize_(x) cx (objective function); subject to A x=b (equality constraints); D x&gt;=d (inequality constraints); l&lt;=x&lt;=u (lower and upper bounds)" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Image_1.gif" alt="minimize_(x) cx (objective function); subject to A x=b (equality constraints); D x&gt;=d (inequality constraints); l&lt;=x&lt;=u (lower and upper bounds)" width="225" height="73" /></p>
<p>We can convert any <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_12.gif" alt="" width="8" height="12" /> constraint to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_13.gif" alt="" width="8" height="12" /> by adding auxiliary variables.</p>
<p>The Wolfram Language has built-in functions to solve linear optimization problems with real variables. They include:</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_14.gif" alt="" width="122" height="14" /><br />
<span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_15.gif" alt="" width="79" height="13" /><br />
<span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_16.gif" alt="" width="79" height="13" /><br />
<span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_17.gif" alt="" width="65" height="13" /><br />
<span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_18.gif" alt="" width="65" height="13" /><br />
<span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_19.gif" alt="" width="58" height="13" /><br />
<span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_20.gif" alt="" width="58" height="13" /></p>
<p>For large-scale problems, the most flexible and efficient of these is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_21.gif" alt="" width="122" height="14" />. The others are appropriate for solving linear programs written in terms of equations.</p>
<h4>Example Using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_22.gif" alt="" width="93" height="14" /></h4>
<p>We consider an example very similar to the one presented in [<a href="#Cornuejols-Pena">2</a>]. Assume that we have obligations to pay cash flows in the next eight years as shown in the following table. The first row shows years and the second row shows the amount of cash to be paid each year.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_2.gif" alt="" width="423" height="43" /></p>
<p>Also assume that we have five government bonds available to invest with the cash flows from the obligations and current prices given as follows.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_3.gif" alt="" width="410" height="181" /></p>
<p>To make a portfolio that minimizes the overall cost and still meets all the expected future cash payments, we can decide on how to allocate the funds by converting this problem into a linear program and solving it. Assume that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_23.gif" alt="" width="10" height="12" /> is the number of bonds <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_24.gif" alt="" width="3" height="12" /> to purchase.</p>
<p>We define four variables for convenience.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_6.gif" alt="" width="172" height="149" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_7.gif" alt="" width="288" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_8.gif" alt="" width="161" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_4.gif" alt="" width="123" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_9.gif" alt="" width="208" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_5.gif" alt="" width="281" height="13" /></p>
<p>Then the problem can be stated as follows.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_6.gif" alt="" width="340" height="177" /></p>
<p>This solves the problem.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_10.gif" alt="" width="317" height="107" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_7.gif" alt="" width="461" height="14" /></p>
<h4>Same Example Using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_25.gif" alt="" width="143" height="14" /></h4>
<p>The problem can also be solved using the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_26.gif" alt="" width="122" height="14" /> function. One of its most useful forms is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_27.gif" alt="" width="233" height="14" />, where:</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_28.gif" alt="" width="7" height="13" /> is the vector of coefficients of the objective function.</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_29.gif" alt="" width="7" height="13" /> is the matrix of coefficients in the constraints.</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_30.gif" alt="" width="7" height="13" /> is a two-column matrix representing the constants on the right side of the constraints and the direction of inequality.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_8.gif" alt="" width="43" height="57" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_31.gif" alt="" width="43" height="13" /> is a two-column matrix of lower and upper bounds for the decision variables.</p>
<p>The variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_32.gif" alt="" width="7" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_33.gif" alt="" width="7" height="13" /> were defined before; here they are displayed in matrix form.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_11.gif" alt="" width="101" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_9.gif" alt="" width="63" height="78" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_12.gif" alt="" width="101" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_10.gif" alt="" width="190" height="126" /></p>
<p>We define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_34.gif" alt="" width="7" height="13" /> from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_35.gif" alt="" width="7" height="14" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_36.gif" alt="" width="43" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_13.gif" alt="" width="207" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_11.gif" alt="" width="64" height="126" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_14.gif" alt="" width="338" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_12.gif" alt="" width="43" height="78" /></p>
<p>This solves the problem.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_15.gif" alt="" width="325" height="76" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_13.gif" alt="" width="311" height="13" /></p>
<p>Mathematica<span class="special-character CloseCurlyQuote">’</span>s built-in capabilities to solve linear programming problems can be used in a wide variety of financial problems. We refer interested readers to [<a href="#Cornuejols-Pena">2</a>].</p>
<h3>3. Mean-CVaR Optimization</h3>
<p>In this section, we solve the mean-CVaR portfolio problem, which was proposed by Rockafellar and Uryasev [<a href="#Rockafellar-Uryasev">3</a>]. CVaR optimization does not depend on any assumption of how returns are distributed, but it works for the normal distribution. We summarize the linear programming formulation of the CVaR problem.</p>
<p>Following [<a href="#Rockafellar-Uryasev">3</a>], <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_37.gif" alt="" width="20" height="12" /> is the joint density function of the underlying asset returns <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_38.gif" alt="" width="99" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_39.gif" alt="" width="9" height="12" /> is the return on asset <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_40.gif" alt="" width="3" height="12" />; <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_41.gif" alt="" width="36" height="12" /> is the loss associated with the decision vector <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_42.gif" alt="" width="106" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_43.gif" alt="" width="12" height="12" /> is the proportion of money invested in asset <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_44.gif" alt="" width="3" height="12" />; and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_45.gif" alt="" width="7" height="12" /> is the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_46.gif" alt="" width="33" height="12" />-quantile of the loss distribution.</p>
<p>Then the CVaR can be defined as:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_47.gif" alt="" width="159" height="26" />,</p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_48.gif" alt="" width="7" height="12" /> is expectation and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_49.gif" alt="" width="82" height="29" /></p>
<p>For a sample size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_50.gif" alt="" width="6" height="12" />, the CVaR is approximately:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_51.gif" alt="" width="187" height="26" />.</p>
<p>The problem can be restated as a linear optimization problem by introducing auxiliary variables, one for each observation in the sample:</p>
<p>Find <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_52.gif" alt="" width="135" height="26" />,</p>
<p>subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_53.gif" alt="" width="86" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_54.gif" alt="" width="30" height="12" /> for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_55.gif" alt="" width="58" height="12" />.</p>
<p>As a linear program, the problem is:</p>
<p>Find <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_56.gif" alt="" width="135" height="26" />,</p>
<p>subject to</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_57.gif" alt="" width="86" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_58.gif" alt="" width="30" height="12" /> for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_59.gif" alt="" width="58" height="12" />,</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_60.gif" alt="" width="57" height="14" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_61.gif" alt="" width="32" height="12" /> for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_62.gif" alt="" width="55" height="12" />,</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_63.gif" alt="" width="67" height="12" />,</p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_64.gif" alt="" width="81" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_65.gif" alt="" width="49" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_66.gif" alt="" width="13" height="12" /> is the target optimal portfolio return.</p>
<p>We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_67.gif" alt="" width="122" height="14" /> to estimate the optimal weights that minimize CVaR. It takes three arguments:</p>
<p><span class="special-character Bullet">•</span> the returns matrix (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_68.gif" alt="" width="50" height="13" />)</p>
<p><span class="special-character Bullet">•</span> the target portfolio return (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_69.gif" alt="" width="122" height="14" />)</p>
<p><span class="special-character Bullet">•</span> the confidence level (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_70.gif" alt="" width="7" height="13" />), between 0.9 and 0.99</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_16.gif" alt="" width="580" height="395" /></p>
<h4>Example</h4>
<p>This downloads monthly returns of three stocks over the period May 1, 2000, to May 30, 2019, and computes the CVaR-based optimal weights and associated values given the target portfolio return and confidence level.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_17.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_18.gif" alt="" width="289" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_14.gif" alt="" width="195" height="117" /></p>
<p>The function computes optimal weights for a long-only portfolio. It can easily be modified to account for short-selling.</p>
<h3>4. Introductory Time-Series Analysis and Forecasting</h3>
<p>Data collected over time is common in finance. Mathematica has many built-in functions to model the stochastic nature of financial time series and to forecast the future value of a series. This section gives examples of functions that are useful for model specification, estimation, diagnostics and forecasting of univariate time-series data.</p>
<h4>Constructing and Visualizing Time Series</h4>
<p>The first step in any exploratory analysis is to construct and plot time series. You can use the built-in functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_71.gif" alt="" width="72" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_72.gif" alt="" width="86" height="14" /> to construct financial time series as pairs <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_73.gif" alt="" width="32" height="12" />. There are two formats for each:</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_74.gif" alt="" width="169" height="12" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_75.gif" alt="" width="188" height="12" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_76.gif" alt="" width="183" height="12" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_77.gif" alt="" width="202" height="12" /></p>
<p>Time-series data can be manipulated using many built-in functions; see the documentation.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_19.gif" alt="" width="88" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_15-1.gif" alt="" width="580" height="123" /></p>
<p>Once we create a time series, we can use functions like <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_78.gif" alt="" width="86" height="13" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_79.gif" alt="" width="86" height="13" /> to visualize it.</p>
<p>We illustrate the historical global price of WTI Crude (POILWTIUSDM). First, we download the historical price of WTI crude oil since January, 1990, and then make a plot. Use the API key 207071a5f2e90e7816259d3c32c1ab81 if needed.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_20.gif" alt="" width="555" height="91" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_16-1.gif" alt="" width="360" height="241" /></p>
<h4>Model Fitting and Its Diagnostics</h4>
<p>The built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_80.gif" alt="" width="130" height="13" /> supports both linear and nonlinear time-series models. It fits an automatically selected parametric model to a time series. We can customize the model fit specification by changing its options. The currently supported families of models are:</p>
<p><span class="special-character Bullet">•</span> autoregressive (AR)</p>
<p><span class="special-character Bullet">•</span> moving-average (MA)</p>
<p><span class="special-character Bullet">•</span> autoregressive moving-average (ARMA)</p>
<p><span class="special-character Bullet">•</span> autoregressive integrated moving-average (ARIMA)</p>
<p><span class="special-character Bullet">•</span> seasonal autoregressive moving-average (SARMA)</p>
<p><span class="special-character Bullet">•</span> seasonal integrated autoregressive moving-average (SARIMA)</p>
<p><span class="special-character Bullet">•</span> autoregressive conditionally heteroscedastic (ARCH)</p>
<p><span class="special-character Bullet">•</span> generalized autoregressive conditionally heteroscedastic (GARCH)</p>
<p>You can find descriptions of these models in any time-series books, including Tsay [<a href="#Tsay">4</a>].</p>
<p>Although <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_81.gif" alt="" width="130" height="13" /> selects the model automatically, there are many built-in functions for choosing appropriate values for the parameterizations for a given family and checking the appropriateness of the fitted models.</p>
<p>Next, we are going to show the use of some tools for model specification and checking the adequacy of fitted models.</p>
<p>Use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_82.gif" alt="" width="137" height="13" /> to test whether the data is autocorrelated. (Use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_83.gif" alt="" width="187" height="13" /> to estimate the partial correlation function of the data.)</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_21.gif" alt="" width="580" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_17.gif" alt="" width="146" height="46" /></p>
<p>Use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_84.gif" alt="" width="86" height="13" /> to test whether data comes from an autoregressive time-series process with unit root.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_22.gif" alt="" width="580" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_18.gif" alt="" width="195" height="78" /></p>
<p>A number of other tools are available for model specification:</p>
<p><span class="special-character Bullet">•</span> Akaike information criterion (AIC)</p>
<p><span class="special-character Bullet">•</span> Finite sample corrected AIC (AICc)</p>
<p><span class="special-character Bullet">•</span> Bayesian information criterion (BIC)</p>
<p><span class="special-character Bullet">•</span> Schwartz<span class="special-character Dash">–</span>Bayes information criterion (SBC)</p>
<p>To choose the appropriate model for the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_85.gif" alt="" width="101" height="13" />, we can do the following. (For information on <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_86.gif" alt="" width="86" height="13" />, see the Mathematica help system.)</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_23.gif" alt="" width="580" height="29" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_19.gif" alt="" width="385" height="373" /></p>
<p>Once the model has been specified, you can estimate its parameters with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_87.gif" alt="" width="130" height="13" /> and you can assess its goodness of fit through analysis of residuals.</p>
<p>This estimates the parameters of the model for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_88.gif" alt="" width="101" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_24.gif" alt="" width="518" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_25.gif" alt="" width="237" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_20.gif" alt="" width="279" height="34" /></p>
<p>Use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_89.gif" alt="" width="50" height="13" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_90.gif" alt="" width="50" height="13" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_91.gif" alt="" width="86" height="14" /> of the residuals to assess the whiteness of the model residuals.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_26.gif" alt="" width="400" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_21.gif" alt="" width="576" height="135" /></p>
<h4>Forecasting</h4>
<p>A primary objective of building a time-series model is to forecast its future values. Prediction limits are important to assess the potential accuracy of the forecast. We can use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_92.gif" alt="" width="130" height="13" /> to forecast unobserved future values. The function takes the methods <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_93.gif" alt="" width="28" height="13" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_94.gif" alt="" width="86" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_95.gif" alt="" width="57" height="13" />. We use mean-squared errors to get the precision of our prediction.</p>
<p>This calculates and plots the forecast for the next 5 months of the series within 95% confidence limits.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_27.gif" alt="" width="580" height="264" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_22-1.gif" alt="" width="360" height="240" /></p>
<h4>ARCH and GARCH Models</h4>
<p>The autoregressive conditional heteroskedasticity (ARCH) model and the generalized ARCH model (GARCH) are often used to get a volatility forecast of a time series. You can also use the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_96.gif" alt="" width="130" height="13" /> to estimate parameters of these volatility models. Most volatility models are based on using returns that are obtained after subtracting unconditional mean returns. For our illustration, we de-mean our returns data. The parameters of the model are typically estimated with maximum likelihood.</p>
<p>To estimate a GARCH model for WTI Crude data, we find the de-mean data and estimate the model as follows.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_28.gif" alt="" width="570" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_23.gif" alt="" width="279" height="50" /></p>
<p>You can use the built-in functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_97.gif" alt="" width="65" height="13" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_98.gif" alt="" width="65" height="13" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_99.gif" alt="" width="79" height="13" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_100.gif" alt="" width="94" height="13" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_101.gif" alt="" width="79" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_102.gif" alt="" width="86" height="13" /> to simulate time-series data and for risk management. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_103.gif" alt="" width="115" height="13" /> is another important function to estimate the parameters of a process given its data and model specification.</p>
<h3>5. Simulating Data and Financial Application</h3>
<p>A financial model consisting of fixed relations and variables may not be accurate because most relationships between financial variables are random. Therefore, we must be able to incorporate stochasticity. Monte Carlo simulation is widely used to represent the true features of random modeling. Simulation modeling is a computer-based modeling technique that mimics a real-life situation and helps to incorporate uncertainties in input variables. Such techniques give a distribution of a forecast variable, not just a single value. Therefore, it is very useful when we are uncertain about future outcomes. In this section, we give examples for simulating data using Mathematica and show an application in capital budgeting.</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_104.gif" alt="" width="94" height="13" /> is a powerful function to get data from built-in statistical distributions, including those that are:</p>
<p><span class="special-character Bullet">•</span> continuous or discrete</p>
<p><span class="special-character Bullet">•</span> univariate or multivariate</p>
<p><span class="special-character Bullet">•</span> parametric or derived</p>
<p><span class="special-character Bullet">•</span> defined by data</p>
<h4>Example in Project Risk Analysis</h4>
<p>Consider a situation in which you have to evaluate an investment by forecasting the present value of its future cash flows.</p>
<p>We define a function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_105.gif" alt="" width="166" height="14" /> to compute the present value of future cash flows. Here are its 11 arguments and values for an example. Assume that the revenue and terminal value both follow a triangular distribution and that gross margin follows a uniform distribution.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_24.gif" alt="" width="355" height="221" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_29.gif" alt="" width="580" height="238" /></p>
<p>For the given values, we simulate the data 10,000 times. (This takes a minute or so.)</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_30.gif" alt="" width="580" height="46" /></p>
<p>We can summarize the data as follows.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_31.gif" alt="" width="580" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_25.gif" alt="" width="183" height="203" /></p>
<p>Here is a histogram of the distribution of the present value of the cash flows. Drag the handles (thin vertical lines) on either side of the red region to see the percentage of cash flows that falls within the range of data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_32.gif" alt="" width="283" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_26.gif" alt="" width="411" height="314" /></p>
<p>This is just one example of simulation. We can define similar functions to compute the value of a firm using different valuation models:</p>
<p><span class="special-character Bullet">•</span> discounted cash flows</p>
<p><span class="special-character Bullet">•</span> residual operating income valuation</p>
<p><span class="special-character Bullet">•</span> abnormal growth in earnings valuation</p>
<p>There are many other areas of finance where simulation can be used.</p>
<h3>6. Bootstrapping and Financial Application</h3>
<p>We can apply the bootstrap approach in several contexts in finance. When the data is limited and the true distribution of the population is unknown, we can generate the sampling distribution of a statistic by generating many new samples from the original data and use the empirical distribution for statistical inference. This is called bootstrapping. Performing a bootstrap analysis in Mathematica is very straightforward using the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_106.gif" alt="" width="86" height="13" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_107.gif" alt="" width="86" height="14" /> functions with or without replacement.</p>
<p>Performing bootstrap analysis entails two steps. First, we define a function that computes the statistic of interest. Second, we estimate the statistic of interest by repeatedly sampling observations (usually 10,000 times or more) from the original sample with replacement. Then we can use the distribution of sample statistics to infer an appropriate decision.</p>
<p>In this section, we illustrate the use of bootstrapping through two examples.</p>
<h4>Example 1</h4>
<p>We consider estimating the distribution of an equally weighted portfolio<span class="special-character CloseCurlyQuote">’</span>s conditional value-at-risk (CVaR) using weekly returns of Walmart stock (WMT) and Procter &amp; Gamble (PG) over the period January 1, 1982, to March 30, 2019.</p>
<h5>Step 1</h5>
<p>We get the historical weekly returns data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_33.gif" alt="" width="570" height="14" /></p>
<h5>Step 2</h5>
<p>We define two functions.</p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_108.gif" alt="" width="101" height="13" /> computes the conditional value-at-risk given the returns data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_34.gif" alt="" width="580" height="14" /></p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_109.gif" alt="" width="94" height="14" /> returns a distribution of conditional value-at-risk measures given the size of the sample.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_35.gif" alt="" width="429" height="62" /></p>
<p>We use these functions to get distributions of CVaR with 10,000 observations.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_36.gif" alt="" width="348" height="14" /></p>
<p>We summarize the data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_37.gif" alt="" width="231" height="91" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_27.gif" alt="" width="411" height="515" /></p>
<h4>Example 2</h4>
<p>The next example focuses on retirement planning using the bootstrapping concept. Assume that we want to calculate the terminal value of the following retirement portfolio. The savings are invested equally in two market indices: the S&amp;P 500 Index and the NASDAQ 100 Index. Assume that future returns would be a random draw from past returns. The initial deposit is $1000. Monthly saving for the next 20 years is $1,500. The number of retirement years is 15. During the 15 years of retirement, $2000 will be withdrawn monthly. Starting at the 10th year, $30,000 will be withdrawn annually for three years.</p>
<p>Define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_110.gif" alt="" width="230" height="13" />, which calculates the terminal value of a retirement portfolio. It takes 10 arguments:</p>
<p><span class="special-character Bullet">•</span> returns of the stocks in which money is equally invested (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_111.gif" alt="" width="50" height="13" />)</p>
<p><span class="special-character Bullet">•</span> initial portfolio value (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_112.gif" alt="" width="86" height="13" />), which must be positive</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_113.gif" alt="" width="86" height="13" /><span class="special-character Dash">–</span>years in service</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_114.gif" alt="" width="43" height="14" /><span class="special-character Dash">–</span>periodic saving</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_115.gif" alt="" width="65" height="14" /><span class="special-character Dash">–</span>frequency of contribution per year; coded as 12 for monthly data and 1 for annual data</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_116.gif" alt="" width="108" height="13" /><span class="special-character Dash">–</span>number of retirement years</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_117.gif" alt="" width="43" height="13" /><span class="special-character Dash">–</span>periodic income during retirement years</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_118.gif" alt="" width="94" height="14" /><span class="special-character Dash">–</span>big annual withdraw amount during planning period</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_119.gif" alt="" width="122" height="14" /><span class="special-character Dash">–</span>big withdrawal starting year; annual and in successive years with no gap</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_120.gif" alt="" width="137" height="14" /><span class="special-character Dash">–</span>number of annual big withdrawals</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_38.gif" alt="" width="580" height="222" /></p>
<p>Using the values given, this computes the terminal value.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_39.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_40.gif" alt="" width="580" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_28.gif" alt="" width="81" height="15" /></p>
<h3>7. Mean-Variance Optimization under Uncertainty</h3>
<p>Optimization under uncertainty (or robust optimization) is another approach that helps to get solutions that are good for most realizations of data. Many financial problems fit into this framework; for example, the mean-variance portfolio optimization problem. Here uncertainty may arise due to many factors:</p>
<p><span class="special-character Bullet">•</span> uncertainty in the mean vector</p>
<p><span class="special-character Bullet">•</span> fluctuations in the covariation matrix</p>
<p><span class="special-character Bullet">•</span> variability of risk in the market over time</p>
<p><span class="special-character Bullet">•</span> imprecise model approximation</p>
<p>Feasibility depends on both the decision variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_121.gif" alt="" width="9" height="12" /> and the uncertain vector <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_122.gif" alt="" width="5" height="12" />; uncertainty can be introduced in the expected value, the variance or both.</p>
<p>This section considers a mean-variance problem that allows some degree of variation in returns and covariances.</p>
<p>The standard form of a mean-variance problem is expressed in terms of the information about the expected returns and the covariance structure of the returns. For given asset returns <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_123.gif" alt="" width="92" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_124.gif" alt="" width="9" height="12" /> is the return on asset <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_125.gif" alt="" width="3" height="12" />; and the decision vector <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_126.gif" alt="" width="99" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_127.gif" alt="" width="12" height="12" /> is the proportion of money invested in asset <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_128.gif" alt="" width="3" height="12" />; the mean variance problem is written as:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_129.gif" alt="" width="47" height="20" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_130.gif" alt="" width="91" height="23" /></p>
<p>subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_131.gif" alt="" width="41" height="12" />.</p>
<p>Here <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_132.gif" alt="" width="136" height="73" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_133.gif" alt="" width="18" height="15" /> is the covariance between securities <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_134.gif" alt="" width="3" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_135.gif" alt="" width="5" height="12" />; <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_136.gif" alt="" width="25" height="12" /> is the risk coefficient; <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_137.gif" alt="" width="55" height="67" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_138.gif" alt="" width="11" height="12" /> is the average return on security <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_139.gif" alt="" width="3" height="12" />; and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_140.gif" alt="" width="6" height="12" /> is an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_141.gif" alt="" width="24" height="12" /> column vector of ones, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_142.gif" alt="" width="40" height="63" />.</p>
<p>It is important to find the portfolio with the maximum Sharpe ratio, which can be obtained by solving the following problem; assume that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_143.gif" alt="" width="25" height="12" /> and denote the risk-free rate by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_144.gif" alt="" width="12" height="12" />:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_145.gif" alt="" width="49" height="20" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_146.gif" alt="" width="124" height="23" /></p>
<p>subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_147.gif" alt="" width="41" height="12" />.</p>
<p>The analytical solution to this basic problem for portfolio optimal portfolio weights <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_148.gif" alt="" width="14" height="12" /> is</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_149.gif" alt="" width="98" height="32" />.</p>
<p>We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_150.gif" alt="" width="94" height="14" /> to compute <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_151.gif" alt="" width="9" height="12" />. It takes the arguments returns data (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_152.gif" alt="" width="50" height="13" />) and risk-free rate (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_153.gif" alt="" width="58" height="13" />) and returns an optimal weight vector.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_41.gif" alt="" width="424" height="61" /></p>
<p>One way to get a robust solution to the mean-variance problem is to sample data in several scenarios to estimate parameters. Assuming that the returns have multivariate normal distribution, we define a function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_154.gif" alt="" width="173" height="14" /> to compute tangency portfolios with simulated data. The function takes four arguments:</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_155.gif" alt="" width="50" height="13" /><span class="special-character Dash">–</span>returns data</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_156.gif" alt="" width="58" height="13" /><span class="special-character Dash">–</span>risk-free rate</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_157.gif" alt="" width="72" height="14" /><span class="special-character Dash">–</span>sample size</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_158.gif" alt="" width="7" height="13" /><span class="special-character Dash">–</span>number of iterations</p>
<p>It returns a distribution of optimal Sharpe ratios.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_42.gif" alt="" width="580" height="157" /></p>
<p>We apply those two functions to simulated data and get the distribution of portfolio means that maximize the Sharpe ratio.</p>
<p>We download historical monthly returns as before, compute the distribution of maximum Sharpe ratios and draw a histogram.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_43.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_44.gif" alt="" width="580" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_29.gif" alt="" width="411" height="315" /></p>
<p>Another way to get robustness in the parameter estimate is to introduce some kinds of uncertainty; interval uncertainty sets and ellipsoidal uncertainty sets are the most commonly used. Following Kim, Kim and Fabozzi [<a href="#Kim-Fabozzi">5</a>] (using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_159.gif" alt="" width="9" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_160.gif" alt="" width="11" height="12" /> instead of their <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_161.gif" alt="" width="7" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_162.gif" alt="" width="7" height="12" />), the interval uncertainty set for the expected returns can be defined as:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_163.gif" alt="" width="184" height="23" />,</p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_164.gif" alt="" width="91" height="12" />, the variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_165.gif" alt="" width="15" height="17" /> is an estimate of the expected return and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_166.gif" alt="" width="10" height="12" /> is a constant used to control the expected returns of stock <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_167.gif" alt="" width="3" height="12" />.</p>
<p>The mean-variance problem with box uncertainty can be written as:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_168.gif" alt="" width="47" height="20" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_169.gif" alt="" width="49" height="20" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_170.gif" alt="" width="91" height="23" /></p>
<p>subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_171.gif" alt="" width="41" height="12" /> and where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_172.gif" alt="" width="11" height="12" /> is such that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_173.gif" alt="" width="70" height="23" /> for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_174.gif" alt="" width="68" height="12" />.</p>
<p>This objective function can be modified as follows (see [<a href="#Kim-Fabozzi">5</a>] for the derivation and explanation of the notation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_175.gif" alt="" width="16" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_176.gif" alt="" width="18" height="12" />):</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_177.gif" alt="" width="47" height="20" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_178.gif" alt="" width="85" height="12" /></p>
<p>subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_179.gif" alt="" width="52" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_180.gif" alt="" width="26" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_181.gif" alt="" width="8" height="12" /> is the transformation matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_182.gif" alt="" width="68" height="12" /> for <img style="vertical-align: middle;" title="I_n" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Image_2.gif" alt="I_n" width="11" height="12" /> a unit matrix of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_183.gif" alt="" width="24" height="12" />; for example, when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_184.gif" alt="" width="26" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_185.gif" alt="" width="102" height="29" />.</p>
<p>We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_186.gif" alt="" width="324" height="14" /> to find the solution to the mean variance optimization problem with box uncertainty. This function takes three arguments:</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_187.gif" alt="" width="50" height="13" /><span class="special-character Dash">–</span>a matrix of stock returns</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_188.gif" alt="" width="7" height="13" /><span class="special-character Dash">–</span>the risk coefficient</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_189.gif" alt="" width="7" height="13" /><span class="special-character Dash">–</span>the confidence level for the uncertainty set</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_45.gif" alt="" width="580" height="330" /></p>
<p>We compute optimal weights for the following portfolio.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_46.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_47.gif" alt="" width="461" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_30.gif" alt="" width="217" height="51" /></p>
<p>In [<a href="#Kim-Fabozzi">5</a>], an ellipsoidal uncertainty set on expected returns is defined as:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_190.gif" alt="" width="165" height="23" />,</p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_191.gif" alt="" width="18" height="12" /> is the covariance matrix of estimation error of expected returns and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_214.gif" alt="" width="6" height="12" /> controls the size of the ellipsoid. With this uncertainty set, the mean variance problem can be written as:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_192.gif" alt="" width="47" height="20" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_193.gif" alt="" width="175" height="25" />,</p>
<p>subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_194.gif" alt="" width="41" height="12" />.</p>
<p>The covariance matrix of estimation errors can be approximated in several ways using the sample covariance matrix of stock returns. Assuming that the samples of stock returns are independent and identically distributed, [<a href="#Kim-Fabozzi">5</a>] defines <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_195.gif" alt="" width="55" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_196.gif" alt="" width="9" height="12" /> is the covariance matrix of stock returns and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_197.gif" alt="" width="6" height="12" /> is the sample size.</p>
<p>Define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_198.gif" alt="" width="382" height="14" /> to compute an optimal portfolio with an ellipsoidal uncertainty. It takes three arguments:</p>
<p><span class="special-character Bullet">•</span> returns (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_199.gif" alt="" width="50" height="13" />)</p>
<p><span class="special-character Bullet">•</span> value of risk coefficient (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_200.gif" alt="" width="7" height="13" />)</p>
<p><span class="special-character Bullet">•</span> confidence level for the uncertainty set (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_201.gif" alt="" width="7" height="13" />)</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_48.gif" alt="" width="580" height="281" /></p>
<p>We compute optimal weights for our usual portfolio subject to an ellipsoidal uncertainty set.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_49.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_50.gif" alt="" width="519" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_31.gif" alt="" width="211" height="51" /></p>
<p>We can use the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_202.gif" alt="" width="173" height="14" /> to optimize the portfolio problem, introducing uncertainty in the mean returns or in the covariance.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_51.gif" alt="" width="545" height="109" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_52.gif" alt="" width="580" height="77" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_32.gif" alt="" width="331" height="13" /></p>
<p>Similarly, we can introduce uncertainty in risk and solve the optimization problem using this same function. See the documentation for an example.</p>
<h3>8. Artificial Intelligence</h3>
<p>With increasing computational resources and larger datasets, machine learning or artificial intelligence is a growing field in finance. A recent book by Dixon, Halperin and Bilokon [<a href="#Dixon-Halperin">6</a>] is a good reference on theory and applications.</p>
<p>Although the Wolfram Language includes a wide range of functions that work on many types of data, including numerical, categorical, time series, textual, image and audio, we focus on the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_203.gif" alt="" width="50" height="13" /> function and time-series data only. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_204.gif" alt="" width="50" height="13" /> function uses input data and returns a predictor function that can be used to forecast the value of dependant variables given the values of independent variables. In this section, we show two examples using financial time series.</p>
<h5>One Predictor for Stock Returns</h5>
<p>This example uses the Aruoba<span class="special-character Dash">–</span>Diebold<span class="special-character Dash">–</span>Scotti (ADS) business conditions index as one predictor of percentage change in the S&amp;P 500 index. We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_205.gif" alt="" width="130" height="14" />. It downloads the ADS index from the Federal Reserve Bank of Philadelphia and the S&amp;P 500 index returns and then merges them for use in the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_206.gif" alt="" width="50" height="13" /> function, given the start and end date as arguments.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_53.gif" alt="" width="580" height="254" /></p>
<p>Using this function, we download the data for the period January 30, 1970, to September 30, 2019, and generate a prediction function. (This takes several minutes.)</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_54.gif" alt="" width="435" height="30" /></p>
<p>Once the prediction function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_207.gif" alt="" width="43" height="13" /> is generated, we can use it to predict the future value of the stock index value. For instance, here it predicts percentage change in the S&amp;P 500 index if ADS is 0.9, 2 or -1.2.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_55.gif" alt="" width="155" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_33.gif" alt="" width="267" height="13" /></p>
<h5>Several Predictors for Stock Returns</h5>
<p>In this example, we use five monthly macro variables to predict percentage change in the value of the S&amp;P 500 index:</p>
<p><span class="special-character Bullet">•</span> USSLIND<span class="special-character Dash">–</span>the leading index for the United States</p>
<p><span class="special-character Bullet">•</span> UMCSENT<span class="special-character Dash">–</span>the University of Michigan consumer sentiment index</p>
<p><span class="special-character Bullet">•</span> CFNAIMA3<span class="special-character Dash">–</span>the Chicago Fed national activity index: three-month moving average</p>
<p><span class="special-character Bullet">•</span> MICH<span class="special-character Dash">–</span>the University of Michigan inflation expectation index</p>
<p><span class="special-character Bullet">•</span> T10Y2YM<span class="special-character Dash">–</span>10-year Treasury constant maturity minus 2-year Treasury constant maturity</p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_208.gif" alt="" width="180" height="14" /> takes a list of macroeconomic series IDs (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_209.gif" alt="" width="101" height="13" />), start date and end date as input arguments. It returns values for specified macroeconomic variables and S&amp;P 500 index returns in the format suitable for the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_210.gif" alt="" width="50" height="13" /> function. The Federal Reserve Bank of St. Louis may require the API key to download its data. The API key can be obtained freely by creating a user account at <a href="https://fred.stlouisfed.org" target="_blank">https://fred.stlouisfed.org</a> (click <span class="special-character OpenCurlyDoubleQuote">“</span>my account<span class="special-character CloseCurlyDoubleQuote">”</span> and follow the instructions). Use the API key 207071a5f2e90e7816259d3c32c1ab81 if needed.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_56.gif" alt="" width="563" height="94" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_57.gif" alt="" width="580" height="366" /></p>
<p>Using this function, we download five macro variables as well as the S&amp;P 500 index returns over the period January 30, 1983, to May 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_58.gif" alt="" width="580" height="30" /></p>
<p>We can generate the prediction function using the data and predict the value. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_211.gif" alt="" width="50" height="13" /> can take the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_212.gif" alt="" width="43" height="13" /> option to specify which regression method to use.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Input_59.gif" alt="" width="401" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Output_34.gif" alt="" width="58" height="13" /></p>
<p>We have shown some applications of only the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/12/Adhikari_Math_213.gif" alt="" width="50" height="13" />. However, the Wolfram Language comes with many other built-in functions that are useful in classification, discriminant analysis and neural networks. You can use these tools to learn from the data and build models to extract useful information. We encourage you to explore more about machine learning in Mathematica.</p>
<h3>9. Conclusion</h3>
<p>As financial data becomes increasingly available, serious data analysis requires knowing software to manipulate large datasets. Aside from demonstrating many built-in functions, we introduced many custom functions especially designed for technical computation of financial data. Mathematica can do much more than what we have shown in this article. The Wolfram Language in general and Mathematica in particular are well-suited to implement sophisticated financial models, including pricing securities, trading strategies, simulation, optimization, risk management and time-series analysis [<a href="#Lewis-2000">7</a>, <a href="#Lewis-2016">8</a>]. Mathematica<span class="special-character CloseCurlyQuote">’</span>s built-in knowledge is also very useful for asset pricing models based on estimating the stochastic discount factor using the generalized method of moments.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Wellin"></a>[1]</td>
<td>P. Wellin, <em>Essentials of Programming in Mathematica</em>, Cambridge, UK: Cambridge University Press, 2016.</td>
</tr>
<tr>
<td class="Reference"><a name="Cornuejols-Pena"></a>[2]</td>
<td>G. Cornu<span class="special-character EAcute">é</span>jols, J. Pe<span class="special-character NTilde">ñ</span>a and R. T<span class="special-character UDoubleDot">ü</span>t<span class="special-character UDoubleDot">ü</span>nc<span class="special-character UDoubleDot">ü</span>, <em>Optimization Methods in Finance</em>, 2nd ed., New York: Cambridge University Press, 2018.</td>
</tr>
<tr>
<td class="Reference"><a name="Rockafellar-Uryasev"></a>[3]</td>
<td>R. T. Rockafellar and S. Uryasev, <span class="special-character OpenCurlyDoubleQuote">“</span>Optimization of Conditional Value-at-Risk<span class="special-character CloseCurlyDoubleQuote">”</span>, <em>The Journal of Risk</em>, <strong>2</strong>(3), 2000 pp. 21<span class="special-character Dash">–</span>41. <a href="https://doi.org/10.21314/JOR.2000.038" target="_blank">https://doi.org/10.21314/JOR.2000.038</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Tsay"></a>[4]</td>
<td>R. S. Tsay, <em>An Introduction to Analysis of Financial Data with R</em>, Hoboken, NJ: Wiley, 2013.</td>
</tr>
<tr>
<td class="Reference"><a name="Kim-Fabozzi"></a>[5]</td>
<td>W. C. Kim, J. H. Kim and F. J. Fabozzi, <em>Robust Equity Portfolio Management</em>, Hoboken, NJ: Wiley, 2016.</td>
</tr>
<tr>
<td class="Reference"><a name="Dixon-Halperin"></a>[6]</td>
<td>M. Dixon, I. Halperin and P. Bilokon, <em>Machine Learning in Finance from Theory to Practice</em>, Cham, Switzerland: Springer, 2020.</td>
</tr>
<tr>
<td class="Reference"><a name="Lewis-2000"></a>[7]</td>
<td>A. L. Lewis, <em>Option Valuation under Stochastic Volatility: With Mathematica Code</em>, Newport Beach, CA: Finance Press, 2000.</td>
</tr>
<tr>
<td class="Reference"><a name="Lewis-2016"></a>[8]</td>
<td>A. L. Lewis, <em>Option Valuation under Stochastic Volatility II: With Mathematica Code</em>, Newport Beach, CA: Finance Press, 2016.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>R. Adhikari, <span class="special-character OpenCurlyDoubleQuote">“</span>Selected Financial Applications,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2021. <a href="https://doi.org/10.3888/tmj.23-5">doi.org/10.3888/tmj.23-5</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Ramesh Adhikari is an Associate Professor of Finance at Humboldt State University. Prior to coming to HSU, he taught undergraduate and graduate students at Tribhuvan University and worked at the Central Bank of Nepal. He was also a research fellow at Osaka Sangyo University, Osaka, Japan. He earned a Ph.D. in Financial Economics from the University of New Orleans. He is interested in the areas of computational finance and high-dimensional statistics.</p>
<p class="TextAboutAuthor"><strong>Ramesh Adhikari</strong><br />
<em>School of Business, Humboldt State University<br />
1 Harpst Street<br />
Arcata, CA 95521</em><br />
<em><a href="mailto:ramesh.adhikari@humboldt.edu">ramesh.adhikari@humboldt.edu</a></em></p>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2021/12/16/selected-financial-applications/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Mixing Numbers and Unfriendly Colorings of Graphs</title>
		<link>https://www.mathematica-journal.com/2021/09/28/mixing-numbers-and-unfriendly-colorings-of-graphs/</link>
		<comments>https://www.mathematica-journal.com/2021/09/28/mixing-numbers-and-unfriendly-colorings-of-graphs/#respond</comments>
		<pubDate>Tue, 28 Sep 2021 15:55:19 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 23]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=62501</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.23-4 &#160; Mathematica has many built-in functions for doing research in graph theory. Formerly it was necessary to load the Combinatorica package to access these functions; most are now available within Mathematica itself. This article studies a problem concerning the vertex coloring of graphs using Mathematica by introducing some user-defined functions. Unfriendly Colorings of Graphs [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.23-4">https://doi.org/10.3888/tmj.23-4</a></span></div>
<p>&nbsp;</p>
<div>
<p>Mathematica has many built-in functions for doing research in graph theory. Formerly it was necessary to load the Combinatorica package to access these functions; most are now available within Mathematica itself. This article studies a problem concerning the vertex coloring of graphs using Mathematica by introducing some user-defined functions.<span id="more-62501"></span></p>
<h3>Unfriendly Colorings of Graphs</h3>
<p>We only consider vertex colorings, so a &#8220;colored graph&#8221; always means a vertex-colored graph. An <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_1.gif" alt="" width="6" height="12" />-coloring of a graph is a partition of the vertices into <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_2.gif" alt="" width="6" height="12" /> disjoint subsets. We start with 2-colorings; call the colors red and blue. Two vertices are <em>neighbors</em> if they are connected by an edge. We say that two vertices of the same color are <em>friends</em> and two vertices of opposite colors are <em>stranger</em>s. If more than half the neighbors of a colored vertex <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_3.gif" alt="" width="5" height="12" /> are friends of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_4.gif" alt="" width="5" height="12" />, we say that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_5.gif" alt="" width="5" height="12" /> lives in a <em>friendly neighborhood</em>; otherwise, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_6.gif" alt="" width="5" height="12" /> is said to live in an <em>unfriendly neighborhood</em>. If all the vertices of the graph have the same color, every vertex lives in a friendly neighborhood. Is there a 2-coloring such that every vertex lives in an unfriendly neighborhood? The surprising answer to this question is yes, as we shall show.</p>
<p>A 2-coloring of a graph is <em>unfriendly</em> if each vertex lives in an unfriendly neighborhood, that is, at least half its neighbors are colored differently from itself. It is a theorem that every finite graph has an unfriendly coloring. (The situation is much more complicated for infinite graphs [<a href="#Aharoni-Milner-Prikry">1</a>, <a href="#Shelah-Milner">2</a>]). The proof is clever, but not very long and we give it next. Define the <em>mixing number</em> of a colored graph to be the number of its edges whose vertices have different colors. Proceed by successively &#8220;flipping,&#8221; that is, changing the color of those vertices that live in friendly neighborhoods. When a vertex is flipped, it may change the neighborhood status of other vertices; however, each flip increases the mixing number of the graph. Since the mixing number is bounded by the number of edges in the graph, this flipping process must eventually end with no more flippable vertices, that is, no more vertices living in friendly neighborhoods.</p>
<h3>Finding the Mixing Number of a Colored Graph</h3>
<p>We start with an easy example. We first consider the complete graph with 7 vertices.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_1.gif" alt="" width="326" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_1.gif" alt="" width="360" height="365" /></p>
<p>We will color the vertices either red or blue. Assume that we start with four blue and three red vertices.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_2.gif" alt="" width="136" height="29" /></p>
<p>Here is how we show the colors.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_3.gif" alt="" width="378" height="30" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_4.gif" alt="" width="154" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_2.gif" alt="" width="360" height="365" /></p>
<p>To calculate the mixing number, we first generate the set of edges.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_5.gif" alt="" width="206" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_3.gif" alt="" width="499" height="29" /></p>
<p>Next we introduce <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_7.gif" alt="" width="72" height="14" />, which determines if the vertices of an edge have the different colors.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_6.gif" alt="" width="336" height="62" /></p>
<p>Then <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_8.gif" alt="" width="72" height="14" /> selects those edges whose vertices have different colors.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_7.gif" alt="" width="361" height="14" /></p>
<p>Finally, we apply <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_9.gif" alt="" width="72" height="14" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_10.gif" alt="" width="14" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_8.gif" alt="" width="190" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_4.gif" alt="" width="543" height="13" /></p>
<p>This is the mixing number of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_11.gif" alt="" width="14" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_9.gif" alt="" width="64" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_5.gif" alt="" width="14" height="13" /></p>
<p>It is easy to see by considering the other 2-colorings of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_12a.gif" alt="" width="14" height="13" /> that this coloring has the maximum mixing number for the graph and hence this coloring must be unfriendly. Four of one color and three of the other gives a mixing number of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_12.gif" alt="" width="24" height="12" />, whereas five of one color and two of the other gives a mixing number of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_13.gif" alt="" width="24" height="12" />, and so on. Of course, a direct inspection also shows the coloring is unfriendly.</p>
<h3>A Larger Example</h3>
<p>We used the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_14.gif" alt="" width="79" height="14" /> function to construct a graph <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_15.gif" alt="" width="22" height="14" /> with 20 vertices and 100 edges. Here is the list of edges that was generated.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_10.gif" alt="" width="580" height="149" /></p>
<p>Arbitrarily color the first 10 vertices red and the remaining 10 blue.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_11.gif" alt="" width="154" height="30" /></p>
<p>Here is the image of the graph, colored as before.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_12.gif" alt="" width="176" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_6.gif" alt="" width="360" height="353" /></p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_16.gif" alt="" width="29" height="14" /> changes the color of a vertex.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_13.gif" alt="" width="252" height="78" /></p>
<p>For example, this flips vertex 1.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_14.gif" alt="" width="154" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_7.gif" alt="" width="468" height="13" /></p>
<p>We need to get the set of <em>neighbors</em> of a vertex <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_17.gif" alt="" width="7" height="13" /> in a graph <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_18.gif" alt="" width="7" height="13" />, that is, those vertices that share an edge with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_19.gif" alt="" width="7" height="13" />. Since the built-in Mathematica function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_20.gif" alt="" width="161" height="14" /> includes the vertex <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_21.gif" alt="" width="7" height="13" /> itself, we remove it.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_15.gif" alt="" width="496" height="14" /></p>
<p>For example, here are the neighbors of vertex 3 in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_22.gif" alt="" width="22" height="14" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_16.gif" alt="" width="169" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_8.gif" alt="" width="179" height="13" /></p>
<p>Next we obtain the edges whose vertices are colored differently.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_17.gif" alt="" width="212" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_9.gif" alt="" width="576" height="74" /></p>
<p>The length of that list is the mixing number of the graph with edges <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_23.gif" alt="" width="22" height="13" /> and the color partition <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_24.gif" alt="" width="104" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_18.gif" alt="" width="64" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_10.gif" alt="" width="14" height="13" /></p>
<p>Call a vertex <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_25.gif" alt="" width="7" height="13" /> a <em>secure</em> vertex in a graph <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_26.gif" alt="" width="7" height="13" /> if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_27.gif" alt="" width="7" height="13" /> lives in a friendly neighborhood, that is, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_28.gif" alt="" width="7" height="13" /> has the same color as most of its neighbors in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_29.gif" alt="" width="7" height="13" />.</p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_30.gif" alt="" width="94" height="13" /> determines whether <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_31.gif" alt="" width="7" height="13" /> is a secure vertex in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_32.gif" alt="" width="7" height="13" /> with the color partition <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_33.gif" alt="" width="39" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_19.gif" alt="" width="517" height="78" /></p>
<p>For example, these are the secure vertices of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_34.gif" alt="" width="22" height="14" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_20.gif" alt="" width="419" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_11.gif" alt="" width="182" height="13" /></p>
<p>We define the corresponding function, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_35.gif" alt="" width="101" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_21.gif" alt="" width="548" height="14" /></p>
<h3>One Step of Unfriendly Coloring a Graph</h3>
<p>We select the first element <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_36.gif" alt="" width="7" height="13" /> in the list of secure vertices <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_37.gif" alt="" width="14" height="13" /> and set the colors.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_22.gif" alt="" width="84" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_12.gif" alt="" width="7" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_23.gif" alt="" width="72" height="29" /></p>
<p>We flip the color of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_38.gif" alt="" width="7" height="13" /> since it lives in a friendly neighborhood, or equivalently, it is a secure vertex.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_24.gif" alt="" width="89" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_13.gif" alt="" width="468" height="13" /></p>
<p>We could now repeat this step using the generated color partition and stop when there are no more secure vertices. In the next section we write the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_39.gif" alt="" width="108" height="14" /> to carry out the process to the end, with output the final color partition.</p>
<h3>Unfriendly Coloring a Graph</h3>
<p>The following short program produces an unfriendly coloring of any 2-colored graph starting with the color partition <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_40.gif" alt="" width="76" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_25.gif" alt="" width="298" height="182" /></p>
<p>Here is the unfriendly color partition.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_26.gif" alt="" width="292" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_14.gif" alt="" width="468" height="13" /></p>
<p>Here is the unfriendly coloring of the graph <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_41.gif" alt="" width="22" height="14" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_27.gif" alt="" width="162" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_15.gif" alt="" width="360" height="353" /></p>
<p>We can even start with all vertices having the same color, say red.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_28.gif" alt="" width="170" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_16.gif" alt="" width="360" height="353" /></p>
<p>We run our program and use the new color partition.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Input_29.gif" alt="" width="375" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Output_17.gif" alt="" width="360" height="353" /></p>
<h3>Relation to the Max-Cut Problem</h3>
<p>The max-cut problem is to partition the vertices <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_42.gif" alt="" width="8" height="12" /> of a graph <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_43.gif" alt="" width="9" height="12" /> into two sets <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_44.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_45.gif" alt="" width="18" height="12" /> so as to maximize the number of edges whose endpoints are in both sets. However, this is equivalent to a two-coloring of the vertices of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_46.gif" alt="" width="9" height="12" /> such that the size of the max cut (i.e. the number of edges joining the two cut sets) is the same as the mixing number of the coloring. The max-cut problem is known to be NP-hard [<a href="#Panigrahi">3</a>, <a href=" #Garey">4</a>], which implies that methods of finding this maximum will not run in polynomial time unless P = NP, something most mathematicians consider unlikely.</p>
<p>In the context of the max-cut problem, our procedure, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/09/Cowen_Math_47.gif" alt="" width="108" height="14" />, is known as local search and can easily be shown to always produce a cut with at least half the number of edges in the graph [<a href="#Panigrahi">3</a>].</p>
<h3>Conclusion</h3>
<p>We have shown how to find unfriendly 2-colorings of finite graphs, which can easily be extended to more colors. We feel that treating a vertex coloring as a partition of the list of vertices and regarding this as an integral and dynamic part of the graph should be of use in investigating other coloring problems.</p>
<p>Finally, I wish to dedicate this work to Bill Emerson, who worked on this problem with me over 30 years ago (see reference 3 in [<a href="#Aharoni-Milner-Prikry">1</a>] to our unpublished paper). Bill was a very talented mathematician and a good friend. He is missed by all who knew him.</p>
<h3>Acknowledgements</h3>
<p>I am grateful to George Beck for improving my programming throughout the paper and to Professor Lenore Cowen for pointing out the connection to the max-cut problem.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Aharoni-Milner-Prikry"></a>[1]</td>
<td>R. Aharoni, E. C. Milner and K. Prikry, <span class="special-character OpenCurlyDoubleQuote">“</span>Unfriendly Partitions of a Graph,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Journal of Combinatorial Theory, Series B</em>, <strong>50</strong>(1), 1990 pp. 1<span class="special-character Dash">–</span>10.<br />
<a href="https://doi.org/10.1016/0095-8956(90)90092-E" target="_blank">https://doi.org/10.1016/0095-8956(90)90092-E</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Shelah-Milner"></a>[2]</td>
<td>S. Shelah and E. C. Milner, <span class="special-character OpenCurlyDoubleQuote">“</span>Graphs with No Unfriendly Partitions,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>A Tribute to Paul Erd<span class="special-character ODoubleAcute">ő</span>s</em> (A. Baker, B. Bollob<span class="special-character AAcute">á</span>s and A. Hajnal, eds.), Cambridge, UK: Cambridge University Press, 1990<br />
pp. 373<span class="special-character Dash">–</span>384.</td>
</tr>
<tr>
<td class="Reference"><a name="Panigrahi"></a>[3]</td>
<td>D. Panigrahi, <span class="special-character OpenCurlyDoubleQuote">“</span>COMPSCI 638: Graph Algorithms, Lecture 22.<span class="special-character CloseCurlyDoubleQuote">”</span> (Sep 10, 2021)<br />
<a href="https://courses.cs.duke.edu//fall19/compsci638/fall19_notes/lecture22.pdf" target="_blank">https://courses.cs.duke.edu//fall19/compsci638/fall19_notes/lecture22.pdf</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Garey"></a>[4]</td>
<td>M. R. Garey, D. S. Johnson and L. Stockmeyer, <span class="special-character OpenCurlyDoubleQuote">“</span>Some Simplified NP-Complete Problems,<span class="special-character CloseCurlyDoubleQuote">”</span> in <em>Proceedings of the Sixth Annual ACM Symposium on Theory of Computing</em>, New York: ACM, Seattle, WA, 1974 pp. 47<span class="special-character Dash">–</span>63. <a href="https://dl.acm.org/doi/10.1145/800119.803884" target="_blank">https://dl.acm.org/doi/10.1145/800119.803884</a>.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>R. Cowen, <span class="special-character OpenCurlyDoubleQuote">“</span>Mixing Numbers and Unfriendly Colorings of Graphs,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2021. <a href="https://doi.org/10.3888/tmj.23-4">doi.org/10.3888/tmj.23<span class="special-character Dash">–</span>4</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Robert Cowen is a Professor Emeritus at Queens College, CUNY. His main research interests are logic and combinatorics. He has enjoyed teaching students how to use Mathematica to do research in mathematics for many years.</p>
<p class="TextAboutAuthor"><strong>Robert Cowen</strong><br />
<em>16422 75th Avenue<br />
Fresh Meadows, NY 11366<br />
</em><em><a href="mailto:robert.cowen@gmail.com">robert.cowen@gmail.com</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2021/09/28/mixing-numbers-and-unfriendly-colorings-of-graphs/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Numerical Contour Integration</title>
		<link>https://www.mathematica-journal.com/2021/07/16/numerical-contour-integration/</link>
		<comments>https://www.mathematica-journal.com/2021/07/16/numerical-contour-integration/#respond</comments>
		<pubDate>Fri, 16 Jul 2021 19:44:55 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 23]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=61520</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.23-3 &#160; We present a straightforward implementation of contour integration by setting options for and , taking advantage of powerful results in complex analysis. As such, this article can be viewed as documentation to perform numerical contour integration with the existing built-in tools. We provide examples of how this method can be used when integrating [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.23-3">https://doi.org/10.3888/tmj.23-3</a></span></div>
<p>&nbsp;</p>
<div>
<p>We present a straightforward implementation of contour integration by setting options for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_1.gif" alt="" width="70" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_2.gif" alt="" width="78" height="13" />, taking advantage of powerful results in complex analysis. As such, this article can be viewed as documentation to perform numerical contour integration with the existing built-in tools. We provide examples of how this method can be used when integrating analytically and numerically some commonly used distributions, such as Wightman functions in quantum field theory. We also provide an approximating technique when time-ordering is involved, a commonly encountered scenario in quantum field theory for computing second-order terms in Dyson series expansion and Feynman propagators. We believe our implementation will be useful for more general calculations involving advanced or retarded Green<span class="special-character CloseCurlyQuote">’</span>s functions, propagators, kernels and so on.<span id="more-61520"></span></p>
<h3>Introduction</h3>
<p>It is well known that we can integrate analytically a large class of functions with known anti-derivatives via <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_3.gif" alt="" width="65" height="14" />; otherwise, we can use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_4.gif" alt="" width="72" height="14" /> for numerical results. There are various settings that one can use to evaluate integrals, depending on the task at hand. Crucially, this can be performed even if the integrand is complex valued, such as the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_5.gif" alt="" width="16" height="15" />. In some cases, when the integrand is a distribution, this integration can also be done analytically by setting the option <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_6.gif" alt="" width="101" height="14" />, for example, or by imposing a regulator, which in physics is often called a UV cutoff.</p>
<p>In this article, we are interested in a contour integral of the form</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_1.gif" alt="" width="67" height="37" /></td>
<td class="DisplayFormulaNumberedLabel">(1)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_7.gif" alt="" width="21" height="12" /> is a complex-valued function or distribution and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_8.gif" alt="" width="6" height="12" /> is an integration contour, with possibly higher-dimensional generalizations. For a large class of functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_9.gif" alt="" width="21" height="12" /> and a contour <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_10.gif" alt="" width="6" height="12" />, this can be done in various ways, such as using powerful techniques in complex analysis like Cauchy<span class="special-character CloseCurlyQuote">’</span>s integral formula or the residue theorem. For many of these functions, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_11.gif" alt="" width="65" height="14" /> can provide answers immediately, sometimes involving special functions.</p>
<p>The motivation for this article is based on the observation that there is no good documentation on how to perform explicit contour integration in Mathematica. It turns out that the ingredients necessary to perform this task are already available within the software. We believe that some of these ingredients are already used elsewhere for different purposes. Our task is to synthesize these components in a coherent way to document how to perform numerical contour integration, using only built-in commands and their options. We will show by way of examples that in many cases this method proves superior to direct integration with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_12.gif" alt="" width="10" height="12" /> prescription, especially when the integrand is complicated or when the integral is multidimensional.</p>
<h3>Example 1: Simple Textbook Example<span class="special-character LongDash">—</span>One-Dimensional Contour Integral with Closed-Form Solutions</h3>
<p>Consider the integral</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_2.gif" alt="" width="357" height="40" /></td>
<td class="DisplayFormulaNumberedLabel">(2)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_13.gif" alt="" width="25" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_14.gif" alt="" width="26" height="12" />, and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_15.gif" alt="" width="6" height="12" /> is the entire real line. The first equality comes from Sokhotsky<span class="special-character CloseCurlyQuote">’</span>s formula [<a href="#Howie">1</a>] and the second equality uses principal value integration. This is a commonly used <span class="special-character OpenCurlyDoubleQuote">“</span>epsilon-regularization<span class="special-character CloseCurlyDoubleQuote">”</span> in physics when evaluating certain apparently divergent integrals, which has to do with the distributional nature of the integrand in question (see Appendix A in [<a href="#Howie">1</a>] for examples).</p>
<p>This integral can be solved using complex analysis instead of Sokhotsky<span class="special-character CloseCurlyQuote">’</span>s formula, based on the observation that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_16.gif" alt="" width="10" height="12" /> can be computed using the following contour.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_1.gif" alt="" width="360" height="194" /></p>
<p>The contour is the horizontal blue segment and the semi-circular arc <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_17.gif" alt="" width="6" height="12" />. The integral over the semi-circular arc vanishes as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_18.gif" alt="" width="34" height="12" /> by Jordan&#8217;s lemma [<a href="#Brown-Churchill">2</a>, <a href="Mukhanov-Winitzki">3</a>]. The contribution from the closed loop can be calculated in various ways, such as the residue theorem. The residue theorem says that since the closed loop encloses the pole at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_19.gif" alt="" width="30" height="12" /> (using the standard counterclockwise convention [<a href="#Brown-Churchill">2</a>, <a href="Mukhanov-Winitzki">3</a>]), <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_20.gif" alt="" width="173" height="18" />. Taking the limit as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_21.gif" alt="" width="27" height="12" />, we get the same result <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_22.gif" alt="" width="19" height="12" /> as before.</p>
<p>There is indeed a built-in function for calculating residues.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_1.gif" alt="" width="192" height="32" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_2.gif" alt="" width="25" height="15" /></p>
<p>Another way to evaluate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_23.gif" alt="" width="10" height="12" /> is based on the fact that the <span class="special-character OpenCurlyDoubleQuote">“</span><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_24.gif" alt="" width="10" height="12" /> prescription<span class="special-character CloseCurlyDoubleQuote">”</span> is an instruction to perform a specific contour integration (without an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_25.gif" alt="" width="5" height="12" />-regulator) in the sense that</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_3.gif" alt="" width="266" height="44" /></td>
<td class="DisplayFormulaNumberedLabel">(3)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_26.gif" alt="" width="6" height="12" /> is a contour chosen to go from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_27.gif" alt="" width="19" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_28.gif" alt="" width="10" height="12" /> but deformed near the pole <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_29.gif" alt="" width="26" height="12" /> to the lower complex plane.</p>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_30.gif" alt="" width="10" height="12" /> prescription in (<a href="#Eq:2">2</a>) shifts the pole at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_31.gif" alt="" width="26" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_32.gif" alt="" width="30" height="12" /> in the upper half-plane, so that we can integrate over the real line and then take the limit as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_33.gif" alt="" width="31" height="12" />. Consequently, if we were to remove the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_34.gif" alt="" width="5" height="12" />-regulator, the deformation theorem [<a href="#Brown-Churchill">2</a>] would require that we deform the contour to the lower complex plane near <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_35.gif" alt="" width="26" height="12" /> in order to obtain the same value of the integral. (The deformation theorem [<a href="#Brown-Churchill">2</a>] in complex analysis states that a contour integral remains constant under deformation of the contour that does not cross any poles or branch cuts.) For this contour, the residue is instead given by the following.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_2.gif" alt="" width="182" height="31" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_3.gif" alt="" width="7" height="13" /></p>
<p>If we choose <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_36.gif" alt="" width="25" height="12" /> instead, the integral is zero. Here is an explicit computation for fixed <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_37.gif" alt="" width="26" height="12" />.</p>
<h4>Case 1</h4>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_3.gif" alt="" width="286" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_4.gif" alt="" width="241" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_4.gif" alt="" width="126" height="33" /></p>
<p>The zero values have a simple explanation in terms of contour integration: since the pole is now shifted to the lower half-plane, the contour does not enclose any poles, which by Cauchy<span class="special-character CloseCurlyQuote">’</span>s integral theorem guarantees that the integral is zero.</p>
<h4>Case 2</h4>
<p>This is a good place to introduce the numerical contour integration scheme. As a simple example, we can use a rectangular contour.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_5.gif" alt="" width="580" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_6.gif" alt="" width="213" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_5.gif" alt="" width="117" height="13" /></p>
<h4>Case 3</h4>
<p>For any <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_38.gif" alt="" width="26" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_39.gif" alt="" width="26" height="12" />, this calculation gives the correct answer, as expected from direct calculation using residues or textbook pen-and-paper calculations (see e.g. [<a href="#Mukhanov-Winitzki">3</a>]). Varying <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_40.gif" alt="" width="6" height="12" /> does not change the integral, as a consequence of the deformation theorem. In particular, other contours also work, such as, for example, a triangular contour.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_7.gif" alt="" width="488" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_8.gif" alt="" width="163" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_6.gif" alt="" width="79" height="13" /></p>
<h4>Case 4</h4>
<p>For completeness, let us show that in this simple case the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_41.gif" alt="" width="10" height="12" /> prescription (which is commonly used in physics) can also be done. We add the condition <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_42.gif" alt="" width="26" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_9.gif" alt="" width="501" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_10.gif" alt="" width="53" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_7.gif" alt="" width="48" height="14" /></p>
<p>The final result involves <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_43.gif" alt="" width="17" height="12" />, which tends to 1 as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_44.gif" alt="" width="37" height="14" />. Therefore, in this simple example, all the methods yield good results. It is straightforward to show that many common textbook examples (see e.g. [<a href="#Mukhanov-Winitzki">3</a>]) can be performed in this way.</p>
<h4>Case 5</h4>
<p>Finally, our main goal is to show that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_45.gif" alt="" width="72" height="14" /> can also perform the task reliably. First do the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_46.gif" alt="" width="10" height="12" /> prescription.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_11.gif" alt="" width="525" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_12.gif" alt="" width="86" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_8.gif" alt="" width="302" height="15" /></p>
<p>Here we see the first instance where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_47.gif" alt="" width="10" height="12" /> prescription starts to fail: when performed numerically, the most basic setting does not work, and increasing the working precision does not help much.</p>
<p>Remark: The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_48.gif" alt="" width="36" height="13" /> command silences all error messages and is used for readability. In practice, in order to discover the issues and possibly infer the sources of problems, it is useful to not use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_49.gif" alt="" width="36" height="13" /> on a first try.</p>
<h4>Case 6: Numerical Contour Integration</h4>
<p>Now do the contour integral using a triangular contour.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_13.gif" alt="" width="502" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_14.gif" alt="" width="170" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_9.gif" alt="" width="278" height="18" /></p>
<p>The contour integration works as is without further modification. The size of the contour does not matter, as long as it is not so small that it leads to numerical instabilities associated with small numbers.</p>
<p>We refer to the numerical computation using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_50.gif" alt="" width="72" height="14" /> that involves contour deformation in the complex plane as numerical contour integration. We will see recurring examples where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_51.gif" alt="" width="10" height="12" /> prescriptions, albeit simplest to implement, almost never work when needed in spite of optimizing various settings. Thus numerical contour integration is a highly competitive technique to use.</p>
<h3>Example 2: Two-Dimensional Integral on <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_52b.gif" alt="" width="19" height="19" /> over a Distribution</h3>
<p>(Remark: Some of the discussion here was briefly outlined in [<a href="#Tjoa">4</a>, <a href="#Tjoa-Mann">5</a>], which is based on what this article contains.)</p>
<p>The main example we consider in this article involves the integral over a distribution or bi-distribution of the form</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_4.gif" alt="" width="404" height="44" /></td>
<td class="DisplayFormulaNumberedLabel">(4)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_53.gif" alt="" width="32" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_54.gif" alt="" width="28" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_55.gif" alt="" width="25" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_56.gif" alt="" width="50" height="12" /> is a distribution or bi-distribution given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_5.gif" alt="" width="301" height="41" /></td>
<td class="DisplayFormulaNumberedLabel">(5)</td>
</tr>
</tbody>
</table>
<p>In physics, more specifically quantum field theory, this distribution is the two-point vacuum correlation function (also called the two-point Wightman function) of a massless scalar field in (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_57.gif" alt="" width="24" height="12" />)-dimensional Minkowski space [<a href="#Birrell-Davies">6</a>].</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_6.gif" alt="" width="246" height="26" /></td>
<td class="DisplayFormulaNumberedLabel">(6)</td>
</tr>
</tbody>
</table>
<p>The arguments of the two-point function are the coordinates of two spacetime events <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_58.gif" alt="" width="25" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_59.gif" alt="" width="32" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_60.gif" alt="" width="59" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_61.gif" alt="" width="68" height="12" /> in Cartesian coordinates and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_62.gif" alt="" width="5" height="12" />. The integral <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_63.gif" alt="" width="43" height="12" /> is evaluated at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_64.gif" alt="" width="29" height="12" /> and is thus independent of the spatial coordinates. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_65.gif" alt="" width="10" height="12" /> prescription tells us that the Wightman function is a distribution or bi-distribution [<a href="#Birrell-Davies">6</a>].</p>
<p>Our task is to evaluate the integral <img style="vertical-align: middle;" title="J_1(Omega,sigma)" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_1.gif" alt="J_1(Omega,sigma)" width="43" height="12" /> in (<a href="#Eq:4">4</a>). This is a two-dimensional complex integral over <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_66.gif" alt="" width="4" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_67.gif" alt="" width="8" height="12" /> with a continuum of poles at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_68.gif" alt="" width="48" height="12" /> for any fixed <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_69.gif" alt="" width="25" height="12" />. In the literature, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_70.gif" alt="" width="43" height="12" /> gives the transition probability (divided by a small coupling constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_71.gif" alt="" width="12" height="15" />) of an Unruh<span class="special-character Dash">–</span>DeWitt (UDW) detector consisting of a two-level quantum system (qubit) with energy gap <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_72.gif" alt="" width="9" height="12" /> interacting with the massless scalar field for a finite duration prescribed by the Gaussian function with timescale set by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_73.gif" alt="" width="8" height="12" /> (see e.g. [<a href="#Smith">7</a>] and references therein). The Gaussian functions in the integrand ensure that the interaction between the detector and the quantum field <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_74.gif" alt="" width="7" height="12" /> is adiabatically switched on and off smoothly; that is, the Fourier transform of the Wightman function has polynomial tails and is strongly suppressed by the exponential tails of the Fourier transform of the Gaussians. This guarantees that there is no spurious divergence in the transition probability due to switching on the detector very sharply or suddenly, such as with a switching function with discontinuity at an endpoint, like a rectangular function, which is unphysical. An analogy is switching on a lightbulb: in realistic scenarios the current in the circuit does not simply increase from zero to a constant value instantaneously, but rather smoothly over some short time interval.</p>
<p>The example in equation (<a href="#Eq:4">4</a>) is important for three reasons.</p>
<p>1. It is one of the simplest examples in quantum field theory; many other examples in physics involve distributions that take similar and sometimes more complicated forms (e.g. different power laws <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_75.gif" alt="" width="60" height="12" /> where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_76.gif" alt="" width="26" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_77.gif" alt="" width="75" height="15" /> for some function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_78.gif" alt="" width="7" height="12" />).</p>
<p>2. It is one of the simplest examples of a two-dimensional integral with a continuum of poles, thus going beyond standard textbook examples (e.g. in [<a href="#Mukhanov-Winitzki">3</a>] all the examples are one dimensional).</p>
<p>3. Despite its somewhat complicated appearance, it admits a closed-form expression [<a href="#Smith">7</a>].</p>
<h4>Benchmark Value for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_79.gif" alt="" width="12" height="14" /></h4>
<p>In [<a href="#Smith">7</a>] it is shown that the exact closed-form expression is given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_7.gif" alt="" width="282" height="37" /></td>
<td class="DisplayFormulaNumberedLabel">(7)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_80.gif" alt="" width="33" height="12" /> is the complementary error function. We want to show that numerically this result can be obtained in a satisfactory way. For this purpose, let us focus on a particular numerical value by setting <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_81.gif" alt="" width="39" height="12" />, so that</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_8.gif" alt="" width="154" height="18" /></td>
<td class="DisplayFormulaNumberedLabel">(8)</td>
</tr>
</tbody>
</table>
<p>We can then use this value as a benchmark for our methods.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_15.gif" alt="" width="347" height="32" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_16.gif" alt="" width="100" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_10.gif" alt="" width="72" height="13" /></p>
<h4>Direct <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_82.gif" alt="" width="13" height="16" /> Integration</h4>
<p>Direct <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_83.gif" alt="" width="11" height="12" /> integration for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_84.gif" alt="" width="11" height="12" /> is given by the following command.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_17.gif" alt="" width="580" height="84" /></p>
<p>The most modest settings yield poor results.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_18.gif" alt="" width="555" height="59" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_11.gif" alt="" width="242" height="70" /></p>
<p>Clearly, although the real parts are all positive (hence physically at least sensible for a transition probability), the results are very different from the benchmark value. The third value is wrong because the probabilities should be real (hence numerically the imaginary part should be much closer to zero).</p>
<p>Increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_85.gif" alt="" width="86" height="13" /> as a first remedy does not help much, if at all.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_19.gif" alt="" width="555" height="59" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_12.gif" alt="" width="243" height="62" /></p>
<h4>Restricting the Domain</h4>
<p>Restricting the integration domain to (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_86.gif" alt="" width="25" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_87.gif" alt="" width="16" height="12" />), where the Gaussian is strongly supported, improves the result, but not enough. (The negligible part of the integral associated to Gaussian tails was ignored.) To see that the behavior scales badly with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_88.gif" alt="" width="5" height="12" />, let us choose a particular setting.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_20.gif" alt="" width="555" height="59" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_13.gif" alt="" width="263" height="106" /></p>
<p>The first two entries, while not accurate enough, are again at least physically valid results because the imaginary part is negligible and hence can represent transition probabilities. In contrast, the last three values have negative real parts and are thus invalid by default.</p>
<p>We leave it to the reader to verify that other possible settings, such as increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_89.gif" alt="" width="115" height="14" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_90.gif" alt="" width="86" height="14" />, do not help, nor does changing the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_91.gif" alt="" width="43" height="13" /> setting from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_92.gif" alt="" width="101" height="14" /> to another. There may be some combination of settings that makes this integration work, but if they exist then they are for our purposes not worth the time. We will in fact show that the exact same setting that yields the bad results above does work with numerical contour integration.</p>
<p>A possible reason for these issues is that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_93.gif" alt="" width="10" height="12" /> prescription changes the asymptotic behavior at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_94.gif" alt="" width="52" height="12" />. Numerically, we are evaluating the integral from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_95.gif" alt="" width="59" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_96.gif" alt="" width="50" height="12" />, so <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_97.gif" alt="" width="72" height="14" /> has to deal with points at infinity that are shifted with a very small imaginary component.</p>
<h4>Numerical Contour Integration</h4>
<p>Here <img style="vertical-align: middle;" title="J_1" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_3.gif" alt="J_1" width="11" height="12" /> is transformed into a numerical contour integral, <img style="vertical-align: middle;" title="J_3" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_5.gif" alt="J_3" width="11" height="12" />. In contrast to the previous subsection, the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_98.gif" alt="" width="5" height="12" />-regulator now serves as a contour deformation near a reasonably shaped contour. Hence the asymptotic behavior of the integral is not altered by varying <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_99.gif" alt="" width="5" height="12" />.</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_9.gif" alt="" width="380" height="46" /></td>
<td class="DisplayFormulaNumberedLabel">(9)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_100.gif" alt="" width="19" height="12" /> is a contour along the real line but deformed around the poles of the Wightman function. Here we have <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_101.gif" alt="" width="25" height="12" /> in the Wightman function because we have converted the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_102.gif" alt="" width="10" height="12" /> prescription into an instruction to perform contour integration, so the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_103.gif" alt="" width="5" height="12" /> is now part of the definition of the contour <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_104.gif" alt="" width="6" height="12" />.</p>
<p>Here is the contour <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_105.gif" alt="" width="19" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_106.gif" alt="" width="26" height="12" /> is the location of the continuum of poles for every fixed <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_107.gif" alt="" width="4" height="12" />.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_14.gif" alt="" width="360" height="152" /></p>
<p>Since many contours work, let us first choose a particularly simple one: a rectangular deformation near the poles. If we integrate over <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_108.gif" alt="" width="8" height="12" /> first, then the continuum of poles is located in the complex plane at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_109.gif" alt="" width="26" height="12" />. Therefore, the contour <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_110.gif" alt="" width="6" height="12" /> should be deformed to the upper complex plane.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_21.gif" alt="" width="560" height="100" /></p>
<p>Based on the previous subsection, we see that using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_111.gif" alt="" width="50" height="12" /> yields a better answer, since more than 99.99% of the area of the Gaussian in the integrand is contained in the interval <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_112.gif" alt="" width="56" height="12" />. We will not set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_113.gif" alt="" width="44" height="12" /> in what follows. Consequently, the parts of the contour from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_114.gif" alt="" width="19" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_115.gif" alt="" width="25" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_116.gif" alt="" width="16" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_117.gif" alt="" width="10" height="12" /> have been truncated and do not yield significant error. This gives the following results.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_22.gif" alt="" width="563" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_15.gif" alt="" width="242" height="80" /></p>
<p>This result may look undesirable, but the first value is numerically the same as the benchmark value up to very small imaginary part. This suggests that in the neighborhood of <img style="vertical-align: middle;" title="epsilon approx 10" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_7.gif" alt="epsilon approx 10" width="31" height="12" /> there is a good range that we can use to get a numerically accurate result; we will show that the result is invariant under smooth deformation of the contour. For example, if we zoom in between <img style="vertical-align: middle;" title="epsilon approx 10^1" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_9.gif" alt="epsilon approx 10^1" width="37" height="15" /> and <img style="vertical-align: middle;" title="epsilon approx 10^2" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_11.gif" alt="epsilon approx 10^2" width="37" height="15" />, we get the following results.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_23.gif" alt="" width="536" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_16.gif" alt="" width="227" height="168" /></p>
<p>That the results are unchanged as we vary <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_118.gif" alt="" width="5" height="12" /> (only the negligible error changes a little) is what we expect from the deformation theorem in complex analysis, since the deformation does not cross any singularities. This invariance under contour deformation is very useful because it is one of the consistency checks we can do (or perhaps need to do) in the absence of exact closed-form expressions and other cross-validation. Direct <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_119.gif" alt="" width="10" height="12" /> integration does not allow this, because every <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_120.gif" alt="" width="5" height="12" /> yields different values (because the asymptotics are also shifted by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_121.gif" alt="" width="10" height="12" />). Furthermore, numerical contour integration is also remarkably fast.</p>
<h4>A Different Contour</h4>
<p>Here is a different contour. The width is fixed but the height toward the imaginary axis varies.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_17b.gif" alt="" width="360" height="194" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_24.gif" alt="" width="560" height="84" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_25.gif" alt="" width="563" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_18.gif" alt="" width="263" height="122" /></p>
<p>This choice of contour highlights that while contour integration is much more powerful than the direct <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_122.gif" alt="" width="10" height="12" /> integration method, one should avoid numerical issues associated with values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_123.gif" alt="" width="5" height="12" /> that are either too large or too small; sometimes different contours yield different stability. Nonetheless, the main takeaway is that we have found that there is a large enough range of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_124.gif" alt="" width="5" height="12" /> for which the contour can be varied but still yields the correct value (in this case, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_125.gif" alt="" width="61" height="15" />). In this range, we can vary <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_126.gif" alt="" width="5" height="12" /> and the answer is invariant. The correct range of <img style="vertical-align: middle;" title="epsilon" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_13.gif" alt="epsilon" width="5" height="12" /> that provides reliable results must however be found empirically and depends strongly on the integrand. For completeness, we show the results for zooming into the range of <img style="vertical-align: middle;" title="epsilon" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_15.gif" alt="epsilon" width="5" height="12" /> (except that this time we need this to be <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_127.gif" alt="" width="58" height="12" />).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_26.gif" alt="" width="579" height="58" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_19.gif" alt="" width="235" height="188" /></p>
<p>A significant advantage of numerical contour integration over direct <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_128.gif" alt="" width="10" height="12" /> integration is that it allows for robust consistency check: if we can find a range for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_129.gif" alt="" width="5" height="12" /> in which the integral is constant (up to small numerical errors like a small imaginary part), then the integral is likely to be correct. This is an extremely important necessary condition, especially when a closed-form expression is not available. Of course, if there are other ways to check the correctness of the value (as in this example where we know the exact closed-form expression or if there are physical arguments to back it up), we should always also perform these other checks.</p>
<h3>Example 3: Two-Dimensional Integral over a Distribution Containing the Heaviside Step Function</h3>
<p>Next, we consider a more complicated integral,</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_10.gif" alt="" width="580" height="44" /></td>
<td class="DisplayFormulaNumberedLabel">(10)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_130.gif" alt="" width="32" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_131.gif" alt="" width="28" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_132.gif" alt="" width="25" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_133.gif" alt="" width="18" height="12" /> is the Heaviside step function and the two-point Wightman function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_134.gif" alt="" width="77" height="12" /> is given in equation (<a href="#Eq:5">5</a>). This integral differs conceptually from Example 2 in two respects:</p>
<p>(1) the additional Heaviside step function in the integrand</p>
<p>(2) we also allow for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_135.gif" alt="" width="29" height="12" /> and changed the sign on the phase</p>
<p>The Heaviside step function appearing in the integrand naturally arises in physics calculations where a Dyson series expansion is involved (i.e. where the notion of time ordering is necessary). In particular, this occurs in various time-dependent perturbation theory calculations within quantum mechanics and quantum field theory. The specific integral in (<a href="#Eq:10">10</a>) appears as part of the calculation of the nonlocal part of the joint two-detector density matrix of two qubits interacting with a massless scalar field in the so-called entanglement harvesting protocol [<a href="#Smith">7</a>, <a href="#Steeg-Menicucci">8</a>].</p>
<p>Perhaps somewhat surprisingly, this integral admits a closed-form solution [<a href="#Smith">7</a>], given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_11.gif" alt="" width="284" height="45" /></td>
<td class="DisplayFormulaNumberedLabel">(11)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_136.gif" alt="" width="60" height="14" />. As before, we can assume that the coordinate system is aligned so that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_137.gif" alt="" width="156" height="12" />.</p>
<h4>Benchmark Value for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_138.gif" alt="" width="15" height="14" /></h4>
<p>For benchmarking, assume <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_139.gif" alt="" width="39" height="12" /> and set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_140.gif" alt="" width="29" height="12" />. This gives</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_12.gif" alt="" width="286" height="15" /></td>
<td class="DisplayFormulaNumberedLabel">(12)</td>
</tr>
</tbody>
</table>
<p>Here is the calculation.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_27.gif" alt="" width="402" height="37" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_28.gif" alt="" width="86" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_20.gif" alt="" width="161" height="13" /></p>
<p>This is an alternative if one prefers arbitrary <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_141.gif" alt="" width="8" height="12" /> in the expression.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_29.gif" alt="" width="111" height="18" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_21.gif" alt="" width="161" height="13" /></p>
<p>This number is complex, so we no longer have the benefit of verifying our numerical calculation by requiring that the imaginary part be small (which we used in Example <a href="Example:2">2</a>).</p>
<p>Let us now evaluate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_142.gif" alt="" width="46" height="12" /> numerically. We will not bother with the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_143.gif" alt="" width="10" height="12" /> prescription anymore because it does not work; this is not surprising since the Heaviside step function only complicates the integral compared to Example <a href="Example:2">2</a>. However, we will evaluate this integral in two ways, both using numerical contour integration, with the two methods differing in how they handle the Heaviside step function.</p>
<h4>Absorbing the Heaviside Function into the Upper Limit</h4>
<p>We rewrite the integral <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_144.gif" alt="" width="14" height="12" /> as:</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_13.gif" alt="" width="580" height="68" /></td>
<td class="DisplayFormulaNumberedLabel">(13)</td>
</tr>
</tbody>
</table>
<p>By suitable relabeling, the two integrals are equal (this property is used in [<a href="#Smith">7</a>, <a href="#Steeg-Menicucci">8</a>]), but we will not need this fact, since in more general situations the two integrals are different. (See e.g. [<a href="#Tjoa-Mann">5</a>, <a href="#Gallock-Yoshimura">9</a>], where the upper limits differ slightly by a <span class="special-character OpenCurlyDoubleQuote">“</span>relative redshift<span class="special-character CloseCurlyDoubleQuote">”</span> factor.) Although equation (<a href="#Eq:13">13</a>) is written in the notation of an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_145.gif" alt="" width="10" height="12" /> prescription, this is merely a shorthand for performing the numerical contour integration, since we already know that direct <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_146.gif" alt="" width="10" height="12" /> integration does not work.</p>
<p>Pick a rectangular contour and set it so that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_147.gif" alt="" width="156" height="12" />. For this choice, the two integrals have a continuum of poles at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_148.gif" alt="" width="45" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_149.gif" alt="" width="45" height="12" />, respectively. The contour will be chosen so that it does not cross any poles as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_150.gif" alt="" width="5" height="12" /> varies.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_22b.gif" alt="" width="360" height="194" /></p>
<p>We can then write the following integral command.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_30.gif" alt="" width="580" height="155" /></p>
<p>The most modest settings yield good results.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_31.gif" alt="" width="580" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_23.gif" alt="" width="240" height="112" /></p>
<p>The contour parameter <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_151.gif" alt="" width="5" height="12" /> is good in the range <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_152.gif" alt="" width="45" height="18" /> and starts to deviate at around <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_153.gif" alt="" width="24" height="15" />. Remarkably, we can compute this result very well despite the extra complications, with nearly no additional settings beyond <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_154.gif" alt="" width="110" height="13" />.</p>
<h4>Approximate Heaviside Step Function</h4>
<p>The integral in equation (<a href="#Eq:9">9</a>) is actually written in a more useful form than the upper limit form in equation (<a href="#Eq:12">12</a>), in the sense that it accommodates a more general scenario where the two-point functions may not be simple functions of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_155.gif" alt="" width="4" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_156.gif" alt="" width="8" height="12" /><em>.</em> In general, the poles of the Wightman functions for the problem at hand can be located at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_157.gif" alt="" width="41" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_158.gif" alt="" width="7" height="12" /> is some function that does not have a simple inverse. In such a situation, the upper limit of the integrals is not simply <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_159.gif" alt="" width="4" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_160.gif" alt="" width="8" height="12" /> and may have to be worked out numerically.</p>
<p>More specifically, in the context of quantum field theory in curved spacetimes, the Wightman function in equation (<a href="#Eq:5">5</a>) is given in flat spacetime in terms of the Minkowski coordinates, and the integrals we computed thus far correspond to two Unruh<span class="special-character Dash">–</span>DeWitt (UDW) detectors separated by proper distance <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_161.gif" alt="" width="7" height="12" />, both of which are at rest relative to this coordinate system. When the detectors are in motion, we have to replace <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_162.gif" alt="" width="24" height="12" /> with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_163.gif" alt="" width="49" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_164.gif" alt="" width="4" height="12" /> is Minkowski coordinate time and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_165.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_166.gif" alt="" width="7" height="12" /> are the proper times of each detector, which take the roles of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_167.gif" alt="" width="4" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_168.gif" alt="" width="8" height="12" /> in the previous sections. Similarly, we have to replace <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_169.gif" alt="" width="27" height="12" /> with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_170.gif" alt="" width="53" height="12" />, where now <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_171.gif" alt="" width="6" height="12" /> takes the role of Minkowski spatial coordinates. In this case, in general it is not true that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_172.gif" alt="" width="6" height="12" /> is a simple function of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_173.gif" alt="" width="7" height="12" />, so it may not always be possible to find an upper limit version similar to equation (<a href="#Eq:12">12</a>). The static detectors (at rest relative to Minkowski coordinates) correspond to the special case where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_174.gif" alt="" width="88" height="12" />, which can then be rewritten as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_175.gif" alt="" width="24" height="12" />. This complexity occurs more generally when the spacetime is not flat, such as when we consider two-dimensional truncation of Schwarzschild spacetime [<a href="#Tjoa-Mann">5</a>].</p>
<p>For this reason, it is useful to try to integrate equation (<a href="#Eq:10">10</a>) using the Heaviside step function directly. Since the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_176.gif" alt="" width="101" height="13" /> is not defined for complex numbers, we approximate it with a smooth function. For example, the Heaviside step function is a limit of a logistic function:</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_14.gif" alt="" width="201" height="34" /></td>
<td class="DisplayFormulaNumberedLabel">(14)</td>
</tr>
</tbody>
</table>
<p>provided that we define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_177.gif" alt="" width="42" height="23" />. We can thus define an approximate Heaviside step function for any fixed <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_178.gif" alt="" width="26" height="12" /> by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_15.gif" alt="" width="140" height="34" /></td>
<td class="DisplayFormulaNumberedLabel">(15)</td>
</tr>
</tbody>
</table>
<p>Any other function used in computing a cumulative probability distribution would work.</p>
<p>Our integral <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_179.gif" alt="" width="14" height="12" /> now becomes</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_16.gif" alt="" width="560" height="45" /></td>
<td class="DisplayFormulaNumberedLabel">(16)</td>
</tr>
</tbody>
</table>
<p>again with the rectangular contour of Figure 2. The task now is to manually find <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_180.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_181.gif" alt="" width="5" height="12" /> that yield good results by trial and error. Again we set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_182.gif" alt="" width="156" height="12" /> so that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_183.gif" alt="" width="60" height="14" />.</p>
<p>We define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_184.gif" alt="" width="7" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_185.gif" alt="" width="14" height="13" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_32.gif" alt="" width="191" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_33.gif" alt="" width="580" height="155" /></p>
<p>The results are promising, since there is a range of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_186.gif" alt="" width="5" height="12" /> that gives a result very close to the benchmark <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_187.gif" alt="" width="156" height="12" />, but we can do better.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_34.gif" alt="" width="580" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_24.gif" alt="" width="253" height="112" /></p>
<p>The key is to set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_188.gif" alt="" width="37" height="15" /> so that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_189.gif" alt="" width="50" height="12" />. For example, for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_190.gif" alt="" width="26" height="12" />, a good choice of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_191.gif" alt="" width="5" height="12" /> is 1/5 but not 1 or 1/12. The only difference in the next command from the last is in the fourth argument of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_192.gif" alt="" width="14" height="13" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_193.gif" alt="" width="7" height="13" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_194.gif" alt="" width="17" height="12" /> instead of 5. The results are slightly better.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_35.gif" alt="" width="580" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_25.gif" alt="" width="260" height="112" /></p>
<p>We can study this relationship better for a smaller set of values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_195.gif" alt="" width="6" height="12" /> and judge the quality.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_36.gif" alt="" width="580" height="58" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_26.gif" alt="" width="200" height="142" /></p>
<p>Thus we have obtained a good range of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_186.gif" alt="" width="5" height="12" /> where the deformation theorem clearly works. We need to work with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_196.gif" alt="" width="33" height="12" /> because the smooth approximation of the Heaviside step functions introduces infinitely many new poles in the complex plane, since <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_197.gif" alt="" width="23" height="12" /> has (countably) infinitely many poles along the imaginary axis. This can be easily seen by rewriting <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_198.gif" alt="" width="10" height="12" /> as:</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_17.gif" alt="" width="222" height="39" /></td>
<td class="DisplayFormulaNumberedLabel">(17)</td>
</tr>
</tbody>
</table>
<p>Therefore the choice of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_199.gif" alt="" width="6" height="12" /> must depend on <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_200.gif" alt="" width="5" height="12" /> so that the contour does not cross extra poles, making the integral gain spurious contributions. Nonetheless, finding the right <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_201.gif" alt="" width="6" height="12" /> that works is an empirical process, especially when the Wightman function is very complicated. Our examples thus far are simple enough that they can be easily cross-validated and evaluated without much effort.</p>
<h3>Further Applications</h3>
<p>The above examples have been used by the author to calculate the density matrix elements of Unruh<span class="special-character Dash">–</span>DeWitt detectors interacting with massless scalar fields for various background spacetimes, where the calculations require time-dependent perturbation theory involving Dyson series expansions. Starting from the calculations in [<a href="#Tjoa">4</a>] where a primitive version was first used to study entanglement harvesting in two-dimensional spacetimes with accelerating mirror (see the Appendix in [<a href="#Tjoa">4</a>]), the technique was subsequently improved (using a full rectangular contour that is not close to the poles) for the entanglement harvesting problem in Schwarzschild and collapsing shell spacetimes [<a href="#Tjoa-Mann">5</a>]. In [<a href="#Tjoa-Mann">5</a>], the derivative-coupling functions (strictly speaking they are not Wightman functions but the proper time derivatives of the Wightman functions) are so complicated that it is somewhat surprising the upper-limit technique outlined above worked very well across large parameter spaces. The author has verified that the approximation of the Heaviside step function works well for calculations in [<a href="#Tjoa-Mann">5</a>], although with the caveat: when the derivative-coupling Wightman functions can be expressed as a sum of distinct terms, the part of the derivative Wightman function that contains <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_202.gif" alt="" width="27" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_203.gif" alt="" width="33" height="12" /> requires relatively small <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_204.gif" alt="" width="6" height="12" /> but the part that contains <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_205.gif" alt="" width="25" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_206.gif" alt="" width="31" height="12" /> may need very large <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_207.gif" alt="" width="44" height="15" />. This highlights the need for empirically testing the choice of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_208.gif" alt="" width="6" height="12" /> before proceeding with physical calculations.</p>
<p>We extend the results of [<a href="#Tjoa-Mann">5</a>] for harvesting of correlations by two quantum-mechanical detectors interacting with a quantum field in [<a href="#Gallock-Yoshimura">9</a>], where we consider more complicated detector trajectories. In this context, the authors verified that the upper-limit form analogous to equation (<a href="#Eq:12">12</a>) proved numerically unstable in physically relevant regimes, thus making indispensable the approximate Heaviside step functions as a way to calculate the nonlocal correlation term in entanglement harvesting contexts. In that setting, the calculation of the nonlocal term involves an integral similar to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_209.gif" alt="" width="14" height="12" /> in equation (<a href="#Eq:10">10</a>, but with much more complicated numerical calculations than in [<a href="#Tjoa-Mann">5</a>]; in particular the upper limits are not simply affine functions of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_210.gif" alt="" width="6" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_211.gif" alt="" width="9" height="12" />. We will explain the technicalities specific to the problem at hand when invoking the techniques outlined in [<a href="#Gallock-Yoshimura">9</a>].</p>
<p>In quantum field theory in generic spacetimes (flat or curved), there are many situations of computing integrals over distributions. Our techniques should be general enough to use in such contexts, where correlation functions take a form similar to Wightman functions. For example, we have verified that our techniques work for computing field commutators [<a href="#Tjoa-Mann">5</a>] and in (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_212.gif" alt="" width="24" height="12" />)-dimensional rotating BTZ black holes [<a href="#Robbins-Henderson-Mann">10</a>, <a href="#Henderson-Hennigar">11</a>]. We are also able to reproduce the computations of transition rates as done for example in [<a href="#Louko-Satz">12</a>] (also see Appendix of [<a href="#Tjoa">4</a>]), which are fundamentally simpler because they are one-dimensional integrals over the Wightman functions.</p>
<h3>Conclusion</h3>
<p>In this article we have presented a straightforward implementation of contour integration using the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_213.gif" alt="" width="65" height="14" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_214.gif" alt="" width="72" height="14" /> commands, taking advantage of powerful results in complex analysis. The goal is to provide a systematic example-based implementation of contour integration that does not require any user-defined functions and only requires setting options. We provide explicit examples of how this can be used when integrating analytically and numerically some commonly used distributions, such as Wightman functions in quantum field theory. We also provide efficient approximation schemes to compute quantities involving time-ordering operations where Heaviside step functions are required. Our examples are geared toward research in relativistic quantum information, where finite-dimensional quantum systems interact with a quantum field on a possible curved background spacetime. We believe our implementation will be useful for calculations involving various Green<span class="special-character CloseCurlyQuote">’</span>s functions, propagators, integral kernels and so on for both students and researchers in fields requiring numerical evaluations of integrals over distributions without resorting to unnecessary or excessive approximation schemes.</p>
<h3>Acknowledgments</h3>
<p>The author thanks Kensuke Gallock-Yoshimura for help in testing the numerical schemes proposed here in [<a href="#Gallock-Yoshimura">9</a>], and Nicholas Funai for reading through the draft and providing useful feedback. The author acknowledges support from the Mike-Ophelia Lazaridis Fellowship from the Institute for Quantum Computing (IQC), University of Waterloo, Canada. The author also would like to thank both the reviewer and editor for very useful and clarifying comments and recommendations.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Howie"></a>[1]</td>
<td>J. M. Howie, <em>Complex Analysis</em>, London: Springer Science &amp; Business Media, 2003.</td>
</tr>
<tr>
<td class="Reference"><a name="Brown-Churchill"></a>[2]</td>
<td>J. W. Brown and R. V. Churchill, <em>Complex Variables and Applications</em>, 8th ed., New York: McGraw-Hill Education, 2009.</td>
</tr>
<tr>
<td class="Reference"><a name="Mukhanov-Winitzki"></a>[3]</td>
<td>V. Mukhanov and S. Winitzki, <em>Introduction to Quantum Effects in Gravity</em>, New York: Cambridge University Press, 2007.</td>
</tr>
<tr>
<td class="Reference"><a name="Tjoa"></a>[4]</td>
<td>E. Tjoa. <em><span class="special-character OpenCurlyDoubleQuote">“</span></em>Aspects of Quantum Field Theory with Boundary Conditions,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>UWSpace</em>, 2019. <a href="http://hdl.handle.net/10012/14843" target="_blank">hdl.handle.net/10012/14843</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Tjoa-Mann"></a>[5]</td>
<td>E. Tjoa and R. B. Mann, <span class="special-character OpenCurlyDoubleQuote">“</span>Harvesting Correlations in Schwarzschild and Collapsing Shell Spacetimes,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Journal of High Energy Physics</em>, <strong>08</strong>(155), 2020. <a href="https://doi.org/10.1007/JHEP08(2020)155" target="_blank">doi.org:10.1007/JHEP08(2020)155</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Birrell-Davies"></a>[6]</td>
<td>N. D. Birrell and P. C. W. Davies, <em>Quantum Fields in Curved Space</em>, Cambridge: Cambridge University Press, 1982.</td>
</tr>
<tr>
<td class="Reference"><a name="Smith"></a>[7]</td>
<td>A. R. H. Smith. <span class="special-character OpenCurlyDoubleQuote">“</span>Detectors, Reference Frames, and Time,<span class="special-character CloseCurlyDoubleQuote">”</span><em> UWSpace</em>, 2017. <a href="http://hdl.handle.net/10012/12618" target="_blank">hdl.handle.net/10012/12618</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Steeg-Menicucci"></a>[8]</td>
<td>G. Ver Steeg and N. C. Menicucci, <span class="special-character OpenCurlyDoubleQuote">“</span>Entangling Power of an Expanding Universe,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Physical Review D</em>, <strong>79</strong>(4), 2009 044027. <a href="https://doi.org/10.1103/PhysRevD.79.044027" target="_blank">doi.org:10.1103/PhysRevD.79.044027</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Gallock-Yoshimura"></a>[9]</td>
<td>K. Gallock-Yoshimura, E. Tjoa and R. B. Mann, <span class="special-character OpenCurlyDoubleQuote">“</span>Harvesting Entanglement with Detectors Freely Falling into a Black Hole.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://arxiv.org/abs/2102.09573" target="_blank">arxiv.org/abs/2102.09573</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Robbins-Henderson-Mann"></a>[10]</td>
<td>M. P. G. Robbins, L. J. Henderson and R. B. Mann, <span class="special-character OpenCurlyDoubleQuote">“</span>Entanglement Amplification from Rotating Black Holes.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://arxiv.org/abs/2010.14517" target="_blank">arxiv.org/abs/2010.14517</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Henderson-Hennigar"></a>[11]</td>
<td>L. J. Henderson, R. A. Hennigar, R. B. Mann, A. R. H. Smith and J. Zhang, <span class="special-character OpenCurlyDoubleQuote">“</span>Harvesting Entanglement from the Black Hole Vacuum,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Classical and Quantum Gravity</em>, <strong>35</strong>(21) 21LT02, 2018. <a href="https://doi.org/10.1088/1361-6382/aae27e" target="_blank">doi.org/10.1088/1361-6382/aae27e</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Louko-Satz"></a>[12]</td>
<td>J. Louko and A. Satz, <span class="special-character OpenCurlyDoubleQuote">“</span>Transition Rate of the Unruh<span class="special-character Dash">–</span>DeWitt Detector in Curved Spacetime,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Classical and Quantum Gravity</em>, <strong>25</strong>(5) 055012, 2008.<br />
<a href="https://doi.org/10.1088/0264-9381/25/5/055012" target="_blank">doi.org/10.1088/0264-9381/25/5/055012</a>.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>Erickson Tjoa, <span class="special-character OpenCurlyDoubleQuote">“</span>Numerical Contour Integration,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2021. <a href="https://doi.org/10.3888/tmj.23-3">doi.org/10.3888/tmj.23<span class="special-character Dash">–</span>3</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Erickson Tjoa was born in Jakarta, Indonesia. He moved to Singapore at the age of 15 and studied physics and mathematics as a double major at Nanyang Technological University from 2013-2017. He then completed an MSc at the University of Waterloo, where he is currently a second-year PhD student in relativistic quantum information.</p>
<p class="TextAboutAuthor"><strong>Erickson Tjoa<br />
</strong><em>Department of Physics and Astronomy<br />
Institute for Quantum Computing (IQC)<br />
University of Waterloo, ON, Canada<br />
200 University Avenue West<br />
Waterloo, ON, Canada N2L 3G1</em><br />
<em><a href="mailto:e2tjoa@uwaterloo.ca">e2tjoa@uwaterloo.ca</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2021/07/16/numerical-contour-integration/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Unconditional Applicability of Lehmer&#8217;s Measure to the Two-Term Machin-like Formula for π</title>
		<link>https://www.mathematica-journal.com/2021/05/24/unconditional-applicability-of-lehmers-measure-to-the-two-term-machin-like-formula-for-%cf%80/</link>
		<comments>https://www.mathematica-journal.com/2021/05/24/unconditional-applicability-of-lehmers-measure-to-the-two-term-machin-like-formula-for-%cf%80/#respond</comments>
		<pubDate>Mon, 24 May 2021 15:04:10 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 23]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=61089</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.23-2 &#160; Lehmer defined a measure where the may be either integers or rational numbers in a Machin-like formula for . When the are integers, Lehmer’s measure can be used to determine the computational efficiency of the given Machin-like formula for . However, because the computations are complicated, it is unclear if Lehmer’s measure applies [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.23-2">https://doi.org/10.3888/tmj.23-2</a></span></div>
<p>&nbsp;</p>
<div>
<p>Lehmer defined a measure</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_1.gif" alt="" width="112" height="37" /></p>
<p>where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_1.gif" alt="" width="13" height="16" /> may be either integers or rational numbers in a Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_2.gif" alt="" width="7" height="14" />. When the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_3.gif" alt="" width="13" height="16" /> are integers, Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure can be used to determine the computational efficiency of the given Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_4.gif" alt="" width="7" height="14" />. However, because the computations are complicated, it is unclear if Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure applies when one or more of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_5.gif" alt="" width="13" height="16" /> are rational. In this article, we develop a new algorithm for a two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_6.gif" alt="" width="7" height="14" /> as an example of the unconditional applicability of Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure. This approach does not involve any irrational numbers and may allow calculating <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_7.gif" alt="" width="7" height="14" /> rapidly by the Newton<span class="special-character Dash">–</span>Raphson iteration method for the tangent function.<span id="more-61089"></span></p>
<h3>1. Introduction</h3>
<p>In 1706, the English astronomer and mathematician John Machin discovered a two-term formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_8.gif" alt="" width="6" height="12" /> [<a href="#Beckmann">1</a>&#8211;<a href="#Borwein-Bailey">3</a>]</p>
<table class="DisplayFormulaNumbered"><a name="Eq:1"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_1.gif" alt="" width="156" height="33" /></td>
<td class="DisplayFormulaNumberedLabel">(1)</td>
</tr>
</tbody>
</table>
<p>that was later named in his honor. This formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_9.gif" alt="" width="6" height="12" /> appeared to be more efficient than any others known by that time. In particular, due to the relatively rapid convergence of the right-hand side of (<a href="#Eq:1">1</a>), he was able to calculate 100 decimal digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_10.gif" alt="" width="6" height="12" /> [<a href="#Beckmann">1</a>]. Nowadays, identities of the form</p>
<table class="DisplayFormulaNumbered"><a name="Eq:2"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_2.gif" alt="" width="113" height="42" /></td>
<td class="DisplayFormulaNumberedLabel">(2)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_11.gif" alt="" width="12" height="14" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_12.gif" alt="" width="12" height="14" /> are either integers or rational numbers, are called the Machin-like formulas for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_13.gif" alt="" width="6" height="12" />. Consequently, a two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_14.gif" alt="" width="6" height="12" /> is given by</p>
<table class="DisplayFormulaNumbered"><a name="Eq:3"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_3.gif" alt="" width="180" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(3)</td>
</tr>
</tbody>
</table>
<p>If in equation (<a href="#Eq:3">3</a>) the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_15.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_16.gif" alt="" width="13" height="12" /> are some positive integers and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_17.gif" alt="" width="33" height="12" />, then the unknown value <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_18.gif" alt="" width="13" height="12" /> can be found as [<a href="#Abrarov-Quine-1">4</a>, <a href="#Abrarov-Quine-2">5</a>]</p>
<table class="DisplayFormulaNumbered"><a name="Eq:4"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_4b.gif" alt="" width="344" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(4)</td>
</tr>
</tbody>
</table>
<p>Furthermore, since we assumed that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_19.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_20.gif" alt="" width="13" height="12" /> are positive integers, from equation (<a href="#Eq:4">4</a>) it immediately follows that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_21.gif" alt="" width="13" height="12" /> must be either an integer or a rational number.</p>
<p>In 1938, Lehmer [<a href="#Lehmer">6</a>] introduced a measure (see also [<a href="#Wetherfield">7</a>])</p>
<table class="DisplayFormulaNumbered"><a name="Eq:5"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_5.gif" alt="" width="96" height="42" /></td>
<td class="DisplayFormulaNumberedLabel">(5)</td>
</tr>
</tbody>
</table>
<p>showing how much computational effort is required for a specific Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_22.gif" alt="" width="6" height="12" />. In particular, when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_23.gif" alt="" width="7" height="12" /> is small, then less computational effort is required and, consequently, the computational efficiency of this formula is higher. Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure is smaller if there are fewer summation terms <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_24.gif" alt="" width="6" height="12" /> and the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_25.gif" alt="" width="12" height="14" /> are larger in magnitude. For more efficient computation, the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_26.gif" alt="" width="12" height="14" /> should be larger by absolute value, since it is easier to approximate the arctangent function as its argument tends to zero (see [<a href="#Wetherfield">7</a>] for more details).</p>
<p>It is also important to emphasize that in the same paper [<a href="#Lehmer">6</a>] Lehmer presented a few Machin-like formulas where some of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_27.gif" alt="" width="12" height="14" /> are not integers but rational numbers. This signifies that Lehmer assumed that his measure (<a href="#Eq:5">5</a>) remains valid whether the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_28.gif" alt="" width="12" height="14" /> are integers or rational numbers.</p>
<p>In 2002 Kanada [<a href="#Calcut">8</a>], using the following self-checking pair of Machin-like formulas for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_29.gif" alt="" width="6" height="12" />,</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_2.gif" alt="" width="368" height="33" /></p>
<p>and</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_3.gif" alt="" width="371" height="33" /></p>
<p>computed more than 1 trillion digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_30.gif" alt="" width="6" height="12" />. These two examples show that the Machin-like formulas have colossal potential in the computation of decimal digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_31.gif" alt="" width="6" height="12" />.</p>
<p>In 1997, Chien-Lih showed a remarkable formula [<a href="#Chien-Lih">9</a>]</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_4.gif" alt="" width="580" height="33" /></p>
<p>with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_32.gif" alt="" width="60" height="12" />. According to Weisstein [<a href="#Weisstein">10</a>], this Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure is the smallest known value for the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_33.gif" alt="" width="12" height="14" /> consisting of integers only. Later Chien-Lih [<a href="#Chien-Li-2004">11</a>] showed how Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure can be reduced even further by using an Euler type of identity in an iteration for generating the two-term Machin-like formulas like (<a href="#Eq:3">3</a>) such that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_34.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_35.gif" alt="" width="13" height="12" /> are rational numbers.</p>
<p>In [<a href="#Abrarov-Quine-3">12</a>], we derived the following simple identity (see also [<a href="#OEIS">13</a>])</p>
<table class="DisplayFormulaNumbered"><a name="Eq:6"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_6.gif" alt="" width="267" height="49" /></td>
<td class="DisplayFormulaNumberedLabel">(6)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_36.gif" alt="" width="31" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_37.gif" alt="" width="79" height="23" />, and described how using this identity, another efficient method for generating the two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_38.gif" alt="" width="6" height="12" /></p>
<table class="DisplayFormulaNumbered"><a name="Eq:7"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_7.gif" alt="" width="178" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(7)</td>
</tr>
</tbody>
</table>
<p>with small Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure can be developed. In this approach, the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_39.gif" alt="" width="13" height="12" /> can be chosen as a positive integer such that</p>
<table class="DisplayFormulaNumbered"><a name="Eq:8"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_8.gif" alt="" width="97" height="48" /></td>
<td class="DisplayFormulaNumberedLabel">(8)</td>
</tr>
</tbody>
</table>
<p>and, in accordance with equation (<a href="#Eq:4">4</a>), the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_40.gif" alt="" width="13" height="12" /> in equation (<a href="#Eq:7">7</a>) can be found from</p>
<table class="DisplayFormulaNumbered"><a name="Eq:9"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_9b.gif" alt="" width="171" height="40" /></td>
<td class="DisplayFormulaNumberedLabel">(9)</td>
</tr>
</tbody>
</table>
<p>It is not reasonable to solve equation (<a href="#Eq:9">9</a>) directly to determine the rational number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_41.gif" alt="" width="13" height="12" />, as its solution becomes tremendously difficult with increasing integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_42.gif" alt="" width="6" height="12" />. However, this problem can be effectively resolved by using a very simple two-step iteration procedure discussed in the next section. Therefore, our approach in generating the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_43.gif" alt="" width="6" height="12" /> with small Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure is much easier than Chien-Lih<span class="special-character CloseCurlyQuote">’</span>s method [<a href="#Chien-Li-2004">11</a>].</p>
<p>Wetherfield [<a href="#Wetherfield">7</a>] provides a detailed explanation clarifying the significance of Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure that shows how much computation is required for a given Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_44.gif" alt="" width="6" height="12" /> when all the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_45.gif" alt="" width="35" height="14" />. However, it is unclear if this paradigm is also applicable when at least one number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_46.gif" alt="" width="12" height="14" /> is rational. More specifically, the problem that occurs in computing the two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_47.gif" alt="" width="6" height="12" /> in Chien-Lih<span class="special-character CloseCurlyQuote">’</span>s [<a href="#Chien-Li-2004">11</a>] and our [<a href="#Abrarov-Quine-1">4</a>] iteration methods is related to the rapidly growing number of digits in the numerators and denominators of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_48.gif" alt="" width="13" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_49.gif" alt="" width="13" height="12" />. This occurs simultaneously with an attempt to decrease Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure. As a result, the subsequent exponentiation in conventional algorithms makes computing the decimal digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_50.gif" alt="" width="6" height="12" /> inefficient. Therefore, the applicability of Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure for a Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_51.gif" alt="" width="6" height="12" /> for the case <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_52.gif" alt="" width="35" height="14" /> is questionable. For example, Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure may be small, say less than 1. This means that less computational work is needed to calculate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_53.gif" alt="" width="6" height="12" />. However, due to the large number of digits in the numerators and denominators in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_54.gif" alt="" width="13" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_55.gif" alt="" width="13" height="12" />, a computer performs more intense arithmetic operations that make the runtime significantly longer. Consequently, we ask, Is Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure still applicable when at least one constant from the set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_56.gif" alt="" width="12" height="14" /> is not an integer but a rational number?</p>
<p>Motivated by an interesting paper in regard to equation (<a href="#Eq:7">7</a>) that was recently published [<a href="#WolframCloud">14</a>], we further develop our previous work [<a href="#Abrarov-Quine-1">4</a>, <a href="#Abrarov-Quine-2">5</a>]. In this article, we propose a new algorithm showing how unconditional applicability of Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure for the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_57.gif" alt="" width="6" height="12" /> can be achieved. We also describe how linear and quadratic convergence to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_58.gif" alt="" width="6" height="12" /> can be implemented.</p>
<h3>2. Preliminaries</h3>
<p>As mentioned, the number of summation terms <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_59.gif" alt="" width="6" height="12" /> in equation (<a href="#Eq:2">2</a>) should be reduced in order to minimize Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure. Since at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_60.gif" alt="" width="26" height="12" /> there is only one Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_61.gif" alt="" width="6" height="12" />,</p>
<table class="DisplayFormulaNumbered"><a name="Eq:10"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_10.gif" alt="" width="72" height="30" /></td>
<td class="DisplayFormulaNumberedLabel">(10)</td>
</tr>
</tbody>
</table>
<p>we consider the case <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_62.gif" alt="" width="26" height="12" />. We attempted to find a method that can be used to generate a two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_63.gif" alt="" width="6" height="12" /> with small Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure. Equation (<a href="#Eq:7">7</a>) provides an efficient way to do this.</p>
<p>In fact, the original Machin formula (<a href="#Eq:1">1</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_63.gif" alt="" width="6" height="12" /> appears quite naturally from the equations (<a href="#Eq:7">7</a>), (<a href="#Eq:8">8</a>) and (<a href="#Eq:9">9</a>) at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_64.gif" alt="" width="26" height="12" />. Specifically, equation (<a href="#Eq:8">8</a>) provides</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_5.gif" alt="" width="235" height="81" /></p>
<p>Substituting into equation (<a href="#Eq:9">9</a>) results in</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_6b.gif" alt="" width="211" height="40" /></p>
<p>Consequently, at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_65.gif" alt="" width="26" height="12" /> we get the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_66.gif" alt="" width="42" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_67.gif" alt="" width="33" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_68.gif" alt="" width="54" height="12" /> in equation (<a href="#Eq:7">7</a>). Since the arctangent function is odd (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_69.gif" alt="" width="118" height="12" />), the constants for equation (<a href="#Eq:3">3</a>) can be rearranged as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_70.gif" alt="" width="33" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_71.gif" alt="" width="42" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_72.gif" alt="" width="33" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_73.gif" alt="" width="45" height="12" />. This corresponds to the original Machin formula (<a href="#Eq:1">1</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_74.gif" alt="" width="6" height="12" />.</p>
<p><strong>Theorem 2.1.</strong></p>
<div id="15044715" class="Theorem"><a name="15044715"></a>There are only four possible cases for a two-term Machin-like formula (<a href="#Eq:3">3</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_75.gif" alt="" width="6" height="12" /> when all four constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_76.gif" alt="" width="13" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_77.gif" alt="" width="13" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_78.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_79.gif" alt="" width="13" height="12" /> are integers:</div>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_1b.gif" alt="" width="160" height="90" /></p>
<p>The proof for Theorem <a href="Theorem:2.1">2.1</a> can be found in [<a href="#Weisstein">10</a>].</p>
<p><strong>Lemma 2.2</strong></p>
<div id="44483745" class="Theorem"><a name="44483745"></a>If in equation (<a href="#Eq:7">7</a>) <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_80.gif" alt="" width="36" height="12" />, then <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_81.gif" alt="" width="36" height="12" /> at any integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_82.gif" alt="" width="26" height="12" />.</div>
<p><strong>Proof</strong></p>
<p>As we can see from the four cases given in Theorem <a href="Theorem:2.1">2.1</a>, the largest possible value for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_83.gif" alt="" width="49" height="15" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_84.gif" alt="" width="6" height="12" /> and it occurs at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_85.gif" alt="" width="26" height="12" /> (see the example above). Therefore, for any integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_86.gif" alt="" width="13" height="12" /> at integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_87.gif" alt="" width="26" height="12" />, the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_88.gif" alt="" width="13" height="12" /> in the equation (<a href="#Eq:7">7</a>) cannot be an integer. <span class="special-character EmptySquare">□</span></p>
<p><strong>Theorem 2.3.</strong></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_8.gif" alt="" width="240" height="67" /></p>
<p><strong>Proof</strong></p>
<p>This is the simplest kind of Ramanujan nested radical and its proof is straightforward. Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_89.gif" alt="" width="50" height="20" />. Then</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_9.gif" alt="" width="274" height="38" /></p>
<p>Squaring both sides,</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_10.gif" alt="" width="150" height="23" /></p>
<p>and solving results in two possible solutions, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_90.gif" alt="" width="43" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_91.gif" alt="" width="34" height="12" />. Since for any positive index <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_92.gif" alt="" width="6" height="12" /> the value <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_93.gif" alt="" width="10" height="12" /> is always positive, we exclude the solution <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_94.gif" alt="" width="43" height="12" />. <span class="special-character EmptySquare">□</span></p>
<p><strong>Lemma 2.4.</strong></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_11.gif" alt="" width="283" height="64" /></p>
<p><strong>Proof</strong></p>
<p>The proof follows immediately from Theorem <a href="Theorem:2.3">2.3</a> since</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_12.gif" alt="" width="335" height="38" /></p>
<p><strong>Lemma 2.5.</strong></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_13.gif" alt="" width="105" height="55" /></p>
<p><strong>Proof</strong></p>
<p>Using equation (<a href="#Eq:8">8</a>) that defines <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_95.gif" alt="" width="13" height="12" /> by the floor function, the limit can be rewritten as</p>
<table class="DisplayFormulaNumbered"><a name="Eq:11"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_11.gif" alt="" width="105" height="75" /></td>
<td class="DisplayFormulaNumberedLabel">(11)</td>
</tr>
</tbody>
</table>
<p>By definition, the fractional part given by the difference</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_14.gif" alt="" width="251" height="48" /></p>
<p>is positive and cannot be greater than 1. Therefore, the limit (<a href="#Eq:11">11</a>) can be rewritten in the form</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_15.gif" alt="" width="407" height="75" /></p>
<p><strong>Lemma 2.6</strong></p>
<table class="DisplayFormulaNumbered"><a name="Eq:12"></a></p>
<tbody>
<tr>
<td>We have that <img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_12-e1621889093732.gif" alt="" width="67" height="20" />.</td>
<td class="DisplayFormulaNumberedLabel">(12)</td>
</tr>
</tbody>
</table>
<p><strong>Proof</strong></p>
<p>Equation (<a href="#Eq:9">9</a>) is too hard to work with directly, so we start with the limit (<a href="#Eq:11">11</a>) from Lemma <a href="Lemma:2.5">2.5</a>. Since the limit is 1, the limit of the ratio of the reciprocals of its numerator and denominator must also be 1,</p>
<table class="DisplayFormulaNumbered"><a name="Eq:13"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_13.gif" alt="" width="213" height="68" /></td>
<td class="DisplayFormulaNumberedLabel">(13)</td>
</tr>
</tbody>
</table>
<p>From Theorem <a href="Theorem:2.3">2.3</a> and Lemma <a href="Lemma:2.4">2.4</a>,</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_16.gif" alt="" width="219" height="65" /></p>
<p>and</p>
<table class="DisplayFormulaNumbered"><a name="Eq:14"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_14.gif" alt="" width="278" height="77" /></td>
<td class="DisplayFormulaNumberedLabel">(14)</td>
</tr>
</tbody>
</table>
<p>Since both the numerator and denominator in (<a href="#Eq:13">13</a>) tend to zero as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_96.gif" alt="" width="6" height="12" /> tends to infinity and since <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_97.gif" alt="" width="67" height="12" /> as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_98.gif" alt="" width="28" height="12" />, we can rewrite (<a href="#Eq:13">13</a>) as</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_17.gif" alt="" width="131" height="69" /></p>
<p>or</p>
<table class="DisplayFormulaNumbered"><a name="Eq:15"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_15.gif" alt="" width="158" height="69" /></td>
<td class="DisplayFormulaNumberedLabel">(15)</td>
</tr>
</tbody>
</table>
<p>Since equation (<a href="#Eq:6">6</a>) is valid for an arbitrarily large integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_99.gif" alt="" width="6" height="12" />, (<a href="#Eq:15">15</a>) implies that</p>
<table class="DisplayFormulaNumbered"><a name="Eq:16"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_16.gif" alt="" width="288" height="49" /></td>
<td class="DisplayFormulaNumberedLabel">(16)</td>
</tr>
</tbody>
</table>
<p>However, we also have</p>
<table class="DisplayFormulaNumbered"><a name="Eq:17"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_17.gif" alt="" width="209" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(17)</td>
</tr>
</tbody>
</table>
<p>since equation (<a href="#Eq:7">7</a>) is also valid at an arbitrarily large integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_100.gif" alt="" width="6" height="12" />. Comparing the limits (<a href="#Eq:16">16</a>) and (<a href="#Eq:17">17</a>), we get</p>
<table class="DisplayFormulaNumbered"><a name="Eq:18"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_18.gif" alt="" width="322" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(18)</td>
</tr>
</tbody>
</table>
<p>Equation (<a href="#Eq:18">18</a>) is valid if and only if</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_18.gif" alt="" width="100" height="35" /></p>
<p>so <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_101.gif" alt="" width="64" height="20" />, which is (<a href="#Eq:12">12</a>). <span class="special-character EmptySquare">□</span></p>
<p><strong>Lemma 2.7.</strong></p>
<div id="104098735" class="Theorem"><a name="104098735"></a>Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure (<a href="#Eq:5">5</a>) may be vanishingly small.</div>
<p><strong>Proof</strong></p>
<p>The limit (<a href="#Eq:14">14</a>) implies that</p>
<table class="DisplayFormulaNumbered"><a name="Eq:19"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_19.gif" alt="" width="61" height="20" /></td>
<td class="DisplayFormulaNumberedLabel">(19)</td>
</tr>
</tbody>
</table>
<p>From (<a href="#Eq:12">12</a>) and (<a href="#Eq:19">19</a>) we conclude that as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_102.gif" alt="" width="32" height="12" />, both <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_103.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_104.gif" alt="" width="13" height="12" /> tend to infinity. Thus, according to equation (<a href="#Eq:5">5</a>), Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_105.gif" alt="" width="7" height="12" /> for the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_106.gif" alt="" width="6" height="12" /> tends to zero with increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_107.gif" alt="" width="6" height="12" />. <span class="special-character EmptySquare">□</span></p>
<p><strong>Theorem 2.8</strong></p>
<div id="28111490" class="Theorem"><a name="28111490"></a>If equation (<a href="#Eq:8">8</a>) holds, then the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_108.gif" alt="" width="13" height="12" /> is always negative.</div>
<p><strong>Proof</strong></p>
<p>There is only one single-term Machin-like formula (<a href="#Eq:10">10</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_109.gif" alt="" width="6" height="12" /> such that the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_110.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_111.gif" alt="" width="13" height="12" /> are both integers. Therefore, in equation (<a href="#Eq:6">6</a>), at any integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_112.gif" alt="" width="26" height="12" /> the argument of the arctangent function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_113.gif" alt="" width="76" height="24" /> cannot be represented as the reciprocal of an integer; that is, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_114.gif" alt="" width="76" height="24" /> is not an integer. Therefore,</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_19.gif" alt="" width="110" height="48" /></p>
<p>and</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_20.gif" alt="" width="223" height="48" /></p>
<p>This implies</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_21.gif" alt="" width="244" height="51" /></p>
<p>or</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_22.gif" alt="" width="175" height="49" /></p>
<p>or</p>
<table class="DisplayFormulaNumbered"><a name="Eq:20"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_20.gif" alt="" width="223" height="49" /></td>
<td class="DisplayFormulaNumberedLabel">(20)</td>
</tr>
</tbody>
</table>
<p>We make (<a href="#Eq:20">20</a>) into an equality by adding a negative error term <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_115.gif" alt="" width="6" height="12" /> such that</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_23.gif" alt="" width="241" height="49" /></p>
<p>Defining the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_116.gif" alt="" width="13" height="12" /> in accordance with equation (<a href="#Eq:9">9</a>), we find the error term to be</p>
<table class="DisplayFormulaNumbered"><a name="Eq:21"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_21.gif" alt="" width="81" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(21)</td>
</tr>
</tbody>
</table>
<p>Since <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_117.gif" alt="" width="6" height="12" /> is negative, the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_118.gif" alt="" width="13" height="12" /> is also negative. <span class="special-character EmptySquare">□</span></p>
<h3>3. Iteration Methods</h3>
<h4>3.1 Arctangent Function</h4>
<p>Since in equation (<a href="#Eq:7">7</a>) the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_119.gif" alt="" width="13" height="12" /> is an integer, the first arctangent function term can be computed by any existing method. For example, we can use Euler<span class="special-character CloseCurlyQuote">’</span>s formula for the arctangent function</p>
<table class="DisplayFormulaNumbered"><a name="Eq:22"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_22.gif" alt="" width="197" height="42" /></td>
<td class="DisplayFormulaNumberedLabel">(22)</td>
</tr>
</tbody>
</table>
<p>Chien-Lih used this formula to develop his iteration method for generating the two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_120.gif" alt="" width="6" height="12" /> [<a href="#Chien-Li-2004">11</a>] and later he found an elegant derivation of this formula [<a href="#Chien-Lih-2015">15</a>].</p>
<p>We derived another series expansion of the arctangent function [<a href="#Abrarov-Quine-2">5</a>, <a href="#Abrarov-Quine-3">12</a>]:</p>
<table class="DisplayFormulaNumbered"><a name="Eq:23"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_23.gif" alt="" width="308" height="38" /></td>
<td class="DisplayFormulaNumberedLabel">(23)</td>
</tr>
</tbody>
</table>
<p>It interesting that generalizing the derivation method that was used to get equation (<a href="#Eq:23">23</a>), we can find by induction the identity</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_24.gif" alt="" width="213" height="40" /></p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_121.gif" alt="" width="11" height="12" /> is the order of arctan function expansion; that yields simple approximations like</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_25.gif" alt="" width="169" height="40" /></p>
<p>and</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_26.gif" alt="" width="317" height="40" /></p>
<p>since <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_122.gif" alt="" width="145" height="19" />.</p>
<p>The representation (<a href="#Eq:23">23</a>) of the arctangent function is not optimal for algorithmic implementation, since it deals with complex numbers. Fortunately, as we showed in [<a href="#Abrarov-Quine-1">4</a>], this series expansion can be significantly simplified to</p>
<table class="DisplayFormulaNumbered"><a name="Eq:24"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_24b.gif" alt="" width="212" height="40" /></td>
<td class="DisplayFormulaNumberedLabel">(24)</td>
</tr>
</tbody>
</table>
<p>where the expansion coefficients are computed by iteration:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_27.gif" alt="" width="213" height="53" /></p>
<p>Both series expansions (<a href="#Eq:22">22</a>) and (<a href="#Eq:24">24</a>) converge rapidly and need no undesirable irrational numbers to compute <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_123.gif" alt="" width="6" height="12" />. However, the computational test we performed shows that the series expansion (<a href="#Eq:24">24</a>) converges more rapidly by many orders of magnitude than Euler<span class="special-character CloseCurlyQuote">’</span>s formula (<a href="#Eq:22">22</a>) (see Figures 2 and 3 in [<a href="#Abrarov-Quine-1">4</a>]). Therefore, the series expansion (<a href="#Eq:24">24</a>) is more advantageous and can be taken to compute the first arctangent function term from the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_124.gif" alt="" width="6" height="12" />.</p>
<p>The second arctangent function term in equation (<a href="#Eq:7">7</a>) should not be computed by straightforward substitution of the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_125.gif" alt="" width="13" height="12" /> into equation (<a href="#Eq:24">24</a>). As mentioned, computing with a ratio of numbers with many digits should be avoided. Instead, the second arctangent function term in equation (<a href="#Eq:7">7</a>) can be computed by Newton<span class="special-character Dash">–</span>Raphson iteration.</p>
<h4>3.2 Rational <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_126.gif" alt="" width="14" height="14" /></h4>
<p>Once the value of the integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_127.gif" alt="" width="6" height="12" /> is chosen, it is not difficult to determine the integer <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_128.gif" alt="" width="13" height="12" /> by using equation (<a href="#Eq:8">8</a>) with the help of Mathematica. However, determining the second constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_129.gif" alt="" width="13" height="12" /> with (<a href="#Eq:9">9</a>) is very hard with increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_130.gif" alt="" width="6" height="12" />, as already mentioned. To overcome this, we proposed a different method [<a href="#Abrarov-Quine-1">4</a>]. We define the very simple two-step iteration for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_131.gif" alt="" width="71" height="12" />,</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_28.gif" alt="" width="92" height="35" /></p>
<p>where</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_29.gif" alt="" width="64" height="39" /></p>
<p>and</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_30.gif" alt="" width="63" height="38" /></p>
<p>Then</p>
<table class="DisplayFormulaNumbered"><a name="Eq:25"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_25.gif" alt="" width="100" height="37" /></td>
<td class="DisplayFormulaNumberedLabel">(25)</td>
</tr>
</tbody>
</table>
<p>For <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_132.gif" alt="" width="26" height="12" />, the second arctangent term in (<a href="#Eq:7">7</a>) deals only with a rational number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_133.gif" alt="" width="13" height="12" />. As <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_134.gif" alt="" width="6" height="12" /> increases, the number of digits in the numerator and denominator of the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_135.gif" alt="" width="13" height="12" /> increases. For example, at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_136.gif" alt="" width="26" height="12" />, equation (<a href="#Eq:8">8</a>) yields</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_31.gif" alt="" width="260" height="139" /></p>
<p>and using (<a href="#Eq:25">25</a>) we find</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_32.gif" alt="" width="557" height="34" /></p>
<p>Consequently, the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_137.gif" alt="" width="6" height="12" /> is generated as</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_33.gif" alt="" width="492" height="34" /></p>
<p>Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure for this two-term Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_138.gif" alt="" width="6" height="12" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_139.gif" alt="" width="60" height="12" />.</p>
<p>However, if we take <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_140.gif" alt="" width="32" height="12" />, then</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_34.gif" alt="" width="256" height="137" /></p>
<p>and using (<a href="#Eq:25">25</a>) we get</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_35.gif" alt="" width="378" height="71" /></p>
<p>The corresponding two-term Machin like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_141.gif" alt="" width="6" height="12" /> is</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_36.gif" alt="" width="369" height="71" /></p>
<p>for which Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure is only <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_142.gif" alt="" width="66" height="12" />. Such a large number of digits in the numerator and denominator in the second arctangent function may look unusual. However, some formulas for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_143.gif" alt="" width="6" height="12" /> obtained from the Borwein integrals involving the sinc function can also result in ratios of integers with a large number of digits. For example, B<span class="special-character ADoubleDot">ä</span>sel and Baillie reported a formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_144.gif" alt="" width="6" height="12" /> that uses a quotient with 453,130,145 digits in the numerator and 453,237,170 digits in the denominator [<a href="#Basel-Baillie">16</a>]; you can download a file with all the digits of the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_145.gif" alt="" width="13" height="12" /> from [<a href="#Abrarov-Quine-4">17</a>].</p>
<p>As we can see from these examples, Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure decreases with increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_146.gif" alt="" width="6" height="12" />. However, that occurs simultaneously with a rapid increase in the number of digits in the numerator and denominator of the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_147.gif" alt="" width="13" height="12" />. As a result, taking powers of such fractions becomes very slow. This raises the doubt that Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure (<a href="#Eq:5">5</a>) is indeed relevant for a given Machin-like formula for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_148.gif" alt="" width="6" height="12" /> when at least one coefficient <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_149.gif" alt="" width="12" height="14" /> is rational.</p>
<p>To resolve this problem, we considered applying the Newton<span class="special-character Dash">–</span>Raphson iteration [<a href="#Abrarov-Quine-5">18</a>]. Specifically, we showed that each consecutive iteration doubles the number of correct digits in the second term of the arctangent function in equation (<a href="#Eq:7">7</a>). This method is based on the iteration formula:</p>
<table class="DisplayFormulaNumbered"><a name="Eq:26"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_26.gif" alt="" width="206" height="35" /></td>
<td class="DisplayFormulaNumberedLabel">(26)</td>
</tr>
</tbody>
</table>
<p>such that</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_37.gif" alt="" width="107" height="35" /></p>
<p>The most important advantage of (<a href="#Eq:26">26</a>) is that the rational number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_150.gif" alt="" width="27" height="12" /> is not involved in the computation of the trigonometric functions. As we can see from (<a href="#Eq:26">26</a>), <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_151.gif" alt="" width="27" height="12" /> is no longer problematic because it is not taken to a power, nor is it the argument of sine or tangent, which consumes most of the runtime. Instead, it is only applied in a single subtraction. This single subtraction (that can be implemented by changing the precision) takes a negligibly small amount of time as compared to the time to compute <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_152.gif" alt="" width="34" height="18" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_153.gif" alt="" width="35" height="18" />.</p>
<p>To reduce the number of trigonometric functions from two to one, it is convenient to put equation (<a href="#Eq:26">26</a>) into the form</p>
<table class="DisplayFormulaNumbered"><a name="Eq:27"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_27.gif" alt="" width="279" height="51" /></td>
<td class="DisplayFormulaNumberedLabel">(27)</td>
</tr>
</tbody>
</table>
<p>using the elementary trigonometric identities</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_38.gif" alt="" width="113" height="35" /></p>
<p>and</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_39.gif" alt="" width="117" height="35" /></p>
<p>The tangent function can be found, for example, by using the equation</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_40b.gif" alt="" width="188" height="57" /></p>
<p>representing the ratio based on the Maclaurin series expansions for the sine and cosine functions. Alternatively, we can use the series expansion</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_41b.gif" alt="" width="228" height="41" /></p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_154.gif" alt="" width="20" height="12" /> is a Bernoulli number. There are several other ways to compute the tangent, like continued fractions [<a href="#Havil">19</a>, <a href="#Trott">20</a>] or Newton<span class="special-character Dash">–</span>Raphson iteration again [<a href="#Muller">21</a>]. Perhaps the argument reduction method for the tangent function can also be used to improve accuracy, but we did not implement that, to keep the algorithm as simple as possible.</p>
<h4>3.3 Tangent Function</h4>
<p>Equation (<a href="#Eq:27">27</a>) is based on the Newton<span class="special-character Dash">–</span>Raphson iteration method. However, this iteration formula contains the tangent function. We showed [<a href="#Abrarov-Quine-5">18</a>] that once the first arctangent term is computed, the number of correct digits in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_155.gif" alt="" width="6" height="12" /> can be doubled at each consecutive step of the iteration as with the Newton<span class="special-character Dash">–</span>Raphson iteration method. To approximate the tangent function with high accuracy, we can apply the Newton<span class="special-character Dash">–</span>Raphson iteration again [<a href="#Muller">21</a>]. The derivation of the iteration-based equation for the tangent function is not difficult. Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_156.gif" alt="" width="64" height="12" />.</p>
<p>Using the Newton<span class="special-character Dash">–</span>Raphson iteration formula</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_42.gif" alt="" width="97" height="40" /></p>
<p>where</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_43.gif" alt="" width="290" height="35" /></p>
<p>we get</p>
<table class="DisplayFormulaNumbered"><a name="Eq:28"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_28.gif" alt="" width="172" height="18" /></td>
<td class="DisplayFormulaNumberedLabel">(28)</td>
</tr>
</tbody>
</table>
<p>such that</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormula_44.gif" alt="" width="79" height="22" /></p>
<p>Substituting <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_157.gif" alt="" width="47" height="18" /> into (<a href="#Eq:28">28</a>) yields</p>
<table class="DisplayFormulaNumbered"><a name="Eq:29"></a></p>
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_DisplayFormulaNumbered_29.gif" alt="" width="187" height="29" /></td>
<td class="DisplayFormulaNumberedLabel">(29)</td>
</tr>
</tbody>
</table>
<p>The iteration-based expansion of the series (<a href="#Eq:24">24</a>) for the arctangent function converges very rapidly. Therefore, we can apply it to compute the arctangent function in equation (<a href="#Eq:29">29</a>).</p>
<h3>4. Implementation</h3>
<h4>4.1 Linear Convergence</h4>
<p>The series expansion (<a href="#Eq:24">24</a>) of the arctangent function can be computed as follows.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_45.gif" alt="" width="567" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_46.gif" alt="" width="396" height="28" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_47.gif" alt="" width="396" height="28" /></p>
<p>Next we define the nested radicals consisting of square roots of 2.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_48.gif" alt="" width="169" height="28" /></p>
<p>This computes the constants <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_158.gif" alt="" width="13" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_159.gif" alt="" width="13" height="12" /> for the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_160.gif" alt="" width="6" height="12" /> at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_161.gif" alt="" width="26" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_49.gif" alt="" width="229" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_2.gif" alt="" width="14" height="12" /></p>
<p>For the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_162.gif" alt="" width="13" height="12" />, we use the iteration-based formula (<a href="#Eq:25">25</a>) instead of equation (<a href="#Eq:9">9</a>).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_50.gif" alt="" width="182" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_3.gif" alt="" width="34" height="32" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_51.gif" alt="" width="199" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_52.gif" alt="" width="142" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_4.gif" alt="" width="34" height="32" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_53.gif" alt="" width="167" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_54.gif" alt="" width="227" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_5.gif" alt="" width="424" height="32" /></p>
<p>Define a function for the Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure corresponding to a two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_163.gif" alt="" width="6" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_55.gif" alt="" width="407" height="34" /></p>
<p>Here is Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure for the case <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_164.gif" alt="" width="26" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_56.gif" alt="" width="176" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_6.gif" alt="" width="50" height="12" /></p>
<p>The accuracy improves with each iteration, so we do not need to use the highest accuracy at each step. At <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_165.gif" alt="" width="26" height="12" />, the Newton<span class="special-character Dash">–</span>Raphson iteration-based formula (<a href="#Eq:29">29</a>) gives 4 to 5 correct digits of the tangent function at each step. Therefore, it is reasonable to use the argument <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_166.gif" alt="" width="32" height="12" /> in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_167.gif" alt="" width="86" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_168.gif" alt="" width="6" height="12" /> is taken to minimize rounding or truncation errors.</p>
<p>Recall that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_169.gif" alt="" width="102" height="31" />. As an initial guess for the Newton<span class="special-character Dash">–</span>Raphson iteration, we choose <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_170.gif" alt="" width="54" height="28" />, since this is close to the actual value of the tangent function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_171b.png" alt="" width="58" height="18" />.</p>
<p>This sets up the recurrence for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_172.gif" alt="" width="11" height="14" /> as defined in (<a href="#Eq:29">29</a>).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_57.gif" alt="" width="268" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_7.gif" alt="" width="66" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_58.gif" alt="" width="394" height="58" /></p>
<p>This part of the program, which computes the tangent function, takes most of the runtime. It uses the Newton<span class="special-character Dash">–</span>Raphson iteration built on the basis of the series expansion (<a href="#Eq:24">24</a>) of the arctangent function (see (<a href="#Eq:29">29</a>)).</p>
<p>This sets up the Newton<span class="special-character Dash">–</span>Raphson iteration formula (<a href="#Eq:27">27</a>).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_59.gif" alt="" width="75" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_8.gif" alt="" width="424" height="32" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_60b.png" alt="" width="279" height="110" /></p>
<p>The next part of the program invokes the value <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_173.gif" alt="" width="52" height="18" /> and performs just a few arithmetic operations. As mentioned, the numerator and denominator of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_174.gif" alt="" width="27" height="12" /> contain many digits, but they are not involved in computing the tangent function. Only a minor part of the time is needed to subtract this number (see equation (<a href="#Eq:27">27</a>)). Consequently, Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure applies unconditionally.</p>
<p>The table shows how the values of the arctangent function gain digits at each iteration step.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_61.gif" alt="" width="292" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_9.gif" alt="" width="479" height="158" /></p>
<p>This shows the linear rate of convergence to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_175.gif" alt="" width="6" height="12" /> in terms of the number of accurate digits.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_62.gif" alt="" width="557" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_10.gif" alt="" width="246" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_63.gif" alt="" width="102" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_11.gif" alt="" width="360" height="229" /></p>
<p>After the first two iterations, each of the following iterations adds five correct digits to the approximation of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_176.gif" alt="" width="6" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_64.gif" alt="" width="102" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_12.gif" alt="" width="165" height="12" /></p>
<p>The convergence rate increases as Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure decreases, which can be readily confirmed by increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_177.gif" alt="" width="6" height="12" /> and readjusting the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_178.gif" alt="" width="86" height="12" /> parameter in this algorithm. No undesirable irrational numbers are needed. Furthermore, since Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure can be made vanishingly small, there is no upper bound in the convergence rate per iteration.</p>
<h4>4.2 Quadratic Convergence</h4>
<p>Consider a variation of the algorithm based on the Newton<span class="special-character Dash">–</span>Raphson iterations for the tangent function that can be implemented to get quadratic convergence to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_179.gif" alt="" width="6" height="12" />. Assume that only <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_180.gif" alt="" width="32" height="12" /> decimal digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_181.gif" alt="" width="6" height="12" /> are known at the beginning.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_65.gif" alt="" width="521" height="43" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_13.gif" alt="" width="415" height="32" /></p>
<p>We determined experimentally that at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_182.gif" alt="" width="26" height="12" />, equation (<a href="#Eq:24">24</a>) provides four or five correct digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_183.gif" alt="" width="6" height="12" /> at each successive step. Therefore, it is sufficient to take <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_184.gif" alt="" width="20" height="12" /> terms. However, to exclude truncation and rounding errors, we use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_185.gif" alt="" width="22" height="12" /> terms of the arctangent function.</p>
<p>We define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_186.gif" alt="" width="43" height="12" /> to determine the accuracy of computation and for the number of summation terms in approximation (<a href="#Eq:24">24</a>) of the arctangent function.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_66.gif" alt="" width="285" height="12" /></p>
<p>The multiplier <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_187.gif" alt="" width="30" height="12" /> was found experimentally. When <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_188.gif" alt="" width="58" height="12" />, we restrict its rapid growth to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_189.gif" alt="" width="38" height="12" />, as we do not need extra accuracy at this stage. We add 10 to exclude truncation and rounding errors. We have taken the initial value <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_190.gif" alt="" width="51" height="12" />.</p>
<p>We use equation (<a href="#Eq:29">29</a>).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_67.gif" alt="" width="496" height="73" /></p>
<p>For our choice of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_191.gif" alt="" width="6" height="12" />, here is the required index.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_68.gif" alt="" width="249" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_14.gif" alt="" width="7" height="12" /></p>
<div id="1059712655" class="Z"><a name="1059712655"></a>Here are the first six values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_192.gif" alt="" width="7" height="12" />.</div>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_69.gif" alt="" width="193" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_15.gif" alt="" width="580" height="158" /></p>
<p>Once the tangent function is computed, we substitute it into equation (<a href="#Eq:27">27</a>). The value <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_193.gif" alt="" width="14" height="12" /> has double the accuracy of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_194.gif" alt="" width="7" height="12" /> with only one iteration.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_70.gif" alt="" width="429" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_16.gif" alt="" width="580" height="28" /></p>
<p>The approximate values of the arctangent function by iteration and by the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_195.gif" alt="" width="43" height="12" /> match to 100 places.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_71.gif" alt="" width="138" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_17.gif" alt="" width="580" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_18.gif" alt="" width="580" height="28" /></p>
<p>Since we got <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_196.gif" alt="" width="14" height="12" /> with double the accuracy, it can now be used to compute <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_197.gif" alt="" width="6" height="12" /> with significantly improved accuracy.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_72.gif" alt="" width="290" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_19.gif" alt="" width="580" height="28" /></p>
<p>This shows that the number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_198.gif" alt="" width="14" height="12" /> of correct decimal digits of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_199.gif" alt="" width="22" height="12" /> doubled from 50 to 101.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_73.gif" alt="" width="348" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_20.gif" alt="" width="22" height="12" /></p>
<p>More directly, this shows the complete match between the computed approximation of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_200.gif" alt="" width="6" height="12" /> and that provided by Mathematica.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_74.gif" alt="" width="147" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_21.gif" alt="" width="580" height="28" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Input_75.gif" alt="" width="54" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Output_22.gif" alt="" width="580" height="28" /></p>
<p>The first arctangent function in the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_201.gif" alt="" width="6" height="12" /> can also be found by using the same algorithm based on the Newton<span class="special-character Dash">–</span>Raphson iteration. Consequently, this method results in quadratic convergence to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_202.gif" alt="" width="6" height="12" />. However, unlike the Brent<span class="special-character Dash">–</span>Salamin algorithm (also known as the Gauss<span class="special-character Dash">–</span>Brent<span class="special-character Dash">–</span>Salamin algorithm) with quadratic convergence to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_203.gif" alt="" width="6" height="12" /> [<a href="#Berggren">2</a>], our approach does not involve any irrational numbers. The number of summation terms in equation (<a href="#Eq:24">24</a>) and the number of iteration cycles for computation of the tangent function (<a href="#Eq:29">29</a>) decrease with increasing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_204.gif" alt="" width="6" height="12" />. This can be confirmed by using the code given here. To the best of our knowledge, this is the first algorithm showing the feasibility of quadratic convergence to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_205.gif" alt="" width="6" height="12" /> without using any irrational numbers.</p>
<h3>5. Conclusion</h3>
<p>In this article, we presented a new algorithm to compute the two-term Machin-like formula (<a href="#Eq:7">7</a>) for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_206.gif" alt="" width="6" height="12" /> and showed an example where the condition <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_207.gif" alt="" width="35" height="14" /> was not necessary in order to validate Lehmer<span class="special-character CloseCurlyQuote">’</span>s measure (<a href="#Eq:5">5</a>). Since this algorithmic implementation lets us avoid subsequent exponentiation of the second constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_208.gif" alt="" width="13" height="12" />, this approach may be promising for computing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_209.gif" alt="" width="6" height="12" /> more rapidly without using irrational numbers.</p>
<h3>Acknowledgments</h3>
<p>This work is supported by National Research Council Canada, Thoth Technology, Inc., York University, Epic College of Technology and Epic Climate Green (ECG) Inc. The authors wish to thank the reviewer for useful comments and recommendations. Constructive suggestions from the editor that improved the content of this work are greatly appreciated.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Beckmann"></a>[1]</td>
<td>P. Beckmann, <em>A History of Pi</em>, Boulder, CO: Golem Press, 1971.</td>
</tr>
<tr>
<td class="Reference"><a name="Berggren"></a>[2]</td>
<td>L. Berggren, J. Borwein and P. Borwein, <em>Pi: A Source Book</em>, 3rd ed., New York: Springer, 2004.</td>
</tr>
<tr>
<td class="Reference"><a name="Borwein-Bailey"></a>[3]</td>
<td>J. Borwein and D. Bailey, <em>Mathematics by Experiment. Plausible Reasoning in the 21st Century</em>, 2nd ed., Wellesley, MA: AK Peters, 2008.</td>
</tr>
<tr>
<td class="Reference"><a name="Abrarov-Quine-1"></a>[4]</td>
<td>S. M. Abrarov and B. M. Quine, <span class="special-character OpenCurlyDoubleQuote">“</span>An Iteration Procedure for a Two-Term Machin-like Formula for Pi with Small Lehmer<span class="special-character CloseCurlyQuote">’</span>s Measure.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://arxiv.org/abs/1706.08835" target="_blank">arxiv.org/abs/1706.08835</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Abrarov-Quine-2"></a>[5]</td>
<td>S. M. Abrarov and B. M. Quine, <span class="special-character OpenCurlyDoubleQuote">“</span>The Two-Term Machin-like Formula for Pi with Small Arguments of the Arctangent Function.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://arxiv.org/abs/1704.02875" target="_blank">arxiv.org/abs/1704.02875</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Lehmer"></a>[6]</td>
<td>D. H. Lehmer, <span class="special-character OpenCurlyDoubleQuote">“</span>On Arccotangent Relations for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_210-e1621867599811.gif" alt="" width="7" height="12" />,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The American Mathematical Monthly</em>, <strong>45</strong>(10), 1938, pp. 657<span class="special-character Dash">–</span>664. <a href="https://www.jstor.org/stable/2302434" target="_blank">doi.org/10.2307/2302434</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Wetherfield"></a>[7]</td>
<td>M. Wetherfield, <span class="special-character OpenCurlyDoubleQuote">“</span>The Enhancement of Machin<span class="special-character CloseCurlyQuote">’</span>s Formula by Todd<span class="special-character CloseCurlyQuote">’</span>s Process,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematical Gazette</em>, <strong>80</strong>(488), 1996, pp. 333<span class="special-character Dash">–</span>344. <a href="https://www.jstor.org/stable/3619567" target="_blank">doi.org/10.2307/3619567</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Calcut"></a>[8]</td>
<td>J. S. Calcut, <span class="special-character OpenCurlyDoubleQuote">“</span>Gaussian Integers and Arctangent Identities for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_211-e1621867619575.gif" alt="" width="7" height="12" />,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The American Mathematical Monthly</em>, <strong>116</strong>(6), 2009, pp. 515<span class="special-character Dash">–</span>530. <a href="https://www.jstor.org/stable/40391144" target="_blank">www.jstor.org/stable/40391144</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Chien-Lih"></a>[9]</td>
<td>H. Chien-Lih, <span class="special-character OpenCurlyDoubleQuote">“</span>More Machin-type Identities,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematical Gazette</em>, <strong>81</strong>(490), 1997, pp. 120<span class="special-character Dash">–</span>121. <a href="https://www.jstor.org/stable/3618793" target="_blank">doi.org/10.2307/3618793</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Weisstein"></a>[10]</td>
<td>E. W. Weisstein. <span class="special-character OpenCurlyDoubleQuote">“</span>Machin-like Formulas<span class="special-character CloseCurlyDoubleQuote">”</span> from Wolfram MathWorld<span class="special-character LongDash">—</span>A Wolfram Web Resource. <a href="https://mathworld.wolfram.com/Machin-LikeFormulas.html">mathworld.wolfram.com/Machin-LikeFormulas.html</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Chien-Li-2004"></a>[11]</td>
<td>H. Chien-Lih, <span class="special-character OpenCurlyDoubleQuote">“</span>Some Observations on the Method of Arctangents for the Calculation of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_212-e1621867635941.gif" alt="" width="7" height="12" />,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematical Gazette</em>, <strong>88</strong>(512), 2004, pp. 270<span class="special-character Dash">–</span>278. <a href="https://www.jstor.org/stable/3620848" target="_blank">www.jstor.org/stable/3620848</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Abrarov-Quine-3"></a>[12]</td>
<td>S. M. Abrarov and B. M. Quine, <span class="special-character OpenCurlyDoubleQuote">“</span>A Formula for Pi Involving Nested Radicals,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Ramanujan Journal</em>, <strong>46</strong>, 2018, pp. 657<span class="special-character Dash">–</span>665. <a href="https://link.springer.com/article/10.1007%2Fs11139-018-9996-8" target="_blank">doi.org/10.1007/s11139-018-9996-8</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="OEIS"></a>[13]</td>
<td>OEIS. <span class="special-character OpenCurlyDoubleQuote">“</span>Decimal Expansion of Pi,<span class="special-character CloseCurlyDoubleQuote">”</span> A000796. <a href="https://oeis.org/A000796" target="_blank">oeis.org/A000796</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="WolframCloud"></a>[14]</td>
<td>Wolfram Cloud. <span class="special-character OpenCurlyDoubleQuote">“</span>A Wolfram Notebook Playing with Machin-like Formulas.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://develop.open.wolframcloud.com/objects/exploration/MachinLike.nb">develop.open.wolframcloud.com/objects/exploration/MachinLike.nb</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Chien-Lih-2015"></a>[15]</td>
<td>H. Chien-Lih, <span class="special-character OpenCurlyDoubleQuote">“</span>An Elementary Derivation of Euler<span class="special-character CloseCurlyQuote">’</span>s Series for the Arctangent Function,<span class="special-character CloseCurlyDoubleQuote">”</span> <strong>89</strong>(516), 2005, pp. 469<span class="special-character Dash">–</span>470. <a href="https://www.cambridge.org/core/journals/mathematical-gazette/article/abs/8967-an-elementary-derivation-of-eulers-series-for-the-arctangent-function/3D53E3BC23BEAF049A9F1013E89E9F46" target="_blank">doi.org/10.1017/S0025557200178404</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Basel-Baillie"></a>[16]</td>
<td>U. B<span class="special-character ADoubleDot">ä</span>sel and R. Baillie, <span class="special-character OpenCurlyDoubleQuote">“</span>Sinc Integrals and Tiny Numbers.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://arxiv.org/abs/1510.03200" target="_blank">arxiv.org/abs/1510.03200</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Abrarov-Quine-4"></a>[17]</td>
<td>S. M. Abrarov and B. M. Quine, <span class="special-character OpenCurlyDoubleQuote">“</span>The Rational Number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/05/Abrarov_Math_213-e1621867650131.gif" alt="" width="10" height="19" /> for the Two-Term Machin-like Formula for Pi Computed by Iteration.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="https://yorkspace.library.yorku.ca/xmlui/handle/10315/33173" target="_blank">yorkspace.library.yorku.ca/xmlui/handle/10315/33173</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Abrarov-Quine-5"></a>[18]</td>
<td>S. M. Abrarov and B. M. Quine, <span class="special-character OpenCurlyDoubleQuote">“</span>Efficient Computation of Pi by the Newton<span class="special-character Dash">–</span>Raphson Iteration and a Two-Term Machin-like Formula,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>International Journal of Mathematics and Computer Science</em>, <strong>13</strong>(2), 2018, pp. 157<span class="special-character Dash">–</span>169. <a href="https://ijmcs.future-in-tech.net/13.2/R-Abrarov.pdf" target="_blank">ijmcs.future-in-tech.net/13.2/R-Abrarov.pdf</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Havil"></a>[19]</td>
<td>J. Havil, <em>The Irrationals: A Story of the Numbers You Can<span class="special-character CloseCurlyQuote">’</span>t Count On</em>, Princeton, NJ: Princeton University Press, 2012.</td>
</tr>
<tr>
<td class="Reference"><a name="Trott"></a>[20]</td>
<td>M. Trott. <span class="special-character OpenCurlyDoubleQuote">“</span>Continued Fraction Approximations of the Tangent Function<span class="special-character CloseCurlyDoubleQuote">”</span> from the Wolfram Demonstrations Project<span class="special-character LongDash">—</span>A Wolfram Web Resource. <a href="https://demonstrations.wolfram.com/ContinuedFractionApproximationsOfTheTangentFunction/">demonstrations.wolfram.com/ContinuedFractionApproximationsOfTheTangentFunction</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Muller"></a>[21]</td>
<td>J.-M. Muller, <em>Elementary Functions. Algorithms and Implementation</em>, 3rd ed., Boston: Birkh<span class="special-character ADoubleDot">ä</span>user, 2016.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>S. M. Abrarov, R. Siddiqui, R. Jagpal and B. M. Quine, <span class="special-character OpenCurlyDoubleQuote">“</span>Unconditional Applicability of Lehmer<span class="special-character CloseCurlyQuote">’</span>s Measure to the Two-Term Machin-like Formula for Pi,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2021. <a href="https://doi.org/10.3888/tmj.23-2">doi.org/10.3888/tmj.23-2</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Authors</h3>
<p class="TextAboutAuthor">Sanjar M. Abrarov received a BSc degree in Physics, and CSc and PhD degrees in Physics and Engineering. He is a research scientist at the Algonquin Radio Observatory at Thoth Technology, Inc., Canada, and a senior lecturer at Epic College of Technology, Canada. He is a recipient of the Canadian Astronautics and Space Institute Alouette (2010).</p>
<p class="TextAboutAuthor"><strong>Sanjar M. Abrarov<br />
</strong><em>Thoth Technology, Inc.<br />
Algonquin Radio Observatory<br />
Achray Rd, RR6<br />
Pembroke, Canada, K8A 6W7</em><br />
<em><a href="mailto:abrarov@alumni.yorku.ca">abrarov@alumni.yorku.ca</a></em><br />
<em><a href="mailto:sanjar@thothx.com">sanjar@thothx.com</a></em></p>
<p class="TextAboutAuthor">Rehan Siddiqui received BSc (Honours) and MSc degrees in Physics, an MEng in Power Engineering, and MSc and PhD degrees in Physics and Astronomy. He is a recipient of the Queen Elizabeth II (2015), Vernon Oliver Stong (2015) and Dr. Ralph Nicholls (2016) graduate scholarships, and of the York University Postdoctoral Fellowship (2017). He is a contract faculty and research associate at York University and a dean at Epic College of Technology, Canada.</p>
<p class="TextAboutAuthor"><strong>Rehan Siddiqui</strong><br />
<em>Dept. Earth and Space Science and Engineering<br />
York University<br />
4700 Keele St.<br />
Toronto, Canada, M3J 1P3</em><br />
<em><a href="mailto:rehanrul@yorku.ca">rehanrul@yorku.ca</a></em><br />
<em><a href="mailto:rehan@epiccollege">rehan@epiccollege.ca</a></em></p>
<p class="TextAboutAuthor">Rajinder K. Jagpal received BSc and MSc degrees in Physics, and MSc and PhD degrees in Physics and Astronomy. He is a contract faculty and research associate at York University, Canada, and a director of Epic College of Technology, Canada. He is a recipient of the Canadian Astronautics and Space Institute Alouette (2010).</p>
<p class="TextAboutAuthor"><strong>Rajinder Jagpal</strong><br />
<em>Dept. Physics and Astronomy, York University<br />
4700 Keele St., Toronto, Canada, M3J 1P3</em><br />
<em><a href="mailto:raj@epiccollege.ca">raj@epiccollege.ca</a></em></p>
<p class="TextAboutAuthor">Brendan M. Quine received BSc, PhD and DPhil degrees in Physics. He is an associate professor at York University, Canada, and a director of the Algonquin Radio Observatory at Thoth Technology, Inc., Canada. He is a recipient of the Canadian Astronautics and Space Institute Alouette (2010).</p>
<p class="TextAboutAuthor"><strong>Brendan M. Quine</strong><br />
<em>Dept. Physics and Astronomy<br />
York University, 4700 Keele St.<br />
Canada, M3J 1P3</em><em><br />
</em><em><a href="mailto:bquine@yorku.ca">bquine@yorku.ca</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2021/05/24/unconditional-applicability-of-lehmers-measure-to-the-two-term-machin-like-formula-for-%cf%80/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Coverage versus Confidence</title>
		<link>https://www.mathematica-journal.com/2021/03/03/coverage-versus-confidence/</link>
		<comments>https://www.mathematica-journal.com/2021/03/03/coverage-versus-confidence/#respond</comments>
		<pubDate>Wed, 03 Mar 2021 23:04:02 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 23]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=60865</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.23-1 This article is intended to help students understand the concept of a coverage probability involving confidence intervals. Mathematica is used as a language for describing an algorithm to compute the coverage probability for a simple confidence interval based on the binomial distribution. Then, higher-level functions are used to compute probabilities of expressions in order [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.23-1">https://doi.org/10.3888/tmj.23-1</a></span></div>
<div>
This article is intended to help students understand the concept of a coverage probability involving confidence intervals. Mathematica is used as a language for describing an algorithm to compute the coverage probability for a simple confidence interval based on the binomial distribution. Then, higher-level functions are used to compute probabilities of expressions in order to obtain coverage probabilities. Several examples are presented: two confidence intervals for a population proportion based on the binomial distribution, an asymptotic confidence interval for the mean of the Poisson distribution, and an asymptotic confidence interval for a population proportion based on the negative binomial distribution.<span id="more-60865"></span></p>
<h3>1. Introduction</h3>
<p>Introductory courses in mathematical statistics present the rudimentary concepts behind confidence intervals. The creation of confidence intervals often involves the use of maximum likelihood estimation and the central limit theorem along with estimated standard errors.This is described in Casella and Berger [<a href="Casella-Berger">1</a>] p. 497. Consequently, the level of confidence is often only approximate. This is particularly the case when continuous probability models are used to approximate discrete probabilities. The probability that the interval surrounds the unknown parameter depends on the value of the unknown parameter. Such a probability is called a <em>coverage probability</em>. Confidence is defined as the infimum of the coverage probabilities. The following definitions can be found in Casella and Berger [<a href="Casella-Berger">1</a>] p. 418.</p>
<p><span class="DisplayFormula"><strong>Definition (Coverage and Confidence)</strong></span></p>
<p>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_1.gif" alt="" width="105" height="12" /> where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_2.gif" alt="" width="12" height="12" /> are all independent from a distribution with probability density (or discrete mass) function given by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_3.gif" alt="" width="101" height="12" />. The support of each <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_4.gif" alt="" width="12" height="12" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_5.gif" alt="" width="8" height="12" /> and the parameter space is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_6.gif" alt="" width="8" height="12" />. Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_7.gif" alt="" width="23" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_8.gif" alt="" width="25" height="12" /> be the lower and upper limits of a confidence interval. Then the coverage probability of the interval evaluated at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_9.gif" alt="" width="5" height="12" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_10.gif" alt="" width="177" height="12" />. The level of confidence is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_11.gif" alt="" width="88" height="14" />.</p>
<p>Students are often confused about how to compute coverage probabilities. This tutorial is intended to help students understand them. We give a detailed explanation of calculating one particular coverage probability. This also allows one to perform the calculations with a minimum of distraction involving programming. We then compute coverage probabilities using higher-level functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_12.gif" alt="" width="79" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_13.gif" alt="" width="86" height="12" /> that allow specifying a function of a random variable along with its distribution. In both cases these functions allow one to focus on the higher-level ideas rather than low-level nuts and bolts of programming.</p>
<p>Coverage probabilities are best calculated by computer. This necessitates the choice of a programming language and programming environment. Statisticians are generally familiar with one or more statistical programming languages such as SAS, R and so on. Such languages are necessary productivity tools due to their significant data handling capabilities as well as their statistical methods. They are indispensable to the statistician. However, they are not as useful as a language for describing algorithms. Small <span class="special-character OpenCurlyDoubleQuote">“</span>bookkeeping&#8221; matters often obscure the algorithm or method to be calculated. This tutorial uses Mathematica as a language to describe the computation of coverage probabilities. With a little additional effort, one can produce graphs of coverage probabilities as well as dynamic demonstrations that use a slider to illustrate the effect of the sample size on the graph. The Wolfram Demonstrations Project website contains numerous Demonstrations involving a wide variety of topics. One such Demonstration provided by Heiner and Wagon [<a href="Heiner-Wagon">2</a>] involves coverage probabilities for a population proportion using a Wald approach as well as a Bayesian approach. This article takes a different approach than Heiner and Wagon.</p>
<p>We illustrate the idea of coverage (and hence confidence) with several examples.</p>
<p>Section <a href="Section:2">2</a> describes two asymptotically justified confidence intervals for estimating a population proportion based on the binomial distribution. The first confidence interval is a simple hand calculation interval contained in many textbooks. We present a step-by-step algorithm for computing the coverage probability for one specific value of the population parameter. We stress clarity of computation rather than efficiency. The approach is adequate for a population described by a discrete distribution with a finite number of possible values. We then compute the coverage probability using a much higher-level function, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_14.gif" alt="" width="79" height="12" />, to automatically compute the probability associated with an inequality. We also use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_15.gif" alt="" width="79" height="12" /> for subsequent calculations. We produce a typical graph of coverage probabilities found in some textbooks. The second confidence interval for a population proportion (again based on the binomial distribution) is more complicated but has gained popularity. Naturally, it will be seen that coverage probabilities are generally higher than the level of confidence when approximations are used to create a confidence interval. This is illustrated in the examples below.</p>
<p>Section <a href="Section:3">3</a> presents an asymptotically justified confidence interval for the mean of a population described by a Poisson distribution. The Poisson distribution has infinitely many possible observable values. The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_16.gif" alt="" width="79" height="12" /> used to evaluate coverage probabilities automatically takes this into account.</p>
<p>Section <a href="Section:4">4</a> presents a graph of coverage probabilities based on an asymptotically justified confidence interval for estimating a population proportion based on the negative binomial distribution.</p>
<p>Section <a href="Section:5">5</a> presents a summary.</p>
<h3>2. A Population Proportion and the Binomial Distribution</h3>
<h4>The Simplest Confidence Interval</h4>
<p>A population has a proportion <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_17.gif" alt="" width="7" height="12" /> of members with a given characteristic. In order to estimate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_18.gif" alt="" width="7" height="12" />, one randomly selects <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_19.gif" alt="" width="6" height="12" /> members of the population with replacement, say <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_20.gif" alt="" width="54" height="12" />, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_21.gif" alt="" width="12" height="12" /> are independent and identically distributed random variables, each with a Bernoulli distribution with parameter <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_22.gif" alt="" width="7" height="12" />. If <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_23.gif" alt="" width="8" height="12" /> is the number of members in the random sample possessing the target characteristic, that is, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_24.gif" alt="" width="112" height="12" />, then <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_25.gif" alt="" width="8" height="12" /> has a binomial distribution with parameters <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_26.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_27.gif" alt="" width="7" height="12" />. The sample proportion of members with the characteristic is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_28.gif" alt="" width="43" height="14" />. Two large sample confidence intervals for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_29.gif" alt="" width="7" height="12" /> are typically given. We start with the simplest. A large sample confidence interval of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_30.gif" alt="" width="25" height="12" /> for<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_31.gif" alt="" width="9" height="12" /> is given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_1.gif" alt="" width="113" height="23" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:1"></a>(1)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_32.gif" alt="" width="19" height="14" /> is the upper <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_33.gif" alt="" width="21" height="12" /> part of the standard normal distribution.</p>
<p>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_34.gif" alt="" width="109" height="23" />, the standard error of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_35.gif" alt="" width="7" height="14" />. So, we may shorten (<a href="Eq:1">1</a>) by writing it as</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_2.gif" alt="" width="69" height="16" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:2"></a>(2)</td>
</tr>
</tbody>
</table>
<p>One can find the confidence interval in expression (<a href="Eq:2">2</a>) in virtually any statistics book; in particular, see Devore and Berk [<a href="Devore-Berk">3</a>] p. 396. Also, coverage probabilities for this confidence interval are described in Brown, Cai and DasGupta [<a href="Brown-Cai-DasGupta">4</a>]. The derivation of the interval leads one to believe that the level of confidence is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_36.gif" alt="" width="25" height="12" />. However, two approximations are used to derive the interval in expression (<a href="Eq:2">2</a>). One approximation uses the central limit theorem. A second approximation uses an estimated variance for the sampling distribution of the sample proportion <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_37.gif" alt="" width="7" height="12" />. We want to compute the actual coverage probability for any possible value of the true population proportion <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_38.gif" alt="" width="7" height="12" />. The coverage probability is</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_3.gif" alt="" width="272" height="18" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:3"></a>(3)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_39.gif" alt="" width="43" height="14" />. Books are sometimes vague about whether or not to include the endpoints in the inequality. We exclude the endpoints in order to be consistent with typical hypothesis testing methods.</p>
<p>The definition of coverage confuses many students. For a given value of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_40.gif" alt="" width="7" height="12" /> with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_41.gif" alt="" width="47" height="12" />, one must determine the set values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_42.gif" alt="" width="8" height="12" /> satisfying the inequality in expression (<a href="Eq:3">3</a>) and compute the probability of observing such values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_43.gif" alt="" width="8" height="12" />. We will describe how to determine the set of values and then compute their probability. Once we know what is actually being computed, we will move on to higher-level functions that perform the computations automatically.</p>
<p>We use an example with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_44.gif" alt="" width="32" height="12" />. A plot will show how bad the approximation can be and also displays the output of each step of the algorithm. We will compute the coverage probability for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_45.gif" alt="" width="36" height="12" />. The input and output are presented in a conversational style with some editorial comments along the way.</p>
<p>We wish to determine the upper <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_46.gif" alt="" width="15" height="12" /> percentage value from the standard normal distribution. The variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_47.gif" alt="" width="14" height="12" /> is often called a critical value for the standard normal distribution. The result will be a floating-point number, which restricts the accuracy and precision of all calculations that use it; the result of this calculation is a floating-point number.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_1.gif" alt="" width="320" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_1.gif" alt="" width="50" height="12" /></p>
<p>Define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_48.gif" alt="" width="14" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_2.gif" alt="" width="162" height="38" /></p>
<p>Here is the confidence interval inequality for sample size 10 and general <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_49.gif" alt="" width="7" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_3.gif" alt="" width="365" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_2.gif" alt="" width="382" height="39" /></p>
<p>The support of the random variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_50.gif" alt="" width="8" height="12" /> is the set of values <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_51.gif" alt="" width="6" height="12" /> for which the probability mass function is positive. They also represent the observable values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_52.gif" alt="" width="8" height="12" /> for a discrete random variable. We represent the support of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_53.gif" alt="" width="8" height="12" /> with the programming variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_54.gif" alt="" width="14" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_4.gif" alt="" width="111" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_3.gif" alt="" width="208" height="12" /></p>
<p>This tests whether the inequality is true for each value of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_55.gif" alt="" width="8" height="12" /> and probability 0.5.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_5.gif" alt="" width="203" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_4.gif" alt="" width="485" height="12" /></p>
<p>These are the positions that yield <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_56.gif" alt="" width="29" height="12" />; <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_57.gif" alt="" width="50" height="12" /> eliminates one level of parentheses. We wish to compute the probabilities of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_52.gif" alt="" width="8" height="12" /> at those positions and sum them.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_6.gif" alt="" width="305" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_5.gif" alt="" width="93" height="12" /></p>
<p>These are the appropriate values of the variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_52.gif" alt="" width="8" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_7.gif" alt="" width="193" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_6.gif" alt="" width="93" height="12" /></p>
<p>Now one computes the probabilities for the individual values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_52.gif" alt="" width="8" height="12" /> satisfying the inequality.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_8.gif" alt="" width="397" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_7.gif" alt="" width="348" height="12" /></p>
<p>Finally, the values of the individual probabilities are summed to create the actual coverage probability for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_58.gif" alt="" width="36" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_9.gif" alt="" width="52" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_8.gif" alt="" width="58" height="12" /></p>
<p>The steps have been broken down so that students can easily understand what is needed. A large sample justification leads us to believe that this number should be about 0.95. The coverage probability is about 0.89 rather than 0.95.</p>
<p>Here is a much more transparent manner in which to compute the coverage probability. We may use a system function for evaluating the probability of expressions of a random variable. Apparently, the system function automatically tests each possible value of the random variable to determine the ones that satisfy the inequality. (This works quite well for a discrete random variable with a finite number of observable values.) The relevant probabilities are then summed. This approach is not efficient in cases with infinitely many observable values of a random variable. However, it is straightforward and easy for a student to understand. We evaluate the probability of an expression involving the binomial random variable. The expression of the binomial random variable is the confidence interval inequality.</p>
<p>Let us define a function that constructs the inequality more explicitly.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_10.gif" alt="" width="273" height="124" /></p>
<p>Define the function that computes the coverage.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_11.gif" alt="" width="257" height="103" /></p>
<p>We now plot the coverage probabilities for a range of values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_59.gif" alt="" width="7" height="12" /> in Figure <a href="Fig:1">1</a> below. We also create a horizontal line at a level of 0.95 for comparison purposes. The graph is symmetric due to properties of the binomial distribution and the large sample approximation involved in the confidence interval justification.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_12.gif" alt="" width="352" height="73" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_9.gif" alt="" width="360" height="236" /></p>
<p class="NumberedFigureCaption"><strong>Figure 1.</strong> Coverage plot for first binomial confidence interval, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_60.gif" alt="" width="25" height="12" />.</p>
<p>Examining Figure <a href="Fig:1">1</a> indicates several points. First, the coverage probabilities are in general not equal to the nominal level of confidence<span class="special-character LongDash">—</span>namely .95. Moreover, coverage probabilities near <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_61.gif" alt="" width="27" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_62.gif" alt="" width="27" height="12" /> are effectively zero. Finally, the coverage probability function is discontinuous. All this with a minimum level of programming. In fact, the programming statements presented are simply a good description of the algorithm.</p>
<p>More is available. We wish to be able to change the plot by varying the sample size with a slider. A dynamic demonstration can easily be created with the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_63.gif" alt="" width="72" height="12" /> function. The manipulate variable is the sample size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_64.gif" alt="" width="6" height="12" />, which you can vary with a slider from 5 to 100.</p>
<p>The graph is in Figure <a href="Fig:2">2</a>. The computer processing time increases with the value of the sample size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_65.gif" alt="" width="6" height="12" /> because the inequality must be tested for each possible value of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_66.gif" alt="" width="8" height="12" />. The initial sample size is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_67.gif" alt="" width="32" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_13.gif" alt="" width="353" height="163" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_10.gif" alt="" width="403" height="340" /></p>
<p class="NumberedFigureCaption"><strong>Figure 2.</strong> Coverage plot as a function of sample size.</p>
<p>A larger sample size improves the coverage probabilities as one expects. After all, the confidence interval formula is justified by a large sample argument. However, it is very clear that the coverage probability is small when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_68.gif" alt="" width="7" height="12" /> is close to either 0 or 1 even with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_69.gif" alt="" width="32" height="12" />. For some sample sizes it is even more obvious that this function contains discontinuities.</p>
<h4>A Better Confidence Interval for a Population Proportion</h4>
<p>This subsection presents coverage probabilities for an improved confidence interval for a population proportion. The improvement makes coverage probabilities generally larger.</p>
<p>Devore and Berk [<a href="Devore-Berk">3</a>, p. 395] give a better large sample confidence interval for a population proportion. Based on the same assumptions as expression (<a href="Eq:1">1</a>), a sample confidence interval of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_70.gif" alt="" width="25" height="12" /> for a population proportion <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_71.gif" alt="" width="7" height="12" /> is given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_4.gif" alt="" width="264" height="25" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:4"></a>(4)</td>
</tr>
</tbody>
</table>
<p>This confidence interval is based on solving the following inequality for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_72.gif" alt="" width="7" height="12" />:</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_5.gif" alt="" width="176" height="18" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:5"></a>(5)</td>
</tr>
</tbody>
</table>
<p>This defines the new inequality accordingly.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_14.gif" alt="" width="275" height="135" /></p>
<p>Just as with the previous kind of inequality, define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_73.gif" alt="" width="65" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_15.gif" alt="" width="257" height="103" /></p>
<p>Figure <a href="Fig:3">3</a> is the corresponding plot, again with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_74.gif" alt="" width="32" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_16.gif" alt="" width="345" height="73" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_11.gif" alt="" width="360" height="228" /></p>
<p class="NumberedFigureCaption"><strong>Figure 3.</strong> Coverage plot for the better confidence interval, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_75.gif" alt="" width="25" height="12" />.</p>
<p>The inequality in (<a href="Eq:5">5</a>) is supposed to have a probability of approximately <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_76.gif" alt="" width="25" height="12" /> before sampling the population. We can of course compute the true probability with respect to the correct binomial distribution. The Mathematica code follows along with a dynamic graph in Figure <a href="Fig:4">4</a>.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_17.gif" alt="" width="346" height="163" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_12.gif" alt="" width="403" height="340" /></p>
<p class="NumberedFigureCaption"><strong>Figure 4.</strong> Coverage probabilities for the superior asymptotic confidence interval for a population proportion.</p>
<p>Figure <a href="Fig:5">5</a> contains the code and plot for the dynamic version of the plot. This plot allows for an easy comparison of the coverage probabilities for the two types of confidence intervals.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_18.gif" alt="" width="580" height="163" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_13.gif" alt="" width="403" height="340" /></p>
<p class="NumberedFigureCaption"><strong>Figure 5.</strong> A comparison of coverage probabilities for the two binomial intervals.</p>
<p>The coverage probabilities for this improved confidence interval for a population proportion are indeed superior to the simpler interval. In particular, the coverage probabilities are quite large when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_77.gif" alt="" width="7" height="12" /> is close to 0 or 1. One can see this even with a sample size of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_78.gif" alt="" width="32" height="12" />, for which the large sample approximation is not appropriate. The difference in coverage probabilities with the simple interval (displayed in Figure <a href="Fig:2">2</a>) and this improved interval is striking.</p>
<h3>3. The Mean of the Poisson Distribution</h3>
<p>We now turn our attention to the Poisson distribution.</p>
<p>The book by Devore and Berk [<a href="#Devore-Berk">3</a>, p. 400] presents a homework exercise for determining a confidence interval of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_79.gif" alt="" width="25" height="12" /> for the mean <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_80.gif" alt="" width="5" height="12" /> of a population described by a Poisson distribution. Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_81.gif" alt="" width="75" height="12" />, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_82.gif" alt="" width="12" height="12" /> are independent and identically distributed with a Poisson distribution with parameter (mean) of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_83.gif" alt="" width="5" height="12" />. Ideally, we must solve the inequality</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_6.gif" alt="" width="145" height="18" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:6"></a>(6)</td>
</tr>
</tbody>
</table>
<p>to obtain the desired confidence interval. However, if we have a large enough sample, we may replace the true standard error in the denominator with its estimate. Again, this produces a less than ideal result.</p>
<p>The resulting simple confidence interval of approximate size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_84.gif" alt="" width="25" height="12" /> for the mean <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_85.gif" alt="" width="5" height="12" /> is given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_7.gif" alt="" width="198" height="24" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:7"></a>(7)</td>
</tr>
</tbody>
</table>
<p>which has an approximate level of confidence of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_86.gif" alt="" width="25" height="12" />. The parameter <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_87.gif" alt="" width="5" height="12" /> in the denominator was replaced by the sample mean. Figure <a href="Fig:6">6</a> contains the code and graph for the coverage probabilities. We use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_88.gif" alt="" width="32" height="12" />. We let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_89.gif" alt="" width="51" height="15" /> where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_90.gif" alt="" width="50" height="33" /> has a Poisson distribution with a mean of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_91.gif" alt="" width="19" height="12" />. In principle, the inequality must be tested for each of the infinitely many possible values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_92.gif" alt="" width="8" height="12" />. Coverage probabilities are evaluated at a discrete set of points in order to save computational time.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_19.gif" alt="" width="329" height="295" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_14.gif" alt="" width="360" height="237" /></p>
<p class="NumberedFigureCaption"><strong>Figure 6.</strong> Coverage probabilities for the confidence interval for the Poisson mean <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_93.gif" alt="" width="25" height="12" />.</p>
<p>Unless <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_94.gif" alt="" width="5" height="12" /> is close to zero, this large sample approximation is quite good for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_95.gif" alt="" width="32" height="12" />, which is easily seen in Figure <a href="Fig:6">6</a>. Given the two approximations used, it is not surprising that the coverage probability is small when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_96.gif" alt="" width="5" height="12" /> is close to zero.</p>
<h3>4. The Population Proportion and the Negative Binomial Distribution</h3>
<p>This section addresses the situation of estimating a population proportion when the negative binomial distribution is appropriate.</p>
<p>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_97.gif" alt="" width="75" height="12" />, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_98.gif" alt="" width="12" height="12" /> are independent and identically distributed with a geometric distribution with parameter <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_99.gif" alt="" width="7" height="12" />. It is well known that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_100.gif" alt="" width="59" height="14" /> has a negative binomial distribution with parameters <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_101.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_102.gif" alt="" width="7" height="12" />, (see [<a href="Kinney">5</a>], p. 127). Consequently, we use the negative binomial distribution for estimating a population proportion. There are many ways to define the negative binomial distribution. We use the version described in Kinney [<a href="Kinney">5</a>, p. 125]. Conduct independent success/failure trials, each with a probability of success <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_103.gif" alt="" width="7" height="12" />. Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_104.gif" alt="" width="8" height="12" /> be the total number of trials needed to obtain <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_105.gif" alt="" width="6" height="12" /> successes. The probability mass function for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_106.gif" alt="" width="8" height="12" /> is given by</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_8.gif" alt="" width="223" height="29" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:8"></a>(8)</td>
</tr>
</tbody>
</table>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_107.gif" alt="" width="47" height="12" />.</p>
<p>Some authors count the number of trials before the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_108.gif" alt="" width="14" height="15" /> success. Other authors count the number of failures before the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_109.gif" alt="" width="14" height="15" /> success. There are other possibilities still. Mathematica uses <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_110.gif" alt="" width="8" height="12" />, the number of failures before the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_111.gif" alt="" width="14" height="15" /> success. Consequently, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_112.gif" alt="" width="48" height="12" />.</p>
<p>Casella and Berger [<a href="Casella-Berger">1</a>, p. 496] describe large sample confidence intervals based on maximum likelihood. It is easily shown that the maximum likelihood estimator for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_113.gif" alt="" width="7" height="12" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_114.gif" alt="" width="43" height="14" />. Moreover, the asymptotic variance of this estimator is the reciprocal of the Fisher information, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_115.gif" alt="" width="108" height="18" />. Fisher information is described in Casella and Berger [<a href="Casella-Berger">1</a>, p. 388]. This variance expression is not useful for creating a confidence interval for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_116.gif" alt="" width="7" height="12" /> since it depends on <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_117.gif" alt="" width="7" height="12" />. So, we estimate the large sample variance by replacing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_118.gif" alt="" width="7" height="12" /> with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_119.gif" alt="" width="7" height="14" />. This leads to the large sample confidence interval:</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_DisplayFormulaNumbered_9.gif" alt="" width="318" height="30" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Eq:9"></a>(9)</td>
</tr>
</tbody>
</table>
<p>In order to conveniently perform the calculations, we note that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_120.gif" alt="" width="105" height="14" />. We evaluate the coverage probability for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_121.gif" alt="" width="71" height="12" /> in steps of 0.01. We based the calculations on <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_122.gif" alt="" width="32" height="12" />. The calculation can take some time depending on the computer. When <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_123.gif" alt="" width="7" height="12" /> is small, values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_124.gif" alt="" width="8" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_125.gif" alt="" width="8" height="12" /> are extremely unlikely. This makes the internal algorithm take quite a while. We can help speed up the calculations by using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_126.gif" alt="" width="86" height="12" /> rather than the symbolic <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_127.gif" alt="" width="79" height="12" />. The speedup occurs by reducing the required number of digits in calculations. Even so, this calculation takes some time (about four minutes on the author<span class="special-character CloseCurlyQuote">’</span>s computer). A graph of the coverage probabilities is contained in Figure <a href="Fig:7">7</a>.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Input_20.gif" alt="" width="374" height="351" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Output_15.gif" alt="" width="360" height="236" /></p>
<p class="NumberedFigureCaption"><strong>Figure 7.</strong> Coverage probabilities for the confidence interval for a population proportion on the negative binomial distribution, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_128.gif" alt="" width="25" height="12" />.</p>
<p>We see from Figure <a href="Fig:7">7</a> that the approximation is quite good for values of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_129.gif" alt="" width="7" height="12" /> close to 0.2. We infer that the approximation is also quite good if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_130.gif" alt="" width="7" height="12" /> is close to 0. The approximation generally gets worse as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_131.gif" alt="" width="7" height="12" /> increases (though not monotonically). A large sample approximation was used. Also, an approximate standard error was used. One sees that the coverage probability is essentially zero when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2021/02/Cook_Math_132.gif" alt="" width="7" height="12" /> is close to 1.</p>
<h3>5. Summary</h3>
<p>Large sample confidence intervals are often quite easy to derive. This is particularly true when using an estimate for the standard error of an estimator. However, the actual probability of surrounding the parameter value (coverage) can be quite different from the nominal value. It is helpful to graph the coverage probabilities to see this. Mathematica is particularly useful in performing these calculations and providing a language for describing the algorithms.</p>
<h3>Acknowledgments</h3>
<p>The author wishes to thank the anonymous reviewer and the editor for their help in improving this article.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Casella-Berger"></a>[1]</td>
<td>G. Casella and R. Berger, <em>Statistical Inference, </em>2nd ed., United States: Brooks/Cole Cengage Learning, 2002.</td>
</tr>
<tr>
<td class="Reference"><a name="Heiner-Wagon"></a>[2]</td>
<td>K. Heiner and S. Wagon. <span class="special-character OpenCurlyDoubleQuote">“</span>Wald and Bayesian Confidence Intervals<span class="special-character CloseCurlyDoubleQuote">”</span> from the Wolfram Demonstrations Project<span class="special-character LongDash">—</span>A Wolfram Web Resource. <a href="https://www.demonstrations.wolfram.com/WaldAndBayesianConfidenceIntervals">www.demonstrations.wolfram.com/WaldAndBayesianConfidenceIntervals</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Devore-Berk"></a>[3]</td>
<td>J. Devore and K. Berk, <em>Modern Mathematical Statistics with Applications</em>, 2nd ed., New York: Springer, 2012.</td>
</tr>
<tr>
<td class="Reference"><a name="Brown-Cai-DasGupta"></a>[4]</td>
<td>L. D. Brown, T. T. Cai and A. DasGupta, <span class="special-character OpenCurlyDoubleQuote">“</span>Confidence Intervals for a Binomial Proportion and Asymptotic Expansions,<span class="special-character CloseCurlyDoubleQuote">”</span> The <em>Annals of Statistics</em>, <strong>30</strong>(1), 2002 pp. 160<span class="special-character Dash">–</span>201. <a href="https://www.jstor.org/stable/2700007" target="_blank">www.jstor.org/stable/2700007</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Kinney"></a>[5]</td>
<td>J. Kinney, <em>Probability: An Introduction with Statistical Applications</em>, New York: John Wiley and Sons, 1997.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>P. Cook, <span class="special-character OpenCurlyDoubleQuote">“</span>Coverage versus Confidence,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2021. <a href="https://doi.org/10.3888/tmj.23-1">https://doi.org/10.3888/tmj.23-1</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Peyton Cook earned a B.A. in Psychology, B.S. in Mathematics, and an M.S. and Ph.D. in Statistics. He is an Associate Professor at The University of Tulsa.</p>
<p class="TextAboutAuthor"><strong>Peyton Cook</strong><br />
<em>Department of Mathematics<br />
The University of Tulsa<br />
800 Tucker Drive<br />
Tulsa, Oklahoma 74104<br />
pcook@utulsa.edu</em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2021/03/03/coverage-versus-confidence/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Structural Equation Modeling</title>
		<link>https://www.mathematica-journal.com/2020/12/28/structural-equation-modeling/</link>
		<comments>https://www.mathematica-journal.com/2020/12/28/structural-equation-modeling/#respond</comments>
		<pubDate>Mon, 28 Dec 2020 23:39:03 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 22]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=60651</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.22-5 Structural equational modeling is a very popular statistical technique in the social sciences, as it is very flexible and includes factor analysis, path analysis and others as special cases. While usually done with specialized programs, the same can be achieved in Mathematica, which has the benefit of allowing control of any aspect of the [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.22-5">https://doi.org/10.3888/tmj.22-5</a></span></div>
<div>
<p>Structural equational modeling is a very popular statistical technique in the social sciences, as it is very flexible and includes factor analysis, path analysis and others as special cases. While usually done with specialized programs, the same can be achieved in Mathematica, which has the benefit of allowing control of any aspect of the calculation. Moreover, a second, more flexible, approach to calculating these models is described that is conceptually much easier yet potentially more powerful. This second approach is used to describe a solution of the attenuation problem of regression.<span id="more-60651"></span></p>
<h3>The SEM Method</h3>
<p>Linear structural equation modeling (SEM) is a technique that has found widespread use in many sciences in the last decades. An early foundational work is Bollen [<a href="#Bollen">1</a>]; a more recent overview is provided by Hoyle [<a href="#Hoyle">2</a>]. The basic idea is to model the linear structure of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_1.gif" alt="" width="6" height="12" /> observed variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_2.gif" alt="" width="49" height="12" /> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_3.gif" alt="" width="6" height="12" /> cases (observations, subjects) by linear equations that may involve latent variables. These variables are not measured directly but inferred from the observed variables by their linear relation to the observed variables.</p>
<p>Many commercial programs (including LISREL, Amos, Mplus) and free ones (including lavaan, sem, OpenMX) have been developed to carry out the estimation procedure. From my perspective, the R package lavaan [<a href="#Gana">3</a>, <a href="#Rosseel">4</a>] by Yves Rosseel is the most reliable and convenient one among the free programs. I use it as the gold standard to judge results of my own code.</p>
<p>This article first gives a quick overview of the standard SEM theory, then shows how to perform the calculations in Mathematica. In the last section, a second approach is discussed.</p>
<h4>The Standard Example</h4>
<p>There is a standard example due to Bollen that is also used in the lavaan manual. The dataset consists of observations of 11 manifest variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_4.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_5.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_6.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_7.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_8.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_9.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_10.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_11.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_12.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_13.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_14.gif" alt="" width="12" height="12" />. SEM models are usually depicted graphically. In the lavaan documentation, this is displayed as in Figure 1.</p>
<p><img src="https://content.wolfram.com/uploads/sites/19/2020/12/1.gif" alt="" width="342" height="283" /></p>
<p class="NumberedFigureCaption"><strong>Figure 1.</strong> Bollen<span class="special-character CloseCurlyQuote">’</span>s democracy model (image from lavaan documentation [<a href="#Rosseel">4</a>]).</p>
<p>The variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_15.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_16.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_17.gif" alt="" width="12" height="12" /> are observed variables that measure the construct of industrialization in 1960, which is described by the latent variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_18.gif" alt="" width="27" height="12" />. This means that the level of industrialization is assumed to be representable by one number for each country, but this number cannot be measured directly; it has to be inferred from its linear relation to gross national product <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_19.gif" alt="" width="12" height="12" />, energy consumption per capita <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_20.gif" alt="" width="12" height="12" /> and share of industrial workers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_21.gif" alt="" width="12" height="12" />. Next, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_22.gif" alt="" width="33" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_23.gif" alt="" width="33" height="12" /> are the democracy levels in 1960 and 1965, measured by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_24.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_25.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_26.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_27.gif" alt="" width="12" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_28.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_29.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_30.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_31.gif" alt="" width="12" height="12" /> (these indicators are freedom of the press, etc.). The data matrix consists of these 11 numbers for each of 75 countries (cases). The data is delivered with the lavaan package for R. The aim of estimating the model is twofold. First, the weights of the linear connections (represented in the picture by arrows) are estimated. These arrows encode linear equations by the rule that all arrows that end in a variable indicate a linear combination that yields the value of this variable plus some error term variable. To bring this mysterious language down to earth, here are the equations represented in Figure 1:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_32.gif" alt="" width="88" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_33.gif" alt="" width="57" height="12" />,<br />
<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_34.gif" alt="" width="95" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_35.gif" alt="" width="70" height="12" />,<br />
<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_36.gif" alt="" width="95" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_37.gif" alt="" width="70" height="12" />,<br />
<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_38.gif" alt="" width="119" height="12" />,<br />
<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_39.gif" alt="" width="183" height="12" />.</p>
<p>The variable <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_40.gif" alt="" width="27" height="12" /> is called an exogenous latent variable because no arrow ends there. It has no associated error variable. However, its manifest (measured) indicator variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_41.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_42.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_43.gif" alt="" width="12" height="12" /> have associated error variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_44.gif" alt="" width="9" height="12" /> (they are called <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_45.gif" alt="" width="10" height="12" /> in [<a href="#Bollen">1</a>]). The indicator variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_46.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_47.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_48.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_49.gif" alt="" width="12" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_50.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_51.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_52.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_53.gif" alt="" width="12" height="12" /> of the two endogenous latent variables (those latent variables where arrows end) have error variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_54.gif" alt="" width="9" height="12" /> (called <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_55.gif" alt="" width="10" height="12" /> in [<a href="#Bollen">1</a>]). The equations that relate latent and manifest variables define the measurement part of the model. The two equations (coming from three arrows) between the latent variables are the structure model, usually of most interest. Fitting the model to the data gives estimates for the weights of the arrows, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_56.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_57.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_58.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_59.gif" alt="" width="11" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_60.gif" alt="" width="14" height="12" /> <span class="special-character Ellipsis">…</span>. The second goal of SEM modeling is to check how well the structure of the model fits the data; that is, SEM is also a hypothesis-testing method.</p>
<p>The equations given do not yet identify all variables. Assume we have a solution of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_61.gif" alt="" width="88" height="12" />; then for any number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_62.gif" alt="" width="6" height="12" />, the numbers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_63.gif" alt="" width="53" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_64.gif" alt="" width="90" height="12" /> would be solutions, too. To avoid this problem, we either fix the variance of the latent variables to be 1 or we fix some of the weights to be 1. This is the default in lavaan and we adopt it here, hence <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_65.gif" alt="" width="31" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_66.gif" alt="" width="32" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_67.gif" alt="" width="32" height="12" />.</p>
<h3>The Standard Way of Estimating SEM</h3>
<p>Ever since SEM<span class="special-character CloseCurlyQuote">’</span>s invention, SEM models are estimated by calculating the model<span class="special-character CloseCurlyQuote">’</span>s covariance matrix. From the data, we get the empirical covariance matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_68.gif" alt="" width="6" height="12" />. On the other hand, from the model, we can calculate a theoretical covariance matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_69.gif" alt="" width="7" height="12" /> between the observed variables. (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_70.gif" alt="" width="7" height="12" /> depends on the model and thus on the parameters.) For example, one entry in this matrix would be <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_71.gif" alt="" width="238" height="12" />. Using linearity and other properties of the covariance, this boils down to a matrix with entries that are polynomials in the model parameters and the covariances and variances between latent variables and error variables. However, without further assumptions, this gives a lot of covariances (e.g. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_72.gif" alt="" width="54" height="12" />) that are not determined by the model and hence must be estimated. As this usually leads to too much freedom, the broad assumption is that most error variables are uncorrelated. Only some covariances between error variables are not assumed to be 0; those are marked in the diagram by two-headed arrows between the observed variables. For every pair of observed variables, we calculate the covariance by using the above given model equation as replacement rules and applies linearity and independence assumptions. In the end, we get a covariance matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_73.gif" alt="" width="7" height="12" /> that depends on the model parameters <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_74.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_75.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_76.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_77.gif" alt="" width="11" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_78.gif" alt="" width="11" height="12" />, <span class="special-character Ellipsis">…</span> and on the variances of the latent variables and the covariances of error variables that are not assumed to be 0. Details can be found in Bollen [<a href="#Bollen">1</a>].</p>
<p>To fit the empirical and the theoretical covariance matrix, we have to choose these parameters to minimize some distance function. The three most common are uniform least-square, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_79.gif" alt="" width="105" height="23" />, generalized least-square, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_80.gif" alt="" width="129" height="23" /> (<em>I</em> is the identity matrix), and maximum likelihood, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_81.gif" alt="" width="209" height="18" /> (here <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_82.gif" alt="" width="6" height="12" /> is the number of manifest variables).</p>
<p>Now we are in the position to define a Mathematica function that performs SEM. First, we define the helper function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_83.gif" alt="" width="108" height="14" /> that gets all variables contained in an expression in such a way that, for example, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_84.gif" alt="" width="28" height="13" /> counts as one variable.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_1.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_2.gif" alt="" width="261" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_3.gif" alt="" width="194" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_4.gif" alt="" width="574" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_5.gif" alt="" width="357" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_6.gif" alt="" width="574" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_7.gif" alt="" width="575" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_8.gif" alt="" width="480" height="140" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_9.gif" alt="" width="274" height="169" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_10.gif" alt="" width="259" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_11.gif" alt="" width="411" height="14" /></p>
<p>Here is an example.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_12.gif" alt="" width="196" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_1.gif" alt="" width="60" height="13" /></p>
<p>The method will be explained with Bollen<span class="special-character CloseCurlyQuote">’</span>s democracy dataset, so first, we need to load this dataset. The file bollen.csv contains headers (the names of the variables are saved in the list <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_85.gif" alt="" width="101" height="13" />) and a first column numbering the cases, which is dropped.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_13.gif" alt="" width="580" height="107" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_2.gif" alt="" width="278" height="14" /></p>
<p>The data has 75 rows.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_14.gif" alt="" width="153" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_3.gif" alt="" width="53" height="13" /></p>
<p>Here is the first row of 11 numbers.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_15.gif" alt="" width="114" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_4.gif" alt="" width="496" height="13" /></p>
<p>The model itself has to be specified as a list of replacement rules that mirror the model equations discussed.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_16.gif" alt="" width="234" height="263" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_17.gif" alt="" width="490" height="13" /></p>
<p>The code for the estimation function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_86.gif" alt="" width="22" height="13" /> includes some utilities. For example, it defines its own covariance and variance functions that take into account which variables are assumed to be uncorrelated. The input of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_87.gif" alt="" width="22" height="13" /> is the data matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_88.gif" alt="" width="29" height="13" />, a matrix of numerical values, one row per case. The structural equations <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_89.gif" alt="" width="72" height="13" /> are given in the format detailed in the previous section, <span class="special-character OpenCurlyDoubleQuote">“</span>The Standard Example.<span class="special-character CloseCurlyDoubleQuote">”</span> Moreover, the function needs:</p>
<p><span class="special-character Bullet">•</span> the lists of free parameters, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_90.gif" alt="" width="72" height="14" /> (e.g. path weights)</p>
<p><span class="special-character Bullet">•</span> endogenous latent variables, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_91.gif" alt="" width="180" height="14" /></p>
<p><span class="special-character Bullet">•</span> exogenous latent variables, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_92.gif" alt="" width="173" height="14" /></p>
<p><span class="special-character Bullet">•</span> the list of error variables of latent variables, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_93.gif" alt="" width="223" height="13" /></p>
<p><span class="special-character Bullet">•</span> errors of exogenous manifest variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_94.gif" alt="" width="245" height="14" /></p>
<p><span class="special-character Bullet">•</span> errors of endogenous manifest variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_95.gif" alt="" width="252" height="14" /></p>
<p><span class="special-character Bullet">•</span> a list <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_96.gif" alt="" width="72" height="13" /> of pairs of error variables specifying which error variables are allowed to be correlated</p>
<p>The code after defining <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_97.gif" alt="" width="7" height="13" /> can be omitted on a first reading; it is only needed to calculate some fit indices (if required by the option <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_98.gif" alt="" width="29" height="13" />, which asks to do the fit index (FI) calculation; similarly, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_99.gif" alt="" width="29" height="13" /> asks to do the maximum likelihood estimation). The estimation is done at the end of the function.</p>
<p>The goal of the first half of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_100.gif" alt="" width="22" height="13" /> program is the definition of the covariance function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_101.gif" alt="" width="22" height="13" /> that takes into account the SEM assumptions: that most error variables are uncorrelated (except those specified to be correlated), leaving variances of latent variables as symbolic entities to be estimated.</p>
<p>This function is then used to calculate the model implied covariance matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_102.gif" alt="" width="7" height="13" />. Applying the model equation rules repeatedly gives a matrix that depends only on parameters, variances of latent variables and error variables and some allowed covariances of error variables. The code from the line defining <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_103.gif" alt="" width="14" height="13" /> (the degree of freedom) onward is only important for getting fit indices. If we are only interested in estimating the model parameters, the next interesting lines are where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_104.gif" alt="" width="79" height="13" /> is applied to estimate the model. As described in the introduction, there are several strategies to measure deviation of covariance matrices; for example, the definition of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_105.gif" alt="" width="22" height="13" /> is a straightforward coding for minimizing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_106.gif" alt="" width="134" height="23" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_18.gif" alt="" width="419" height="30" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_19.gif" alt="" width="580" height="1254" /></p>
<p>Let us run the code on Bollen&#8217;s model in a simplified version where no correlation of error variables is assumed. This may take several minutes.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_20.gif" alt="" width="580" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_5.gif" alt="" width="580" height="366" /></p>
<p>The result combines parameter, variance and covariance estimations according to the various estimating strategies. To judge how well the model fits the data, you can set the option <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_107.gif" alt="" width="29" height="13" /> to some fit indices:</p>
<p><span class="special-character Bullet">•</span> RMSEA is the root square mean error</p>
<p><span class="special-character Bullet">•</span> CFI is the comparable fit index</p>
<p><span class="special-character Bullet">•</span> TLI is the Tucker<span class="special-character Dash">–</span>Lewis fit index</p>
<p><span class="special-character Bullet">•</span> NFI is the normed fit index</p>
<p>RMSEA should be less than 0.1 or better, less than 0.05, and the last three should all be greater than 0.9 or 0.95 for good model fit.</p>
<p>The results of estimating using the three different methods differ somewhat. This is not a bug of our program; lavaan determines the same numbers up to several decimal places. There are results in the literature about which methods are equivalent under which conditions. For these fit indices to be interpretable, we need to assume that the data is multivariate normally distributed. If this assumption is violated, then we should judge model fit by other indices, which is beyond the scope of this article; however, they could be calculated based on the current approach as well. The book edited by Hoyle [<a href="#Hoyle">2</a>] gives some information on these methods.</p>
<p>For the original model that allows some covariances between error variables, the runtime gets worse, especially for maximum likelihood estimation. Hence, this is turned off in the following code.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_21.gif" alt="" width="580" height="44" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_6.gif" alt="" width="580" height="304" /></p>
<p>The results of both models are exactly the same as calculated with lavaan.</p>
<h3>An Alternative Approach: Case-based Estimation</h3>
<p>When I first learned about SEM, I was puzzled by the many notions (e.g. exogenous, endogenous) and the assumptions needed. For example, I felt that correlation of error variables should be calculated by the estimation algorithm and not be set at will when specifying the model. However, these difficulties seem to play no large role in practice and there are thousands of research papers (mainly) in the social sciences that use these methods with great success. Yet, there are some reasons why the standard approach to SEM via covariance matrices can be criticized (a more detailed discussion is given in [<a href="#Oldenburg">5</a>]). Traditional SEM:</p>
<p><span class="special-character Bullet">•</span> is well suited only for linear models (there are some nonlinear extensions, but they have not yet become mainstream)</p>
<p><span class="special-character Bullet">•</span> does not give estimates of the values of latent variables for each case (Bayesian variants can do this)</p>
<p><span class="special-character Bullet">•</span> requires the covariance matrix of observed data to be nonsingular; however, improving measurement methods in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_108.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_109.gif" alt="" width="12" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_110.gif" alt="" width="12" height="12" />, for example, may result in highly correlated measures of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_111.gif" alt="" width="27" height="12" /> (in the extreme case with identical vectors of measured values) and hence their covariance matrix will be almost singular</p>
<p><span class="special-character Bullet">•</span> has resulting estimations for parameters that depend a lot on the estimation method used</p>
<p><span class="special-character Bullet">•</span> forbids certain linear models that are not identified in this approach, even though the model itself is sensible and well defined (e.g. the number of covariances of error variables allowed to be nonzero is limited, although in practice there may be correlations)</p>
<p>You may then wonder why the covariance matrix<span class="special-character Dash">–</span>based approach is so popular. I suppose that more than 40 years ago, computers were not powerful enough to deal with a full dataset, so that the information reduction by calculating the correlation matrix was essential. Since then, many powerful programs have been developed and research has been carried out that gave a good understanding of conditions under which the method works well. Moreover, the psychometric community reached a consensus on how model fit should be judged and thus studies using this method faced no problem being published.</p>
<p>After this discussion of pros and cons, it is time to present the following case-based approach to SEM estimation that is very easy (one may even call it naive) to implement but is also very flexible and with today&#8217;s computing power, it is feasible in many real-world situations.</p>
<p>Hence, I propose to do SEM case-based by least-square optimization of the defects of the equations. Assume we have <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_112.gif" alt="" width="6" height="12" /> observations (cases) of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_113.gif" alt="" width="6" height="12" /> variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_114.gif" alt="" width="39" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_115.gif" alt="" width="43" height="12" />. A general equational model consists of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_116.gif" alt="" width="9" height="12" /> equations <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_117.gif" alt="" width="107" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_118.gif" alt="" width="49" height="12" />, which involve the data, latent variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_119.gif" alt="" width="11" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_120.gif" alt="" width="52" height="12" />, and parameters <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_121.gif" alt="" width="9" height="12" />. Then the latent variables and the parameters are estimated by minimizing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_122.gif" alt="" width="157" height="20" />.</p>
<p>Another twist is needed to get the best results, however. The above objective function gives all equations the same weight. However, it turned out (by working with simulated data where it is clear which parameters should be found) that we get better results by multiplying by a factor that gives the equations different weights, that is, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_123.gif" alt="" width="169" height="20" />. The factor <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_124.gif" alt="" width="10" height="12" /> can be modified by an option in the code that follows. Best results are obtained for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_125.gif" alt="" width="42" height="12" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_126.gif" alt="" width="6" height="12" /> is the number of latent variables in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_127.gif" alt="" width="11" height="12" />. The idea behind this choice is that an equation that involves only one latent variable links this variable directly to the manifest data and thus should have a high weight. In contrast, equations with many latent variables are not so close to the manifest observations and are thus are more hypothetical, so they should have a lower weight.</p>
<p>The model equations are not formulated as rules as for the first SEM, but as equations with the name of the error variable attached to each equation. Moreover, the dataset is not normalized, so there are nonzero intercepts in the linear equations. In the first approach this had no consequences, because such additive values are eliminated by calculating the covariance matrix, but in the SEM2 approach, intercepts must be modeled explicitly (and we have the benefit of getting estimates for them as well).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_22n.gif" alt="" width="282" height="233" /></p>
<p>The function SEM2 that carries out the model estimation takes as input <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_128.gif" alt="" width="29" height="13" /> and the names of the manifest (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_129.gif" alt="" width="58" height="13" />) and latent variables (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_130.gif" alt="" width="108" height="13" />). At the technical heart of the function is the subroutine <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_131.gif" alt="" width="14" height="13" />. This function takes an equation involving latent variables (e.g. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_132.gif" alt="" width="68" height="13" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_133.gif" alt="" width="63" height="13" />) and adds to the objective function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_134.gif" alt="" width="101" height="14" /> the appropriate term for each case (i.e. with values from the data replacing the names of manifest variables):</p>
<p><img style="vertical-align: middle;" title="(dem60[1]-(b1 ind60[1]+u1[1]))^2+ (dem60[2]-(b1 ind60[2]+u1[2]))^2+ ...+ (dem60[n]-(b1 ind60[n]+u1[n]))^2" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Image_2.gif" alt="(dem60[1]-(b1 ind60[1]+u1[1]))^2+ (dem60[2]-(b1 ind60[2]+u1[2]))^2+ ...+ (dem60[n]-(b1 ind60[n]+u1[n]))^2" width="239" height="68" /></p>
<p>There is one option.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_23.gif" alt="" width="283" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_24.gif" alt="" width="580" height="475" /></p>
<p>This code estimates Bollen<span class="special-character CloseCurlyQuote">’</span>s model.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_25.gif" alt="" width="538" height="29" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_7.gif" alt="" width="659" height="69" /></p>
<p>As mentioned, there is a version that weights equations according to the number of latent variables they have.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_26.gif" alt="" width="531" height="46" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_8.gif" alt="" width="659" height="69" /></p>
<p>The results for the estimates differ from what is calculated in the traditional covariance matrix<span class="special-character Dash">–</span>based approach given for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_135.gif" alt="" width="22" height="13" />. A simulation study that compares the two approaches [<a href="#Oldenburg">5</a>] showed that in many situations the case-based approach gives better results, especially when the assumption of independent errors is violated. Moreover, the case-based approach is easily applied to nonlinear equations. However, in certain situations it may be necessary to perform the minimization with higher accuracy than provided by standard hardware floating-point numbers.</p>
<h4>Application to Measurement Error</h4>
<p>In standard linear regression <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_136.gif" alt="" width="22" height="12" />, one assumes that the independent variables are measured exactly, while the dependent variable has an error that is ideally normally distributed. If the independent variables are measured with error too, standard linear regression underestimates the regression coefficient. This is the famous attenuation problem and I will show how to solve it. Let us first simulate a dataset with error on both variables.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_27.gif" alt="" width="379" height="195" /></p>
<p>Then linear regression underestimates the slope, which should be 0.5.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_28.gif" alt="" width="296" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_9.gif" alt="" width="216" height="27" /></p>
<p>When using case-based modeling, several strategies are possible. We may use one or two latent variables for the true values. As the true dependent variable is just <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_137.gif" alt="" width="46" height="12" />, the following code uses just one latent variable. Another twist is that the equations are divided by the empirical standard deviations to put them on an equal footing.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Input_29.gif" alt="" width="237" height="123" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Output_10.gif" alt="" width="58" height="13" /></p>
<p>This example shows both the power of this method and the responsibility of the modeler to set up sensible equations. If we are sure that the errors are uncorrelated, we may add <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/12/Oldenburg_Math_138.gif" alt="" width="184" height="13" /> as another constraint to further improve the estimate. This may also be done automatically with an extended version of SEM2, which will be published when its development is completed.</p>
<h3>Summary</h3>
<p>Two methods for the estimation of structural equational models are presented. One uses the traditional covariance matrix<span class="special-character Dash">–</span>based approach and is therefore restricted to linear equations, while the other approach is more general but not yet established in practice. Estimating the models is rather easy in Mathematica, but the numerical problems that arise can be demanding. The new case-based approach is very flexible and promising in certain situations where the standard approach shows limitations.</p>
<h3>Conclusion</h3>
<p>Case-based calculation of SEM looks very promising given the numerical power of today<span class="special-character CloseCurlyQuote">’</span>s computers and might give insight in situations where the restrictions of the traditional approach urge researchers into making assumptions that may not be warranted.</p>
<h3>Acknowledgments</h3>
<p>It is my pleasure to thank Ed Merkle and Yves Rosseel for many explanations of SEM.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Bollen"></a>[1]</td>
<td>K. A. Bollen, <em>Structural Equations with Latent Variables</em>, New York: Wiley, 1989.</td>
</tr>
<tr>
<td class="Reference"><a name="Hoyle"></a>[2]</td>
<td>R. H. Hoyle (ed.), <em>Handbook of Structural Equation Modeling</em>, New York: Guilford Press, 2012.</td>
</tr>
<tr>
<td class="Reference"><a name="Gana"></a>[3]</td>
<td>K. Gana and G. Broc, <em>Structural Equation Modeling with lavaan</em>, Hoboken: John Wiley &amp; Sons, 2019.</td>
</tr>
<tr>
<td class="Reference"><a name="Rosseel"></a>[4]</td>
<td>Y. Rosseel. <span class="special-character OpenCurlyDoubleQuote">“</span>lavaan.<span class="special-character CloseCurlyDoubleQuote">”</span> (Aug 25, 2019) <a href="https://lavaan.ugent.be/" target="_blank">https://lavaan.ugent.be</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Oldenburg"></a>[5]</td>
<td>R. Oldenburg, <span class="special-character OpenCurlyDoubleQuote">“</span>Case-based vs. Covariance-based SEM,<span class="special-character CloseCurlyDoubleQuote">”</span> forthcoming.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>R. Oldenburg, <span class="special-character OpenCurlyDoubleQuote">“</span>Structural Equation Modeling,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2020. <a href="https://doi.org/10.3888/tmj.22-5">https://doi.org/10.3888/tmj.22–5</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Reinhard Oldenburg has studied physics and mathematics and received a PhD in algebra. He has been a high-school teacher and now holds a professorship in Mathematics Education at Augsburg University. His research interests are computer algebra, the logic of elementary algebra and real-world applications.</p>
<p class="TextAboutAuthor"><strong>Reinhard Oldenburg</strong><br />
<em>Augsburg University<br />
Mathematics Department<br />
Universit<span class="special-character ADoubleDot">ä</span>tsstra<span class="special-character SZ">ß</span>e 14<br />
86159 Augsburg, Germany<br />
</em><em><a href="mailto:reinhard.oldenburg@math.uni-augsburg.de">reinhard.oldenburg@math.uni-augsburg.de</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2020/12/28/structural-equation-modeling/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Generating Minimally Unsatisfiable Conjunctive Normal Forms</title>
		<link>https://www.mathematica-journal.com/2020/10/29/generating-minimally-unsatisfiable-conjunctive-normal-forms/</link>
		<comments>https://www.mathematica-journal.com/2020/10/29/generating-minimally-unsatisfiable-conjunctive-normal-forms/#respond</comments>
		<pubDate>Thu, 29 Oct 2020 20:06:45 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 22]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=60427</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.22-4 A method of generating minimally unsatisfiable conjunctive normal forms is introduced. A conjunctive normal form (CNF) is minimally unsatisfiable if it is unsatisfiable and such that removing any one of its clauses results in a satisfiable CNF. Introduction Ivor Spence [1] introduced a method for producing small unsatisfiable formulas of propositional logic that were [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.22-4">https://doi.org/10.3888/tmj.22-4</a></span></div>
<div>
<p>A method of generating minimally unsatisfiable conjunctive normal forms is introduced. A conjunctive normal form (CNF) is minimally unsatisfiable if it is unsatisfiable and such that removing any one of its clauses results in a satisfiable CNF.<span id="more-60427"></span></p>
<h3>Introduction</h3>
<p>Ivor Spence [<a href="#Spence">1</a>] introduced a method for producing small unsatisfiable formulas of propositional logic that were difficult to solve by most SAT solvers at the time, which we believe was because they were usually minimally (i.e. just barely) unsatisfiable. Kullmann and Zhao [<a href="#Kullmann-Zhao">2</a>] claim that minimally unsatisfiable formulas are <span class="special-character OpenCurlyDoubleQuote">“</span>the hardest examples for proof systems.<span class="special-character CloseCurlyDoubleQuote">”</span> We will generalize Spence<span class="special-character CloseCurlyQuote">’</span>s construction and show that it can be used to generate minimally unsatisfiable propositional formulas in conjunctive normal form, that is, formulas that are unsatisfiable but such that the removal of even a single clause produces a satisfiable formula. In addition to increasing our understanding of the satisfiability problem, these formulas have important connections to other combinatorial problems [<a href="#Aharoni-Linial">3</a>].</p>
<h3><strong>Definitions</strong></h3>
<p>We assume the reader has at least a minimal acquaintance with propositional logic and truth tables. An <em>interpretation</em> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_1.gif" alt="" width="5" height="12" /> of a propositional formula is an assignment of truth values to its propositional variables. A propositional formula is <em>satisfiable </em>if there is an interpretation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_2.gif" alt="" width="5" height="12" /> that makes it true when evaluated using the usual truth table rules. A <em>literal</em> is a propositional variable or a negated propositional variable. A <em>clause</em> is a disjunction of literals; if it contains exactly <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_3.gif" alt="" width="6" height="12" /> literals, we call it a <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_4.gif" alt="" width="6" height="12" /><em>-clause</em>. A <em>conjunctive normal form</em> (or <em>CNF</em>) is a conjunction of clauses. A <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_5.gif" alt="" width="6" height="12" />-CNF is a conjunction of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_6.gif" alt="" width="6" height="12" />-clauses.</p>
<p>For example, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_7.gif" alt="" width="150" height="12" /> is a 3-CNF. It is often convenient to think of CNFs as a list of lists of literals; in this format, the 3-CNF example would be written as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_8.gif" alt="" width="172" height="14" />. This way of writing CNFs is quite common in computer science and is the approach that we took in [<a href="#Cowen">4</a>], where we showed how the famous Davis<span class="special-character Dash">–</span>Putnam algorithm for satisfiability testing could be easily programmed in Mathematica. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_9.gif" alt="" width="86" height="13" />, Mathematica<span class="special-character CloseCurlyQuote">’</span>s built-in function for satisfiability testing, requires replacing &#8220;<span class="special-character Not">¬</span>&#8221; by &#8220;!&#8221;, &#8220;<span class="special-character Or">∨</span>&#8221; by &#8220;||&#8221; and &#8220;<span class="special-character And">∧</span>&#8221; by &#8220;&amp;&amp;&#8221;; so in Mathematica the 3-CNF example is written as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_10.gif" alt="" width="200" height="14" />. In this article, we adopt the <span class="special-character OpenCurlyDoubleQuote">“</span>list of lists<span class="special-character CloseCurlyDoubleQuote">”</span> approach for programming purposes and then convert to Mathematica<span class="special-character CloseCurlyQuote">’</span>s format when testing for satisfiability with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_11.gif" alt="" width="86" height="13" />.</p>
<h3><strong>Constructing Unsatisfiable CNFs</strong></h3>
<p>In this section, we show how to generalize a construction of Ivor Spence [<a href="#Spence">1</a>] that produces unsatisfiable 3-CNFs that are relatively short but take a relatively long time to verify that they are indeed unsatisfiable using standard computer programs, even though it is relatively easy, as we shall show, to demonstrate that they are unsatisfiable. (Perhaps humans are not replaceable by computers, after all!)</p>
<p>Given positive integers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_12.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_13.gif" alt="" width="6" height="12" />, suppose the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_14.gif" alt="" width="66" height="12" /> propositional variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_15.gif" alt="" width="13" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_16.gif" alt="" width="13" height="12" />, <span class="special-character Ellipsis">…</span>, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_17.gif" alt="" width="54" height="15" /> are partitioned in order into <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_18.gif" alt="" width="24" height="12" /> sets of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_19.gif" alt="" width="32" height="12" /> and one set of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_20.gif" alt="" width="32" height="12" />. For each cell of the partition, form all <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_21.gif" alt="" width="6" height="12" />-clauses from the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_22.gif" alt="" width="7" height="12" /><span class="special-character CloseCurlyQuote">’</span>s in that cell and let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_23.gif" alt="" width="14" height="12" /> be the conjunction of all these <img style="vertical-align: middle;" title="k" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Image_1.gif" alt="k" width="6" height="12" />-clauses. If <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_24.gif" alt="" width="14" height="12" /> is to be true under an interpretation <img style="vertical-align: middle;" title="I" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Image_3.gif" alt="I" width="5" height="12" />, no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_25.gif" alt="" width="24" height="12" /> of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_26.gif" alt="" width="7" height="12" />-variables from each partition cell can be false, since if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_27.gif" alt="" width="6" height="12" /> were false, the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-clause containing exactly these <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_29.gif" alt="" width="7" height="12" />-variables would be false, as would their conjunction <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_30.gif" alt="" width="14" height="12" />. Thus no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_31.gif" alt="" width="40" height="12" /> of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-variables can be false under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="7" height="12" />.</p>
<p>Next let<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_34.gif" alt="" width="14" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_35.gif" alt="" width="12" height="12" />, <span class="special-character Ellipsis">…</span>, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_36.gif" alt="" width="53" height="15" /> be a random permutation of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_37.gif" alt="" width="7" height="12" /><span class="special-character CloseCurlyQuote">’</span>s and partition these <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_38.gif" alt="" width="6" height="12" /><span class="special-character CloseCurlyQuote">’</span>s just as the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_39.gif" alt="" width="7" height="12" /><span class="special-character CloseCurlyQuote">’</span>s were partitioned. However, this time, for each cell of the partition, form all <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_40.gif" alt="" width="6" height="12" />-clauses from the <u>negated</u> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_41.gif" alt="" width="6" height="12" />-variables in that cell and let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_42.gif" alt="" width="14" height="12" /> be the conjunction of all these <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_43.gif" alt="" width="6" height="12" />-clauses. Reasoning as before, no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_44.gif" alt="" width="40" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-variables can be true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="5" height="12" />.</p>
<p>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_47.gif" alt="" width="63" height="12" />. If <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_48.gif" alt="" width="8" height="12" /> is to be true under some interpretation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="5" height="12" />, both <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_50.gif" alt="" width="14" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_51.gif" alt="" width="14" height="12" /> must be true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="5" height="12" />; thus no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_53.gif" alt="" width="40" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_54.gif" alt="" width="7" height="12" />-variables can be false and no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_55.gif" alt="" width="40" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_56.gif" alt="" width="6" height="12" />-variables can be true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_57.gif" alt="" width="5" height="12" />. Since the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_58.gif" alt="" width="6" height="12" />-variables are permuted <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_59.gif" alt="" width="7" height="12" />-variables, it follows that no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_60.gif" alt="" width="44" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_61.gif" alt="" width="7" height="12" />-variables can be true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_62.gif" alt="" width="5" height="12" />. However, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_63.gif" alt="" width="234" height="12" />, the number of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_64.gif" alt="" width="7" height="12" />-variables in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_65.gif" alt="" width="8" height="12" />! Thus <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_66.gif" alt="" width="8" height="12" /> is an unsatisfiable CNF, because there is no interpretation of all its <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_67.gif" alt="" width="66" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-variables that makes <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_69.gif" alt="" width="8" height="12" /> true.</p>
<h3><strong>Minimally Unsatisfiable CNFs</strong></h3>
<p>Suppose next that we drop one of the clauses in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_70.gif" alt="" width="8" height="12" />, say for example, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_71.gif" alt="" width="110" height="12" />; let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_72.gif" alt="" width="58" height="12" /> and let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_73.gif" alt="" width="73" height="12" />. Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="7" height="12" /> be an interpretation that assigns false to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_75.gif" alt="" width="13" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_76.gif" alt="" width="13" height="12" />, <span class="special-character Ellipsis">…</span>, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_77.gif" alt="" width="12" height="12" /> and true to the remaining variables in the first <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_78.gif" alt="" width="7" height="12" />-cell. As long as no more than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_79.gif" alt="" width="24" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_80.gif" alt="" width="7" height="12" />-variables in each of the remaining cells of the partition of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_81.gif" alt="" width="7" height="12" /><span class="special-character CloseCurlyQuote">’</span>s are assigned the value false, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_82.gif" alt="" width="19" height="12" /> would be true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="7" height="12" />. Whether or not <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_84.gif" alt="" width="14" height="12" /> and hence <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_85.gif" alt="" width="13" height="12" /> are true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_86.gif" alt="" width="5" height="12" /> depends on whether <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_87.gif" alt="" width="5" height="12" /> also has the property that at most <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_88.gif" alt="" width="24" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-variables in each cell of the partition of the randomly permuted variables (the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_90.gif" alt="" width="6" height="12" /><span class="special-character CloseCurlyQuote">’</span>s) are assigned the value true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="7" height="12" />. While this is unlikely for any given interpretation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_92.gif" alt="" width="5" height="12" />, there are so many interpretations satisfying <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_93.gif" alt="" width="19" height="12" /> that it is most likely that some such interpretation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_46.gif" alt="" width="7" height="12" /> has this property and the reduced CNF <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_95.gif" alt="" width="13" height="12" /> will then be true under <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_96.gif" alt="" width="5" height="12" />.</p>
<p>We will investigate this intuitive argument. For <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_97.gif" alt="" width="13" height="12" /> to be true, the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_98.gif" alt="" width="6" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_99.gif" alt="" width="7" height="12" />-variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_100.gif" alt="" width="13" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_101.gif" alt="" width="13" height="12" />, <span class="special-character Ellipsis">…</span>, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_102.gif" alt="" width="12" height="12" /> can now be false in the first cell, as long as each of the remaining <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_103.gif" alt="" width="24" height="12" /> cells in the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-partition has at most <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_105.gif" alt="" width="24" height="12" /> false variables; thus <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_106.gif" alt="" width="84" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_107.gif" alt="" width="7" height="12" />-variables can be false and, as above, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_108.gif" alt="" width="40" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-variables can be true. However, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_110.gif" alt="" width="216" height="12" />, and the argument showing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_111.gif" alt="" width="8" height="12" /> to be unsatisfiable cannot be applied to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_112.gif" alt="" width="13" height="12" />.</p>
<h3><strong>Programming</strong></h3>
<p>First we allow for different choices for the parameters <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_113.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_114.gif" alt="" width="6" height="12" />. Initially we set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_115.gif" alt="" width="26" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_116.gif" alt="" width="32" height="12" />. The next several steps serve to introduce the variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_117.gif" alt="" width="11" height="12" /> and partition them into cells.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_1.gif" alt="" width="83" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_2.gif" alt="" width="212" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_1.gif" alt="" width="580" height="30" /></p>
<p>Define the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_118.gif" alt="" width="19" height="12" /> partition of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_32.gif" alt="" width="7" height="12" />-variables.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_3.gif" alt="" width="260" height="77" /></p>
<p>Here is the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_120.gif" alt="" width="7" height="12" />-partition for our example.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_4.gif" alt="" width="172" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_2.gif" alt="" width="540" height="46" /></p>
<p>Next we generate, negate and partition the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_121.gif" alt="" width="6" height="12" />-variables.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_5.gif" alt="" width="315" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_3.gif" alt="" width="580" height="46" /></p>
<p>We join <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_122.gif" alt="" width="14" height="13" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_123.gif" alt="" width="14" height="13" /> and form all <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_124.gif" alt="" width="6" height="12" />-sets from the result.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_6.gif" alt="" width="298" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_4.gif" alt="" width="580" height="270" /></p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_125.gif" alt="" width="72" height="14" /> puts these steps together. The argument <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_126.gif" alt="" width="7" height="13" /> is a permutation of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_127.gif" alt="" width="132" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_7.gif" alt="" width="247" height="171" /></p>
<p>For the experiments that follow, leaving out the third argument uses a random permutation.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_8.gif" alt="" width="495" height="14" /></p>
<p>Because of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_128.gif" alt="" width="86" height="14" />, the negated pieces can change from one run to the next.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_9.gif" alt="" width="147" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_5.gif" alt="" width="580" height="270" /></p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_129.gif" alt="" width="65" height="14" /> transforms a list of clauses into an expression that allows for satisfiability testing, as described in the section Definitions.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_10.gif" alt="" width="235" height="14" /></p>
<p>Equivalently, here is a longer form.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_11.gif" alt="" width="327" height="14" /></p>
<p>To test that a CNF is minimally unsatisfiable, we must show both that it is unsatisfiable and that the removal of any one clause always results in a satisfiable CNF. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_130.gif" alt="" width="166" height="14" /> tests the satisfiability of a CNF in list form by converting it to a logical expression with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_131.gif" alt="" width="65" height="14" /> and applying the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_132.gif" alt="" width="86" height="13" />; then it tests if all the formulas with one clause deleted are indeed satisfiable.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_12.gif" alt="" width="300" height="125" /></p>
<p>This tests whether <span class="MR">C3</span> is minimally unsatisfiable.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_13.gif" alt="" width="263" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_6.gif" alt="" width="29" height="13" /></p>
<p>Most of the unsatisfiable formulas generated in this way are, as we shall see, minimally unsatisfiable, but not always. However, we conjecture that the bigger we take <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_133.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_134.gif" alt="" width="6" height="12" />, the more likely we are to get a minimally unsatisfiable formula. We have done some experiments on this conjecture and discuss them in the next section.</p>
<p>If we remove two different clauses instead of one from our unsatisfiable formulas, the result is almost always a satisfiable formula. We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_135.gif" alt="" width="173" height="14" /> and experiment with it in the next section.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_14.gif" alt="" width="456" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_15.gif" alt="" width="301" height="62" /></p>
<h3><strong>Experiments</strong></h3>
<p>We run some experiments to investigate the frequency of minimally unsatisfiable CNFs obtained with our Spence generalizations.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_16.gif" alt="" width="517" height="77" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_17.gif" alt="" width="229" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_7.gif" alt="" width="196" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_18.gif" alt="" width="236" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_8.gif" alt="" width="236" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_19.gif" alt="" width="229" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_9.gif" alt="" width="203" height="13" /></p>
<p>The table below summarizes some larger computer experiments we have conducted to test our conjecture that most of the formulas constructed by the above methods are minimally unsatisfiable. The third column, <span class="special-character OpenCurlyDoubleQuote">“</span><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_136.gif" alt="" width="36" height="12" /><span class="special-character CloseCurlyDoubleQuote">”</span>, stands for the number of clauses in the CNF defined by <tt>SpenceCNF@SpenceList[k,g]</tt>. The fourth column gives the percentage of these clauses that were minimally unsatisfiable.</p>
<p>Each line in the table represents results on 500 formulas. For example, the first line constructs 500 3-CNFs, based on <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_138.gif" alt="" width="68" height="12" /> variables and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_139.gif" alt="" width="74" height="12" /> clauses in each. It turned out that 62% were minimally unsatisfiable.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_20.gif" alt="" width="580" height="62" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_10.gif" alt="" width="150" height="145" /></p>
<p>Next we look at what happens if we remove two different clauses from our Spence formulas. With <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_140.gif" alt="" width="26" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_141.gif" alt="" width="32" height="12" />, there are 92 clauses in the Spence CNF; hence <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_142.gif" alt="" width="96" height="12" /> distinct ways to remove two different clauses. We count the number of times the resulting CNF is true in 100 trials.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_21.gif" alt="" width="483" height="61" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_11.gif" alt="" width="580" height="104" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_22.gif" alt="" width="61" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_12.gif" alt="" width="50" height="13" /></p>
<p>In this trial, we are very close to all Spence CNFs becoming satisfiable after removing two different clauses. We believe this is true in general.</p>
<h3>Derangements</h3>
<p>In this section we modify our construction to generate only derangements of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_143.gif" alt="" width="6" height="12" />-variables. A <em>derangement</em> is a permutation that leaves no number in its original position. There are three resource functions that deal with derangements.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_23.gif" alt="" width="250" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_13.gif" alt="" width="434" height="29" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_24.gif" alt="" width="286" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_14.gif" alt="" width="75" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_25.gif" alt="" width="250" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_15.gif" alt="" width="29" height="13" /></p>
<p>It is known that derangements constitute slightly more than a third of the permutations (see [<a href="#Wikipedia">5</a>]), as the following calculation illustrates.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_26.gif" alt="" width="572" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_16.gif" alt="" width="14" height="13" /></p>
<p>We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Math_144.gif" alt="" width="79" height="14" /> that does <span class="special-character OpenCurlyDoubleQuote">“</span>derangement<span class="special-character CloseCurlyDoubleQuote">”</span> experiments.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_27.gif" alt="" width="580" height="123" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_28.gif" alt="" width="125" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_17.gif" alt="" width="29" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_29.gif" alt="" width="118" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_18.gif" alt="" width="29" height="13" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Input_30.gif" alt="" width="118" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/10/Cowen_Output_19.gif" alt="" width="29" height="13" /></p>
<p>On the basis of these experiments we conjecture that the derangements are about as likely to produce minimally unsatisfiable formulas as permutations in general.</p>
<h3>Conclusion</h3>
<p>We have adapted a method of I. Spence [<a href="#Spence">1</a>] to easily obtain large numbers of unsatisfiable CNFs that are usually but not always minimally unsatisfiable. We also ran some experiments to indicate what percentages would be minimally unsatisfiable. In addition, our experiments suggest that if two different clauses are removed rather than one, the resulting formula will almost always be satisfiable. Finally we restricted the random permutations in our construction by requiring them to be derangements and saw that this gave similar percentages of minimally unsatisfiable formulas.</p>
<h3>Acknowledgements</h3>
<p>I am grateful to the referee for his advice and to the editor, George Beck, for greatly improving my Mathematica coding throughout the paper.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Spence"></a>[1]</td>
<td>I. Spence, <span class="special-character OpenCurlyDoubleQuote">“</span>sgen1: A Generator of Small but Difficult Satisfiability Benchmarks,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>ACM Journal of Experimental Algorithmics</em>, <strong>15</strong>, 2010 pp. 1.1<span class="special-character Dash">–</span>1.15. <a href="https://doi.org/10.1145/1671970.1671972" target="_blank">doi:10.1145/1671970.1671972</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Kullmann-Zhao"></a>[2]</td>
<td>O. Kullmann and X. Zhao, <span class="special-character OpenCurlyDoubleQuote">“</span>On Davis<span class="special-character Dash">–</span>Putnam Reductions for Minimally Unsatisfiable Clause-Sets,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Theoretical Computer Science</em>, <strong>492</strong>, 2013 pp. 70<span class="special-character Dash">–</span>87. <a href="https://doi.org/10.1016/j.tcs.2013.04.020" target="_blank">doi:10.1007/978-3-642-31612-8_ 21</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Aharoni-Linial"></a>[3]</td>
<td>R. Aharoni and N. Linial, <span class="special-character OpenCurlyDoubleQuote">“</span>Minimal Non-Two-Colorable Hypergraphs and Minimal Unsatisfiable Formulas,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Journal of Combinatorial Theory, Series A</em> <strong>43</strong>(2), 1986 pp. 196<span class="special-character Dash">–</span>204. <a href="https://doi.org/10.1016/0097-3165(86)90060-9" target="_blank">doi:10.1016/0097-3165(86)90060-9</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Cowen"></a>[4]</td>
<td>R.Cowen, M. Huq and W. MacDonald, <span class="special-character OpenCurlyDoubleQuote">“</span>Implementing the Davis<span class="special-character Dash">–</span>Putnam Algorithm in Mathematica,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Mathematica in Education and Research</em>, <strong>10</strong>, 2005 pp, 46<span class="special-character Dash">–</span>55. <a href="https://www.researchgate.net/publication/246429822_Implementing_the_Davis-Putnam_Algorithm_in_Mathematica" target="_blank">www.researchgate.net/publication/246429822_Implementing_the_Davis-Putnam_Algorithm_in_Mathematica</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Wikipedia"></a>[5]</td>
<td>Wikipedia. <span class="special-character OpenCurlyDoubleQuote">“</span>Derangement.<span class="special-character CloseCurlyDoubleQuote">”</span> (Jul 10, 2010) <a href="https://en.wikipedia.org/wiki/Derangement#Limit_of_ratio_of_derangement_to_permutation_as_n_approaches_%E2%88%9E" target="_blank">en.wikipedia.org/wiki/Derangement#Limit_of_ratio_of_derangement_to_permutation_as_n_approaches_<span class="special-character Infinity">∞</span></a>.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>R. Cowen, <span class="special-character OpenCurlyDoubleQuote">“</span>Generating Minimally Unsatisfiable Conjunctive Normal Forms,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2020. <a href="https://doi.org/10.3888/tmj.22-4">https://doi.org/10.3888/tmj.22–4</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Robert Cowen is a Professor Emeritus at Queens College, CUNY. His main research interests are logic and combinatorics. He has enjoyed teaching students how to use Mathematica to do research in mathematics for many years.</p>
<p class="TextAboutAuthor"><strong>Robert Cowen</strong><br />
<em>16422 75th Avenue<br />
Fresh Meadows, NY 11366<br />
</em><em><a href="mailto:robert.cowen@gmail.com">robert.cowen@gmail.com</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2020/10/29/generating-minimally-unsatisfiable-conjunctive-normal-forms/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Degree versus Dimension for Rational Parametric Curves</title>
		<link>https://www.mathematica-journal.com/2020/09/22/degree-versus-dimension-for-rational-parametric-curves/</link>
		<comments>https://www.mathematica-journal.com/2020/09/22/degree-versus-dimension-for-rational-parametric-curves/#respond</comments>
		<pubDate>Tue, 22 Sep 2020 15:25:54 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 22]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=59944</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.22-3 Given a rationally parameterized curve in or , where the and are polynomials, we find the dimension of the smallest linear subset of containing the curve. If all the and are of degree or less, then it is known abstractly that this dimension is or less and rational normal curves play a key role [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.22-3">https://doi.org/10.3888/tmj.22-3</a></span></div>
<div>
<p>Given a rationally parameterized curve <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_1.gif" alt="" width="175" height="13" /> in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_2.gif" alt="" width="15" height="13" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_3.gif" alt="" width="14" height="13" />, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_4.gif" alt="" width="12" height="16" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_5.gif" alt="" width="8" height="13" /> are polynomials, we find the dimension of the smallest linear subset of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_6.gif" alt="" width="15" height="13" /> containing the curve. If all the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_7.gif" alt="" width="12" height="16" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_8.gif" alt="" width="8" height="13" /> are of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_9.gif" alt="" width="7" height="13" /> or less, then it is known abstractly that this dimension is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_10.gif" alt="" width="7" height="13" /> or less and <em>rational normal curves</em> play a key role in the argument. We consider this from a computational point of view with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_11.gif" alt="" width="172" height="13" /> playing an essential part in the discussion.<span id="more-59944"></span></p>
<h3>1. Introduction</h3>
<p>The ancients were confused about the concepts of degree and dimension. As late as 1545 in his famous book <em>Ars Magna</em> [<a href="#Cardano">1</a>], Cardano, who did not hesitate to invent imaginary numbers, in reference to his assistant Ferrari&#8217;s solution of the quartic gives the following disclaimer:</p>
<div id="1980113918" class="Quote"><a name="1980113918"></a>Although a long series of rules might be added and a long discourse given about them, we conclude our detailed consideration with the cubic, others being merely mentioned, even if generally, in passing. For as the first power refers to a line, the square to a surface, and the cube to a solid body, it would be very foolish to go beyond this point. Nature does not permit it.</div>
<p>The distinction between degree and dimension was later resolved by Descartes&#8217;s algebraic notation. But, in the context of parametric curves, I recently noticed a simple linear algebra proof of the following theorem:</p>
<p><strong>Theorem A</strong></p>
<div id="1101531249" class="Theorem"><a name="1101531249"></a>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_12.gif" alt="" width="119" height="12" />, be a curve in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_13.gif" alt="" width="15" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_14.gif" alt="" width="14" height="12" /> where the coordinate functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_15.gif" alt="" width="24" height="14" /> are polynomials of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_16.gif" alt="" width="6" height="12" /> or less. Then for any <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_17.gif" alt="" width="26" height="12" />, the curve lies in a linear subset of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_18.gif" alt="" width="15" height="12" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_19.gif" alt="" width="14" height="12" /> of dimension <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_20.gif" alt="" width="6" height="12" />.</div>
<p>This theorem, as well as many of the other facts in this article, is given in Joe Harris<span class="special-character CloseCurlyQuote">’</span>s book [<a href="#Harris">2</a>] from a projective geometry point of view. He also considers the degree versus dimension issue in a number of other situations. We give the linear algebra proof in Section 2.</p>
<p>Unfortunately, projective geometry is not computationally friendly. Instead we can view these results from an affine point of view using the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_21.gif" alt="" width="158" height="12" /> [<a href="#Wolfram">3</a>], which we discuss in Section 3.</p>
<p>We then generalize and rephrase our result in Section 4 as Theorem B. The generalization is to rational curves and we can give the dimensions of the smallest linear space containing the curve. Theorem B does clarify that, while the degree bounds the size of a linear set, the curve may lie in a smaller dimensional linear set.</p>
<p>In Section 5 we observe that the <em>rational normal curve</em> in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_22.gif" alt="" width="14" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_23.gif" alt="" width="15" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_24.gif" alt="" width="76" height="18" />, is universal for rational curves. That is, every rational curve is a transform of a normal curve. This is very easily seen via the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_25.gif" alt="" width="158" height="12" />. This lets us rephrase Theorem B in another useful form, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_26.gif" alt="" width="144" height="12" /> can be found directly from the expression of a rational function in the form</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_DisplayFormula_1.gif" alt="" width="167" height="34" /></p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_27.gif" alt="" width="110" height="12" /> and the common denominator<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_28.gif" alt="" width="22" height="12" /> are all polynomials of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_29.gif" alt="" width="6" height="12" /> or less written in descending degree. To simplify notation we generally work with coefficients in the real numbers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_30.gif" alt="" width="9" height="12" />, but it should be understood that one could work in any subfield of the complex numbers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_31.gif" alt="" width="8" height="12" /> as well. But, as immediately below, in some cases we must consider parameter values in the algebraic closure of the subfield.</p>
<p>Sections 5 and 6 give two applications.</p>
<p>The first discusses the recognition problem: given a point <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_32.gif" alt="" width="35" height="12" />, is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_33.gif" alt="" width="39" height="12" /> for some <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_34.gif" alt="" width="26" height="12" />? This is equivalent to the well-studied problem of finding a common solution of a family of univariate polynomials, which we do not consider here. We show that modulo the linear <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_35.gif" alt="" width="158" height="12" />, the recognition problem can often be solved in a linear space of smaller dimension.</p>
<p>The second example is the implicitization problem for rational functions, which is to find an implicit system that describes the ideal of the rational curve. We only sketch this, as there is no room to carefully describe the routines in [<a href="#Dayton 1">4</a>].</p>
<p>In fact, this article was motivated by the author<span class="special-character CloseCurlyQuote">’</span>s work on implicitization of parametric curves. I noticed that an unexpectedly large number of linear equations appeared in the implicit systems.</p>
<h3>2. Special Case of Polynomial Parameters</h3>
<p>In this article a <em>linear subset of </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_36.gif" alt="" width="15" height="12" /> is a set defined by a system of linear equations, not necessarily homogeneous. A linear subset is distinguished from a <em>linear subspace</em>, which is a subspace of the vector space <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_37.gif" alt="" width="15" height="12" /> and defined with homogeneous equations. The big difference is that a subspace contains the origin <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_38.gif" alt="" width="46" height="12" />. A linear subset is a coset of a linear subspace under the operation of vector addition.</p>
<p>A polynomial parametric curve is a function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_39.gif" alt="" width="117" height="12" /> where each coordinate function is a polynomial that we write in descending degree:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_DisplayFormula_2.gif" alt="" width="258" height="24" /></p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_40.gif" alt="" width="11" height="14" /> is the <em>degree</em> of the coordinate polynomial. The largest such degree is the degree of the parameterization. Note that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_41.gif" alt="" width="165" height="19" />. This constant acts merely as a basepoint; a different basepoint gives a curve that is a translation of the first. Thus the basepoint does not affect the geometry. We say our parameterization is <em>stripped</em> if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_42.gif" alt="" width="41" height="12" /> (or alternatively if each <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_43.gif" alt="" width="49" height="15" />). Each polynomial parameterized curve is then a translate of a stripped curve, so we first consider those. We <em>strip</em> a polynomial parameterized curve by dropping all the constant terms.</p>
<p>We now create a stripped coefficient matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_44.gif" alt="" width="11" height="12" /> from the stripped polynomial. If <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_45.gif" alt="" width="6" height="12" /> is the degree of the polynomial, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_46.gif" alt="" width="11" height="12" /> is the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_47.gif" alt="" width="20" height="12" /> matrix with rows <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_48.gif" alt="" width="70" height="19" />. Consider the following equation where points are column vectors.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_DisplayFormula_3.gif" alt="" width="559" height="91" /></p>
<p>This shows that every point on the parameterized curve is in the vector space spanned by the columns of the coefficient matrix. So Theorem A is true for a stripped parameterization, but adding back the constant <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_49.gif" alt="" width="21" height="12" /> simply moves this subspace to a linear subset.</p>
<p>To describe the smallest linear set containing a finite set of points in terms of a system of equations, here is a short routine.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_4.gif" alt="" width="333" height="268" /></p>
<p>A longer version of this with error detecting is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_50.gif" alt="" width="79" height="12" /> in [<a href="#Dayton 1">4</a>].</p>
<p class="Example">Example 1:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_5.gif" alt="" width="225" height="18" /></p>
<div id="1441233715" class="ExampleContinuation"><a name="1441233715"></a>We know a linear set containing this curve must be of dimension no greater than three, since this set is contained in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_51.gif" alt="" width="15" height="15" />, so it is generated as a linear set by four or fewer points. Therefore it is enough to take four random points on this curve and calculate the smallest linear set containing them.</div>
<p>Here are the four random points.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_6.gif" alt="" width="326" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_1.gif" alt="" width="430" height="28" /></p>
<p>Here is the linear expression for the linear set.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_7.gif" alt="" width="214" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_2.gif" alt="" width="323" height="12" /></p>
<p>A linear set defined by one linear equation in three variables is of dimension two. This curve lies in the linear set defined by setting the linear expression to zero.</p>
<h3>3. Rational Parametric Curves via <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_52.gif" alt="" width="211" height="16" /></h3>
<p>The central concept in this article is the built-in Wolfram Language function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_53.gif" alt="" width="158" height="12" /><strong>. </strong>When we say <em>transformation function</em> we mean a function given by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_54.gif" alt="" width="158" height="12" />. Basically these are affine versions of <em>projective linear</em> transformations, which can include translations along with the usual transformations of linear algebra. They appeared in Lecture 2 of Abhyankar [<a href="#Abhyankar">5</a>] and much of the author<span class="special-character CloseCurlyQuote">’</span>s work [<a href="#Dayton 1">4</a>, <a href="#Dayton 2">6</a>] as <em>fractional linear transformations</em>; they are also known in the literature as <em>linear fractional transformations</em>. Our major use of these transformations is to be able to access projective geometry where points are cosets of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_55.gif" alt="" width="32" height="12" />-tuples, while working in affine geometry where points are merely <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_56.gif" alt="" width="6" height="12" />-tuples, which are easy to manipulate computationally.</p>
<p>A transformation function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_57.gif" alt="" width="50" height="12" /> can be described by an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_58.gif" alt="" width="79" height="12" /> matrix. The matrix of the associated projective linear transformation is called the <em>transformation matrix</em> in the Wolfram Language. Thus the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_59.gif" alt="" width="158" height="12" /> of an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_60.gif" alt="" width="75" height="12" /> matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_61.gif" alt="" width="8" height="12" /> takes an affine <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_62.gif" alt="" width="9" height="12" />-tuple, appends 1 to represent this in projective <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_63.gif" alt="" width="9" height="12" />-space, applies the projective linear transformation defined by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_64.gif" alt="" width="8" height="12" /> and then specializes by dividing by the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_65.gif" alt="" width="39" height="15" /> component.</p>
<p>Here is an example.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_8.gif" alt="" width="306" height="46" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_3.gif" alt="" width="166" height="34" /></p>
<p>These transformations in the special case <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_66.gif" alt="" width="49" height="15" /> are discussed in detail in Chapter 6 of my book [<a href="#Dayton 1">4</a>].</p>
<p>A transformation function is <em>affine</em> if the last row is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_67.gif" alt="" width="59" height="12" />; the denominators are always 1, the upper-left <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_68.gif" alt="" width="27" height="12" /> submatrix gives a linear transformation and the first <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_69.gif" alt="" width="6" height="12" /> entries of the last column describe a translation.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_9.gif" alt="" width="282" height="46" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_4.gif" alt="" width="149" height="12" /></p>
<p>In particular, the domain of an affine transformation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_70.gif" alt="" width="50" height="12" /> is all of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_71.gif" alt="" width="16" height="12" />. Otherwise we call the transformation function <em>projective</em>. If the last row of the transformation matrix is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_72.gif" alt="" width="106" height="19" />, then the hyperplane of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_73.gif" alt="" width="16" height="12" /> given by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_74.gif" alt="" width="189" height="15" /> is not in the domain of the transformation function. In the context of an affine transformation, it is understood that the equation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_75.gif" alt="" width="26" height="12" /> defines the empty set.</p>
<p>In this article we assume that a rational parametric curve has coordinates that are quotients of two polynomials in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_76.gif" alt="" width="4" height="12" />. We insist that the parametric curve be given with a common denominator <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_77.gif" alt="" width="20" height="12" />, so, for example, is of the form</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_DisplayFormulaNumbered_1.gif" alt="" width="164" height="34" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Unspecified"></a>(1)</td>
</tr>
</tbody>
</table>
<p>for polynomials <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_78.gif" alt="" width="67" height="12" />. The degrees of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_79.gif" alt="" width="24" height="14" /> may be greater than, equal to or less than the degree of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_80.gif" alt="" width="20" height="12" />. In particular, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_81.gif" alt="" width="20" height="12" /> could be the constant polynomial 1, in which case <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_82.gif" alt="" width="21" height="12" /> is a polynomial curve that we can treat as a special case of a rational curve. The degree of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_83.gif" alt="" width="21" height="12" /> is the largest degree of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_84.gif" alt="" width="67" height="12" />.</p>
<p>The advantage of writing polynomials in the parameter <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_85.gif" alt="" width="4" height="12" /> in descending degree is that writing a transformation matrix for a rational function is easy. Suppose in equation (1) that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_86.gif" alt="" width="157" height="18" /> for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_87.gif" alt="" width="75" height="12" />, where we write <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_88.gif" alt="" width="46" height="12" />. Then the transformation matrix for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_89.gif" alt="" width="21" height="12" /> is</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_DisplayFormulaNumbered_2.gif" alt="" width="192" height="73" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="Unspecified"></a>(2)</td>
</tr>
</tbody>
</table>
<p class="Example">Example 2.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_10.gif" alt="" width="319" height="35" /></p>
<div id="1519665463" class="ExampleContinuation"><a name="1519665463"></a>Here is the transformation matrix.</div>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_11.gif" alt="" width="580" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_5.gif" alt="" width="88" height="78" /></p>
<div id="1121747672" class="ExampleContinuation"><a name="1121747672"></a>This is the curve.</div>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_12.gif" alt="" width="270" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_6.gif" alt="" width="343" height="78" /></p>
<p>Both [<a href="#Harris">2</a>] and [<a href="#Abhyankar">5</a>] mention the fact that every rationally parameterized curve is a projective transformation applied to a polynomially parameterized curve. In particular, [<a href="#Harris">2</a>] notes that this polynomial curve can be the rational normal curve of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_90.gif" alt="" width="9" height="12" /></p>
<h3>4. Theorem B</h3>
<p>Before we state Theorem B, we note that every linear transformation can be factored into a projection on some coordinates followed by an embedding. This is accomplished in a special way using Mathematica by the following matrix reduction algorithm we call <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_91.gif" alt="" width="122" height="12" />. This takes an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_92.gif" alt="" width="24" height="12" /> matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_93.gif" alt="" width="10" height="12" />of rank <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_94.gif" alt="" width="5" height="12" /> and outputs an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_95.gif" alt="" width="23" height="12" /> matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_96.gif" alt="" width="7" height="12" /> and an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_97.gif" alt="" width="23" height="12" /> matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_98.gif" alt="" width="8" height="12" /> consisting of rows of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_99.gif" alt="" width="8" height="12" /> such that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_100.gif" alt="" width="39" height="12" />. This implies that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_101.gif" alt="" width="5" height="12" /> rows of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_102.gif" alt="" width="10" height="12" />are what the Wolfram Language calls <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_103.gif" alt="" width="79" height="12" />; that is, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_104.gif" alt="" width="7" height="12" /> contains an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_105.gif" alt="" width="22" height="12" /> identity matrix as a submatrix.</p>
<p>In the code, the functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_106.gif" alt="" width="65" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_107.gif" alt="" width="86" height="12" /> defined in the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_108.gif" alt="" width="14" height="12" /> statements invert the lists <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_109.gif" alt="" width="43" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_110.gif" alt="" width="65" height="12" /> viewed as functions from their index sets. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_111.gif" alt="" width="58" height="12" /> tests whether <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_112.gif" alt="" width="7" height="12" /> is in the domain of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_113.gif" alt="" width="65" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_13.gif" alt="" width="485" height="283" /></p>
<p>We can now state and prove our main theorem; we write <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_114.gif" alt="" width="70" height="12" />. It may seem counterintuitive that we can strip the constant off the denominator, in particular for polynomially parameterized curves <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_115.gif" alt="" width="40" height="12" /> (so stripping it gives <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_116.gif" alt="" width="28" height="16" />). But projectively the denominator is just another coordinate so we can still do that. So if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_117.gif" alt="" width="8" height="12" /> is the matrix from the previous section and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_118.gif" alt="" width="97" height="18" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_119.gif" alt="" width="8" height="12" /> is the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_120.gif" alt="" width="158" height="12" /> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_121.gif" alt="" width="8" height="12" />, then the <em>projective stripped coefficient matrix</em> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_122.gif" alt="" width="7" height="12" /> is just the submatrix of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_123.gif" alt="" width="8" height="12" /> with the last column removed.</p>
<p><strong>Theorem B</strong></p>
<div id="1248459024" class="Theorem"><a name="1248459024"></a>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_124.gif" alt="" width="173" height="12" /> be a parametric curve in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_125.gif" alt="" width="15" height="12" /> of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_126.gif" alt="" width="6" height="12" />. Suppose the projective stripped coefficient matrix of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_127.gif" alt="" width="7" height="12" /> has rank <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_128.gif" alt="" width="5" height="12" />. Then there are <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_129.gif" alt="" width="5" height="12" /> components of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_130.gif" alt="" width="7" height="12" /> defining a stripped polynomial parametric curve <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_131.gif" alt="" width="124" height="23" /> in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_132.gif" alt="" width="14" height="12" /> and a transformation function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_133.gif" alt="" width="63" height="12" /> taking <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_134.gif" alt="" width="19" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_135.gif" alt="" width="21" height="12" />.</div>
<p><strong>Proof</strong></p>
<div id="1967746591" class="Proof"><a name="1967746591"></a>We apply the algorithm <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_136.gif" alt="" width="122" height="12" /> to the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_137.gif" alt="" width="50" height="12" /> projective stripped coefficient matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_138.gif" alt="" width="11" height="12" /> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_139.gif" alt="" width="7" height="12" />, obtaining a list of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_140.gif" alt="" width="5" height="12" /> rows forming a basis <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_141.gif" alt="" width="17" height="12" /> of the row space of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_142.gif" alt="" width="11" height="12" /> and a matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_143.gif" alt="" width="16" height="12" /> of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_144.gif" alt="" width="49" height="12" />, where the rows corresponding to this basis are replaced by rows of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_145.gif" alt="" width="22" height="12" /> identity matrix. Multiplying <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_146.gif" alt="" width="17" height="12" /> by the vector <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_147.gif" alt="" width="80" height="18" /> gives the parametric function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_148.gif" alt="" width="19" height="12" />. Appending a last column to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_149.gif" alt="" width="16" height="12" /> with the constant terms of the original <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_150.gif" alt="" width="19" height="12" /> gives a transformation matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_151.gif" alt="" width="14" height="12" />. By the above comments it is easy to see that the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_152.gif" alt="" width="158" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_153.gif" alt="" width="8" height="12" /> defined by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_154.gif" alt="" width="14" height="12" /> takes <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_155.gif" alt="" width="19" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_156.gif" alt="" width="19" height="12" />.</div>
<p>One can paraphrase this theorem as: <em>Given a parametric curve </em><img style="vertical-align: middle;" title="P(t)" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Image_1.gif" alt="P(t)" width="21" height="12" /><em> of degree </em><img style="vertical-align: middle;" title="d" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Image_3.gif" alt="d" width="6" height="12" />, <em>there is an </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_157.gif" alt="" width="25" height="12" />, <em>a stripped parametric polynomial curve </em><img style="vertical-align: middle;" title="rho" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Image_5.gif" alt="rho" width="7" height="12" /><em> in </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_158.gif" alt="" width="14" height="12" /><em> and a </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_159.gif" alt="" width="173" height="12" /> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_160.gif" alt="" width="8" height="12" /> <em>so that the following diagram commutes</em>.</p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_7a.gif" alt="" width="180" height="180" /></p>
<p>We ask the reader not to take this diagram literally in the case of a rational parameterization, as the domains of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_161.gif" alt="" width="7" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_162.gif" alt="" width="8" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_163.gif" alt="" width="7" height="12" /> may not be the full spaces indicated. But if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_164.gif" alt="" width="7" height="12" /> is a polynomial parameterization, then the domains are the full spaces and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_165.gif" alt="" width="8" height="12" /> is an embedding.</p>
<p class="Example">Example 3: We illustrate this proof by fully working out the following degree-two curve in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_166.gif" alt="" width="15" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_14.gif" alt="" width="225" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_15.gif" alt="" width="87" height="62" /></p>
<p>The decomposition can be easily done by hand.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_16.gif" alt="" width="341" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_8.gif" alt="" width="120" height="70" /></p>
<p>So we add the constant row; remember that the constant in the last row is 1.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_17.gif" alt="" width="386" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_9.gif" alt="" width="76" height="70" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_18.gif" alt="" width="223" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_10.gif" alt="" width="249" height="72" /></p>
<p>Theorem B tells us the composition of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_167.gif" alt="" width="14" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_168.gif" alt="" width="14" height="12" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_169.gif" alt="" width="14" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_19.gif" alt="" width="42" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_11.gif" alt="" width="205" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_20.gif" alt="" width="385" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_12.gif" alt="" width="337" height="12" /></p>
<p>So this curve is contained in a plane.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_21.gif" alt="" width="568" height="58" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_13a.gif" alt="" width="360" height="408" /></p>
<p class="Example">Example 2 (continued): We now consider the rational parameterization<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_170.gif" alt="" width="11" height="12" /> of example 2.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_22.gif" alt="" width="318" height="35" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_23.gif" alt="" width="580" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_14.gif" alt="" width="88" height="78" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_24.gif" alt="" width="139" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_15.gif" alt="" width="359" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_25.gif" alt="" width="154" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_16.gif" alt="" width="179" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_26.gif" alt="" width="221" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_17.gif" alt="" width="442" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_27.gif" alt="" width="139" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_18.gif" alt="" width="376" height="31" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_28.gif" alt="" width="140" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_19.gif" alt="" width="127" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_29.gif" alt="" width="215" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_20.gif" alt="" width="289" height="35" /></p>
<p>We check that this lies in a two-dimensional plane in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_171.gif" alt="" width="15" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_30.gif" alt="" width="362" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_21.gif" alt="" width="576" height="43" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_31.gif" alt="" width="246" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_22.gif" alt="" width="580" height="12" /></p>
<p>The step in the proof of Theorem B where we use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_172.gif" alt="" width="17" height="12" /> to obtain the curve <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_173.gif" alt="" width="7" height="12" /> from the rational normal curve can also be done by using an affine transformation function obtained by adding the row and column <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_174.gif" alt="" width="59" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_175.gif" alt="" width="17" height="12" />. In Example 2 we have the following.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_32.gif" alt="" width="341" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_23.gif" alt="" width="269" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_33.gif" alt="" width="290" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_24.gif" alt="" width="127" height="18" /></p>
<p>This gives:</p>
<p><strong>Theorem C</strong></p>
<div id="898550562" class="Theorem"><a name="898550562"></a>Let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_176.gif" alt="" width="59" height="12" /> be a rational (or polynomial) curve parameterization of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_177.gif" alt="" width="6" height="12" />. Suppose the projective stripped coefficient matrix of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_178.gif" alt="" width="19" height="12" /> has rank <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_179.gif" alt="" width="5" height="12" />. Then the transformation function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_180.gif" alt="" width="8" height="12" /> in Theorem B can be decomposed into transformation functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_181.gif" alt="" width="35" height="12" /> as in the following diagram.</div>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_25a.gif" alt="" width="180" height="181" /></p>
<div id="267170589" class="TheoremContinuation"><a name="267170589"></a>Here <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_182.gif" alt="" width="14" height="12" /> is an affine transformation function of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_183.gif" alt="" width="15" height="15" /> onto <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_184.gif" alt="" width="14" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_185.gif" alt="" width="14" height="12" /> is a possibly projective transformation of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_186.gif" alt="" width="14" height="12" /> into <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_187.gif" alt="" width="15" height="12" />. In particular, the parametric curve given by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_188.gif" alt="" width="7" height="12" /> lies in a linear subset of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_189.gif" alt="" width="15" height="12" /> of dimension less than or equal to the minimum of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_190.gif" alt="" width="6" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_191.gif" alt="" width="5" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_192.gif" alt="" width="6" height="12" />.</div>
<p><strong>Construction</strong></p>
<p class="Example">As in Theorem B, we let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_193.gif" alt="" width="11" height="12" /> be the projective stripped matrix of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_194.gif" alt="" width="21" height="12" /> and apply <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_195.gif" alt="" width="122" height="12" /> to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_196.gif" alt="" width="11" height="12" /> to get <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_197.gif" alt="" width="48" height="12" /> of sizes <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_198.gif" alt="" width="49" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_199.gif" alt="" width="23" height="12" />, respectively. Appending a row of zeros and then a column of zeros with last component 1 to make <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_200.gif" alt="" width="17" height="12" /> into an affine transformation matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_201.gif" alt="" width="25" height="15" /> of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_202.gif" alt="" width="77" height="12" />, let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_203.gif" alt="" width="14" height="12" /> be the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_204.gif" alt="" width="144" height="12" /> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_205.gif" alt="" width="25" height="15" />. Appending the column of constants to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_206.gif" alt="" width="16" height="12" />, we get a transformation matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_207.gif" alt="" width="24" height="15" /> of size <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_208.gif" alt="" width="75" height="12" />. Then <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_209.gif" alt="" width="14" height="12" /> is the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_210.gif" alt="" width="144" height="12" /> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_211.gif" alt="" width="24" height="15" />. One can check that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_212.gif" alt="" width="153" height="18" />.</p>
<p>This recovers the known result [<a href="#Harris">2</a>] that every rational parameterization is a projective linear transformation of the rational normal curve, but here we have a constructive approach.</p>
<p class="Example">Example 4: For an easy but nontrivial (i.e. not conic) example we use the <em>piriform</em> [<a href="#Weisstein">7</a>].</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_34.gif" alt="" width="208" height="35" /></p>
<p>Here <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_213.gif" alt="" width="26" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_214.gif" alt="" width="26" height="12" />. Here is the stripped projective matrix.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_35.gif" alt="" width="117" height="46" /></p>
<p>A trivial application of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_215.gif" alt="" width="122" height="12" /> in that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_216.gif" alt="" width="14" height="12" /> is of full rank gives the following.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_36.gif" alt="" width="341" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_26.gif" alt="" width="162" height="46" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_37.gif" alt="" width="523" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_27.gif" alt="" width="95" height="62" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_38.gif" alt="" width="230" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_28a.gif" alt="" width="294" height="45" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_39.gif" alt="" width="345" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_29.gif" alt="" width="72" height="46" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_40.gif" alt="" width="230" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_30.gif" alt="" width="245" height="46" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_41.gif" alt="" width="169" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_31.gif" alt="" width="172" height="35" /></p>
<p>Notice here that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_217.gif" alt="" width="26" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_218.gif" alt="" width="25" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_219.gif" alt="" width="29" height="12" /> In this case, the curve lies in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_220.gif" alt="" width="15" height="15" />, a two-dimensional space. The numbers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_221.gif" alt="" width="6" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_222.gif" alt="" width="5" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_223.gif" alt="" width="6" height="12" /> are important values in describing a rational parameterized curve. Even though the transformation matrix for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_224.gif" alt="" width="14" height="12" /> contains the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_225.gif" alt="" width="24" height="12" /> identity matrix, it is not injective, which is typical in the case of a rational parameterization, even when <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_226.gif" alt="" width="25" height="12" />, but this does not occur for a polynomial parameterization.</p>
<h3>5. The Recognition Problem</h3>
<p>The recognition problem is: <em>given a parameterized curve </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_227.gif" alt="" width="58" height="12" /><em> and a point </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_228.gif" alt="" width="6" height="12" /><em> in </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_229.gif" alt="" width="15" height="12" />,<em> is </em><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_230.gif" alt="" width="6" height="12" /><em> in the curve</em>; that is, does there exist <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_231.gif" alt="" width="4" height="12" /> with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_232.gif" alt="" width="39" height="12" />?</p>
<p>There are two obvious methods to solve this problem. The first is to directly solve the over-determined system <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_233.gif" alt="" width="39" height="12" /> using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_234.gif" alt="" width="84" height="12" />. This works surprisingly well, failing mostly with poorly conditioned systems for which the other methods following may not work well either. The biggest problem with this approach is that when it does not work, it gives a false negative to the recognition problem. One can, of course, solve component by component and see if any solutions are numerically close.</p>
<p class="Example">Example 2 continued.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_42.gif" alt="" width="580" height="69" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_32.gif" alt="" width="249" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_33.gif" alt="" width="293" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_43.gif" alt="" width="91" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_34.gif" alt="" width="102" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_44.gif" alt="" width="91" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_35.gif" alt="" width="14" height="12" /></p>
<p>So the first point <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_235.gif" alt="" width="35" height="12" /> is on the curve but the second point <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_236.gif" alt="" width="35" height="12" /> is not. In general, finding a common zero of a set of polynomial or rational equations is an interesting problem, but we do not consider that here.</p>
<p>The second method is to find a system of equations whose solution set is the Zariski closure of the point set <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_237.gif" alt="" width="56" height="12" />. All that then needs to be done, in principle, is to evaluate this system at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_238.gif" alt="" width="6" height="12" /> and check that the value is 0. We consider this issue in Section 5.</p>
<p>As we have seen, a parameterized curve in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_239.gif" alt="" width="15" height="12" /> may lie in a linear subset of dimension less than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_240.gif" alt="" width="9" height="12" /> Using Theorem C and the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_241.gif" alt="" width="65" height="12" /> algorithm, we can get some additional information about the problem and perhaps reduce this to a problem in a smaller <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_242.gif" alt="" width="14" height="12" />.</p>
<p class="Example">Example 5.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_45.gif" alt="" width="461" height="35" /></p>
<p>We would like to find out which, if any, of the following points are on this curve.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_46.gif" alt="" width="167" height="105" /></p>
<p>We first find the transformation functions. Here is the projective stripped coefficient matrix.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_47.gif" alt="" width="118" height="78" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_48.gif" alt="" width="238" height="12" /></p>
<p>Apply <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_243.gif" alt="" width="122" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_49.gif" alt="" width="325" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_36.gif" alt="" width="185" height="86" /></p>
<p>Augment these matrices to get transformation matrices.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_50.gif" alt="" width="260" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_37.gif" alt="" width="110" height="86" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_51.gif" alt="" width="487" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_38.gif" alt="" width="88" height="62" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_52.gif" alt="" width="231" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_39.gif" alt="" width="261" height="62" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_53.gif" alt="" width="231" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_40a.gif" alt="" width="314" height="45" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_54.gif" alt="" width="223" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_41.gif" alt="" width="425" height="35" /></p>
<p>Generate some random points.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_55.gif" alt="" width="234" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_56.gif" alt="" width="269" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_42.gif" alt="" width="14" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_57.gif" alt="" width="288" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_43.gif" alt="" width="389" height="12" /></p>
<p>This says <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_244.gif" alt="" width="22" height="12" /> is not contained in any proper subspace, but the image of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_245.gif" alt="" width="22" height="12" /> lies in a three-dimensional subspace of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_246.gif" alt="" width="15" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_58.gif" alt="" width="230" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_44.gif" alt="" width="114" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_59.gif" alt="" width="230" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_45.gif" alt="" width="114" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_60.gif" alt="" width="230" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_46.gif" alt="" width="80" height="12" /></p>
<p>The points <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_247.gif" alt="" width="22" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_248.gif" alt="" width="22" height="12" /> do lie in the image of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_249.gif" alt="" width="58" height="12" />, so may be points on the curve, but we can eliminate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_250.gif" alt="" width="22" height="12" />. We find the fibers (preimage) of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_251.gif" alt="" width="22" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_252.gif" alt="" width="22" height="12" /> in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_253.gif" alt="" width="15" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_61.gif" alt="" width="234" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_47.gif" alt="" width="326" height="33" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_62.gif" alt="" width="322" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_48.gif" alt="" width="86" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_63.gif" alt="" width="326" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_49.gif" alt="" width="79" height="12" /></p>
<p>These conveniently are singleton points. Thus we have reduced this rational recognition problem in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_254.gif" alt="" width="15" height="15" /> to a polynomial problem recognition problem in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_255.gif" alt="" width="15" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_64.gif" alt="" width="142" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_50.gif" alt="" width="221" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_65.gif" alt="" width="106" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_51.gif" alt="" width="66" height="12" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_66.gif" alt="" width="106" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_52.gif" alt="" width="14" height="12" /></p>
<p>So <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_256.gif" alt="" width="75" height="12" /> but <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_257.gif" alt="" width="22" height="12" /> is not on the curve.</p>
<h3>6. Implicitization of Rational Parametric Space Curves</h3>
<p>As mentioned, the motivation for this article is my work on implicitization of rational parametric space curves. In this section I only sketch my algorithms; details are in [<a href="#Dayton 1">4</a>]. The key here is that by the material discussed, especially Theorem C, every such curve is simply a fractional linear transformation of the rational normal curve.</p>
<p>By <em>implicitization</em> I mean describing these parametric curves by way of algebraic equations. A problem that arises is that while one expects a curve in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_258.gif" alt="" width="15" height="12" /> to be given by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_259.gif" alt="" width="24" height="12" /> equations, this is often not enough to fully describe the curve pointwise or algebraically. The standard counterexample is the <em>twisted cubic</em>, which is just the rational normal curve of degree three, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_260.gif" alt="" width="85" height="18" />. A system of three equations in the variables <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_261.gif" alt="" width="6" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_262.gif" alt="" width="6" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_263.gif" alt="" width="5" height="12" /> describing the twisted cubic, given in [<a href="#Harris">2</a>], is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_264.gif" alt="" width="119" height="18" />. An exercise in [<a href="#Harris">2</a>] is to show that the zero set of any pair of these three equations contains not only the twisted cubic, but also a line, but note that the extra line in the last pair lies in the infinite plane of projective three-space.</p>
<p>Any implicitization problem has infinitely many possible answers, but the best answers are systems of equations that form an H-basis. This idea goes back to F. S. Macaulay in 1916, who was studying homogeneous equations, hence the <span class="special-character OpenCurlyDoubleQuote">“</span>H<span class="special-character CloseCurlyDoubleQuote">”</span>; basically in our context it means that any equation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_265.gif" alt="" width="7" height="12" /> of total degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_266.gif" alt="" width="6" height="12" /> containing the parametric curve in its zero set is a polynomial combination <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_267.gif" alt="" width="107" height="12" />, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_268.gif" alt="" width="10" height="12" /> are in the H-basis and the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_269.gif" alt="" width="10" height="12" /> are polynomials so that each term <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_270.gif" alt="" width="22" height="12" /> has total degree at most <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_271.gif" alt="" width="9" height="12" /> Thus for an H-basis, the ideal membership problem reduces to linear algebra.</p>
<p>If one has a system <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_272.gif" alt="" width="6" height="12" /> with zero set describing the parametric curve <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_273.gif" alt="" width="19" height="12" />, then the Gr<span class="special-character ODoubleDot">ö</span>bner basis with respect to a degree ordering is an H-basis, perhaps larger than necessary. In practical terms one can simply use the following format.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_67.gif" alt="" width="403" height="12" /></p>
<p>In the case of the rational normal curve of degree <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_274.gif" alt="" width="6" height="12" />, Harris [<a href="#Harris">2</a>] claims that using quadratic equations is sufficient, so we can proceed as follows: we first give a procedure finding the total degree <img style="vertical-align: middle;" title="d" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Image_7.gif" alt="d" width="6" height="12" /> of a polynomial of several variables.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_68.gif" alt="" width="440" height="12" /></p>
<p>Then we use the following code, say for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_275.gif" alt="" width="26" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_69.gif" alt="" width="296" height="28" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_53.gif" alt="" width="175" height="18" /></p>
<p>This defines <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_276.gif" alt="" width="7" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_70.gif" alt="" width="580" height="73" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_54.gif" alt="" width="341" height="18" /></p>
<p>Likewise we get the following for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_277.gif" alt="" width="39" height="12" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_71.gif" alt="" width="554" height="38" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_72.gif" alt="" width="580" height="38" /></p>
<p>The size of the H-basis <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_278.gif" alt="" width="15" height="12" /> is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_279.gif" alt="" width="31" height="23" />, which gets much larger than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_280.gif" alt="" width="24" height="12" />. The numbers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_281.gif" alt="" width="31" height="23" /> are binomial coefficients and can be enumerated recursively; however, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_282.gif" alt="" width="26" height="12" /> does not contain <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_283.gif" alt="" width="15" height="12" />, so there is no obvious recursive construction of these bases.</p>
<p>In [<a href="#Dayton 1">4</a>] I construct, for the fractional linear transformation given by an <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_284.gif" alt="" width="79" height="12" /> transformation matrix <span class="MCode">A</span>, a transformation <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_285.gif" alt="" width="162" height="12" />. This takes the system <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_286.gif" alt="" width="7" height="12" /> in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_287.gif" alt="" width="16" height="12" /> with variables given by the list <span class="MCode">X</span> to a system in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_288.gif" alt="" width="15" height="12" /> with variable list <span class="MCode">Y</span> such that for a solution <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_289.gif" alt="" width="14" height="12" /> of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_290.gif" alt="" width="7" height="12" /> then <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_291.gif" alt="" width="207" height="12" /> is a solution of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_292.gif" alt="" width="7" height="12" />. Unfortunately, this works numerically and the user must provide a number <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_293.gif" alt="" width="7" height="12" /> that bounds the degrees of the polynomials used and a small tolerance <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_294.gif" alt="" width="22" height="12" />, but for an appropriate choice of these parameters the system <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_295.gif" alt="" width="7" height="12" /> is often an H-basis if <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_296.gif" alt="" width="7" height="12" /> is.</p>
<p>Thus, a possible method for finding an implicit system describing the rational parameterized curve <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_297.gif" alt="" width="19" height="12" /> is to write it in the form <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_298.gif" alt="" width="115" height="18" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_299.gif" alt="" width="8" height="12" /> is a <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_300.gif" alt="" width="158" height="12" />, and use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_301.gif" alt="" width="169" height="12" />.</p>
<p>We use Example 4 to illustrate this.</p>
<p>Example 4 continued; define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_302.gif" alt="" width="14" height="12" /> and so on.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_73.gif" alt="" width="131" height="46" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_74.gif" alt="" width="352" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_55.gif" alt="" width="172" height="35" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_75.gif" alt="" width="412" height="103" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_56.gif" alt="" width="373" height="38" /></p>
<p>Then we get the implicitization directly using a related function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_303.gif" alt="" width="36" height="12" /> (fractional linear transformation, i.e. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_304.gif" alt="" width="158" height="12" />) that takes not points to points but equation systems to equation systems. In [<a href="#Dayton 2">6</a>] this is simple, because all transformation matrices used are invertible. In this context the 3<span class="special-character Times">×</span>5 transformation matrix is not invertible, so finding the equation system for the image of a transformation function becomes quite involved. Essentially this is the subject of all of Chapter 2 in [<a href="#Dayton 1">4</a>]. For instance, in this case we are compacting six equations into one.</p>
<p>The following non-executable code and result are copied from [<a href="#Dayton 1">4</a>, Section 3.1]. For executable code, see the GlobalFunctionsMD.nb notebook of [<a href="#Dayton 1">4</a>].</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_76.gif" alt="" width="410" height="12" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_57.gif" alt="" width="195" height="18" /></p>
<p>Once this is done we can check that this works.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Input_77.gif" alt="" width="528" height="43" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Output_58a.gif" alt="" width="160" height="161" /></p>
<h3>Summary</h3>
<p>We have shown how the Wolfram function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/09/Dayton_Math_305.gif" alt="" width="158" height="12" /> simplifies the study of rational parameterized curves.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Cardano"></a>[1]</td>
<td>J. Cardano, <em>The Great Art</em> (T. R. Whitmer, trans.), Boston: MIT Press, 1968.</td>
</tr>
<tr>
<td class="Reference"><a name="Harris"></a>[2]</td>
<td>J. Harris, <em>Algebraic Geometry, A First Course</em>, Springer Graduate Texts in Mathematics 133, New York: Springer, 1992.</td>
</tr>
<tr>
<td class="Reference"><a name="Wolfram"></a>[3]</td>
<td>S. Wolfram, <em>An Elementary Introduction to the Wolfram Language</em>, Champaign, IL: Wolfram Media, 2015. See also <a href="https://reference.wolfram.com/language/">reference.wolfram.com/language</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Dayton 1"></a>[4]</td>
<td>B. H. Dayton. <span class="special-character OpenCurlyDoubleQuote">“</span>Space Curve Book.<span class="special-character CloseCurlyDoubleQuote">”</span> <a href="http://barryhdayton.space/SpaceCurves/spindex.html" target="_blank">http://barryhdayton.space/SpaceCurves/spindex.html</a>. (Sep 4, 2020). Code in <a href="http://www.barryhdayton.space/SpaceCurves/GlobalFunctionsMD.nb">barryhdayton.space/SpaceCurves/GlobalFunctionsMD.nb</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Abhyankar"></a>[5]</td>
<td>S. Abhyankar, <em>Algebraic Geometry for Scientists and Engineers</em>, Providence, RI: American Mathematical Society, 1990.</td>
</tr>
<tr>
<td class="Reference"><a name="Dayton 2"></a>[6]</td>
<td>B. H. Dayton, <em>A Numerical Approach to Real Algebraic Curves with the Wolfram Language</em>, Champaign, IL: Wolfram Media, 2018.</td>
</tr>
<tr>
<td class="Reference"><a name="Weisstein"></a>[7]</td>
<td>E. W. Weisstein. <span class="special-character OpenCurlyDoubleQuote">“</span>Piriform Curve<span class="special-character CloseCurlyDoubleQuote">”</span> from Wolfram MathWorld<span class="special-character LongDash">—</span>A Wolfram Web Resource. <a href="https://mathworld.wolfram.com/PiriformCurve.html">mathworld.wolfram.com/PiriformCurve.html</a>.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>B. Dayton, <span class="special-character OpenCurlyDoubleQuote">“</span>Degree versus Dimension for Rational Parametric Curves,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2020. <a href="https://doi.org/10.3888/tmj.22-3">https://doi.org/10.3888/tmj.22–3</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p>Barry Dayton is the author of <em>A Numerical Approach to Real Algebraic Curves with the Wolfram Language</em> and is Professor Emeritus at Northeastern Illinois University in Chicago, IL. He lives in Ridgefield CT.</p>
<p class="TextAboutAuthor"><strong>Barry H. Dayton</strong><em><br />
Department of Mathematics<br />
Northeastern Illinois University<br />
Chicago, Illinois 60625-4699<br />
</em><em><a href="http://barryhdayton.space">barryhdayton.space</a></em><em><br />
</em><em><a href="mailto:barry@barryhdayton.us">barry@barryhdayton.us</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2020/09/22/degree-versus-dimension-for-rational-parametric-curves/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Foundations of Computational Finance</title>
		<link>https://www.mathematica-journal.com/2020/08/18/foundations-of-computational-finance/</link>
		<comments>https://www.mathematica-journal.com/2020/08/18/foundations-of-computational-finance/#respond</comments>
		<pubDate>Tue, 18 Aug 2020 21:56:00 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 22]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=59471</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.22-2 The Wolfram Language has numerous knowledge-based built-in functions to support financial computations. This article introduces many built-in and other financial functions that are based on concepts and models covered in undergraduate-level finance courses. Examples are taken from a wide range of finance areas. They emphasize importing and visualization of data from many sources, valuation, [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.22-2">https://doi.org/10.3888/tmj.22-2</a></span></div>
<div>
<p>The Wolfram Language has numerous knowledge-based built-in functions to support financial computations. This article introduces many built-in and other financial functions that are based on concepts and models covered in undergraduate-level finance courses. Examples are taken from a wide range of finance areas. They emphasize importing and visualization of data from many sources, valuation, capital budgeting, analysis of stock returns, portfolio optimization and analysis of bonds and stock options. We hope that all the functions selected in this article are very useful for analyzing real-world financial data. All examples provide a unique set of tools for users to engage with real-world financial data and solve practical problems. The feature of automatic data retrieval from online sources and its analysis makes all results reproducible without any modifications in the code. We hope this feature will attract new users from the finance community. <span id="more-59471"></span></p>
<h3>1. Introduction</h3>
<p>Finance is computational in nature and often involves the analysis and visualization of complex data, optimization, simulation and use of data for risk management. Without the proper use of technology, it is almost impossible to analyze these functions of modern finance. Moreover, the field of finance has become far more driven by data and technology since the 1990s, which has made large-scale data analysis the norm. Data-driven decision-making and predictive modeling are now the heart of every strategic financial decision. Since the publication of Varian [<a href="#Varian1">1</a>, <a href="#Varian2">2</a>], Shaw [<a href="#Shaw">3</a>] and Stojanovic [<a href="#Stojanovic">4</a>], there have been many updates and new functions, but no new articles or books have been written to cover wide areas of computational finance. This article provides a comprehensive overview of functions related to finance and introduces many functions that are useful for real-world financial data analysis using Mathematica 12.</p>
<p>We have provided all the custom functions in the text so that users can make changes as they learn how to program in the Wolfram Language. Furthermore, we minimize the explanation of any financial concepts in this article as our focus is on introducing financial application of the Wolfram Language.</p>
<p>We begin by defining some symbols that are frequently used as input arguments of custom functions in the article. The article uses <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_1.gif" alt="" width="50" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_2.gif" alt="" width="58" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_3.gif" alt="" width="75" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_4.gif" alt="" width="58" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_5.gif" alt="" width="50" height="15" /> as arguments in many functions defined in this article. Most of these symbols are used as input in the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_6.gif" alt="" width="108" height="15" />. All these arguments must be specified in the format acceptable in the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_7.gif" alt="" width="108" height="15" /> function. We use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_8.gif" alt="" width="50" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_9.gif" alt="" width="58" height="15" /> to represent a company<span class="special-character CloseCurlyQuote">’</span>s or companies<span class="special-character CloseCurlyQuote">’</span> stock ticker symbol or symbols. It could be a string or a list of strings. The format <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_10.gif" alt="" width="75" height="15" /> represents the start date of the sample period specified and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_11.gif" alt="" width="58" height="15" /> represents the last date of the analysis period. Both must be specified as date objects in any date format supported by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_12.gif" alt="" width="83" height="15" />. Similarly, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_13.gif" alt="" width="50" height="15" /> represents data frequency. It may include <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_14.gif" alt="" width="41" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_15.gif" alt="" width="49" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_16.gif" alt="" width="57" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_17.gif" alt="" width="49" height="15" />. In the subsequent functions defined in this article, we will not describe them when they are used as arguments.</p>
<p>The article is organized into 13 sections:</p>
<p>1. this Introduction</p>
<p>2. importing and visualizing data from different sources</p>
<p>3. capital budgeting and business valuation</p>
<p>4. functions for the analysis of security returns</p>
<p>5. rolling-window performance analysis</p>
<p>6. financial application of optimization</p>
<p>7. decomposing the risk of a portfolio into its components</p>
<p>8. importing factor data and running factor models</p>
<p>9. computing different types of portfolio performance measures</p>
<p>10. technical analysis of stock prices</p>
<p>11. bond analysis</p>
<p>12. analyzing derivative products</p>
<p>13. concluding remarks</p>
<h3>2. Accessing Financial Data and Basic Data Visualization</h3>
<p>The most commonly used built-in functions for retrieving company-specific financial data are <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_18.gif" alt="" width="58" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_19.gif" alt="" width="91" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_20.gif" alt="" width="75" height="15" />. For example,</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_21.gif" alt="" width="628" height="15" /></p>
<p>imports Facebook&#8217;s financial statement data and</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_22.gif" alt="" width="337" height="15" /></p>
<p>imports Facebook&#8217;s price-related data.</p>
<p>Similarly, the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_23.gif" alt="" width="108" height="15" /> can be used to get data about stocks and other financial instruments. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_24.gif" alt="" width="99" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_25.gif" alt="" width="133" height="15" /> can be used to chart prices against time. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_26.gif" alt="" width="99" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_27.gif" alt="" width="190" height="15" /> can be used to make interactive plots with additional features of adding different technical indicators. Other functions such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_28.gif" alt="" width="75" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_29.gif" alt="" width="83" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_30.gif" alt="" width="133" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_31.gif" alt="" width="116" height="15" /> can also be used to visualize financial data. In the remaining part of this section, we are going to show you how to import data from different sources and visualize it.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_1.gif" alt="" width="580" height="142" /></p>
<p>We download Apple<span class="special-character CloseCurlyQuote">’</span>s return on assets (ROA), return on equity (ROE) and revenue growth over the period January 1, 2001, to January 1, 2019, and plot them.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_2.gif" alt="" width="580" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_1.gif" alt="" width="414" height="296" /></p>
<p>Similarly, we define the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_32.gif" alt="" width="141" height="15" /> function to compare any specified property of different companies. The function takes a list of stock symbols, beginning period, end period and a property to consider as its arguments.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_3.gif" alt="" width="580" height="160" /></p>
<p>We plot the revenue growth of Apple, Facebook, Walmart and Bank of America over the period January 1, 2000, to January 1, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_4.gif" alt="" width="580" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_2.gif" alt="" width="414" height="296" /></p>
<p>Second, we import and visualize data from the Federal Reserve Bank of St. Louis, as it is one of the most important data sources when it comes to economic data. The built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_33.gif" alt="" width="116" height="15" /> can be used to request the data from the Federal Reserve Economic Data API. Its argument structure is:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_34.gif" alt="" width="590" height="15" /></p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_35.gif" alt="" width="25" height="15" /> is a series ID or a list of IDs. It returns a time series containing data for the specified series. It is often of interest to plot the economic time series with the recession dates.</p>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_36.gif" alt="" width="91" height="15" /> function downloads and plots the selected series along with the shaded recession period. The function takes series ID, start date, end date and title as inputs and returns a graph. It uses recession indicators based on USREC (US recession) data from the National Bureau of Economic Research (NBER) for the United States from the period following the peak through the trough to indicate the recession period. The Federal Reserve Bank of St. Louis may require the API key to download its data. The API key can be obtained freely by creating a user account at <a href="https://fred.stlouisfed.org" target="_blank">https://fred.stlouisfed.org</a> (click &#8220;my account&#8221; and follow the instructions).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_5.gif" alt="" width="580" height="412" /></p>
<p>Now we can download any series and plot it. For example, we download and plot the Leading Index for the United States (USSLIND) over the period January 30, 1990, to January 30, 2019. Please use the API key 207071a5f2e90e7816259d3c32c1ab81 if needed. The shaded regions indicate recession periods.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_6.gif" alt="" width="425" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_3.gif" alt="" width="414" height="293" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_7.gif" alt="" width="580" height="268" /></p>
<p>We download and plot the historical real S&amp;P 500 prices by month (MULTPL/SP500_REAL_PRICE _MONTH) over the period March 31, 1975, to May 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_8.gif" alt="" width="580" height="107" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_4.gif" alt="" width="414" height="295" /></p>
<p>Finally, we show how to create a dataset. The built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_37.gif" alt="" width="58" height="15" /> is very useful for organizing large or small sets of data.</p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_38.gif" alt="" width="116" height="15" /> can be used to get a company&#8217;s fundamental data. After the data is stored, we can organize and analyze the data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_9.gif" alt="" width="580" height="250" /></p>
<p>For example, we download return on assets (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_39.gif" alt="" width="42" height="16" />), return on equity (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_40.gif" alt="" width="40" height="16" />) and revenue growth (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_41.gif" alt="" width="103" height="16" />) for Apple Inc. (AAPL) over the period January 1, 2000, to January 1, 2019, and make a dataset. After the dataset is constructed, we can pull data and do further analysis using a rich set of built-in Wolfram knowledge.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_10.gif" alt="" width="580" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_5.gif" alt="" width="580" height="178" /></p>
<h3>3. Common Financial Decision Making, Capital Budgeting and Business Valuation</h3>
<p>Basic concepts used in common financial decision making are important for learning and understanding the finance discipline. Many functions such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_42.gif" alt="" width="141" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_43.gif" alt="" width="66" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_44.gif" alt="" width="58" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_45.gif" alt="" width="83" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_46.gif" alt="" width="75" height="15" /> are directly related to finance. Other functions such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_47.gif" alt="" width="41" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_48.gif" alt="" width="66" height="15" /> can be used to find one of the unknowns when relevant information is given. All these functions are useful for solving time value of money, capital begetting and business valuation problems. The Mathematica documentation provides numerous examples of how to use these functions. In this section, we are going to focus on a few examples concerning loan amortization, capital budgeting and business valuation.</p>
<p>A loan amortization table is often used to visualize periodic payments of the loan, loan balance and payment breakdown into principle payment and interest payment. The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_49.gif" alt="" width="141" height="15" /> returns an amortization table given its input arguments. It takes four arguments:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_50.gif" alt="" width="17" height="15" />: current value of loan amount</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_51.gif" alt="" width="41" height="15" />: loan term in years</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_52.gif" alt="" width="25" height="15" />: annual percentage interest rate</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_53.gif" alt="" width="75" height="15" />: frequency of loan payment per year: 12 for monthly payment, 1 for annual payment, and so on</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_54.gif" alt="" width="17" height="15" />: (an optional argument) future value of the loan amount; if no value for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_55.gif" alt="" width="17" height="15" /> is provided, the future value of the loan is assumed to be zero</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_11.gif" alt="" width="580" height="372" /></p>
<p>Using this function, we compute an amortization table for a loan of $40,000 with 1-year loan term, 5% APR paid monthly.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_12.gif" alt="" width="298" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_6.gif" alt="" width="536" height="281" /></p>
<p>The most commonly used decision tools in capital budgeting are net present value (NPV), internal rate of return (IRR), modified internal rate of return (MIRR) and profitability index (PI). These are defined in terms of the cash flows <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_56.gif" alt="" width="21" height="16" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_57.gif" alt="" width="89" height="16" />, the discount rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_58.gif" alt="" width="5" height="16" /> and the reinvestment rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_59.gif" alt="" width="9" height="16" /> by:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_13.gif" alt="" width="273" height="39" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_14.gif" alt="" width="306" height="39" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_15.gif" alt="" width="461" height="22" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_16.gif" alt="" width="184" height="53" /></p>
<p>We use the built-in Mathematica functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_60.gif" alt="" width="75" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_61.gif" alt="" width="66" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_62.gif" alt="" width="66" height="15" /> in the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_63.gif" alt="" width="174" height="15" /> function to compute these measures. It takes cash flows <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_64.gif" alt="" width="17" height="15" /> (a list), discount rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_65.gif" alt="" width="8" height="15" /> and reinvestment rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_66.gif" alt="" width="17" height="15" /> as its arguments.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_17.gif" alt="" width="580" height="178" /></p>
<p>We illustrate the use of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_67.gif" alt="" width="174" height="15" /> function with an example. Say a project requires a $50,000 initial investment and is expected to produce, after tax, a cash flow of $15,000, $8,000, $10,000, $12,000, $14,000 and $16,000 over the next six years. The discount rate is 10% and the reinvestment rate is 11%. We compute the project<span class="special-character CloseCurlyQuote">’</span>s NPV, IRR, MIRR and PI.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_18.gif" alt="" width="580" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_7.gif" alt="" width="475" height="15" /></p>
<p>One of the most widely used business valuation models is the discounted cash flow model, in which the value of any asset is obtained by discounting the expected cash flows on that asset at a rate that reflects its riskiness. In its most general form, the value of a company is the present value of the expected free cash flows the company can generate in perpetuity. Because we cannot estimate free cash flows (FCF) in perpetuity, we generally allow for a period where FCF can grow at extraordinary rates, but we allow for closure in the model by assuming that the growth rate will decline to a stable rate that can be sustained forever at some point in the future. If we assume that the discount rate is the weighted average cost of capital (WACC), FCF grows at the rate of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_68.gif" alt="" width="7" height="16" /> per year and that the last year<span class="special-character CloseCurlyQuote">’</span>s free cash flow is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_69.gif" alt="" width="53" height="16" />, then the value of the firm can be defined as</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_19.gif" alt="" width="156" height="46" /></p>
<p>If we assume that FCF grows at the rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_70.gif" alt="" width="13" height="16" /> for the next <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_71.gif" alt="" width="13" height="16" /> years and at the rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_72.gif" alt="" width="13" height="16" /> thereafter, then the value of the firm can be written as</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormulaNumbered_1.gif" alt="" width="370" height="48" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="DFN:1"></a>(1)</td>
</tr>
</tbody>
</table>
<p>We implement formula (<a href="#DFN:1">1</a>) with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_73.gif" alt="" width="133" height="15" /> that takes five arguments:</p>
<p>1. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_74.gif" alt="" width="25" height="15" />, last year&#8217;s free cash flows</p>
<p>2. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_75.gif" alt="" width="17" height="15" />, the annual growth rate of free cash flows in the first growth period</p>
<p>3. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_76.gif" alt="" width="17" height="15" />, the number of years in the first growth period</p>
<p>4. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_77.gif" alt="" width="17" height="15" />, the stable growth rate</p>
<p>5. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_78.gif" alt="" width="33" height="15" />, the weighted average cost of capital</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_20.gif" alt="" width="372" height="69" /></p>
<p>Suppose that a company has $100 as its past year<span class="special-character CloseCurlyQuote">’</span>s CFC, its FCF is expected to grow at 5% for the next five years and 2.5% thereafter and that its WACC is 9.5%. We compute its value.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_21.gif" alt="" width="349" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_8.gif" alt="" width="58" height="15" /></p>
<p>The most practical approach is to assume that a company goes through three phases: growth, transition and maturity. First, a company<span class="special-character CloseCurlyQuote">’</span>s growth increases. In the transition phase, the growth rate decreases. In the mature phase, a company grows at the same rate as that of the overall economy.</p>
<p>Assume that the FCF is positive and grew at the rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_79.gif" alt="" width="13" height="16" /> last year. Assume further that it grows at the higher rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_80.gif" alt="" width="13" height="16" /> each year for the next <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_81.gif" alt="" width="13" height="16" /> years and that after <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_82.gif" alt="" width="13" height="16" /> years, it declines at the rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_83.gif" alt="" width="13" height="16" /> each year for the next <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_84.gif" alt="" width="13" height="16" /> years. Finally, assume the company grows at the stable positive rate <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_85.gif" alt="" width="13" height="16" /> per year after <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_86.gif" alt="" width="41" height="16" /> years and that the cost of capital is represented by WACC. Then the value of the firm can be written as</p>
<table class="DisplayFormulaNumbered">
<tbody>
<tr>
<td><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormulaNumbered_2.gif" alt="" width="556" height="109" /></td>
<td class="DisplayFormulaNumberedLabel"><a name="DFN:2"></a>(2)</td>
</tr>
</tbody>
</table>
<p>We implement formula (<a href="#DFN:2">2</a>) with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_87.gif" alt="" width="149" height="15" /> that takes eight arguments:</p>
<p>1. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_88.gif" alt="" width="25" height="15" />, last year&#8217;s free cash flows</p>
<p>2. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_89.gif" alt="" width="17" height="15" />, last year&#8217;s FCF growth rate</p>
<p>3. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_90.gif" alt="" width="17" height="15" />, the incremental growth rate in the high growth period</p>
<p>4. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_91.gif" alt="" width="17" height="15" />, the number of years in the high growth period</p>
<p>5. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_92.gif" alt="" width="17" height="15" />, the declining growth rate in the translational growth period</p>
<p>6. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_93.gif" alt="" width="17" height="15" />, the number of years in the translational growth period</p>
<p>7. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_94.gif" alt="" width="17" height="15" />, the stable growth rate in the maturity growth period</p>
<p>8. <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_95.gif" alt="" width="33" height="15" />, the weighted average cost of capital</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_22.gif" alt="" width="580" height="142" /></p>
<p>To apply the function, consider a company in the early stage of its life cycle, assuming that the company experienced 10 percent growth in the past year. The company is expected to grow by 8% more each year for the next 7 years and its growth will start to decline by 5% each year after the seventh year for 5 years. After 12 years, the company is expected to grow at the same rate as that of the overall economy, which is 2.5% per year. Suppose the past year<span class="special-character CloseCurlyQuote">’</span>s CFC was $100 million and the weighted average cost of capital is 9.5%. We compute the value of the company.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_23.gif" alt="" width="479" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_9.gif" alt="" width="60" height="15" /></p>
<p>When using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_96.gif" alt="" width="149" height="15" />, we assume that the growth rate in the stable phase is never negative. Therefore, do not assume the declining growth rate to be too high. Otherwise, the growth rate of FCF in the maturity phase may be negative.</p>
<h3>4. Analysis of Stock Returns</h3>
<p>There are various methods in analyzing historical stock prices and returns data. We can use different kinds of charts and graphs as well as descriptive statistics. Similarly, it is also important to understand whether the stock returns distribution is normal. In the next two subsections, we explain some of the most common charts and descriptive measures.</p>
<h4>4.1 Individual Stock Return Analysis</h4>
<p>Commonly used charts for historical performance analysis are time series plot of prices, normalized prices (historical prices divided by the price at the beginning), continuous draw-downs (cumulative continuous returns) and cumulative returns. The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_97.gif" alt="" width="174" height="15" />l takes four arguments as defined in Section 1 and returns four different plots: historical prices, the normalized price, continuous draw-downs and cumulative returns.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_24.gif" alt="" width="580" height="304" /></p>
<p>We can apply <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_98.gif" alt="" width="174" height="15" />l to any symbol and period. For example, we plot the historical stock prices and returns of Walmart Inc. (WMT) over the period October 10, 2018, to June 7, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_25.gif" alt="" width="519" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_10.gif" alt="" width="444" height="367" /></p>
<p>A histogram and an empirical plot of kernel density estimates are often used to describe the general shape of the data. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_99.gif" alt="" width="91" height="15" /> function takes four arguments as defined in Section 1 and returns density and histogram plots of returns.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_26.gif" alt="" width="580" height="268" /></p>
<p>Using the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_100.gif" alt="" width="91" height="15" /> function, we download the daily closing price of the S&amp;P 500 index over the period October 1, 2000, to October 1, 2019, and plot the histogram, the empirical density function and the density function of a normal distribution with the same mean and variance.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_27.gif" alt="" width="436" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_11.gif" alt="" width="414" height="319" /></p>
<p>Many built-in functions can be used to compute different descriptive statistics. These descriptive statistics describe properties of distributions, such as location, dispersion and shape. The most common measures are computed by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_101.gif" alt="" width="207" height="15" />:</p>
<p><span class="special-character Bullet">•</span> holding period return</p>
<p><span class="special-character Bullet">•</span> average return</p>
<p><span class="special-character Bullet">•</span> geometric mean return</p>
<p><span class="special-character Bullet">•</span> cumulative returns</p>
<p><span class="special-character Bullet">•</span> standard deviation</p>
<p><span class="special-character Bullet">•</span> minimum return</p>
<p><span class="special-character Bullet">•</span> maximum return</p>
<p><span class="special-character Bullet">•</span> skewness</p>
<p><span class="special-character Bullet">•</span> kurtosis</p>
<p><span class="special-character Bullet">•</span> historical value at risk</p>
<p><span class="special-character Bullet">•</span> historical conditional value at risk</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_28.gif" alt="" width="580" height="790" /></p>
<p>For example, we compute the descriptive statistics for Walmart Inc. (WMT) using monthly returns over the period October 10, 2010, to June 6, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_29.gif" alt="" width="580" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_12.gif" alt="" width="211" height="279" /></p>
<p>It is also informative to examine the historical performance of an individual stock. In such an analysis, we calculate monthly statistics using daily returns and report them on a monthly basis. We define the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_102.gif" alt="" width="207" height="15" /> function to download historical stock prices, compute desired statistics and return a dataset. The function takes four arguments: stock ticker symbol, start date, end date and a statistical function such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_103.gif" alt="" width="33" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_104.gif" alt="" width="141" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_105.gif" alt="" width="41" height="15" />, and returns a dataset. For the function to work, it requires more than two years of data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_30.gif" alt="" width="580" height="790" /></p>
<p>For example, we compute the monthly cumulative returns for Walmart Inc. (WMT) using daily returns over the period October 1, 2010, to June 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_31.gif" alt="" width="526" height="34" /></p>
<p>Once we compute the statistics, we can take specific columns by specifying their names.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_32.gif" alt="" width="580" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_13.gif" alt="" width="580" height="178" /></p>
<p>We are often interested in knowing whether returns data follows a normal distribution because understanding whether stock returns are normal or not is very important in investment management. One way to check whether returns are normally distributed or not is to compare the empirical quantiles of the data with normal distribution. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_106.gif" alt="" width="99" height="15" /> function can be used to produce quantile-quantile plots. Many other built-in functions can help to assess whether returns are normally distributed.</p>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_107.gif" alt="" width="157" height="15" /> function can be used to test whether data is normally distributed and can also be used to assess the goodness of fit of data to any distribution.</p>
<h4>4.2 Analysis of Multiple Stocks Returns</h4>
<p>As a majority of financial data is multivariate, it is advantageous to perform comparative analysis of multiple security returns. In some cases, one has to compare one series with another. In other cases, many variables might have to be simultaneously measured to capture the complex nature of the relationship among variables. Comparing the complexities of these factors gives the analyst a more detailed account of the relationships between selected returns, thus allowing for a better interpretation of their values and behaviors. In this section, we first compare the performance of one asset with another using graphs, then compute descriptive statistics as well as correlation matrices.</p>
<p>Two most commonly used graphs for comparing historical performance of more than one stock/ETF are time series plots of normalized prices and cumulative returns. The next two functions take four arguments as defined in Section 1 and compute normalized prices and cumulative returns.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_33.gif" alt="" width="580" height="394" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_34.gif" alt="" width="580" height="394" /></p>
<p>We get normalized prices and cumulative returns and plot them for three stocks (Facebook, Inc. (FB), Costco Wholesale Corporation (COST) and Walmart Inc. (WMT)) over the period May 1, 2000, to May 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_35.gif" alt="" width="580" height="106" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_14.gif" alt="" width="414" height="311" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_36.gif" alt="" width="558" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_15.gif" alt="" width="414" height="303" /></p>
<p>Besides graphs, we can also compute descriptive statistics and compare their performance. We define a function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_108.gif" alt="" width="215" height="15" /> for that purpose. It takes four arguments as defined in Section 1 and returns a table with different types of descriptive statistics.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_37.gif" alt="" width="580" height="484" /></p>
<p>For example, we download historical data and compute different descriptive statistics for three stocks (Walmart Inc. (WMT), Apple Inc. (AAPL) and Microsoft Corporation (MSFT) ) using monthly data over the period January 1, 2010, to March 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_38.gif" alt="" width="580" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_16.gif" alt="" width="417" height="281" /></p>
<p>Similarly to how we calculated an individual stock<span class="special-character CloseCurlyQuote">’</span>s monthly statistics in Section 4.1, we define the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_109.gif" alt="" width="182" height="15" /> function to compute monthly statistics for more than one stock given the arguments: stock ticker symbols, start date, end date and a statistical function such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_110.gif" alt="" width="33" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_111.gif" alt="" width="141" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_112.gif" alt="" width="41" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_39.gif" alt="" width="580" height="268" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_40.gif" alt="" width="580" height="106" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_41.gif" alt="" width="580" height="178" /></p>
<p>For example, we compute the monthly cumulative returns for four stocks (Walmart Inc. (WMT), Apple Inc. (AAPL), Microsoft Corporation (MSFT) and Netflix, Inc. (NFLX)) over the period January 1, 2010, to June 30, 2019, and create a dataset. The first column represents year and month, the first four digits for the year and the last two digits for the month.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_42.gif" alt="" width="554" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_17.gif" alt="" width="580" height="178" /></p>
<p>Similarly, box-and-whisker charts, paired histograms, paired smooth histograms and matrix scatterplots are often used to examine multivariate data. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_113.gif" alt="" width="124" height="15" /> function can be used to make a box plot that gives a glimpse of the distribution of the given dataset. You can see the statistical information by hovering over the boxes in the plot. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_114.gif" alt="" width="174" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_115.gif" alt="" width="199" height="15" /> functions are used to create paired histogram and smooth distribution plots. They can be used to compare how two datasets are distributed. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_116.gif" alt="" width="157" height="15" /> function from the Statistical Plots package can be used to make scatter plots of multivariate data. It creates scatter plots comparing the data in each column against other columns. More complex analysis of multivariate data can be done using functions from the Multivariate Statistics package. The package contains functions to compute descriptive statistics for multivariate data and distributions derived from the multivariate normal distribution. All these functions are well explained in the official documentation.</p>
<h3>5. Rolling-Window Performance Analysis</h3>
<p>Rolling-window performance analysis is a simple technique to access variability of the statistical performance measures. For example, if we want to access the stability of mean or standard deviation of returns on a stock over time, we can choose rolling window (the number of consecutive observations per rolling window), estimate the mean or standard deviation and plot series of the estimates. A little fluctuation is normal but large fluctuations indicate a shift in the values of the estimate. Built-in functions such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_117.gif" alt="" width="108" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_118.gif" alt="" width="75" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_119.gif" alt="" width="157" height="15" /> are useful for rolling-window performance analysis. In this section, we are going to show a few examples of how to compute rolling-window-based performance statistics.</p>
<p>We define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_120.gif" alt="" width="224" height="15" /> that can be used to plot rolling-window statistics given its five inputs: stock ticker symbol, start date, end date, size of window in days and function to apply, which can be any built-in or user-defined function.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_43.gif" alt="" width="551" height="179" /></p>
<p>For example, we compute and plot the 90-day rolling mean to standard deviation ratio on Walmart&#8217;s daily stock returns over the period January 1, 2001, to March 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_44.gif" alt="" width="555" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_18.gif" alt="" width="414" height="278" /></p>
<p>Similarly, we define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_121.gif" alt="" width="182" height="15" /> to compute the rolling correlation of two series and apply it together with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_122.gif" alt="" width="75" height="15" /> to the desired data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_45.gif" alt="" width="580" height="179" /></p>
<p>We use the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_123.gif" alt="" width="182" height="15" /> function to plot the 90-day rolling correlation of daily returns on two stocks, WMT and COST, for the period from March 30, 2009, to March 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_46.gif" alt="" width="580" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_19.gif" alt="" width="414" height="298" /></p>
<p>Sometimes, it is also useful to store these time-varying descriptive statistics as a dataset so that we can use them in the subsequent analysis. The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_124.gif" alt="" width="182" height="15" />, given its input, computes the geometric mean, standard deviation and the ratio of the arithmetic mean to the standard deviation on a rolling-window basis.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_47.gif" alt="" width="580" height="286" /></p>
<p>For example, we compute the 90-day rolling-window geometric mean (GM), standard deviation (Std. Dev.) and arithmetic mean to standard deviation ratio (AM/Std. Dev.) of Walmart<span class="special-character CloseCurlyQuote">’</span>s daily stock returns over the period July 1, 2018, to October 30, 2019. You can scroll through the dataset.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_48.gif" alt="" width="513" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_20.gif" alt="" width="580" height="178" /></p>
<h3>6. Portfolio Optimization</h3>
<p>Mean-variance analysis is one of the foundations of financial economics. Portfolio optimization is essential, whether it be in professional or personal financial planning. In this section, we are going to show how to implement the most commonly used optimization techniques in finance using historical returns. We want to point out that future returns on investment depend on expected returns and other conditioning information, not on the past returns. Past returns are used only for illustration and do not guarantee future returns.</p>
<p>Define the following variables:</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_125.gif" alt="" width="10" height="16" /> is the risk-free rate</p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_126.gif" alt="" width="13" height="16" /> is the proportion of wealth invested in security <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_127.gif" alt="" width="4" height="16" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_128.gif" alt="" width="12" height="16" /> is the average return on security <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_129.gif" alt="" width="4" height="16" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_130.gif" alt="" width="15" height="19" /> is the variance of security <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_131.gif" alt="" width="4" height="16" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_132.gif" alt="" width="17" height="18" /> is the covariance between securities <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_133.gif" alt="" width="4" height="16" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_134.gif" alt="" width="6" height="16" /></p>
<p><span class="special-character Bullet">•</span> <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_135.gif" alt="" width="16" height="18" /> is the correlation between securities <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_136.gif" alt="" width="4" height="16" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_137.gif" alt="" width="6" height="16" /></p>
<p>Then we define the vectors of mean returns and weights and the covariance matrix:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_49.gif" alt="" width="297" height="75" /></p>
<p>The formulas for the portfolio mean and variance are <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_138.gif" alt="" width="126" height="18" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_139.gif" alt="" width="195" height="21" />, respectively. The corresponding Mathematica code is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_140.gif" alt="" width="24" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_141.gif" alt="" width="40" height="15" />.</p>
<p>In order to compute portfolio statistics, we need returns data. We can use the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_142.gif" alt="" width="116" height="15" /> function to download historical returns data. It takes four arguments as defined in Section 1 and gives a matrix of returns. Most functions in this section use the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_143.gif" alt="" width="116" height="15" /> function, so run it before you run other functions.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_50.gif" alt="" width="580" height="142" /></p>
<p>To compute basic portfolio statistics such as portfolio mean, variance, standard deviation and Sharpe ratio, we can use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_144.gif" alt="" width="157" height="15" />, which takes six arguments. The first four arguments are as defined in Section 1 and the other two are a list of weights and the optional risk-free rate.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_51.gif" alt="" width="580" height="377" /></p>
<p>For example, we compute the portfolio mean, variance, standard deviation and Sharpe ratio for the portfolio that consists of the stock returns of five companies: Apple (AAPL), Walmart (WMT), Boeing (BA), 3M and Exxon Mobil (XOM), using monthly returns over the period January 1, 2009, to May 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_52.gif" alt="" width="550" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_21.gif" alt="" width="323" height="57" /></p>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_145.gif" alt="" width="99" height="15" /> function plots the Markowitz portfolio frontier; it takes a matrix of returns obtained from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_146.gif" alt="" width="116" height="15" /> as its only argument. The function uses the concept that any two efficient portfolios are enough to establish the whole portfolio frontier, as first proved by Black [<a href="#Black">5</a>]. It accepts any <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_147.gif" alt="" width="66" height="15" /> option.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_53.gif" alt="" width="580" height="346" /></p>
<p>For example, we plot the portfolio frontier for the portfolio that consists of stock returns of five companies: Apple (AAPL), Walmart (WMT), Boeing (BA), 3M and Exxon Mobil (XOM), using monthly returns over the period January 1, 2009, to May 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_54.gif" alt="" width="580" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_22.gif" alt="" width="443" height="296" /></p>
<p>Next, we solve two kinds of portfolio problems: global minimum variance portfolio and tangency portfolio. In terms of the notation defined earlier in this section, the global minimum variance portfolio can be obtained by minimizing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_148.gif" alt="" width="16" height="21" /> subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_149.gif" alt="" width="62" height="17" /> and solving for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_150.gif" alt="" width="13" height="16" />. Its solution can be obtained with the built-in Mathematica function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_151.gif" alt="" width="75" height="15" />.</p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_152.gif" alt="" width="323" height="15" /> computes weights, returning the portfolio allocation on stocks considered for a global minimum variance portfolio.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_55.gif" alt="" width="580" height="233" /></p>
<p>We compute the global minimum variance portfolio weights using the monthly stock returns of five companies: Apple (AAPL), Walmart (WMT), Boeing (BA), 3M and Exxon Mobil (XOM), over the period January 1, 2009, to May 30, 2019.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_56.gif" alt="" width="580" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_23.gif" alt="" width="407" height="15" /></p>
<p>Similarly, the tangency portfolio can be obtained by maximizing <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_153.gif" alt="" width="74" height="21" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_154.gif" alt="" width="10" height="16" /> is the risk-free rate (a constant in this case), subject to <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_155.gif" alt="" width="62" height="17" /> and solving for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_156.gif" alt="" width="13" height="16" />. The solution uses the built-in Mathematica function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_157.gif" alt="" width="75" height="15" />. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_158.gif" alt="" width="199" height="15" /> function computes the tangency portfolio weights given its five inputs, four as defined in the Section 1 and the risk-free rate.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_57.gif" alt="" width="580" height="232" /></p>
<p>Assuming a monthly risk-free rate of 0.1667 percent and using monthly data over the period January 1, 2009, to May 30, 2019, we calculate the tangency portfolio weights for our portfolio of five stocks: (Apple (AAPL), Walmart (WMT), Boeing (BA), 3M and Exxon Mobil (XOM)).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_58.gif" alt="" width="580" height="34" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_24.gif" alt="" width="408" height="15" /></p>
<p>Portfolio optimization using the Wolfram Language is very flexible. We can formulate any kind of portfolio and use built-in functions such as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_159.gif" alt="" width="75" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_160.gif" alt="" width="75" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_161.gif" alt="" width="174" height="15" /> to get numerical solutions to the portfolio problem.</p>
<h3>7. Portfolio Risk Decomposition</h3>
<p>In this section, we concentrate on how to decompose a measure of portfolio risk (portfolio standard deviation) into risk contribution from individual assets included in the portfolio. It helps to see how individual assets influence portfolio risk. When risk is measured by standard deviation, we can use Euler<span class="special-character CloseCurlyQuote">’</span>s theorem for decomposing risk into asset-specific risk contribution. Euler<span class="special-character CloseCurlyQuote">’</span>s theorem provides an additive decomposition of a homogeneous function. For reference, see Campolieti and Makarov [<a href="#Campolieti-Makarov">6</a>]. Using Euler<span class="special-character CloseCurlyQuote">’</span>s theorem, we can define the percentage contribution to portfolio standard deviation of an asset as <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_162.gif" alt="" width="70" height="21" />, where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_163.gif" alt="" width="17" height="16" /> is the marginal contribution of the asset, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_164.gif" alt="" width="14" height="16" /> is the weight of the asset, and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_165.gif" alt="" width="16" height="18" /> is the portfolio standard deviation.</p>
<p>We define the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_166.gif" alt="" width="141" height="15" /> for portfolio risk decomposition. It takes five arguments, four arguments as defined in Section 1 and a list of portfolio weights; it returns a bar chart representing the individual asset&#8217;s risk contribution to the portfolio standard deviation.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_59.gif" alt="" width="580" height="250" /></p>
<p>We calculate the risk contribution of each asset in a portfolio that consists of five stocks using the historical monthly returns over the period January 30, 2010, to May 30, 2019 and make a bar chart.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_60.gif" alt="" width="552" height="52" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_25.gif" alt="" width="440" height="281" /></p>
<h3>8. Factor Models</h3>
<p>Currently, factor models are widely accepted and used in finance to construct portfolios, to evaluate portfolio performance and for risk analysis. Factor models are regression models. We can use the built-in function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_167.gif" alt="" width="116" height="15" /> to estimate and evaluate the appropriateness of the regression models. In addition, we can download all factor data directly from Prof. Kenneth French<span class="special-character CloseCurlyQuote">’</span>s data library. Before we apply factor models to real-world data, we need data in the form</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_61.gif" alt="" width="33" height="16" /></p>
<p>where</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_62.gif" alt="" width="136" height="79" /></p>
<p>is a matrix of values of independent variables and</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_63.gif" alt="" width="55" height="75" /></p>
<p>is a vector of values of a dependent variable.</p>
<p>Commonly used factor models are summarized in Table 1. We can find more about the factor models in Fama and French [<a href="#Fama-French">7</a>]. We use the following notation: <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_168.gif" alt="" width="30" height="16" /> for excess return on the security or portfolio, MKT for excess return on the value-weighted market portfolio, SML for return on a diversified portfolio of small-capitalization stocks minus the return on a diversified portfolio of large-capitalization stocks, HML for difference in the returns on diversified portfolios of high-book-to-market stocks and low-book-to-market stocks, MOM for difference in returns on diversified portfolios of the prior year<span class="special-character CloseCurlyQuote">’</span>s winners and losers, RMW for difference between the returns on diversified portfolios of stocks with robust and weak profitability, CMA for difference between the returns on diversified portfolios of the stocks of low and high investment firms, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_169.gif" alt="" width="8" height="16" /> for risk-adjusted return on security or portfolio and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_170.gif" alt="" width="32" height="16" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_171.gif" alt="" width="31" height="16" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_172.gif" alt="" width="32" height="16" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_173.gif" alt="" width="35" height="16" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_174.gif" alt="" width="35" height="16" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_175.gif" alt="" width="33" height="17" /> for betas or factor loadings.</p>
<div id="1546589653" class="Table"><a name="1546589653"></a><br />
<img style="vertical-align: middle;" title="InterpretationBox[Description, TextCell[Enter column head here, Italic, Editable -&gt; True]] InterpretationBox[Models for r-rf, TextCell[Enter column head here, Italic, Editable -&gt; True]]; InterpretationBox[Capital asset pricing model (CAPM), TextCell[Enter data here, Editable -&gt; True]] CAPM=alpha+beta_(MKT)MKT; InterpretationBox[Fama-French three-factor model, TextCell[Enter data here, Editable -&gt; True]] InterpretationBox[{{FF, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[3]}, =, {CAPM, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[SMB]}, SMB}, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[HML]}, HML}}}, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Carhart four-factor model, TextCell[Enter data here, Editable -&gt; True]] InterpretationBox[{{C, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[4]}, =, {{FF, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[3]}, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[RMW]}, RMW}}}, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Fama-French five-factor model, TextCell[Enter data here, Editable -&gt; True]] InterpretationBox[{{FF, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[5]}, =, {{C, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[4]}, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[CMA]}, CMA}}}, TextCell[Enter data here, Editable -&gt; True]]" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_1.gif" alt="InterpretationBox[Description, TextCell[Enter column head here, Italic, Editable -&gt; True]] InterpretationBox[Models for r-rf, TextCell[Enter column head here, Italic, Editable -&gt; True]]; InterpretationBox[Capital asset pricing model (CAPM), TextCell[Enter data here, Editable -&gt; True]] CAPM=alpha+beta_(MKT)MKT; InterpretationBox[Fama-French three-factor model, TextCell[Enter data here, Editable -&gt; True]] InterpretationBox[{{FF, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[3]}, =, {CAPM, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[SMB]}, SMB}, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[HML]}, HML}}}, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Carhart four-factor model, TextCell[Enter data here, Editable -&gt; True]] InterpretationBox[{{C, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[4]}, =, {{FF, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[3]}, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[RMW]}, RMW}}}, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Fama-French five-factor model, TextCell[Enter data here, Editable -&gt; True]] InterpretationBox[{{FF, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[5]}, =, {{C, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[4]}, +, {{beta, _, DocumentationBuild&#96;Utils&#96;Private&#96;Parenth[CMA]}, CMA}}}, TextCell[Enter data here, Editable -&gt; True]]" width="577" height="120" /></div>
<div id="1534119701" class="NumberedTableCaption"><a name="1534119701"></a><strong>Table 1.</strong> Overview of factor models.</div>
<p>Before we estimate these models using real data, we need factors data. We download five factors and the momentum factor data from Kenneth French<span class="special-character CloseCurlyQuote">’</span>s website (<a href="http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html" target="_blank">http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a>) and define variables to store them.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_64.gif" alt="" width="580" height="90" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_65.gif" alt="" width="580" height="90" /></p>
<p>The function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_176.gif" alt="" width="91" height="15" /> takes only two arguments, the start date and end date, and returns time series of all factors data. The start date and end date must be specified as date objects.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_66.gif" alt="" width="580" height="556" /></p>
<p>Similarly, the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_177.gif" alt="" width="157" height="15" /> function can be used to get a stock<span class="special-character CloseCurlyQuote">’</span>s monthly returns data. It takes three arguments, a ticker symbol of any publicly traded company, and the start and end dates for the analysis period.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_67.gif" alt="" width="569" height="142" /></p>
<p>Using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_178.gif" alt="" width="91" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_179.gif" alt="" width="157" height="15" />, we define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_180.gif" alt="" width="157" height="15" /> to combine factors and returns data. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_181.gif" alt="" width="157" height="15" /> takes four arguments (the symbol of the stock for which we want to estimate the factor model, the start date, the end date and an integer that represents the number of factors) and returns a data matrix suitable for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_182.gif" alt="" width="116" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_68.gif" alt="" width="580" height="323" /></p>
<p>Next, we estimate different factor models for Apple<span class="special-character CloseCurlyQuote">’</span>s stock using monthly data from October 1, 2008, to March 30, 2019. We estimate the capital asset pricing model (CAPM) with market factor (MKT).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_69.gif" alt="" width="580" height="52" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_26.gif" alt="" width="345" height="57" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_70.gif" alt="" width="580" height="52" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_27.gif" alt="" width="166" height="99" /></p>
<p>We estimate the Fama<span class="special-character Dash">–</span>French three-factor model with market, size and value factors (MKT, SMB, HML).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_71.gif" alt="" width="580" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_28.gif" alt="" width="361" height="93" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_72.gif" alt="" width="565" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_29.gif" alt="" width="166" height="99" /></p>
<p>Similarly, we estimate the Carhart four-factor model with market, size, value and momentum factors (MKT, SMB, HML, MOM).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_73.gif" alt="" width="580" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_30.gif" alt="" width="365" height="111" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_74.gif" alt="" width="565" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_31.gif" alt="" width="166" height="99" /></p>
<p>Finally, the Fama<span class="special-character Dash">–</span>French five-factor model with market, size, value, profitability and investment factors (MKT, SMB, HML, RMW, CMA) is estimated as follows.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_75.gif" alt="" width="580" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_32.gif" alt="" width="356" height="129" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_76.gif" alt="" width="565" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_33.gif" alt="" width="166" height="99" /></p>
<p>Once the model is estimated, we must access different properties related to data and fitted models. To assess how well the model fits the data and how well the model meets the assumptions, there are many built-in functions.To learn more about obtaining diagnostic information, see the properties of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_183.gif" alt="" width="116" height="15" />.</p>
<h3>9. Stock Portfolio Performance Measures</h3>
<p>There are various measures to evaluate the performance and risk of portfolios. Most of these measures are used to evaluate a portfolio of interest against a chosen benchmark, by taking a snapshot of the past or considering the entire historical picture. We will compute some common metrics often employed by investors while analyzing performance measures. All the computations are based on the formulas developed in Bacon [<a href="#Bacon">8</a>]. Most common measures are summarized in the function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_184.gif" alt="" width="265" height="15" />. The function takes four arguments:</p>
<p><span class="special-character Bullet">•</span> ticker symbols for the test assets and the benchmark asset</p>
<p><span class="special-character Bullet">•</span> periodic risk-free rate</p>
<p><span class="special-character Bullet">•</span> time period</p>
<p><span class="special-character Bullet">•</span> frequency of data</p>
<p>We repeat the definition of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_185.gif" alt="" width="116" height="15" /> function defined earlier to make this section self-contained.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_77.gif" alt="" width="580" height="142" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_78.gif" alt="" width="580" height="1583" /></p>
<p>The next example uses stocks, although these measures are used to evaluate the performance of portfolios, mutual funds and exchange-traded funds. We evaluate the performance of (Walmart Inc. (WMT), Apple Inc. (AAPL) and Microsoft Corporation (MSFT) ) against the S&amp;P 500 index (^SPX) using 0.0016 as a monthly risk-free rate and month as the data frequency over the period January 1, 1995, to March 30, 2019.</p>
<div class="Code">
<pre>computePortfolioPerformanceTable[{"WMT","AAPL","MSFT"},"^SPX",0.0016,
{1995,01,01},{2019,03,30},"Month"]//Text</pre>
</div>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_34.gif" alt="" width="445" height="399" /></p>
<h3>10. Interactive Graphics and Technical Analysis of Stock Prices</h3>
<p>Short-term traders commonly use interactive graphics and technical indicators of stock prices to profit from stocks that may be overbought or oversold. Much is based on market sentiment, but also market timing. When a stock is oversold, the price is low and people want to buy. In comparison, when a stock is overbought, the price is between its normal range and higher, and people do not want to buy, or may want to short sell. Many technical indicators are used to determine a given stock<span class="special-character CloseCurlyQuote">’</span>s peak or bottom price and how to take advantage of that information. Three of the most useful functions for technical analysis of stocks are <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_186.gif" alt="" width="99" height="15" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_187.gif" alt="" width="190" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_188.gif" alt="" width="133" height="15" />. The documentation provides a comprehensive set of examples on how to use them.</p>
<p>We show one example of how to use the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_189.gif" alt="" width="99" height="15" /> function and one example of how to use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_190.gif" alt="" width="190" height="15" />.</p>
<p>You can choose the chart type and from over 100 technical indicators, which are divided into eight groups:</p>
<p><span class="special-character Bullet">•</span> basic</p>
<p><span class="special-character Bullet">•</span> moving average</p>
<p><span class="special-character Bullet">•</span> market strength</p>
<p><span class="special-character Bullet">•</span> momentum</p>
<p><span class="special-character Bullet">•</span> trend</p>
<p><span class="special-character Bullet">•</span> volatility</p>
<p><span class="special-character Bullet">•</span> band</p>
<p><span class="special-character Bullet">•</span> statistical</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_191.gif" alt="" width="190" height="15" /> displays all the available technical indicators.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_79.gif" alt="" width="190" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_35.gif" alt="" width="580" height="502" /></p>
<p>Here is the basic format:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_192.gif" alt="" width="597" height="15" /></p>
<p>Alternatively, use:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_193.gif" alt="" width="466" height="15" /></p>
<p>The time series data must be of the form:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_194.gif" alt="" width="374" height="88" /></p>
<p>The historical open, high, low, close and volume data retrieved from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_195.gif" alt="" width="108" height="15" /> can also be used as data input. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_196.gif" alt="" width="99" height="15" /> function has many options that can be used to enhance graphics. We produce a chart using historical prices of Apple&#8217;s stock and volume over the period January 1, 2018, to March 30, 2019.</p>
<p>The top of the chart shows a plot of historical prices and 50-day and 200-day moving averages. The second part shows the historical volume. The last two parts show plots of two indicators, the commodity channel index (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_197.gif" alt="" width="174" height="15" />) and the relative strength index (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_198.gif" alt="" width="174" height="15" />).</p>
<p>A good introduction to technical indicators can be found in standard references, including at Fidelity Learning Center [<a href="#Fidelity">9</a>].</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_80.gif" alt="" width="580" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_36.gif" alt="" width="414" height="417" /></p>
<p>The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_199.gif" alt="" width="190" height="15" /> function provides a point-and-click interactive chart, with a similar setup:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_200.gif" alt="" width="635" height="142" /></p>
<p>Alternatively, use:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_201.gif" alt="" width="566" height="15" /></p>
<p>For example, we make a chart showing prices, volume and indicators for historical data of Apple&#8217;s stock over the period January 1, 2018, to March 30, 2019. The <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_202.gif" alt="" width="190" height="15" /> function provides a user-friendly environment where you can drag a slider to view different parts of the chart or you can choose different indicators with point-and-click.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_81.gif" alt="" width="580" height="70" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_37.gif" alt="" width="527" height="700" /></p>
<h3>11. Essentials of Bond Mathematics</h3>
<p>A bond is a long-term debt instrument in which a borrower agrees to make payments of principal and interest, on specific dates, to the holders of the bond. When it comes to analysis and pricing of bonds and computing returns, convexity and duration are important concepts. When a bond is traded between coupon payment dates, its price has two parts: the quoted price and the accrued interest. The quoted price is net of accrued interest, and does not include accrued interest. Accrued interest is the proportion or share of the next coupon payment. The full price is the price of a bond including any interest that has accrued since issue of the most recent coupon payment. Similarly, yield to maturity is the rate of return earned on a bond if it is held to maturity. Duration is a measure of the average length of time for which money is invested in a coupon bond. Convexity estimates the change in the bond price given a change in the yield to maturity, assuming a nonlinear relationship between the two. The built-in functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_203.gif" alt="" width="108" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_204.gif" alt="" width="66" height="15" /> can be used to compute various properties including value of the bond, accrued interest, yield, duration, modified duration, convexity, and so on. This section provides a few examples of how to use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_205.gif" alt="" width="108" height="15" /> and how the concepts of bond convexity and duration can be used in bond portfolio management.</p>
<p>We discuss zero-coupon bonds first. The zero-coupon bond does not make coupon payments. The only cash payment is the face value of the bond on the maturity date. The yield to maturity (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_206.gif" alt="" width="21" height="16" />) for a zero-coupon bond with <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_207.gif" alt="" width="7" height="16" /> periods to maturity, current price <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_208.gif" alt="" width="8" height="16" /> and face value <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_209.gif" alt="" width="18" height="16" /> can be obtained by solving <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_210.gif" alt="" width="106" height="16" />.</p>
<p>For example, we compute the yield to maturity of a zero-coupon bond with a $10,000 face value, time to maturity 4 years and current price $9,662 using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_211.gif" alt="" width="50" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_212.gif" alt="" width="66" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_82.gif" alt="" width="357" height="40" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_38.gif" alt="" width="158" height="15" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_83.gif" alt="" width="580" height="124" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_39.gif" alt="" width="142" height="15" /></p>
<p>Similarly, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_213.gif" alt="" width="66" height="15" /> can also be used to compute the yield to maturity of a nonzero coupon payment bond.</p>
<p>For example, we compute the yield to maturity of a $1,000 par value 10-year bond with 5% semiannual coupons issued on June 20, 2013, with maturity date of June 20, 2023, selling for $920 on September 15, 2018.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_84.gif" alt="" width="528" height="222" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_40.gif" alt="" width="117" height="15" /></p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_214.gif" alt="" width="108" height="15" /> can also be used to compute the price, duration, modified duration and convexity of a bond. For example, we compute those values for a bond with 8% yield, 8% annual coupons, 10-year maturity and $1,000 face value.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_85.gif" alt="" width="580" height="88" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_41.gif" alt="" width="270" height="15" /></p>
<p>There are different approaches to bond portfolio management. We concentrate here on a liability-driven portfolio strategy, in which the characteristics of the bonds that are held in the portfolio are coordinated with those of the liabilities the investor is obligated to pay. The matching techniques can range from an attempt to exactly match the levels and timing of the required cash payments to more general approaches that focus on other investment characteristics, such as setting the average duration or convexity of the bond portfolio equal to that of the underlying liabilities. One specific example would be to construct the portfolio so that the duration of the bond portfolio is equal to the duration of cash obligation and the total money invested in the bond portfolio today is equal to the present value of the future cash obligations.</p>
<p>To illustrate the concept of bond portfolio management, assume that we have an obligation to pay $1,000,000 in 10 years and there are two bonds available for investment. The first bond matures in 30 years with $100 face value and annual coupon payment of 6%. The second bond matures in 10 years with $100 face value and annual coupon payment of 5%. The yield to maturity is 9% on both bonds. We can decide on how much to invest in each bond so that the overall portfolio is immunized against changes in the interest rate.</p>
<p>We compute the duration of each bond using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_215.gif" alt="" width="108" height="15" />, which gives that the duration of bond 1 is 11.88 and that of bond 2 is 6.75. Assuming that the proportion of money invested in bonds 1 and 2 is <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_216.gif" alt="" width="15" height="16" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_217.gif" alt="" width="15" height="16" />, the immunized portfolio is found by solving the simultaneous equations:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_86.gif" alt="" width="146" height="37" /></p>
<p>These two equations can be solved using <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_218.gif" alt="" width="41" height="15" />.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_87.gif" alt="" width="391" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_42.gif" alt="" width="243" height="15" /></p>
<p>The result shows how much money should be allocated to each bond. More examples can be found in Benninga [<a href="#Benninga">10</a>]. A more general approach to bond portfolio management can be solved by using linear programming. It is beyond the scope of this article to introduce linear programming.</p>
<h3>12. Binomial and Black<span class="special-character Dash">–</span>Scholes<span class="special-character Dash">–</span>Morton Stock Option Pricing Models</h3>
<p>The most popular options pricing models are the binomial model and the Black<span class="special-character Dash">–</span>Scholes<span class="special-character Dash">–</span>Morton option pricing formulas for European options. In the next two subsections, we discuss these models and their implementation.</p>
<h4>12.1 Binomial Option Pricing Model</h4>
<div id="299878867" class="Quote"><a name="299878867"></a>Following the notation from Hull [<a href="#Hull">11</a>], define:</div>
<div id="1687046500" class="Quote"><a name="1687046500"></a><img style="vertical-align: middle;" title="S_0" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_2.gif" alt="S_0" width="13" height="16" />: the current stock price</div>
<div id="471348486" class="Quote"><a name="471348486"></a><img style="vertical-align: middle;" title="K" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_4.gif" alt="K" width="10" height="16" />: the strike price</div>
<div id="1353282150" class="Quote"><a name="1353282150"></a><img style="vertical-align: middle;" title="rf" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_6.gif" alt="rf" width="10" height="16" />: the annual risk-free rate</div>
<div id="2086360432" class="Quote"><a name="2086360432"></a><img style="vertical-align: middle;" title="sigma" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_8.gif" alt="sigma" width="9" height="16" />: the annual standard deviation of the stock returns</div>
<div id="937008774" class="Quote"><a name="937008774"></a><img style="vertical-align: middle;" title="T" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_10.gif" alt="T" width="9" height="16" />: the time to expiration of the option in years</div>
<div id="1240908550" class="Quote"><a name="1240908550"></a><img style="vertical-align: middle;" title="n" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_12.gif" alt="n" width="7" height="16" />: the total number of up and down moves</div>
<div id="1583385862" class="Quote"><a name="1583385862"></a><img style="vertical-align: middle;" title="j" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_14.gif" alt="j" width="6" height="16" />: the number of upward moves.</div>
<div id="691206369" class="Quote"><a name="691206369"></a>Then <img style="vertical-align: middle;" title="n-j" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_16.gif" alt="n-j" width="28" height="16" /> is the number of down moves on the tree.</div>
<p>In terms of these variables, we can define:</p>
<p><span class="special-character Bullet">•</span> time per period <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_219.gif" alt="" width="53" height="16" /></p>
<p><span class="special-character Bullet">•</span> up factor <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_220.gif" alt="" width="61" height="22" /></p>
<p><span class="special-character Bullet">•</span> down factor <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_221.gif" alt="" width="68" height="22" /></p>
<p><span class="special-character Bullet">•</span> probability of an up move <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_222.gif" alt="" width="79" height="33" /></p>
<p><span class="special-character Bullet">•</span> probability of a down move <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_223.gif" alt="" width="52" height="16" /></p>
<p><span class="special-character Bullet">•</span> stock price <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_224.gif" alt="" width="54" height="18" /> at node <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_225.gif" alt="" width="7" height="16" /></p>
<p><span class="special-character Bullet">•</span> payoff from a European call <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_226.gif" alt="" width="128" height="21" /></p>
<p><span class="special-character Bullet">•</span> payoff from a European put <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_227.gif" alt="" width="128" height="21" /></p>
<p>In the risk-neutral world, the price of the call and put using the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_228.gif" alt="" width="7" height="16" />-period binomial options pricing model can be computed as:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_88.gif" alt="" width="306" height="35" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_DisplayFormula_89.gif" alt="" width="304" height="35" /></p>
<p>The functions <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_229.gif" alt="" width="141" height="15" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_230.gif" alt="" width="133" height="15" /> calculate the prices of European call and put options; they output the option price. Each function takes six arguments as defined at the beginning of this subsection.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_90.gif" alt="" width="558" height="254" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_91.gif" alt="" width="562" height="254" /></p>
<p>We use these functions to find the prices of call and put options when the current stock price is $50, the strike price is $45, the annual volatility is 40%, the risk-free rate is 10%, the time to maturity is half a year and the total number of up and down moves is 500.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_92.gif" alt="" width="356" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_43.gif" alt="" width="58" height="15" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_93.gif" alt="" width="348" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_44.gif" alt="" width="58" height="15" /></p>
<h4>12.2 Black<span class="special-character Dash">–</span>Scholes<span class="special-character Dash">–</span>Morton Options Pricing Model</h4>
<div id="113410473" class="Quote"><a name="113410473"></a>Similar to the binomial option pricing formula defined in the last section, we follow Hull [<a href="#Hull">11</a>] to explain the Black<span class="special-character Dash">–</span>Scholes<span class="special-character Dash">–</span>Morton option pricing formulas. Define the variables:</div>
<div id="1602071827" class="Quote"><a name="1602071827"></a><img style="vertical-align: middle;" title="c_0" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_18.gif" alt="c_0" width="12" height="16" />: the current call option value</div>
<div id="1565596608" class="Quote"><a name="1565596608"></a><img style="vertical-align: middle;" title="p_0" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_20.gif" alt="p_0" width="14" height="16" />: the current put option value</div>
<div id="2114058766" class="Quote"><a name="2114058766"></a><img style="vertical-align: middle;" title="S_0" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_22.gif" alt="S_0" width="13" height="16" />: the current stock price</div>
<div id="2134100585" class="Quote"><a name="2134100585"></a><img style="vertical-align: middle;" title="K" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_24.gif" alt="K" width="10" height="16" />: the exercise price</div>
<div id="527056553" class="Quote"><a name="527056553"></a><img style="vertical-align: middle;" title="T" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_26.gif" alt="T" width="9" height="16" />: the time in years until the option expires</div>
<div id="1999935908" class="Quote"><a name="1999935908"></a><img style="vertical-align: middle;" title="rf" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_28.gif" alt="rf" width="10" height="16" />: the annual risk-free interest rate</div>
<div id="903238236" class="Quote"><a name="903238236"></a><img style="vertical-align: middle;" title="sigma" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_30.gif" alt="sigma" width="9" height="16" />: the annual standard deviation of the rate of return of the underlying stock</div>
<div id="896966445" class="Quote"><a name="896966445"></a><img style="vertical-align: middle;" title="delta" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_32.gif" alt="delta" width="6" height="16" />: the annual dividend yield of the underlying stock</div>
<div id="138993203" class="Quote"><a name="138993203"></a>Furthermore, assume that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_231.gif" alt="" width="70" height="45" /> is the standard normal density function (where <img style="vertical-align: middle;" title="e approx 2.71828..." src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_34.gif" alt="e approx 2.71828..." width="83" height="16" /> the base of the natural logarithms) and let <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_37.gif" alt="" width="102" height="22" /> be the standard normal cumulative distribution function, so that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_232.gif" alt="" width="28" height="16" /> denotes the probability that a random variable drawn from a standard normal distribution is less than <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_233.gif" alt="" width="7" height="16" />. Then the call and put values can be computed as</div>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_234.gif" alt="" width="197" height="18" />,</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_235.gif" alt="" width="253" height="18" />,</p>
<p>where</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_236.gif" alt="" width="165" height="29" />,</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_237.gif" alt="" width="93" height="21" />.</p>
<p>Table 2 summarizes the price sensitivity measures of call and put options (denoted by Greek symbols) with respect to their major price determinants; here <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_238.gif" alt="" width="9" height="16" /> stands for value of the option.</p>
<div id="1782071188" class="Table"><a name="1782071188"></a><br />
<img style="vertical-align: middle;" title="InterpretationBox[Greeks, TextCell[Enter data here, Editable -&gt; True]] Evaluation InterpretationBox[Interpretation, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[estimated change in value relative to change in:, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Delta (Delta), TextCell[Enter data here, Editable -&gt; True]] (partialV)/(partialS) InterpretationBox[the underlying asset price, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Vega (upsilon), TextCell[Enter data here, Editable -&gt; True]] (partialV)/(partialsigma) InterpretationBox[the underlying asset volatility, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Rho (rho), TextCell[Enter data here, Editable -&gt; True]] (partialV)/(partialr) InterpretationBox[the risk-free interest rate, TextCell[Enter data here, Editable -&gt; True]]; Theta (theta) (partialV)/(partialT) the time to expiration (for a negative change); Gamma (Gamma) (partial^2V)/(partialS^2) estimated change in delta relative to a change in the underlying asset price" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Image_38.gif" alt="InterpretationBox[Greeks, TextCell[Enter data here, Editable -&gt; True]] Evaluation InterpretationBox[Interpretation, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[estimated change in value relative to change in:, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Delta (Delta), TextCell[Enter data here, Editable -&gt; True]] (partialV)/(partialS) InterpretationBox[the underlying asset price, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Vega (upsilon), TextCell[Enter data here, Editable -&gt; True]] (partialV)/(partialsigma) InterpretationBox[the underlying asset volatility, TextCell[Enter data here, Editable -&gt; True]]; InterpretationBox[Rho (rho), TextCell[Enter data here, Editable -&gt; True]] (partialV)/(partialr) InterpretationBox[the risk-free interest rate, TextCell[Enter data here, Editable -&gt; True]]; Theta (theta) (partialV)/(partialT) the time to expiration (for a negative change); Gamma (Gamma) (partial^2V)/(partialS^2) estimated change in delta relative to a change in the underlying asset price" width="635" height="225" /></div>
<div id="44603118" class="NumberedTableCaption"><a name="44603118"></a><strong>Table 2.</strong> Greeks as measures of sensitivity.</div>
<p>The built-in Mathematica function <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_239.gif" alt="" width="157" height="15" /> computes the values and other price sensitivity measures for common types of derivative contracts. The function can compute the value of an option, any of delta, gamma, theta and vega, as well as the implied volatility of the contract. The Mathematica documentation provides many examples of how to use <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_240.gif" alt="" width="157" height="15" />. Here are the first 10 of a list of 101 available contracts.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_94.gif" alt="" width="327" height="15" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_45.gif" alt="" width="265" height="186" /></p>
<p>For example, we compute the price and Greeks of the European-style put option with strike price $50, expiration date 0.3846 years, interest rate 5%, annual volatility 20%, no annual dividend and current price $49.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_95.gif" alt="" width="580" height="52" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_46.gif" alt="" width="580" height="34" /></p>
<p>Similarly, we compute the implied volatility of an American-style call option with the same values of the parameters.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_96.gif" alt="" width="580" height="52" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_47.gif" alt="" width="50" height="15" /></p>
<p>One interesting application of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_241.gif" alt="" width="157" height="15" /> is to get real-world data and compute related measures related to options. We define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_242.gif" alt="" width="190" height="15" /> that computes the theoretical value of options and their Greeks, which takes five arguments:</p>
<p><span class="special-character Bullet">•</span> ticker symbol (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_243.gif" alt="" width="50" height="15" />)</p>
<p><span class="special-character Bullet">•</span> strike price (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_244.gif" alt="" width="8" height="15" />)</p>
<p><span class="special-character Bullet">•</span> expiration date (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_245.gif" alt="" width="116" height="15" />)</p>
<p><span class="special-character Bullet">•</span> risk-free rate (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_246.gif" alt="" width="17" height="15" />)</p>
<p><span class="special-character Bullet">•</span> either <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_247.gif" alt="" width="82" height="15" /> or <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_248.gif" alt="" width="82" height="15" /> (<img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_249.gif" alt="" width="33" height="15" />)</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_97.gif" alt="" width="580" height="538" /></p>
<p>We compute the European-style option parameters for Boeing (BA), assuming that the option expires on December 28, 2020, with exercise price $145 and risk-free rate 0.0187. Make sure that the expiration date is later than the current date, since <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_250.gif" alt="" width="190" height="15" /> uses historical data.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Input_98.gif" alt="" width="580" height="52" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Output_48.gif" alt="" width="211" height="155" /></p>
<p>We strongly encourage you to explore the built-in or online documentation for the powerful <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/08/Adhikari-1_Math_251.gif" alt="" width="157" height="15" /> function.</p>
<h3>13. Conclusion</h3>
<p>The article provides a brief overview of built-in functions and introduces many functions especially designed for analysis of financial data. In particular, we have focused on functions that are more relevant to introductory computational financial concepts. We emphasize importing company fundamental data and its visualization, analysis of individual stocks and portfolio returns, factor models and the use of built-in functions for bond and financial derivative analysis. The functions we have provided are just a few examples. The Wolfram Language can do much more than what we have shown in this article. Interested readers can start exploring the Wolfram Language via Mathematica<span class="special-character CloseCurlyQuote">’</span>s extensive documentation.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="Varian1"></a>[1]</td>
<td>H. R. Varian, ed., <em>Economic and Financial Modeling with Mathematica</em>, New York: Springer-Verlag, 1993.</td>
</tr>
<tr>
<td class="Reference"><a name="Varian2"></a>[2]</td>
<td>H. R. Varian, ed., <em>Computational Economics and Finance Modeling and Analysis with Mathematica</em>, New York: Springer-Verlag, 1996.</td>
</tr>
<tr>
<td class="Reference"><a name="Shaw"></a>[3]</td>
<td>W. Shaw, <em>Modelling Financial Derivatives with Mathematica</em>, Cambridge, UK: Cambridge University Press, 1998.</td>
</tr>
<tr>
<td class="Reference"><a name="Stojanovic"></a>[4]</td>
<td>S. Stojanovic, <em>Computational Financial Mathematics using MATHEMATICA Optimal Trading in Stocks and Options</em>, Boston: Birkh<span class="special-character ADoubleDot">ä</span>user, 2003.</td>
</tr>
<tr>
<td class="Reference"><a name="Black"></a>[5]</td>
<td>F. Black, <span class="special-character OpenCurlyDoubleQuote">“</span>Capital Market Equilibrium with Restricted Borrowing,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Journal of Business</em>, <strong>4</strong>(3), 1972 pp. 444<span class="special-character Dash">–</span>455. <a href="https://www.jstor.org/stable/2351499" target="_blank">www.jstor.org/stable/2351499</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Campolieti-Makarov"></a>[6]</td>
<td>G. Campolieti and R. Makarov, <em>Financial Mathematics: A Comprehensive Treatment</em>, London: Chapman and Hall/CRC Press, 2014.</td>
</tr>
<tr>
<td class="Reference"><a name="Fama-French"></a>[7]</td>
<td>E. F. Fama and K. R. French, <span class="special-character OpenCurlyDoubleQuote">“</span>A Five-Factor Asset Pricing Model,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Journal of Financial Economics</em>, <strong>116</strong>(1), 2015 pp.1<span class="special-character Dash">–</span>22. <a href="https://doi.org/10.1016/j.jfineco.2014.10.010" target="_blank">doi:10.1016/j.jfineco.2014.10.010</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Bacon"></a>[8]</td>
<td>C. R. Bacon, <em>Practical Risk-Adjusted Performance Measurement</em>, 2nd ed., Hoboken: Wiley, 2013.</td>
</tr>
<tr>
<td class="Reference"><a name="Fidelity"></a>[9]</td>
<td>Fidelity Learning Center. <span class="special-character OpenCurlyDoubleQuote">“</span>Technical Indicator Guide.<span class="special-character CloseCurlyDoubleQuote">”</span> (Jul 29, 2020) <a href="https://www.fidelity.com/learning-center/trading-investing/technical-analysis/technical-indicator-guide/overview" target="_blank">www.fidelity.com/learning-center/trading-investing/technical-analysis/technical-indicator-guide/overview</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Benninga"></a>[10]</td>
<td>S. Benninga, <em>Financial Modeling</em>, 4th ed., Massachusetts: The MIT Press, 2014.</td>
</tr>
<tr>
<td class="Reference"><a name="Hull"></a>[11]</td>
<td>J.C. Hull, <em>Options, Futures and Other Derivatives</em>, 10th ed., New York: Pearson Education Limited, 2018.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>R. Adhikari, <span class="special-character OpenCurlyDoubleQuote">“</span>Foundations of Computational Finance,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2020. <a href="https://doi.org/10.3888/tmj.22-2">https://doi.org/10.3888/tmj.22–2</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Author</h3>
<p class="TextAboutAuthor">Ramesh Adhikari is an assistant professor of finance at Humboldt State University. Prior to coming to HSU, he taught undergraduate and graduate students at the Tribhuvan University and worked at the Central Bank of Nepal. He was also a research fellow at the Osaka Sangyo University, Osaka, Japan. He earned a Ph.D. in Financial Economics from the University of New Orleans. He is interested in the areas of computational finance and high-dimensional statistics.</p>
<p class="TextAboutAuthor"><strong>Ramesh Adhikari</strong><br />
<em>School of Business, Humboldt State University<br />
1 Harpst Street<br />
Arcata, CA 95521</em><br />
<em><a href="mailto:ramesh.adhikari@humboldt.edu">ramesh.adhikari@humboldt.edu</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2020/08/18/foundations-of-computational-finance/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Sectional Curvature in Riemannian Manifolds</title>
		<link>https://www.mathematica-journal.com/2020/03/19/sectional-curvature-in-riemannian-manifolds/</link>
		<comments>https://www.mathematica-journal.com/2020/03/19/sectional-curvature-in-riemannian-manifolds/#respond</comments>
		<pubDate>Thu, 19 Mar 2020 15:08:19 +0000</pubDate>
		<dc:creator><![CDATA[Todd Akers]]></dc:creator>
				<category><![CDATA[Volume 22]]></category>

		<guid isPermaLink="false">https://www.mathematica-journal.com/?p=59312</guid>
		<description><![CDATA[https://doi.org/10.3888/tmj.22-1 The metric structure on a Riemannian or pseudo-Riemannian manifold is entirely determined by its metric tensor, which has a matrix representation in any given chart. Encoded in this metric is the sectional curvature, which is often of interest to mathematical physicists, differential geometers and geometric group theorists alike. In this article, we provide a [&#8230;]]]></description>
				<content:encoded><![CDATA[<div>
<div class="DOIReference"><span style="font-size: xx-small;"><a href="https://doi.org/10.3888/tmj.22-1">https://doi.org/10.3888/tmj.22-1</a></span></div>
<div>
<p>The metric structure on a Riemannian or pseudo-Riemannian manifold is entirely determined by its metric tensor, which has a matrix representation in any given chart. Encoded in this metric is the sectional curvature, which is often of interest to mathematical physicists, differential geometers and geometric group theorists alike. In this article, we provide a function to compute the sectional curvature for a Riemannian manifold given its metric tensor. We also define a function to obtain the Ricci tensor, a closely related object. <span id="more-59312"></span></p>
<h3>Introduction</h3>
<p>A <em>Riemannian manifold</em> is a differentiable manifold together with a Riemannian metric tensor that takes any point in the manifold to a positive-definite inner product function on its <em>tangent space</em>, which is a vector space representing geodesic directions from that point [<a href="#doCarmo">1</a>]. We can treat this tensor as a symmetric matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_1.gif" alt="" width="9" height="12" /> with entries denoted by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_2.gif" alt="" width="14" height="15" /> representing the relationship between tangent vectors at a point in the manifold, once a system of local coordinates has been chosen [<a href="#Lee">2</a>, <a href="#Stover-Weisstein">3</a>]. In the case of a parameterized surface, we can use the parameters to compute the full metric tensor.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_1.gif" alt="" width="452" height="108" /></p>
<p>A classical parametrization of a surface is the standard parameterization of the sphere. We compute the metric tensor of the standard sphere below.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_2.gif" alt="" width="490" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_3.gif" alt="" width="580" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_1.gif" alt="" width="84" height="32" /></p>
<p>This also works for more complicated surfaces. The following is an example taken from [<a href="#ParametricPlot3D">4</a>].</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_4.gif" alt="" width="580" height="14" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_5.gif" alt="" width="580" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_2.gif" alt="" width="360" height="384" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_6.gif" alt="" width="369" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_3.gif" alt="" width="580" height="78" /></p>
<p>Denoting the coordinates by <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_3.gif" alt="" width="10" height="15" />, we can then define <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_4.gif" alt="" width="88" height="18" />, where the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_5.gif" alt="" width="14" height="15" /> are functions of the coordinates <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_6.gif" alt="" width="10" height="15" />; this definition uses Einstein notation, which will also apply wherever applicable in the following. From this surprisingly dense description of distance, we can extract many properties of a given Riemannian manifold, including <em>sectional curvature</em>, which will be given an explicit formula later. In particular, two-dimensional manifolds, also called <em>surfaces</em>, carry a value that measures at any given point how far they are from being flat. This value can be positive, negative or zero. For intuition, we give examples of each of these types of behavior.</p>
<p>The sphere is the prototypical example of a surface of positive curvature.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_7.gif" alt="" width="564" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_4.gif" alt="" width="360" height="391" /></p>
<p>Any convex subspace of Euclidean space has zero curvature everywhere.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_8.gif" alt="" width="562" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_5.gif" alt="" width="360" height="237" /></p>
<p>The monkey saddle is an example of a two-dimensional figure with negative curvature.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_9.gif" alt="" width="523" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_6.gif" alt="" width="362" height="190" /></p>
<p>Sectional curvature is a locally defined value that gives the curvature of a special type of two-dimensional subspace at a point, where the two dimensions defining the surface are input as tangent vectors. Manifolds may have points that admit sections of both negative and positive curvature simultaneously, as is the case for the Schwarzchild metric discussed in the section <span class="special-character OpenCurlyDoubleQuote">“</span>Applications in Physics.<span class="special-character CloseCurlyDoubleQuote">”</span> An important property of sectional curvature is that on a Riemannian manifold it varies smoothly with respect to both the point in the manifold being considered and the choice of tangent vectors.</p>
<p>Sectional curvature is given by</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_DisplayFormula_10.gif" alt="" width="206" height="37" /></p>
<p>where <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_7.gif" alt="" width="53" height="16" />.</p>
<p>In this formula, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_8.gif" alt="" width="8" height="12" /> represents the purely covariant Riemannian curvature tensor, a function on tangent vectors that is completely determined by the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_9.gif" alt="" width="14" height="15" />. Both <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_10.gif" alt="" width="8" height="12" /> and the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_11.gif" alt="" width="14" height="15" /> are treated more thoroughly in the following section, as well as in [<a href="#doCarmo">1</a>]. Some immediate properties of the curvature formula are that <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_12.gif" alt="" width="9" height="12" /> is symmetric in its two entries, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_13.gif" alt="" width="9" height="12" /> is undefined if the vectors <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_14.gif" alt="" width="6" height="14" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_15.gif" alt="" width="5" height="14" /> are linearly dependent, and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_16.gif" alt="" width="9" height="12" /> does not change when either vector is scaled. Moreover, any two tangent vectors that define the same subspace of the tangent space give the same value. This is important because curvature should only depend on the embedded surface itself and not how it was determined.</p>
<p>While we are primarily concerned with Riemannian manifolds, it is worth noting that all calculations are valid for pseudo-Riemannian manifolds, in which the assumption that the metric tensor is positive-definite is dropped. This generalization is especially important in areas such as general relativity, where the metric tensors that represent spacetime have a different signature than that of traditional Riemannian manifolds. We explore this connection more in the section <span class="special-character OpenCurlyDoubleQuote">“</span>Applications in Physics.<span class="special-character CloseCurlyDoubleQuote">”</span></p>
<h3>Coordinate Systems and the Representation of the Metric Tensors</h3>
<p>For a differentiable manifold, an <em>atlas</em> is a collection of homeomorphisms, called <em>charts</em>, from open sets in Euclidean space to the manifold, such that overlapping charts can be made compatible by a differentiable transition map between them. Via these homeomorphisms, we can define coordinates in an open set around any point by adopting the coordinates in the corresponding Euclidean neighborhood. By convention, these coordinates are labelled <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_17.gif" alt="" width="10" height="15" />, and unless important, we omit the point giving rise to the coordinates. In some cases of interest, it is possible to adopt a coordinate system that is valid over the whole manifold.</p>
<p>From such a coordinate system, whether local or global, we can define a basis for the tangent space using a <em>coordinate frame</em> [<a href="#Minkowski">5</a>]. This will be the basis consisting of the partial derivative operators in each of the coordinate directions, that is, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_18.gif" alt="" width="15" height="16" />. Considering the tangent space as a vector space, this set is sometimes referred to in mathematical physics as a <em>holonomic basis</em> for the manifold. We use this expression then to define the symmetric matrix <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_19.gif" alt="" width="45" height="19" /> by the following expression for <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_20.gif" alt="" width="32" height="12" />:</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_DisplayFormula_11.gif" alt="" width="109" height="37" /></p>
<p>From here, we define one more tensor of interest for the purposes of calculating curvature. Using Einstein notation, the Riemannian curvature tensor is</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_DisplayFormula_12.gif" alt="" width="86" height="15" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_DisplayFormula_13.gif" alt="" width="224" height="31" /></p>
<p>The various <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_21.gif" alt="" width="7" height="12" /> are the <em>Christoffel symbols</em>, for which code is presented in the next section. In light of these definitions, we recall sectional curvature once again from the introduction as the following, now considering the special case of the tangent vectors being chosen in coordinate directions:</p>
<p><img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Image_2.gif" alt="" width="192" height="33" />.</p>
<p>The norm in the denominator is the norm of the tangent vector associated to that partial derivative in the holonomic basis, which is induced by the associated inner product from <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_22.gif" alt="" width="9" height="12" />.</p>
<h3>Sectional Curvature</h3>
<p>We now create functions to compute these tensors and sectional curvature itself. These values depend on a set of coordinates and a Riemannian metric tensor, so that will be the information that serves as the input for these functions. Coordinates should be a list of coordinate names like <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_23.gif" alt="" width="57" height="14" />, and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_24.gif" alt="" width="86" height="13" /> should be a square symmetric matrix whose size matches the length of the coordinate list. Some not inconsiderable inspiration for the first half of this code was taken from Professor Leonard Parker&#8217;s Mathematica notebook &#8220;Curvature and the Einstein Equation,&#8221; which is available online as a supplement to [<a href="#Hartle">6</a>].</p>
<p>We can now define a function for the Christoffel symbols from the previous section. This calculation consists of taking partial derivatives of the metric tensor components and one tensor operation. In Mathematica, the dot product, typically used for vectors and matrices, is also able to take tensors and contract indices.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_14.gif" alt="" width="361" height="187" /></p>
<p>We can now use the formulas stated in the second section to define both the covariant and contravariant forms of the Riemannian curvature tensor.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_15.gif" alt="" width="505" height="157" /></p>
<p>We perform one more tensor operation using the dot product to transform our partially contravariant tensor into one that is purely covariant. Both of these will be called at various points later.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_16.gif" alt="" width="437" height="30" /></p>
<p>The full function to return the sectional curvatures consists of computing a scaled version of the covariant Riemannian metric tensor.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_17.gif" alt="" width="513" height="233" /></p>
<p>The output consists of a symmetric matrix with zero diagonal entries representing curvatures in the coordinate directions. These diagonal values should not be taken literally, as curvature is undefined given two linearly dependent directions. While this of course does not give all possible sectional curvatures, one may perform a linear transformation on the basis in order to obtain a new metric tensor with arbitrary (linearly independent) vectors as basis elements. From here, the new tensor may be used for computation.</p>
<p>Here is an example with diagonal entries that are functions of the last coordinate.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_18.gif" alt="" width="482" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_7.gif" alt="" width="580" height="134" /></p>
<p>Any good computation in mathematics must stand to scrutiny by known cases, so we evaluate our function with the input of hyperbolic 3-space. The two in the exponent should be imagined as the squaring of the exponential function.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_19.gif" alt="" width="545" height="30" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_8.gif" alt="" width="81" height="46" /></p>
<p>Checking with [<a href="#Ratcliffe">7</a>] verifies that this is indeed a global metric tensor for hyperbolic 3-space. As such, we know that it has constant sectional curvature of <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_25.gif" alt="" width="15" height="12" /> (recall the diagonal entries do not represent any curvature information).</p>
<h3>Applications in Topology</h3>
<p>Continuing with the hyperbolic space metric tensor, it is a well-known result in hyperbolic geometry that one is able to scale these first two dimensions to vary the curvature and produce a <em>pinched curvature</em> manifold.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_20.gif" alt="" width="472" height="14" /></p>
<p>If we allow for new constant coefficients in the exponents for positive real numbers <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_26.gif" alt="" width="6" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_27.gif" alt="" width="6" height="12" />, then we should see explicit bounds on the curvatures.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_21.gif" alt="" width="421" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_9.gif" alt="" width="107" height="54" /></p>
<p>In this vein, the Riemannian structure for <em>complex hyperbolic space</em> is similar to the real case, except for a modification to allow for complex variables.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_22.gif" alt="" width="223" height="110" /></p>
<p>In this setting, a formula for the metric tensor valid over the entire manifold is available from [<a href="#Parker">8</a>], among other places.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_23.gif" alt="" width="450" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_10.gif" alt="" width="214" height="112" /></p>
<p>One can verify that, although not constant, the entries in the upper-left block are always bounded between <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_28.gif" alt="" width="15" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_29.gif" alt="" width="15" height="12" /> for positive <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_30.gif" alt="" width="5" height="12" />. This result agrees with sectional curvature in complex hyperbolic space, and so serves as an example of sectional curvature computation where the underlying tensor is not diagonal. A careful review of [<a href="#Parker">8</a>] reminds us that this metric is only well-defined up to rescaling, which can change the values of the sectional curvature. What does not change, however, is the ratio of the largest and smallest curvatures, which are always exactly 4. The introduction in [<a href="#Goldman">9</a>] takes considerable care to remind us that definitions change between curvatures in <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_31.gif" alt="" width="45" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_32.gif" alt="" width="59" height="12" /> and even <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_33.gif" alt="" width="59" height="12" />.</p>
<h3>Applications in Physics</h3>
<p>Perhaps the most interesting applications of differentiable manifolds and curvature to physics lie in the area of relativity. This discipline uses the idea of a <em>Lorentzian manifold</em>, which is defined as a manifold equipped with a Lorentzian metric that has signature <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_34.gif" alt="" width="49" height="12" /> instead of the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_35.gif" alt="" width="49" height="12" /> signature for four-dimensional Riemannian manifolds. As noted in the introduction, however, this has no impact on the computations of sectional curvature. Examples of such Lorentzian metrics include the <em>Minkowski flat spacetime metric</em>; <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_36.gif" alt="" width="5" height="12" /> is the familiar constant speed of light.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_24.gif" alt="" width="479" height="14" /></p>
<p>Justifying the name of <em>flat</em> spacetime, our curvature calculation guarantees all sectional curvatures are identically zero.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_25.gif" alt="" width="418" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_11.gif" alt="" width="72" height="62" /></p>
<p>More generic Lorentzian manifolds may have nonzero curvature. To this end, we examine the <em>Schwarzschild metric</em>, which describes spacetime outside a spherical mass such that the gravitational field outside the mass satisfies Einstein&#8217;s field equations. This most commonly is viewed in the context of a black hole and how spacetime behaves nearby. More details on the following tensor can be found in [<a href="#general-relativity">10</a>].</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_26.gif" alt="" width="240" height="89" /></p>
<p>In the following, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_37.gif" alt="" width="5" height="12" />, <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_38.gif" alt="" width="7" height="12" /> and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_39.gif" alt="" width="5" height="12" /> are standard spherical coordinates for three-dimensional space and <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_40.gif" alt="" width="4" height="12" /> represents time. With this setup, we can calculate the sectional curvature of spacetime for areas outside such a spherical mass.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_27.gif" alt="" width="461" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_12.gif" alt="" width="192" height="102" /></p>
<p>This result indicates that the sectional curvature is directly proportional to the mass and inversely proportional to the distance from the object. In particular, there is a singularity at <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_41.gif" alt="" width="25" height="12" />, indicating that curvature <span class="special-character OpenCurlyDoubleQuote">“</span>blows up<span class="special-character CloseCurlyDoubleQuote">”</span> near the center of the mass. Indeed, these results are in line with Flamm&#8217;s paraboloid, the graphical representation of a constant-time equatorial slice of the Schwarzchild metric, whose details can be found in [<a href="#curved-space">11</a>].</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_28.gif" alt="" width="534" height="29" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_13.gif" alt="" width="370" height="270" /></p>
<h3>Ricci Curvature</h3>
<p>In fact, the calculations we have done already allow us to compute one further object of interest for a Riemannian or pseudo-Riemannian manifold: the Ricci curvature. The Ricci curvature is a tensor that contracts the curvature tensor and is computable when one has the contravariant Riemannian curvature tensor. Below we use a built-in function for tensors to contract the first and third indices of the contravariant Riemannian curvature tensor to obtain a matrix containing condensed curvature information (see [<a href="#Sidorov">12</a>] for more information).</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_29.gif" alt="" width="580" height="30" /></p>
<p>The values 1 and 3 above refer to the dimensions we are contracting. In general, the corresponding indices must vary over sets of the same size; here all dimensions have indices that vary over a set whose size is the number of coordinates. We compute the Ricci curvature for some of the previous examples.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_30.gif" alt="" width="392" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_14.gif" alt="" width="271" height="54" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_31.gif" alt="" width="418" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_15.gif" alt="" width="208" height="118" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_32.gif" alt="" width="432" height="13" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_16.gif" alt="" width="72" height="62" /></p>
<p>The fact that the Ricci curvature vanishes for the above solution to the Einstein field equation is a consequence of its types of symmetries. In general, the Ricci curvature for other solutions is nonzero. Notice for the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_42.gif" alt="" width="115" height="14" /> example (and the <img style="vertical-align: middle;" src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Math_43.gif" alt="" width="137" height="13" />, trivially), all information from the Ricci tensor is contained in the diagonal elements. This is always the case for a diagonal metric tensor [<a href="#Sidorov">12</a>]. As such, we may sometimes be interested only in these values, so we take the diagonal in such a case.</p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_33.gif" alt="" width="580" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_17.gif" alt="" width="81" height="18" /></p>
<p class="input"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Input_34.gif" alt="" width="368" height="14" /></p>
<p class="output"><img src="https://content.wolfram.com/uploads/sites/19/2020/02/Healy_Output_18.gif" alt="" width="271" height="18" /></p>
<h3>Acknowledgments</h3>
<p>The supervising author would like to thank Dr. Nicolas Robles for suggesting the submission of this article to <em>The Mathematica Journal</em>. We would also like to thank Leonard Parker, who authored the notebook file available at [<a href="#Hartle">6</a>], which greatly illuminated some of the calculations. We are also very grateful to the referee and especially the editor, whose contributions have made this article much more accurate, legible and efficient.</p>
<h3>References</h3>
<table class="ReferenceTable">
<tbody>
<tr>
<td class="Reference"><a name="doCarmo"></a>[1]</td>
<td>M. do Carmo, <em>Differential Geometry of Curves &amp; Surfaces,</em> Mineola, NY: Dover Publications, Inc., 2018.</td>
</tr>
<tr>
<td class="Reference"><a name="Lee"></a>[2]</td>
<td>J. M. Lee, <em>Introduction to Smooth Manifolds,</em> Graduate Texts in Mathematics, 218, New York: Springer, 2003.</td>
</tr>
<tr>
<td class="Reference"><a name="Stover-Weisstein"></a>[3]</td>
<td>C. Stover and E. W. Weisstein, <span class="special-character OpenCurlyDoubleQuote">“</span>Metric Tensor<span class="special-character CloseCurlyDoubleQuote">”</span> from MathWorld<span class="special-character LongDash">—</span>A Wolfram Web Resource. <a href="http://mathworld.wolfram.com/MetricTensor.html">mathworld.wolfram.com/MetricTensor.html</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="ParametricPlot3D"></a>[4]</td>
<td><span class="special-character OpenCurlyDoubleQuote">“</span>ParametricPlot3D,<span class="special-character CloseCurlyDoubleQuote">”</span> ParametricPlot3D from Wolfram Language &amp; System Documentation Center<span class="special-character LongDash">—</span>A Wolfram Web Resource. <a href="https://reference.wolfram.com/language/ref/ParametricPlot3D.html">reference.wolfram.com/language/ref/ParametricPlot3D.html</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Minkowski"></a>[5]</td>
<td>F. Catoni, D. Boccaletti, R. Cannata, V. Catoni, E. Nichelatti and P. Zampetti, <em>The Mathematics of Minkowski Space-Time,</em> Frontiers in Mathematics, Basel: Birkh<span class="special-character ADoubleDot">ä</span>user Verlag, 2008.</td>
</tr>
<tr>
<td class="Reference"><a name="Hartle"></a>[6]</td>
<td>J. B. Hartle, <em>Gravity: An Introduction to Einstein<span class="special-character CloseCurlyQuote">’</span>s General Relativity,</em> San Francisco: Addison-Wesley, 2003. <a href="http://web.physics.ucsb.edu/~gravitybook/math/curvature.pdf" target="_blank">web.physics.ucsb.edu/~gravitybook/math/curvature.pdf</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Ratcliffe"></a>[7]</td>
<td>J. G. Ratcliffe, <em>Foundations of Hyperbolic Manifolds</em>, 2nd ed., Graduate Texts in Mathematics, 149, New York: Springer, 2006.</td>
</tr>
<tr>
<td class="Reference"><a name="Parker"></a>[8]</td>
<td>J. Parker, <span class="special-character OpenCurlyDoubleQuote">“</span>Notes on Complex Hyperbolic Geometry<span class="special-character CloseCurlyDoubleQuote">”</span> (Jan 10, 2020). <a href="http://maths.dur.ac.uk/~dma0jrp/img/NCHG.pdf" target="_blank">maths.dur.ac.uk/~dma0jrp/img/NCHG.pdf</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Goldman"></a>[9]</td>
<td>W. M. Goldman, <em>Complex Hyperbolic Geometry,</em> Oxford Mathematical Monographs, Oxford Science Publications, New York: Oxford University Press, 1999.</td>
</tr>
<tr>
<td class="Reference"><a name="general-relativity"></a>[10]</td>
<td>R. Adler, M. Bazin and M. Schiffer, <em>Introduction to General Relativity</em>, New York: McGraw-Hill, 1965.</td>
</tr>
<tr>
<td class="Reference"><a name="curved-space"></a>[11]</td>
<td>R. T. Eufrasio, N. A. Mecholsky and L. Resca, <span class="special-character OpenCurlyDoubleQuote">“</span>Curved Space, Curved Time, and Curved Space-Time in Schwarzschild Geodetic Geometry,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>General Relativity and Gravitation</em>, <strong>50</strong>(159), 2018. <a href="https://doi.org/10.1007/s10714-018-2481-2" target="_blank">doi:10.1007/s10714-018-2481-2</a>.</td>
</tr>
<tr>
<td class="Reference"><a name="Sidorov"></a>[12]</td>
<td>L. A. Sidorov, <span class="special-character OpenCurlyDoubleQuote">“</span>Ricci Tensor,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>Encyclopedia of Mathematics</em> (M. Hazewinkel, ed.), Netherlands: Springer, 1990. <a href="https://www.encyclopediaofmath.org/index.php/Ricci_tensor" target="_blank">www.encyclopediaofmath.org/index.php/Ricci_tensor</a>.</td>
</tr>
<tr>
<td id="1099737697" class="DOIReference" colspan="2"><a name="1099737697"></a>E. Fairchild, F. Owen and B. Burns Healy, <span class="special-character OpenCurlyDoubleQuote">“</span>Sectional Curvature in Riemannian Manifolds,<span class="special-character CloseCurlyDoubleQuote">”</span> <em>The Mathematica Journal</em>, 2020. <a href="https://doi.org/10.3888/tmj.22-1">https://doi.org/10.3888/tmj.22-1</a>.</td>
</tr>
</tbody>
</table>
<h3 class="SectionAboutAuthor">About the Authors</h3>
<p class="TextAboutAuthor">Elliott Fairchild is a high-school student at Cedarburg High School. He particularly enjoys problems in analysis, and is always looking for more research opportunities.</p>
<p class="TextAboutAuthor">Francis Owen is an undergraduate student at the University of Wisconsin-Milwaukee. His major is Applied Mathematics and Computer Science, and he is eager to find new programming opportunities.</p>
<p class="TextAboutAuthor">Brendan Burns Healy is a Visiting Assistant Professor at the University of Wisconsin-Milwaukee. Though a geometric group theorist and low-dimensional topologist by training, he also enjoys problems of computation and coding.</p>
<p class="TextAboutAuthor"><strong>Elliott Fairchild</strong><br />
<em>Department of Mathematical Sciences<br />
University of Wisconsin-Milwaukee<br />
3200 N. Cramer St.<br />
Milwaukee, WI 53211<br />
</em><em><a href="mailto:rsquared3.1415926@gmail.com">rsquared3.1415926@gmail.com</a></em></p>
<p class="TextAboutAuthor"><strong>Francis Owen</strong><br />
<em>Department of Mathematical Sciences<br />
University of Wisconsin-Milwaukee<br />
3200 N. Cramer St.<br />
Milwaukee, WI 53211</em></p>
<p class="TextAboutAuthor"><strong>Brendan Burns Healy, PhD</strong><em><br />
Department of Mathematical Sciences<br />
University of Wisconsin-Milwaukee<br />
3200 N. Cramer St.<br />
Milwaukee, WI 53211</em><br />
<em><a href="http://www.burnshealy.com">www.burnshealy.com</a></em></p>
</div>
</div>
]]></content:encoded>
			<wfw:commentRss>https://www.mathematica-journal.com/2020/03/19/sectional-curvature-in-riemannian-manifolds/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
	</channel>
</rss>