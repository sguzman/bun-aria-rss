{
  "title": "Video: Overlay Histogram in R (Normal, Density, Another Series)",
  "description": "<p>This video explains how to overlay histogram plots in R for 3 common cases: overlaying a histogram with a normal curve, overlaying a histogram with a density curve, and overlaying a histogram with a second data series plotted on a secondary axis.</p>",
  "pubDate": "Fri, 09 Nov 2012 13:40:01 +0000",
  "link": "http://randyzwitch.com/overlay-histogram-in-r/",
  "guid": "http://randyzwitch.com/overlay-histogram-in-r/",
  "content": "<p>This video explains how to overlay histogram plots in R for 3 common cases: overlaying a histogram with a normal curve, overlaying a histogram with a density curve, and overlaying a histogram with a second data series plotted on a secondary axis.</p>\n\n<p>Note: Towards the end of the video (maybe minute 14 or so), I make a language error when talking about the <code class=\"language-plaintext highlighter-rouge\">padj</code> parameter in the mtext function…the setting doesn’t “left truncated” the label, I meant “right align”, “left align”, etc.</p>\n\n<iframe width=\"640\" height=\"480\" src=\"http://www.youtube.com/embed/C67KNai92Mo\" frameborder=\"0\" allowfullscreen=\"\"></iframe>\n\n<figure class=\"highlight\"><pre><code class=\"language-r\" data-lang=\"r\"><table class=\"rouge-table\"><tbody><tr><td class=\"gutter gl\"><pre class=\"lineno\">1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n</pre></td><td class=\"code\"><pre><span class=\"c1\">#Step 0:  load/prepare data</span><span class=\"w\">\n\n</span><span class=\"c1\">#Read in data</span><span class=\"w\">\n</span><span class=\"n\">sample_data</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">read.csv</span><span class=\"p\">(</span><span class=\"s2\">\"~/Desktop/test_data.csv\"</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\"># \"Explode\" counts by age back to unsummarized \"raw\" data</span><span class=\"w\">\n</span><span class=\"n\">age.exploded</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">rep.int</span><span class=\"p\">(</span><span class=\"n\">sample_data</span><span class=\"o\">$</span><span class=\"n\">age</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sample_data</span><span class=\"o\">$</span><span class=\"n\">count</span><span class=\"p\">)</span><span class=\"w\">\n\n\n</span><span class=\"c1\">#1. Histogram with normal distributon overlaid or density curve</span><span class=\"w\">\n\n\n</span><span class=\"c1\">#1A.  Create histogram</span><span class=\"w\">\n</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">xlim</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">20</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">ylim</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">.2</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">breaks</span><span class=\"o\">=</span><span class=\"n\">seq</span><span class=\"p\">(</span><span class=\"nf\">min</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\">\n  </span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"o\">=</span><span class=\"m\">22</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">xlab</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Age\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ylab</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Percentage of Accounts\"</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Age Distribution of Accounts\\n (where 0 &lt;= age &lt;= 20)\"</span><span class=\"p\">,</span><span class=\"w\">\n  </span><span class=\"n\">prob</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">col</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"lightgray\"</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\">#1B.  Do one of the following, either put the normal distribution on the histogram</span><span class=\"w\">\n</span><span class=\"c1\">#     or put the smoothed density function</span><span class=\"w\">\n\n</span><span class=\"c1\">#Calculate normal distribution having mean/sd equal to data plotted in the</span><span class=\"w\">\n</span><span class=\"c1\">#histogram above</span><span class=\"w\">\n</span><span class=\"n\">points</span><span class=\"p\">(</span><span class=\"n\">seq</span><span class=\"p\">(</span><span class=\"nf\">min</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">length.out</span><span class=\"o\">=</span><span class=\"m\">500</span><span class=\"p\">),</span><span class=\"w\">\n       </span><span class=\"n\">dnorm</span><span class=\"p\">(</span><span class=\"n\">seq</span><span class=\"p\">(</span><span class=\"nf\">min</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">length.out</span><span class=\"o\">=</span><span class=\"m\">500</span><span class=\"p\">),</span><span class=\"w\">\n             </span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">sd</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">)),</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"o\">=</span><span class=\"s2\">\"l\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">col</span><span class=\"o\">=</span><span class=\"s2\">\"red\"</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\">#Add smoothed density function to histogram, smoothness toggled using</span><span class=\"w\">\n</span><span class=\"c1\">#\"adjust\" parameter</span><span class=\"w\">\n</span><span class=\"n\">lines</span><span class=\"p\">(</span><span class=\"n\">density</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">adjust</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">col</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"blue\"</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\">#2 Histogram with line plot overlaid</span><span class=\"w\">\n\n</span><span class=\"c1\">#2A.  Create histogram with extra border space on right-hand side</span><span class=\"w\">\n\n</span><span class=\"c1\">#Extra border space \"2\" on right  (bottom, left, top, right)</span><span class=\"w\">\n</span><span class=\"n\">par</span><span class=\"p\">(</span><span class=\"n\">oma</span><span class=\"o\">=</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">2</span><span class=\"p\">))</span><span class=\"w\">\n\n</span><span class=\"n\">hist</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">xlim</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">20</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">ylim</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"m\">0</span><span class=\"p\">,</span><span class=\"m\">.2</span><span class=\"p\">),</span><span class=\"w\">\n     </span><span class=\"n\">breaks</span><span class=\"o\">=</span><span class=\"n\">seq</span><span class=\"p\">(</span><span class=\"nf\">min</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"nf\">max</span><span class=\"p\">(</span><span class=\"n\">age.exploded</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"o\">=</span><span class=\"m\">22</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">xlab</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Age\"</span><span class=\"p\">,</span><span class=\"w\">\n     </span><span class=\"n\">ylab</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Percentage of Accounts\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">main</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"Age Distribution of Accounts vs. Subscription Rate \\n (where reported age &lt;= 20)\"</span><span class=\"p\">,</span><span class=\"w\">\n     </span><span class=\"n\">prob</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">col</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"lightgray\"</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\">#2B.  Add overlaid line plot, create a right-side numeric axis</span><span class=\"w\">\n</span><span class=\"n\">par</span><span class=\"p\">(</span><span class=\"n\">new</span><span class=\"o\">=</span><span class=\"nb\">T</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">sample_data</span><span class=\"o\">$</span><span class=\"n\">subscribe_pct</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">xlab</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ylab</span><span class=\"o\">=</span><span class=\"s2\">\"\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"b\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">col</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"red\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">axes</span><span class=\"o\">=</span><span class=\"kc\">FALSE</span><span class=\"p\">)</span><span class=\"w\">  \n</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"m\">4</span><span class=\"p\">)</span><span class=\"w\">\n\n</span><span class=\"c1\">#2C.  Add right-side axis label</span><span class=\"w\">\n\n</span><span class=\"n\">mtext</span><span class=\"p\">(</span><span class=\"n\">text</span><span class=\"o\">=</span><span class=\"s2\">\"Subscription Rate\"</span><span class=\"p\">,</span><span class=\"n\">side</span><span class=\"o\">=</span><span class=\"m\">4</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">outer</span><span class=\"o\">=</span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">padj</span><span class=\"o\">=</span><span class=\"m\">1</span><span class=\"p\">)</span>\n</pre></td></tr></tbody></table></code></pre></figure>\n\n<p>File Download:</p>\n\n<p><a title=\"Histogram overlay in R\" href=\"http://randyzwitch.com/wp-content/uploads/2012/11/histogram-overlay-r.zip\" target=\"_blank\">Histogram overlay in R code and sample data file</a></p>"
}