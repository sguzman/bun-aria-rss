{
  "title": "Modeling the Extinction of Species with SVM-Kernel",
  "link": "https://www.r-bloggers.com/2022/10/modeling-the-extinction-of-species-with-svm-kernel/",
  "dc:creator": "Selcuk Disci",
  "pubDate": "Mon, 31 Oct 2022 09:00:00 +0000",
  "category": "R bloggers",
  "guid": "http://datageeek.com/?p=4886",
  "description": "<div style = \"width:60%; display: inline-block; float:left; \"> In the last article, we analyzed carbon emissions and the effects that created them. This time I want to look into another important environmental issue, animal biodiversity; by animals, I mean mammals, birds, fish, reptiles, and amphibians. The metric we are going to be interested in is the living planet ...</div>\n<div style = \"width: 40%; display: inline-block; float:right;\"></div>\n<div style=\"clear: both;\"></div>\n<strong>Continue reading</strong>: <a href=\"https://www.r-bloggers.com/2022/10/modeling-the-extinction-of-species-with-svm-kernel/\">Modeling the Extinction of Species with SVM-Kernel</a>",
  "content:encoded": "<!-- \n<div style=\"min-height: 30px;\">\n[social4i size=\"small\" align=\"align-left\"]\n</div>\n-->\n\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;\">\n[This article was first published on  <strong><a href=\"https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/\"> DataGeeek</a></strong>, and kindly contributed to <a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers</a>].  (You can report issue about the content on this page <a href=\"https://www.r-bloggers.com/contact-us/\">here</a>)\n<hr>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div>\n\n<p>In the last article, we analyzed carbon emissions and the effects that created them. This time I want to look into another important environmental issue, animal biodiversity; by animals, I mean mammals, birds, fish, reptiles, and amphibians.</p>\n\n\n\n<p>The metric we are going to be interested in is the <a href=\"https://ourworldindata.org/living-planet-index-decline#the-living-planet-index-tells-us-that-studied-animal-populations-have-seen-an-average-relative-decline-of-69-since-1970\" rel=\"nofollow\" target=\"_blank\"><em>living planet index</em></a> which measures the change in the number of 31,831 populations across 5,230 species relative to the year 1970. The explanatory variables we will take, are annual carbon emissions per capita(<strong><em>co2</em></strong>), annual gross domestic product per capita(<strong><em>gdp</em></strong>), and regions(<em><strong>region</strong></em>).</p>\n\n\n\n<p>First, we will compare the living planet index(<em><strong>lpi</strong></em>) by region. To do that, we will create our datasets; because we do that by regions, we will summarize the <em><strong>co2</strong></em> and <em><strong>gdp</strong></em> variables by the relative region.</p>\n\n\n<pre>\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(DALEX)\nlibrary(DALEXtra)\nlibrary(janitor)\nlibrary(plotly)\nlibrary(bbplot)\nlibrary(scales)\nlibrary(countrycode)\nlibrary(glue)\n  \ndf_co <- read_csv(\"https://raw.githubusercontent.com/mesdi/blog/main/co-emissions-per-capita.csv\")\ndf_gdp <- read_csv(\"https://raw.githubusercontent.com/mesdi/blog/main/gdp-per-capita-worldbank.csv\")\ndf_lpi <- read_csv(\"https://raw.githubusercontent.com/mesdi/blog/main/global-living-planet-index.csv\")\n  \n#Building the main dataset \ndf_co_gdp <- \n  df_gdp %>% \n  left_join(df_co) %>% \n  clean_names() %>% \n  #continent names\n  mutate(region = countrycode(sourcevar = entity,\n                              origin = \"country.name\",\n                              destination = \"region\")) %>% \n  select(\n    year,\n    region,\n    co2= annual_co2_emissions_per_capita,\n    gdp= gdp_per_capita_ppp_constant_2017_international) %>% \n  na.omit() %>%\n  #adjusting the region values for merging with the LPI data frame\n  mutate(\n    region = str_replace(region, \"&\", \"and\"),\n    region=case_when(\n    region==\"South Asia\" | region == \"East Asia and Pacific\" ~ \"Asia and Pacific\",\n    region==\"Middle East and North Africa\" | region == \"Sub-Saharan Africa\" ~ \"Africa\",\n    TRUE ~ region\n  )) %>% \n  #summing the co2 and gdp values by the region, separately\n  group_by(region,year) %>% \n  summarise(co2= sum(co2),\n            gdp= sum(gdp))\n\n\ndf_tidy <- \n  df_lpi %>% \n  left_join(df_co_gdp) %>% \n  na.omit() \n\n\n#Comparing the regions by plotting\np <- \n  df_tidy %>% \n  ggplot(aes(x= year, \n             y=lpi, \n             color=region,\n             group=region,\n             #text variable for hoverinfo\n             text = glue(\"{number(round(lpi), suffix='%')}\\n{year}\")))+\n  geom_line()+\n  #the reference line\n  geom_line(aes(y=100,color=\"red\"))+ \n  geom_point()+\n  #region texts\n  geom_text(data = df_tidy %>% \n              group_by(region) %>% \n              filter(year==round(median(year))),\n            aes(x= year, y= lpi,label=region),\n            show.legend = FALSE,\n            nudge_y = 4.2\n  )+\n  #the reference line text\n  geom_text(aes(x = 1994, \n                y=105, color= \"red\",\n                label = \"The reference line(1970 = %100)\"))+ \n  scale_y_continuous(breaks = pretty_breaks(),\n                     labels = label_percent(scale = 1))+\n  labs(title = \"Living Planet Index\")+\n  bbc_style() +\n  theme(legend.position = \"none\", #removes the legend keys\n        plot.title = element_text(hjust = 0.5))\n\n#plotly for interactive plotting\nggplotly(p, tooltip = c(\"text\")) %>% \n  #removes the reference line info\n  style(hoverinfo = \"none\",traces = 6)\n</pre>\n\n\n<figure class=\"wp-block-image size-large\"><a href=\"https://rpubs.com/Selcuk/963709\" rel=\"nofollow\" target=\"_blank\"><img data-attachment-id=\"4896\" data-permalink=\"https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/compare/\" data-orig-file=\"https://datageeek.files.wordpress.com/2022/10/compare.png\" data-orig-size=\"1242,641\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"compare\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://datageeek.files.wordpress.com/2022/10/compare.png?w=300\" data-large-file=\"https://datageeek.files.wordpress.com/2022/10/compare.png?w=578\" src=\"https://datageeek.files.wordpress.com/2022/10/compare.png?w=578\" alt=\"\" class=\"wp-image-4896\" srcset_temp=\"https://datageeek.files.wordpress.com/2022/10/compare.png?w=578 750w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=150 150w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=300 300w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=768 768w, https://datageeek.files.wordpress.com/2022/10/compare.png?w=1024 1024w, https://datageeek.files.wordpress.com/2022/10/compare.png 1242w\" sizes=\"(max-width: 750px) 100vw, 750px\" data-recalc-dims=\"1\" /></a></figure>\n\n\n\n<p>When we look at the regions, it seems they are all under their 1970-year values. We will now examine the underlying reasons for this. To do that, we will first model the data with a <em><a rel=\"nofollow\" href=\"https://www.jstatsoft.org/article/view/v011i09\" target=\"_blank\">support vector machine with kernel-based algorithms</a></em>.</p>\n\n\n<pre>\n#Preprocessing the data\ndf_rec <- \n  recipe(lpi ~ ., data = df_train) %>% \n  step_dummy(all_nominal_predictors(), one_hot = TRUE) %>% \n  #all numeric predictors should be in the same unit\n  step_normalize(all_numeric_predictors())\n\n\n#Modeling with svm with kernel-based algorithms\ndf_spec <- \n  svm_linear() %>% \n  set_engine(\"kernlab\") %>% \n  set_mode(\"regression\")\n\ndf_wf <- \n  workflow() %>% \n  add_recipe(df_rec) %>% \n  add_model(df_spec)\n\n#cross-validation for resamples\nset.seed(12345)\ndf_folds <- vfold_cv(df_train, strata = region)\n\n#Resampling for the accuracy metrics\nset.seed(234)\ndf_rs <- \n  df_wf %>% \n  fit_resamples(resamples = df_folds)\n\n#computes the accuracy metrics  \ncollect_metrics(df_rs)\n# A tibble: 2 x 6\n#  .metric .estimator  mean     n std_err .config       \n#  <chr>   <chr>      <dbl> <int>   <dbl> <chr>         \n#1 rmse    standard   4.32     10 0.387   Preprocessor1~\n#2 rsq     standard   0.980    10 0.00528 Preprocessor1~\n\n#fits the best model to the training set\n#and evaluate it with the testing set.\nfinal_fit <- last_fit(df_wf, df_split)\n\ncollect_metrics(final_fit)\n# A tibble: 2 x 4\n#  .metric .estimator .estimate .config             \n#  <chr>   <chr>          <dbl> <chr>               \n#1 rmse    standard       7.27  Preprocessor1_Model1\n#2 rsq     standard       0.963 Preprocessor1_Model1\n</pre>\n\n\n<p>The above accuracy results look fine to step forward with that model. Now, we can compute and draw <a rel=\"nofollow\" href=\"https://www.tmwr.org/explain.html#:~:text=one%20way%20to%20compute%20variable%20importance%20is%20to%20permute%20the%20features%20(breiman%202001a).%20we%20can%20permute%20or%20shuffle%20the%20values%20of%20a%20feature%2C%20predict%20from%20the%20model%2C%20and%20then%20measure%20how%20much%20worse%20the%20model%20fits%20the%20data%20compared%20to%20before%20shuffling.\" target=\"_blank\"><em>permutation-based variable importance</em></a> scores.</p>\n\n\n<pre>\n#Permutation-based variable importance\n\n#Creating a preprocessed dataframe of the train dataset\nimp_data <- \n  df_rec %>%\n  prep() %>%\n  bake(new_data = NULL)\n\n \n#building the explainer-object\nexplainer_svm <- \n  explain_tidymodels(\n    df_spec %>% \n      fit(lpi ~ ., data = imp_data),\n    data = imp_data %>% select(-lpi), \n    y = df_train$lpi,\n    verbose = FALSE\n  )\n\n\nset.seed(1983)\n#calculates the variable-importance measure\nvip_svm <- \n  model_parts( \n    explainer = explainer_svm, \n    loss_function = loss_root_mean_square, \n    B = 100, #the number of permutations\n    type = \"difference\",\n    label =\"\"\n  )\n\n#Plotting ranking of the importance of explanatory variables\nplot(vip_svm) +\n  ggtitle(\"Mean variable-importance over 100 permutations\", \"\")+\n  theme(plot.title = element_text(hjust = 0.5))\n</pre>\n\n\n<figure class=\"wp-block-image size-large\"><a href=\"https://datageeek.files.wordpress.com/2022/10/vip.jpeg\" rel=\"nofollow\" target=\"_blank\"><img data-attachment-id=\"4915\" data-permalink=\"https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/vip-3/\" data-orig-file=\"https://datageeek.files.wordpress.com/2022/10/vip.jpeg\" data-orig-size=\"857,422\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"vip\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=300\" data-large-file=\"https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=750\" src=\"https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=578\" alt=\"\" class=\"wp-image-4915\" srcset_temp=\"https://datageeek.files.wordpress.com/2022/10/vip.jpeg 857w, https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=150 150w, https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=300 300w, https://datageeek.files.wordpress.com/2022/10/vip.jpeg?w=768 768w\" sizes=\"(max-width: 857px) 100vw, 857px\" data-recalc-dims=\"1\" /></a></figure>\n\n\n\n<p>The interesting thing we can extract from the above plot is that the carbon emission variable(<em><strong>co2</strong></em>) is a very weak effect on the LPI index. Instead of it, Europe and Latin America regions, and the <em><strong>gdp</strong></em> variables look to have far the most dominant effects on the index.</p>\n\n<div style=\"border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;\">\n<div style=\"text-align: center;\">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href=\"https://datageeek.com/2022/10/31/modeling-the-extinction-of-species-with-svm-kernel/\"> DataGeeek</a></strong>.</div>\n<hr />\n<a href=\"https://www.r-bloggers.com/\" rel=\"nofollow\">R-bloggers.com</a> offers <strong><a href=\"https://feedburner.google.com/fb/a/mailverify?uri=RBloggers\" rel=\"nofollow\">daily e-mail updates</a></strong> about <a title=\"The R Project for Statistical Computing\" href=\"https://www.r-project.org/\" rel=\"nofollow\">R</a> news and tutorials about <a title=\"R tutorials\" href=\"https://www.r-bloggers.com/how-to-learn-r-2/\" rel=\"nofollow\">learning R</a> and many other topics. <a title=\"Data science jobs\" href=\"https://www.r-users.com/\" rel=\"nofollow\">Click here if you're looking to post or find an R/data-science job</a>.\n\n<hr>Want to share your content on R-bloggers?<a href=\"https://www.r-bloggers.com/add-your-blog/\" rel=\"nofollow\"> click here</a> if you have a blog, or <a href=\"http://r-posts.com/\" rel=\"nofollow\"> here</a> if you don't.\n</div><strong>Continue reading</strong>: <a href=\"https://www.r-bloggers.com/2022/10/modeling-the-extinction-of-species-with-svm-kernel/\">Modeling the Extinction of Species with SVM-Kernel</a>",
  "enclosure": [
    "",
    "",
    "",
    ""
  ],
  "post-id": 334069
}