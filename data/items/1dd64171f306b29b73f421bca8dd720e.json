{
  "title": "How to analyze smartphone sensor data with R and the BreakoutDetection package",
  "link": "http://beautifuldata.net/2015/01/how-to-analyze-smartphone-sensor-data-with-r-and-the-breakoutdetection-package/",
  "comments": "http://beautifuldata.net/2015/01/how-to-analyze-smartphone-sensor-data-with-r-and-the-breakoutdetection-package/#comments",
  "dc:creator": "Benedikt Koehler",
  "pubDate": "Sat, 10 Jan 2015 14:56:46 +0000",
  "category": [
    "R",
    "sensors",
    "twitter",
    "visualization",
    "breakout detection",
    "sensor data"
  ],
  "guid": "http://beautifuldata.net/?p=1161",
  "description": "Yesterday, Jörg has written a blog post on Data Storytelling with Smartphone sensor data. Here&#8217;s a practical approach on how to analyze smartphone sensor data with R. In this example I will be using the accelerometer smartphone data that Datarella provided in its Data Fiction competition. The dataset shows the acceleration along the three axes &#8230; <a href=\"http://beautifuldata.net/2015/01/how-to-analyze-smartphone-sensor-data-with-r-and-the-breakoutdetection-package/\" class=\"more-link\">Continue reading<span class=\"screen-reader-text\"> \"How to analyze smartphone sensor data with R and the BreakoutDetection package\"</span></a>",
  "content:encoded": "<p>Yesterday, Jörg has written a <a href=\"http://beautifuldata.net/2015/01/data-storytelling-stepwise-abstraction-from-raw-data/\">blog post</a> on Data Storytelling with Smartphone sensor data. Here&#8217;s a practical approach on how to analyze <a ref=\"http://developer.android.com/guide/topics/sensors/sensors_overview.html\">smartphone sensor data</a> with R. In this example I will be using the accelerometer smartphone data that Datarella provided in its <a href=\"http://datarella.com/call-for-data-fiction/\">Data Fiction competition</a>. The dataset shows the acceleration along the <a href=\"http://blog.contus.com/how-to-measure-acceleration-in-smartphones-using-accelerometer/\">three axes of the smartphone</a>:</p>\n<ul>\n<li>x &#8211; sideways acceleration of the device\n<li>y &#8211; forward and backward acceleration of the device\n<li>z &#8211; acceleration up and down\n</ul>\n<p>The interpretation of these values can be quite tricky because on the one hand there are manufacturer, device and sensor specific variations and artifacts. On the other hand, all acceleration is measured relative to the sensor orientation of the device. So, for example, the activity of taking the smartphone out of your pocket and reading a tweet can look the following way:</p>\n<ul>\n<li>y acceleration &#8211; the smartphone had been in the pocket top down and is now taken out of the pocket\n<li>z and y acceleration &#8211; turning the smartphone so that is horizontal\n<li>x acceleration &#8211; moving the smartphone from the left to the middle of your body\n<li>z acceleration &#8211; lifting the smartphone so you can read the fine print of the tweet\n</ul>\n<p>And third, there is gravity influencing all the movements.</p>\n<p>So, to find out what you are really doing with your smartphone can be quite challenging. In this blog post, I will show how to do one small task &#8211; identifying breakpoints in the dataset. As a nice side effect, I use this opportunity to introduce an application of the Twitter <a href=\"https://blog.twitter.com/2014/breakout-detection-in-the-wild\">BreakoutDetection</a> Open Source library (see <a href=\"https://github.com/twitter/BreakoutDetection\">Github</a>) that can be used for <a href=\"http://wiki.cbr.washington.edu/qerm/index.php/Behavioral_Change_Point_Analysis\">Behavioral Change Point analysis</a>.</p>\n<p>First, I load the dataset and take a look at it:</p>\n<pre class=\"wp-code-highlight prettyprint\">\nsetwd(\"~/Documents/Datarella\")\naccel <- read.csv(\"SensorAccelerometer.csv\", stringsAsFactors=F)\nhead(accel)\n\n  user_id           x          y        z                 updated_at                 type\n1      88 -0.06703765 0.05746084 9.615114 2014-05-09 17:56:21.552521 Probe::Accelerometer\n2      88 -0.05746084 0.10534488 9.576807 2014-05-09 17:56:22.139066 Probe::Accelerometer\n3      88 -0.04788403 0.03830723 9.605537 2014-05-09 17:56:22.754616 Probe::Accelerometer\n4      88 -0.01915361 0.04788403 9.567230 2014-05-09 17:56:23.372244 Probe::Accelerometer\n5      88 -0.06703765 0.08619126 9.615114 2014-05-09 17:56:23.977817 Probe::Accelerometer\n6      88 -0.04788403 0.07661445 9.595961  2014-05-09 17:56:24.53004 Probe::Accelerometer\n</pre>\n<p>This is the sensor data for one user on one day:</p>\n<pre class=\"wp-code-highlight prettyprint\">\naccel$day <- substr(accel$updated_at, 1, 10)\ndf <- accel[accel$day == &#039;2014-05-12&#039; & accel$user_id == 88,]\ndf$timestamp <- as.POSIXlt(df$updated_at) # Transform to POSIX datetime\nlibrary(ggplot2)\nggplot(df) + geom_line(aes(timestamp, x, color=\"x\")) + \n             geom_line(aes(timestamp, y, color=\"y\")) + \n             geom_line(aes(timestamp, z, color=\"z\")) + \n             scale_x_datetime() + xlab(\"Time\") + ylab(\"acceleration\")\n</pre>\n<p><img loading=\"lazy\" src=\"http://beautifuldata.net/wp-content/uploads/2015/01/sensor_all.png\" alt=\"sensor_all\" width=\"600\" height=\"350\" class=\"aligncenter size-full wp-image-1165\" srcset=\"http://beautifuldata.net/wp-content/uploads/2015/01/sensor_all.png 600w, http://beautifuldata.net/wp-content/uploads/2015/01/sensor_all-300x175.png 300w\" sizes=\"(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px\" /></p>\n<p>Let&#8217;s zoom in to the period between 12:32 and 13:00:</p>\n<pre class=\"wp-code-highlight prettyprint\">\nggplot(df[df$timestamp >= &#039;2014-05-12 12:32:00&#039; & df$timestamp < &#039;2014-05-12 13:00:00&#039;,]) +\n  geom_line(aes(timestamp, x, color=\"x\")) + \n  geom_line(aes(timestamp, y, color=\"y\")) + \n  geom_line(aes(timestamp, z, color=\"z\")) + \n  scale_x_datetime() + xlab(\"Time\") + ylab(\"acceleration\")\n</pre>\n<p><img loading=\"lazy\" src=\"http://beautifuldata.net/wp-content/uploads/2015/01/sensor_zoom.png\" alt=\"sensor_zoom\" width=\"600\" height=\"350\" class=\"aligncenter size-full wp-image-1166\" srcset=\"http://beautifuldata.net/wp-content/uploads/2015/01/sensor_zoom.png 600w, http://beautifuldata.net/wp-content/uploads/2015/01/sensor_zoom-300x175.png 300w\" sizes=\"(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px\" /></p>\n<p>Then, I load the Breakoutdetection library:</p>\n<pre class=\"wp-code-highlight prettyprint\">\ninstall.packages(\"devtools\")\ndevtools::install_github(\"twitter/BreakoutDetection\")\nlibrary(BreakoutDetection)\nbo <- breakout(df$x[df$timestamp >= &#039;2014-05-12 12:32:00&#039; & df$timestamp < &#039;2014-05-12 12:35:00&#039;], \n               min.size=10, method=&#039;multi&#039;, beta=.001, degree=1, plot=TRUE)\nbo$plot\n</pre>\n<p><img loading=\"lazy\" src=\"http://beautifuldata.net/wp-content/uploads/2015/01/sensor_breakout.png\" alt=\"sensor_breakout\" width=\"623\" height=\"364\" class=\"aligncenter size-full wp-image-1167\" srcset=\"http://beautifuldata.net/wp-content/uploads/2015/01/sensor_breakout.png 623w, http://beautifuldata.net/wp-content/uploads/2015/01/sensor_breakout-300x175.png 300w\" sizes=\"(max-width: 709px) 85vw, (max-width: 909px) 67vw, (max-width: 984px) 61vw, (max-width: 1362px) 45vw, 600px\" /></p>\n<p>This quick analysis of the acceleration in the x direction gives us 4 change points, where the acceleration suddenly changes. In the beginning, the smartphone seems to lie flat on a horizontal surface &#8211; the sensor is reading a value of around 9.8 in positive direction &#8211; this means, the gravitational force only effects this axis and not the x and y axes. Ergo: the smartphone is lying flat. But then things change and after a few movements (our change points) the last observation has the  smartphone on a position where the x axis has around -9.6 acceleration, i.e. the smartphone is being held in landscape orientation pointing to the right.</p>\n",
  "wfw:commentRss": "http://beautifuldata.net/2015/01/how-to-analyze-smartphone-sensor-data-with-r-and-the-breakoutdetection-package/feed/",
  "slash:comments": 2
}