{
  "title": "Tutorial: Sentiment Analysis of Airlines Using the syuzhet Package and Twitter",
  "link": "https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/",
  "comments": "https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/#comments",
  "dc:creator": "Colin Priest",
  "pubDate": "Sun, 30 Apr 2017 14:35:31 +0000",
  "category": [
    "R",
    "Sentiment Analysis",
    "Social Media",
    "Text Mining",
    "Twitter"
  ],
  "guid": "http://colinpriest.com/?p=996",
  "description": "In my last job, I was a frequent flyer. Each week I flew between 2 or 3 countries, briefly returning &#8230;<p><a href=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/\">Continue reading <span class=\"meta-nav\">&#8594;</span></a></p>",
  "content:encoded": "<p>In my last job, I was a frequent flyer. Each week I flew between 2 or 3 countries, briefly returning for 24 hours on the weekend to get a change of clothes. My favourite airlines were <a href=\"https://www.cathaypacific.com\">Cathay Pacific</a>, <a href=\"https://www.emirates.com\">Emirates</a> and <a href=\"http://www.singaporeair.com\">Singapore Air</a>. Now, unless you have been living in a cave, you&#8217;d be well aware of the recent news story of how <a href=\"https://www.united.com\">United Airlines</a> <a href=\"http://edition.cnn.com/2017/04/28/opinions/united-airlines-settlement-cevallos/index.html\">removed David Dao from an aircraft</a>. I wondered how that incident had affected United&#8217;s brand value, and being a data scientist I decided to do sentiment analysis of United versus my favourite airlines.</p>\n<p>Way back on 4th July 2015, almost two years ago, I wrote a blog entitled <a href=\"https://colinpriest.com/2015/07/04/tutorial-using-r-and-twitter-to-analyse-consumer-sentiment/\" target=\"_blank\" rel=\"noopener noreferrer\">Tutorial: Using R and Twitter to Analyse Consumer Sentiment</a>. Even though that blog post is one of my earliest, it continues to be the most popular, attracting just as many readers per day as when I first wrote it.</p>\n<p>Since the <a href=\"https://cran.r-project.org/web/packages/RSentiment/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">sentiment package</a>, upon which that blog was based, is no longer supported by CRAN, and many readers have problems with the manual and technical process of installing an obsolete package from an archive, I have written a new blog using a different, live CRAN package. The <a href=\"https://cran.r-project.org/web/packages/syuzhet/index.html\">syuzhet package</a> was published only several weeks ago, and offers a range of different sentiment analysis models. So I&#8217;ve started to try it out.</p>\n<p>I have collected tweets for 4 airlines:</p>\n<ol>\n<li>Cathay Pacific</li>\n<li>Emirates</li>\n<li>Singapore Air</li>\n<li>United Airlines</li>\n</ol>\n<p>The tweet data starts at 01-Jan-2015 and go up to mid-April 2017.</p>\n<p><strong>Step 1:</strong> Load the tweets and load the relevant packages</p>\n<pre class=\"brush: r; title: ; notranslate\">\nlibrary(foreign)\nlibrary(syuzhet)\nlibrary(lubridate)\nlibrary(plyr)\nlibrary(ggplot2)\nlibrary(tm)\nlibrary(wordcloud)\n\n# get the data for the tweets\ndataURL = 'https://s3-ap-southeast-1.amazonaws.com/colinpriest/tweets.zip'\nif (! file.exists('tweets.zip')) download.file(dataURL, 'tweets.zip')\nif (! file.exists('tweets.dbf')) unzip('tweets.zip')\ntweets = read.dbf('tweets.dbf', as.is = TRUE)\n</pre>\n<p>&nbsp;</p>\n<p>I&#8217;ve stored the tweets in a dbf file and zipped it. The zip file is 68MB in size, and the dbf file is 353MB. The code shown above downloads the zip file, extracts the dbf and then reads the dbf file into a data.frame.</p>\n<p><strong>Step 2:</strong> Do Sentiment Scoring using the syuzhet package</p>\n<pre class=\"brush: r; title: ; notranslate\">\n\n# function to get various sentiment scores, using the syuzhet package\nscoreSentiment = function(tab)\n{\n tab$syuzhet = get_sentiment(tab$Text, method=\"syuzhet\")\n tab$bing = get_sentiment(tab$Text, method=\"bing\")\n tab$afinn = get_sentiment(tab$Text, method=\"afinn\")\n tab$nrc = get_sentiment(tab$Text, method=\"nrc\")\n emotions = get_nrc_sentiment(tab$Text)\n n = names(emotions)\n for (nn in n) tab[, nn] = emotions[nn]\n return(tab)\n}\n\n# get the sentiment scores for the tweets\ntweets = scoreSentiment(tweets)\ntweets = tweets[tweets$TimeStamp < as.Date('19-04-2017', format = '%d-%m-%Y'),]\n\n</pre>\n<p>The syuzhet package offers a few different algorithms, each taking a different approach to sentiment scoring. It also does emotion scoring based upon the nrc algorithm. The code above calculates scores using the syuzhet, bing, afinn and nrc algorithms, adding columns with the scores from each algorithm.</p>\n<p><strong>Step 3:</strong> Visualise the Sentiment Scores</p>\n<pre class=\"brush: r; title: ; notranslate\">\n\n# function to find the week in which a date occurs\nround_weeks <- function(x)\n{\nrequire(data.table)\ndt = data.table(i = 1:length(x), day = x, weekday = weekdays(x))\noffset = data.table(weekday = c('Sunday', 'Monday', 'Tuesday', 'Wednesday',\n'Thursday', 'Friday', 'Saturday'),\noffset = -(0:6))\ndt = merge(dt, offset, by=\"weekday\")\ndt[ , day_adj := day + offset]\nsetkey(dt, i)\nreturn(dt[ , day_adj])\n}\n# get daily summaries of the results\ndaily = ddply(tweets, ~ Airline + TimeStamp, summarize, num_tweets = length(positive), ave_sentiment = mean(bing),\n ave_negative = mean(negative), ave_positive = mean(positive), ave_anger = mean(anger))\n\n# plot the daily sentiment\nggplot(daily, aes(x=TimeStamp, y=ave_sentiment, colour=Airline)) + geom_line() +\n ggtitle(\"Airline Sentiment\") + xlab(\"Date\") + ylab(\"Sentiment\") + scale_x_date(date_labels = '%d-%b-%y')\n\n# get weekly summaries of the results\nweekly = ddply(tweets, ~ Airline + week, summarize, num_tweets = length(positive), ave_sentiment = mean(bing),\n ave_negative = mean(negative), ave_positive = mean(positive), ave_anger = mean(anger))\n\n# plot the weekly sentiment\nggplot(weekly, aes(x=week, y=ave_sentiment, colour=Airline)) + geom_line() +\n ggtitle(\"Airline Sentiment\") + xlab(\"Date\") + ylab(\"Sentiment\") + scale_x_date(date_labels = '%d-%b-%y')\n</pre>\n<p>The code above summarises the sentiment for each airline across time. The first plot shows the daily sentiment values for each airline:</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1060\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-01-daily-sentiment/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 01 daily sentiment\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png?w=529\" class=\"alignnone size-full wp-image-1060\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png\" alt=\"20170429 plot 01 daily sentiment\" width=\"695\" height=\"531\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png 695w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png?w=150&h=115 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-01-daily-sentiment.png?w=300&h=229 300w\" sizes=\"(max-width: 695px) 100vw, 695px\" /></p>\n<p>Based upon the bing sentiment algorithm, United has the poorest sentiment, and Singapore has the best sentiment. United usually has negative sentiment. Daily to day random fluctuations in sentiment make this a cluttered graph, so I decided to summarise the sentiment weekly instead of daily:</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1061\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-02-weekly-sentiment/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 02 weekly sentiment\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png?w=529\" class=\"alignnone size-full wp-image-1061\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png\" alt=\"20170429 plot 02 weekly sentiment\" width=\"695\" height=\"531\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png 695w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png?w=150&h=115 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-02-weekly-sentiment.png?w=300&h=229 300w\" sizes=\"(max-width: 695px) 100vw, 695px\" /></p>\n<p>Now it&#8217;s easier to see the differences in sentiment between the four airlines. While Emirates and Cathay Pacific have similar levels of sentiment, the values for Emirates are more stable. This, however, may be due to the sheer volume of tweets about Emirates versus the smaller number of tweets about Cathay Pacific.</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1062\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-03-positive-sentiment/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 03 positive sentiment\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=529\" class=\"alignnone size-full wp-image-1062\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png\" alt=\"20170429 plot 03 positive sentiment\" width=\"695\" height=\"531\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png 695w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=150&h=115 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=300&h=229 300w\" sizes=\"(max-width: 695px) 100vw, 695px\" /></p>\n<p><strong>Step 4:</strong> Compare the Sentiment Algorithms</p>\n<p>The sentiment scores above use the bing algorithm, but we should check whether the different algorithms produce different results.</p>\n<pre class=\"brush: r; title: ; notranslate\">\n\n# compare the sentiment for across the algorithms\nalgorithms = tweets[rep(1, nrow(tweets) * 4), c(\"week\", \"syuzhet\", \"Airline\", \"Airline\")]\nnames(algorithms) = c(\"TimeStamp\", \"Sentiment\", \"Algorithm\", \"Airline\")\nalgorithms$Algorithm = \"syuzhet\"\nalgorithms[seq_len(nrow(tweets)), c(\"TimeStamp\", \"Sentiment\", \"Airline\")] = tweets[,c(\"TimeStamp\", \"syuzhet\", \"Airline\")]\nalgorithms[nrow(tweets) + seq_len(nrow(tweets)), c(\"TimeStamp\", \"Sentiment\", \"Airline\")] = tweets[,c(\"TimeStamp\", \"bing\", \"Airline\")]\nalgorithms$Algorithm[nrow(tweets) + seq_len(nrow(tweets))] = \"bing\"\nalgorithms[2 * nrow(tweets) + seq_len(nrow(tweets)), c(\"TimeStamp\", \"Sentiment\", \"Airline\")] = tweets[,c(\"TimeStamp\", \"afinn\", \"Airline\")]\nalgorithms$Algorithm[2 * nrow(tweets) + seq_len(nrow(tweets))] = \"afinn\"\nalgorithms[3 * nrow(tweets) + seq_len(nrow(tweets)), c(\"TimeStamp\", \"Sentiment\", \"Airline\")] = tweets[,c(\"TimeStamp\", \"nrc\", \"Airline\")]\nalgorithms$Algorithm[3 * nrow(tweets) + seq_len(nrow(tweets))] = \"nrc\"\n\n# get the algorithm averages for each airline\naverages = ddply(algorithms, ~ Airline + Algorithm, summarize, ave_sentiment = mean(Sentiment))\naverages$ranking = 1\nfor (alg in c(\"syuzhet\", \"bing\", \"afinn\", \"nrc\")) averages$ranking[averages$Algorithm == alg] = 5 - rank(averages$ave_sentiment[averages$Algorithm == alg])\naverages = averages[order(averages$Airline, averages$Algorithm), ]\n\n</pre>\n<p>The code above was a bit clumsy &#8211; I probably should have used reshape.</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1089\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-08-sentiment-algorithm-comparisons/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png\" data-orig-size=\"310,391\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 08 sentiment algorithm comparisons\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png?w=238\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png?w=310\" class=\"alignnone size-full wp-image-1089\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png\" alt=\"20170429 plot 08 sentiment algorithm comparisons\" width=\"310\" height=\"391\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png 310w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png?w=119&h=150 119w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-08-sentiment-algorithm-comparisons.png?w=238&h=300 238w\" sizes=\"(max-width: 310px) 100vw, 310px\" /></p>\n<p>The different algorithms give similar rankings between the airlines with one big exception: the nrc algorithm is surprisingly positive about United and unusually negative about Singapore Air compared to the other algorithms. This goes to show that sentiment analysis isn&#8217;t just a plug and play technique and also means that a warning should be applied to the emotion analysis shown in Step 5 below, as it is based upon the nrc algorithm!</p>\n<p><strong>Step 5:</strong> Emotion Analysis</p>\n<p>Noting the warning, from the previous section, let&#8217;s compare the emotions between the airlines and between tweets, using the nrc algorithm.</p>\n<pre class=\"brush: r; title: ; notranslate\">\n\nggplot(weekly, aes(x=week, y=ave_negative, colour=Airline)) + geom_line() +\nggtitle(\"Airline Sentiment (Positive Only)\") + xlab(\"Date\") + ylab(\"Sentiment\") + scale_x_date(date_labels = '%d-%b-%y')\n\nggplot(weekly, aes(x=week, y=ave_positive, colour=Airline)) + geom_line() +\nggtitle(\"Airline Sentiment (Negative Only)\") + xlab(\"Date\") + ylab(\"Sentiment\") + scale_x_date(date_labels = '%d-%b-%y')\n\nggplot(weekly, aes(x=week, y=ave_anger, colour=Airline)) + geom_line() +\nggtitle(\"Airline Sentiment (Anger Only)\") + xlab(\"Date\") + ylab(\"Sentiment\") + scale_x_date(date_labels = '%d-%b-%y')\n\n# function to make the text suitable for analysis\nclean.text = function(x)\n{\n# tolower\nx = tolower(x)\n# remove rt\nx = gsub(\"rt\", \"\", x)\n# remove at\nx = gsub(\"@\\\\w+\", \"\", x)\n# remove punctuation\nx = gsub(\"[[:punct:]]\", \"\", x)\n# remove numbers\nx = gsub(\"[[:digit:]]\", \"\", x)\n# remove links http\nx = gsub(\"http\\\\w+\", \"\", x)\n# remove tabs\nx = gsub(\"[ |\\t]{2,}\", \"\", x)\n# remove blank spaces at the beginning\nx = gsub(\"^ \", \"\", x)\n# remove blank spaces at the end\nx = gsub(\" $\", \"\", x)\nreturn(x)\n}\n\n# emotion analysis: anger, anticipation, disgust, fear, joy, sadness, surprise, trust\n# put everything in a single vector\nall = c(\npaste(tweets$Text[tweets$anger > 0], collapse=\" \"),\npaste(tweets$Text[tweets$anticipation > 0], collapse=\" \"),\npaste(tweets$Text[tweets$disgust > 0], collapse=\" \"),\npaste(tweets$Text[tweets$fear > 0], collapse=\" \"),\npaste(tweets$Text[tweets$joy > 0], collapse=\" \"),\npaste(tweets$Text[tweets$sadness > 0], collapse=\" \"),\npaste(tweets$Text[tweets$surprise > 0], collapse=\" \"),\npaste(tweets$Text[tweets$trust > 0], collapse=\" \")\n)\n# clean the text\nall = clean.text(all)\n# remove stop-words\n# adding extra domain specific stop words\nall = removeWords(all, c(stopwords(\"english\"), 'singapore', 'singaporeair',\n'emirates', 'united', 'airlines', 'unitedairlines',\n'cathay', 'pacific', 'cathaypacific', 'airline',\n'airlinesunited', 'emiratesemirates', 'pacifics'))\n#\n# create corpus\ncorpus = Corpus(VectorSource(all))\n#\n# create term-document matrix\ntdm = TermDocumentMatrix(corpus)\n#\n# convert as matrix\ntdm = as.matrix(tdm)\n#\n# add column names\ncolnames(tdm) = c('anger', 'anticipation', 'disgust', 'fear', 'joy', 'sadness', 'surprise', 'trust')\n#\n# Plot comparison wordcloud\nlayout(matrix(c(1, 2), nrow=2), heights=c(1, 4))\npar(mar=rep(0, 4))\nplot.new()\ntext(x=0.5, y=0.5, 'Emotion Comparison Word Cloud')\ncomparison.cloud(tdm, random.order=FALSE,\ncolors = c(\"#00B2FF\", \"red\", \"#FF0099\", \"#6600CC\", \"green\", \"orange\", \"blue\", \"brown\"),\ntitle.size=1.5, max.words=250)\n\n&nbsp;\n\n</pre>\n<p>The code above plots the emotions across time for each airline.</p>\n<p>\n<a href='https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-05-anger/'><img width=\"150\" height=\"115\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-05-anger.png?w=150\" class=\"attachment-thumbnail size-thumbnail\" alt=\"\" loading=\"lazy\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-05-anger.png?w=150 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-05-anger.png?w=300 300w\" sizes=\"(max-width: 150px) 100vw, 150px\" data-attachment-id=\"1064\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-05-anger/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-05-anger.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 05 anger\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-05-anger.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-05-anger.png?w=529\" /></a>\n<a href='https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-03-positive-sentiment/'><img width=\"150\" height=\"115\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=150\" class=\"attachment-thumbnail size-thumbnail\" alt=\"\" loading=\"lazy\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=150 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=300 300w\" sizes=\"(max-width: 150px) 100vw, 150px\" data-attachment-id=\"1062\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-03-positive-sentiment/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 03 positive sentiment\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-03-positive-sentiment.png?w=529\" /></a>\n<a href='https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-04-negative-sentiment/'><img width=\"150\" height=\"115\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-04-negative-sentiment.png?w=150\" class=\"attachment-thumbnail size-thumbnail\" alt=\"\" loading=\"lazy\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-04-negative-sentiment.png?w=150 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-04-negative-sentiment.png?w=300 300w\" sizes=\"(max-width: 150px) 100vw, 150px\" data-attachment-id=\"1063\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-04-negative-sentiment/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-04-negative-sentiment.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 04 negative sentiment\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-04-negative-sentiment.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-04-negative-sentiment.png?w=529\" /></a>\n</p>\n<p>United Airlines attracts more angry tweets, and this has spiked in April 2017 following the David Dao incident. But United Airlines also attracts more positive tweets than the other airlines. This might explain the ranking differences between the algorithms &#8211; maybe the algorithms weight positive tweets differently to negative tweets.</p>\n<p>Then the code creates a comparison word cloud, to show the different words in airline tweets that are associated with each emotion.</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1141\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-09-emotions/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 09 emotions\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png?w=529\" class=\"alignnone size-full wp-image-1141\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png\" alt=\"20170429 plot 09 emotions\" width=\"695\" height=\"531\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png 695w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png?w=150&h=115 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-09-emotions.png?w=300&h=229 300w\" sizes=\"(max-width: 695px) 100vw, 695px\" /></p>\n<p><strong>Step 6:</strong> Compare the Different Tweeting Behaviour of Different Twitter Users</p>\n<p>Are some users more positive than others? Is this user behaviour different between the airlines? Do people who tweet more have a different sentiment to those who tweet about airlines less frequently? Are particular users dragging the average up or down? To answer these questions, I have tracked the 100 users who tweeted the most about these airlines.</p>\n<pre class=\"brush: r; title: ; notranslate\">\n\n# get the user summaries of the results\nusers = ddply(tweets, ~ Airline + UserName, summarize, num_tweets = length(positive), ave_sentiment = mean(bing),\nave_negative = mean(negative), ave_positive = mean(positive), ave_anger = mean(anger))\nsizeSentiment = ddply(users, ~ num_tweets, summarize, ave_sentiment = mean(ave_sentiment),\nave_negative = mean(ave_negative), ave_positive = mean(ave_positive), ave_anger = mean(ave_anger))\nsizeSentiment$num_tweets = as.numeric(sizeSentiment$num_tweets)\n\n# plot users positive versus negative with bubble plot\ncutoff = sort(users$num_tweets, decreasing = TRUE)[100]\nggplot(users[users$num_tweets > cutoff,], aes(x = ave_positive, y = ave_negative, size = num_tweets, fill = Airline)) +\ngeom_point(shape = 21) +\nggtitle(\"100 Most Prolific Tweeters About Airlines\") +\nlabs(x = \"Positive Sentiment\", y = \"Negative Sentiment\")\n#\nggplot(sizeSentiment, aes(x = num_tweets, y = ave_sentiment)) + geom_point() + stat_smooth(method = \"loess\", size = 1, span = 0.35) +\nggtitle(\"Number of Tweets versus Sentiment\") + scale_x_log10() +\nlabs(x = \"Positive Sentiment\", y = \"Negative Sentiment\")\n\n</pre>\n<p>Firstly let&#8217;s look at the behaviour of individual users:</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1065\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-06-top-100-tweeters/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 06 top 100 tweeters\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png?w=529\" class=\"alignnone size-full wp-image-1065\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png\" alt=\"20170429 plot 06 top 100 tweeters\" width=\"695\" height=\"531\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png 695w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png?w=150&h=115 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-06-top-100-tweeters.png?w=300&h=229 300w\" sizes=\"(max-width: 695px) 100vw, 695px\" /></p>\n<p>Top user sentiment is quite different by airline. Emirates has a number of frequent tweeters who are unemotional, who on average post neither positive nor negative sentiment. United Airlines attracts more emotional posts. Singapore Air and Cathay Pacific have big users that post a lot of tweets about them.</p>\n<p><img loading=\"lazy\" data-attachment-id=\"1066\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-07-sentiment-versus-tweet-count/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 07 sentiment versus tweet count\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png?w=529\" class=\"alignnone size-full wp-image-1066\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png\" alt=\"20170429 plot 07 sentiment versus tweet count\" width=\"695\" height=\"531\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png 695w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png?w=150&h=115 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-07-sentiment-versus-tweet-count.png?w=300&h=229 300w\" sizes=\"(max-width: 695px) 100vw, 695px\" /></p>\n<p>However, on average bigger frequent tweeters post a similar balance of positive and negative content to smaller users who tweet infrequently.</p>\n<p><strong>Step 7:</strong> Compare The Words Used to Describe Each Airline</p>\n<p>In order to explain the differences in sentiment, we can create a word cloud that contrasts the words used in posts about each airline.</p>\n<pre class=\"brush: r; title: ; notranslate\">\n\n# Join texts in a vector for each company\ntxt1 = paste(tweets$Text[tweets$Airline == 'United'], collapse=\" \")\ntxt2 = paste(tweets$Text[tweets$Airline == 'SingaporeAir'], collapse=\" \")\ntxt3 = paste(tweets$Text[tweets$Airline == 'Emirates'], collapse=\" \")\ntxt4 = paste(tweets$Text[tweets$Airline == 'Cathay Pacific'], collapse=\" \")\n#\n# put everything in a single vector\nall = c(clean.text(txt1), clean.text(txt2), clean.text(txt3), clean.text(txt4))\n#\n# remove stop-words\n# adding extra domain specific stop words\nall = removeWords(all, c(stopwords(\"english\"), 'singapore', 'singaporeair',\n'emirates', 'united', 'airlines', 'unitedairlines',\n'cathay', 'pacific', 'cathaypacific', 'airline',\n'airlinesunited', 'emiratesemirates', 'pacifics'))\n#\n# create corpus\ncorpus = Corpus(VectorSource(all))\n#\n# create term-document matrix\ntdm = TermDocumentMatrix(corpus)\n#\n# convert as matrix\ntdm = as.matrix(tdm)\n#\n# add column names\ncolnames(tdm) = c('United', 'Singapore Air', 'Emirates', 'Cathay Pacific')\n#\n# Plot comparison wordcloud\nlayout(matrix(c(1, 2), nrow=2), heights=c(1, 4))\npar(mar=rep(0, 4))\nplot.new()\ntext(x=0.5, y=0.5, 'Word Comparison by Airline')\ncomparison.cloud(tdm, random.order=FALSE,\ncolors = c(\"#00B2FF\", \"red\", \"#FF0099\", \"#6600CC\"),\ntitle.size=1.5, max.words=250)\n#\n# Plot commonality cloud\nlayout(matrix(c(1, 2), nrow=2), heights=c(1, 4))\npar(mar=rep(0, 4))\nplot.new()\ntext(x=0.5, y=0.5, 'Word Commonality by Airline')\ncommonality.cloud(tdm, random.order=FALSE,\ncolors = brewer.pal(8, \"Dark2\"),\ntitle.size=1.5, max.words=250)\n\n</pre>\n<p>The code above is quite similar to that in the previous step, except that this time we are comparing airlines instead of emotions.</p>\n<p>\n<a href='https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-10-airline-word-contrast/'><img width=\"150\" height=\"115\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-10-airline-word-contrast.png?w=150\" class=\"attachment-thumbnail size-thumbnail\" alt=\"\" loading=\"lazy\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-10-airline-word-contrast.png?w=150 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-10-airline-word-contrast.png?w=300 300w\" sizes=\"(max-width: 150px) 100vw, 150px\" data-attachment-id=\"1151\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-10-airline-word-contrast/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-10-airline-word-contrast.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 10 airline word contrast\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-10-airline-word-contrast.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-10-airline-word-contrast.png?w=529\" /></a>\n<a href='https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-11-airline-word-commonality/'><img width=\"150\" height=\"115\" src=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-11-airline-word-commonality.png?w=150\" class=\"attachment-thumbnail size-thumbnail\" alt=\"\" loading=\"lazy\" srcset=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-11-airline-word-commonality.png?w=150 150w, https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-11-airline-word-commonality.png?w=300 300w\" sizes=\"(max-width: 150px) 100vw, 150px\" data-attachment-id=\"1152\" data-permalink=\"https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/20170429-plot-11-airline-word-commonality/\" data-orig-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-11-airline-word-commonality.png\" data-orig-size=\"695,531\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"20170429 plot 11 airline word commonality\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-11-airline-word-commonality.png?w=300\" data-large-file=\"https://colinpriestdotcom.files.wordpress.com/2017/04/20170429-plot-11-airline-word-commonality.png?w=529\" /></a>\n</p>\n<p>Emirates includes &#8220;aniston&#8221;, presumably in reference to the <a href=\"https://youtu.be/yz_qZQbiZuA\" target=\"_blank\" rel=\"noopener noreferrer\">marketing campaign involving Jennifer Aniston</a>, while United includes &#8220;CEO&#8221; due to a number of news stories about United CEO&#8217;s including a <a href=\"https://www.forbes.com/sites/maggiemcgrath/2015/09/08/united-airlines-ceo-resigns-in-wake-of-federal-investigation/#4f72e1c23dcf\" target=\"_blank\" rel=\"noopener noreferrer\">resignation</a> and a <a href=\"http://fortune.com/united-airlines-ceo-oscar-munoz/\" target=\"_blank\" rel=\"noopener noreferrer\">heart transplant</a>.</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n",
  "wfw:commentRss": "https://colinpriest.com/2017/04/30/tutorial-sentiment-analysis-of-airlines-using-the-syuzhet-package-and-twitter/feed/",
  "slash:comments": 32,
  "media:thumbnail": "",
  "media:content": [
    {
      "media:title": "Airplane Clipart 1336"
    },
    {
      "media:title": "colinpriest1966"
    },
    {
      "media:title": "20170429 plot 01 daily sentiment"
    },
    {
      "media:title": "20170429 plot 02 weekly sentiment"
    },
    {
      "media:title": "20170429 plot 03 positive sentiment"
    },
    {
      "media:title": "20170429 plot 08 sentiment algorithm comparisons"
    },
    "",
    "",
    "",
    {
      "media:title": "20170429 plot 09 emotions"
    },
    {
      "media:title": "20170429 plot 06 top 100 tweeters"
    },
    {
      "media:title": "20170429 plot 07 sentiment versus tweet count"
    },
    "",
    ""
  ]
}