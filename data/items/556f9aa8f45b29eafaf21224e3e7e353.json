{
  "title": "Introducing Turing Image Super Resolution: AI powered image enhancements for Microsoft Edge and Bing Maps",
  "link": "https://blogs.bing.com/search-quality-insights/may-2022/Turing-Image-Super-Resolution",
  "pubDate": "Thu, 19 May 2022 08:00:00 -0700",
  "dc:creator": "Bing Team",
  "category": [
    "AI",
    "artificial intelligence",
    "Image",
    "maps",
    "Resolution",
    "Super",
    "Turing"
  ],
  "guid": "d8f53306-f6f7-480b-ac02-38578306cc20",
  "description": "<samp>The Microsoft Turing team has a new addition to its family of image and language models. The Turing Image Super Resolution model (T-ISR) uses deep learning to deliver the magical &ldquo;enhance&rdquo; to any image in the world. It is already being used today to improve the quality of the aerial view in Bing Maps around the globe and is also rolling out in Microsoft Edge to bring its powers to the entire web. See examples of the model in action, learn how it works, and join us in dreaming about the future possibilities this model will enable.</samp>",
  "content:encoded": "<style type=\"text/css\">.grid-container-2 {\n  display: grid;\n  grid-template-columns: auto auto;\n  padding: 5px;\n}\n.grid-container-3{\n  display: grid;\n  grid-template-columns: auto auto auto;\n  padding: 5px;\n}\n.grid-item {\n  padding: 20px 5px 20px 5px;\n  font-size: 12px;\n  text-align: center;\n}\n.grid-img{\nwidth:100%;\nheight:100%;\n}\n\n.img-center {\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  width: 50%;\n}\n</style>\n<p><samp>As the saying goes, &ldquo;a picture is worth a thousand words&rdquo;. Pictures help us to capture our favorite memories and experience the world around us. But that memory or experience is degraded significantly when we encounter a low quality image. Maybe the photo was taken with an old camera, the dimensions of the image are too small, or the file was overly compressed at some point. We can all probably think of a time when we had the perfect image - a prized portrait of a family member to be framed or the best screenshot to illustrate your point in a presentation - but could not use it because the quality was too low. Using the power of Deep Learning, the <a href=\"https://turing.microsoft.com/\">Microsoft Turing</a> team has built a new model to help in these scenarios.</samp><br />\n&nbsp;</p>\n\n<div><a href=\"https://blogs.bing.com/BingBlogs/files/e2/e220f2e0-fe2f-451c-9b66-b366e5998293.png\" target=\"_blank\"><img alt=\"Salad_Combined.png\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Salad_Combined.png.aspx?lang=en-US\" title=\"Salad_Combined.png\" /></a></div>\n\n<div class=\"grid-container-2\">\n<div class=\"grid-item\"><img alt=\"Original\" class=\"center\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Leaf-Water-Before.png.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"center\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Leaf-Water-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n\n<div class=\"grid-item\"><img alt=\"Original\" class=\"center\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Shoes-Before.png.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"center\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Shoes-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n</div>\n\n<p><samp>We call this model Turing Image Super-Resolution (T-ISR), another addition to the Microsoft Turing family of image and language models <a href=\"https://blogs.microsoft.com/ai-for-business/ai-at-scale-explained/\">powering various AI experiences</a> across the company. At Microsoft we have been steadily rolling out this capability in a variety of our products and have seen a strong positive response from our users:</samp></p>\n\n<ul>\n\t<li><samp>In Bing Maps, we are using the model to improve the quality of our <a href=\"https://www.bing.com/maps?osid=57866c43-69ac-46e9-8edb-633c97d3b07a&cp=41.902558~12.45263&lvl=19&style=a&imgid=035d20b4-675b-44c5-a705-70d67896cc07&v=2&sV=2&form=S00027\">aerial imagery</a> for our users around the world! The model is robust to all types of terrain and in our side-by-side tests with users, the super-resolved aerial images are preferred over the original imagery 98% of the time. We have rolled out the model to most of the world&rsquo;s land area, benefiting the vast majority of our users across the globe. In addition, we are able to bring this experience not only to our Bing Maps users, but also to our customers on Azure who leverage Azure Maps satellite imagery for their own products and services.</samp></li>\n</ul>\n\n<ul>\n\t<li><samp>In Microsoft Edge, we are starting to roll out the model to allow users to enhance the images they see on the web with the goal of turning Microsoft Edge into the best browser for viewing images on the web. We have seen early promising feedback from our users and are continuing to improve the experience as it scales to serve all images on the internet!</samp> &nbsp;</li>\n</ul>\n\n<div class=\"grid-container-2\">\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Maps1-Before-(1).png.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Maps1-After-(1).png.aspx?lang=en-US\" />Turing-ISR</div>\n\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Maps2-Before.jpg.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Maps2-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Maps3-Before.png.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Maps3-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Cricket-Before.jpg.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Cricket-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Statues-Before.png.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Statues-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n</div>\n\n<div style=\"clear:both;\">&nbsp;\n<h4><strong>Model Details</strong></h4>\n\n<p><br />\n<samp>In our exploration of the super-resolution problem space, there were four major findings that played a key role in the development of our state-of-the-art (SOTA) model:</samp></p>\n\n<ol>\n\t<li><strong>Human eyes as the north star</strong>: The metrics widely used in industry and academic models, PSNR and SSIM, were not always aligned with the perception and preference of the human eye and also required a ground truth image to be computed. In response, we built a side-by-side evaluation tool that measured the preferences of human judges and we used this tool as the north star metric to build and improve our model. &nbsp;</li>\n\t<li><strong>Noise modeling</strong>: In the first version of our training recipe, we created low-resolution and high-resolution pairs for training by simply taking a large number of high-quality images and downscaling them. We then trained the model with the downscaled image as input and an objective of recovering the ground truth as closely as possible. While this approach produced good results in many cases, we found that it was not robust enough to handle many of the &ldquo;true&rdquo; low-resolution images we were testing with, like ones coming from the web or old cameras. We found that by randomly applying distortions on our training input images such as blurring, compression, and gaussian noise, our model learned how to recover details for a much wider set of low-quality images.&nbsp;</li>\n\t<li><strong>Perceptual and GAN loss</strong>: Like the first finding, we found that optimizing our models solely using pixel loss between the output images and ground truth images was not enough to produce the optimal output that aligned with a human eye&rsquo;s perception. In response, we also introduced perceptual and GAN loss and tuned an optimal weighted combination of the three losses as an objective function.&nbsp;</li>\n\t<li><strong>Transformers for vision</strong>: When we began working on super-resolution, we saw that most approaches were still using CNN architectures. Given the Microsoft Turing team&rsquo;s <a href=\"https://www.microsoft.com/en-us/research/blog/using-deepspeed-and-megatron-to-train-megatron-turing-nlg-530b-the-worlds-largest-and-most-powerful-generative-language-model/\">expertise</a> and <a href=\"https://sites.research.google/xtreme\">success</a> applying transformers in large, language models and our recent use of transformers in our <a href=\"https://www.microsoft.com/en-us/research/blog/turing-bletchley-a-universal-image-language-representation-model-by-microsoft/\">multi-modal Turing Bletchley model</a>, we experimented with transformers and found it had some compelling advantages (along with some disadvantages). Ultimately, we incorporated the positive aspects of both architectures by breaking the problem space into two stages: 1) Enhance and 2) Zoom.&nbsp;</li>\n</ol>\n\n<h5><strong>DeepEnhance &ndash; Cleaning and Enhancing Images</strong>&nbsp;</h5>\n\n<p>When testing with very noisy images like highly compressed photos or aerial photos taken from long range satellites, we found that transformer-based models did a very good job at &ldquo;cleaning&rdquo; up the noise tailored to what was in the image. For example, noise around a person&rsquo;s face was handled differently than the noise on a highly textured photo of a forest. We believe this is because of the large datasets we trained on and the superior long-range memory capabilities of transformer architectures. So as a first step, we use a sparse transformer which we scaled up to support extremely large sequence lengths (to adequately process the large context of an image) to &ldquo;enhance&rdquo; the image. The result is a cleaner, crisper, and much more attractive output image whose size is the same as the input. In some product scenarios, a larger image is not needed, so in those cases we stop here.</p>\n<img alt=\"DiagramDescription automatically generated\" class=\"center\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/DeepEnhance-Diagram.png.aspx?lang=en-US\" />\n<div style=\"text-align: center;\"><cite><em>T-ISR DeepEnhance Transformer </em></cite></div>\n<br />\n<br />\n&nbsp;\n<div class=\"grid-container-2\">\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Ant-Before.jpg.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Ant-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n\n<div class=\"grid-item\"><img alt=\"Original\" class=\"left grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Fox-Before.png.aspx?lang=en-US\" />Original</div>\n\n<div class=\"grid-item\"><img alt=\"using T-ISR\" class=\"right grid-img\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Fox-After.png.aspx?lang=en-US\" />Turing-ISR</div>\n</div>\n\n<div style=\"clear:both;\">&nbsp;</div>\n&nbsp;\n\n<h5><strong>DeepZoom &ndash; Scaling up Images</strong></h5>\n\n<p>In other product scenarios, we want an image that is larger than the original image; we want to &ldquo;zoom&rdquo; the image. While there are many methods to zoom an image, the most commonly used method is bicubic interpolation. When you drag the corner of the image on your favorite image editing software, you are likely using bicubic interpolation. In bicubic interpolation, pixels are inferred based on the surrounding pixels. The result is usually a grainy image missing a large amount of detail that gets worse the larger the scaling factor is. Rather than naively interpolating pixels solely based on the surrounding pixels, we trained a 200-layer CNN to learn the best way to recover &ldquo;lost&rdquo; pixel detail. The result is a model that knows the best way to recover pixels for the specific types and scenes of an image.</p>\n&nbsp;\n\n<div style=\"text-align: center;\"><img alt=\"ChartDescription automatically generated\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/DeepZoom-Diagram-(1).png.aspx?lang=en-US\" /><cite><em>T-ISR DeepZoom CNN</em></cite><br />\n<br />\n<br />\n<img alt=\"Yellow-Flower-Combined.png\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Leaf-Combined-2.png.aspx?lang=en-US\" title=\"Yellow-Flower-Combined.png\" /><br />\n<img alt=\"Curtain-Combined.png\" class=\"grid-item\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Curtain-Combined.png.aspx\" title=\"Curtain-Combined.png\" /></div>\n&nbsp;<br />\n<img alt=\"Curtain-Combined.png\" class=\"grid-item\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Dog-Combined-2.png.aspx?lang=en-US\" title=\"Curtain-Combined.png\" /></div>\n<img alt=\"Worksheet-Combined.png\" class=\"grid-item\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/Worksheet-Combined.png.aspx\" title=\"Worksheet-Combined.png\" /> &nbsp;\n<h4><strong>Generalization Ability</strong>&nbsp;</h4>\n\n<p>The T-ISR model was trained on a massive and diverse amount of data across several different tasks. Because of this, the same T-ISR model can be shipped in Bing Maps, Microsoft Edge and potentially other experiences as well. In fact, this diversity in domains helped to push fundamental model improvements. For example, improvements we made to the training recipe to handle specific challenges in the heavily forested rural areas of our satellite images also helped to improve the quality of our model output for &ldquo;natural&rdquo; images, like ones of people, animals, and buildings. We believe this approach is one of the main reasons our model performs so well on traditional benchmarks.</p>\n\n<h4><strong>Optimization and Shipping</strong>&nbsp;</h4>\n\n<p>To ship super-resolution at scale to our users, there were several optimizations we needed to make the model cost-efficient. The first set of optimizations were all around reducing model size and latency. As you can see from the graph below, after quantization, using ONNX Runtime (ORT), and model pruning with the help of the <a href=\"https://www.microsoft.com/en-us/research/project/deepspeed/\">Microsoft DeepSpeed</a> team we were able to reduce the model latency by 16x.</p>\n\n<div style=\"text-align: center;\"><img alt=\"image074.png\" class=\"img-center\" src=\"https://blogs.bing.com/getattachment/search-quality-insights/may-2022/Turing-Image-Super-Resolution/image074.png.aspx?width=683&height=383\" title=\"image074.png\" /></div>\n\n<div style=\"text-align: center;\"><cite><em>Optimizing T-ISR</em></cite><br />\n&nbsp;</div>\n\n<p>In addition to core model optimizations, we also did some further engineering optimizations to enable the experience to scale. For shipping in Bing Maps, while we had massive amounts of data to process, we had the benefit of being able to process this data offline as large batch jobs. Bing&rsquo;s <a href=\"https://www.microsoft.com/en-us/research/publication/deep-learning-inference-service-at-microsoft/\">Deep Learning Inferencing Service</a> (DLIS) enabled us to exploit this fact and harvest idle GPU time to run our jobs: a win-win for the platform and our users! For shipping in Microsoft Edge, we&rsquo;re using CDNs&nbsp;so that the same image does not need to be processed repeatedly, cutting down latency and processing load significantly.</p>\n\n<h4><strong>Responsible AI</strong></h4>\n\n<p>From our work with large language models, the Microsoft Turing team is aware of the issues that plague large, generalizable deep learning models. We, like the rest of the AI community, have invested and continue to invest in efforts to study and prevent these harms and these efforts extend to the T-ISR model.&nbsp;<br />\n<br />\nIn a world of deepfakes and other similar harms, we are cognizant of the challenges posed in the image space. While shipping T-ISR in production scenarios, we have carefully followed the measures outlined by the <a href=\"https://www.microsoft.com/en-us/ai/responsible-ai?activetab=pivot1%3aprimaryr6\">Microsoft Responsible AI principles</a> to mitigate and minimize potential harm to users. Those principles emphasize that fairness, reliability and safety, privacy and security, inclusiveness, transparency, and accountability be considered as the key cornerstones of a responsible and trustworthy approach to development and use of AI.</p>\n\n<h4><strong>Future</strong></h4>\n\n<p>As mentioned, you can currently find T-ISR shipped in the <a href=\"https://www.bing.com/maps?osid=9a1da506-a118-4cda-a6ad-ef916a116933&cp=41.902226~12.452865&lvl=19&style=a&v=2&sV=2&form=S00027\">Aerial View of Bing Maps</a> around the world! And T-ISR in Microsoft Edge is currently shipped in <a href=\"https://www.microsoftedgeinsider.com/en-us/download/canary\">Edge Canary</a> and we will continue to roll this out to more and more users in the coming months. The ultimate mission for the Turing Super-Resolution effort is to turn any application where people view, consume or create media into an &ldquo;HD&rdquo; experience. We are closely working with key teams across Microsoft to explore how to achieve that vision in more places and on more devices.&nbsp;</p>\n\n<div>&nbsp;</div>\n\n<div>&nbsp;</div>\n"
}