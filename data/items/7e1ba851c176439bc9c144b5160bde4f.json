{
  "title": "Numerical Contour Integration",
  "link": "https://www.mathematica-journal.com/2021/07/16/numerical-contour-integration/",
  "comments": "https://www.mathematica-journal.com/2021/07/16/numerical-contour-integration/#respond",
  "pubDate": "Fri, 16 Jul 2021 19:44:55 +0000",
  "dc:creator": "Todd Akers",
  "category": "Volume 23",
  "guid": "https://www.mathematica-journal.com/?p=61520",
  "description": "https://doi.org/10.3888/tmj.23-3 &#160; We present a straightforward implementation of contour integration by setting options for and , taking advantage of powerful results in complex analysis. As such, this article can be viewed as documentation to perform numerical contour integration with the existing built-in tools. We provide examples of how this method can be used when integrating [&#8230;]",
  "content:encoded": "<div>\n<div class=\"DOIReference\"><span style=\"font-size: xx-small;\"><a href=\"https://doi.org/10.3888/tmj.23-3\">https://doi.org/10.3888/tmj.23-3</a></span></div>\n<p>&nbsp;</p>\n<div>\n<p>We present a straightforward implementation of contour integration by setting options for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_1.gif\" alt=\"\" width=\"70\" height=\"13\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_2.gif\" alt=\"\" width=\"78\" height=\"13\" />, taking advantage of powerful results in complex analysis. As such, this article can be viewed as documentation to perform numerical contour integration with the existing built-in tools. We provide examples of how this method can be used when integrating analytically and numerically some commonly used distributions, such as Wightman functions in quantum field theory. We also provide an approximating technique when time-ordering is involved, a commonly encountered scenario in quantum field theory for computing second-order terms in Dyson series expansion and Feynman propagators. We believe our implementation will be useful for more general calculations involving advanced or retarded Green<span class=\"special-character CloseCurlyQuote\">’</span>s functions, propagators, kernels and so on.<span id=\"more-61520\"></span></p>\n<h3>Introduction</h3>\n<p>It is well known that we can integrate analytically a large class of functions with known anti-derivatives via <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_3.gif\" alt=\"\" width=\"65\" height=\"14\" />; otherwise, we can use <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_4.gif\" alt=\"\" width=\"72\" height=\"14\" /> for numerical results. There are various settings that one can use to evaluate integrals, depending on the task at hand. Crucially, this can be performed even if the integrand is complex valued, such as the function <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_5.gif\" alt=\"\" width=\"16\" height=\"15\" />. In some cases, when the integrand is a distribution, this integration can also be done analytically by setting the option <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_6.gif\" alt=\"\" width=\"101\" height=\"14\" />, for example, or by imposing a regulator, which in physics is often called a UV cutoff.</p>\n<p>In this article, we are interested in a contour integral of the form</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_1.gif\" alt=\"\" width=\"67\" height=\"37\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(1)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_7.gif\" alt=\"\" width=\"21\" height=\"12\" /> is a complex-valued function or distribution and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_8.gif\" alt=\"\" width=\"6\" height=\"12\" /> is an integration contour, with possibly higher-dimensional generalizations. For a large class of functions <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_9.gif\" alt=\"\" width=\"21\" height=\"12\" /> and a contour <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_10.gif\" alt=\"\" width=\"6\" height=\"12\" />, this can be done in various ways, such as using powerful techniques in complex analysis like Cauchy<span class=\"special-character CloseCurlyQuote\">’</span>s integral formula or the residue theorem. For many of these functions, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_11.gif\" alt=\"\" width=\"65\" height=\"14\" /> can provide answers immediately, sometimes involving special functions.</p>\n<p>The motivation for this article is based on the observation that there is no good documentation on how to perform explicit contour integration in Mathematica. It turns out that the ingredients necessary to perform this task are already available within the software. We believe that some of these ingredients are already used elsewhere for different purposes. Our task is to synthesize these components in a coherent way to document how to perform numerical contour integration, using only built-in commands and their options. We will show by way of examples that in many cases this method proves superior to direct integration with <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_12.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription, especially when the integrand is complicated or when the integral is multidimensional.</p>\n<h3>Example 1: Simple Textbook Example<span class=\"special-character LongDash\">—</span>One-Dimensional Contour Integral with Closed-Form Solutions</h3>\n<p>Consider the integral</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_2.gif\" alt=\"\" width=\"357\" height=\"40\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(2)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_13.gif\" alt=\"\" width=\"25\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_14.gif\" alt=\"\" width=\"26\" height=\"12\" />, and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_15.gif\" alt=\"\" width=\"6\" height=\"12\" /> is the entire real line. The first equality comes from Sokhotsky<span class=\"special-character CloseCurlyQuote\">’</span>s formula [<a href=\"#Howie\">1</a>] and the second equality uses principal value integration. This is a commonly used <span class=\"special-character OpenCurlyDoubleQuote\">“</span>epsilon-regularization<span class=\"special-character CloseCurlyDoubleQuote\">”</span> in physics when evaluating certain apparently divergent integrals, which has to do with the distributional nature of the integrand in question (see Appendix A in [<a href=\"#Howie\">1</a>] for examples).</p>\n<p>This integral can be solved using complex analysis instead of Sokhotsky<span class=\"special-character CloseCurlyQuote\">’</span>s formula, based on the observation that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_16.gif\" alt=\"\" width=\"10\" height=\"12\" /> can be computed using the following contour.</p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_1.gif\" alt=\"\" width=\"360\" height=\"194\" /></p>\n<p>The contour is the horizontal blue segment and the semi-circular arc <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_17.gif\" alt=\"\" width=\"6\" height=\"12\" />. The integral over the semi-circular arc vanishes as <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_18.gif\" alt=\"\" width=\"34\" height=\"12\" /> by Jordan&#8217;s lemma [<a href=\"#Brown-Churchill\">2</a>, <a href=\"Mukhanov-Winitzki\">3</a>]. The contribution from the closed loop can be calculated in various ways, such as the residue theorem. The residue theorem says that since the closed loop encloses the pole at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_19.gif\" alt=\"\" width=\"30\" height=\"12\" /> (using the standard counterclockwise convention [<a href=\"#Brown-Churchill\">2</a>, <a href=\"Mukhanov-Winitzki\">3</a>]), <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_20.gif\" alt=\"\" width=\"173\" height=\"18\" />. Taking the limit as <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_21.gif\" alt=\"\" width=\"27\" height=\"12\" />, we get the same result <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_22.gif\" alt=\"\" width=\"19\" height=\"12\" /> as before.</p>\n<p>There is indeed a built-in function for calculating residues.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_1.gif\" alt=\"\" width=\"192\" height=\"32\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_2.gif\" alt=\"\" width=\"25\" height=\"15\" /></p>\n<p>Another way to evaluate <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_23.gif\" alt=\"\" width=\"10\" height=\"12\" /> is based on the fact that the <span class=\"special-character OpenCurlyDoubleQuote\">“</span><img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_24.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription<span class=\"special-character CloseCurlyDoubleQuote\">”</span> is an instruction to perform a specific contour integration (without an <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_25.gif\" alt=\"\" width=\"5\" height=\"12\" />-regulator) in the sense that</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_3.gif\" alt=\"\" width=\"266\" height=\"44\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(3)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_26.gif\" alt=\"\" width=\"6\" height=\"12\" /> is a contour chosen to go from <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_27.gif\" alt=\"\" width=\"19\" height=\"12\" /> to <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_28.gif\" alt=\"\" width=\"10\" height=\"12\" /> but deformed near the pole <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_29.gif\" alt=\"\" width=\"26\" height=\"12\" /> to the lower complex plane.</p>\n<p>The <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_30.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription in (<a href=\"#Eq:2\">2</a>) shifts the pole at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_31.gif\" alt=\"\" width=\"26\" height=\"12\" /> to <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_32.gif\" alt=\"\" width=\"30\" height=\"12\" /> in the upper half-plane, so that we can integrate over the real line and then take the limit as <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_33.gif\" alt=\"\" width=\"31\" height=\"12\" />. Consequently, if we were to remove the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_34.gif\" alt=\"\" width=\"5\" height=\"12\" />-regulator, the deformation theorem [<a href=\"#Brown-Churchill\">2</a>] would require that we deform the contour to the lower complex plane near <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_35.gif\" alt=\"\" width=\"26\" height=\"12\" /> in order to obtain the same value of the integral. (The deformation theorem [<a href=\"#Brown-Churchill\">2</a>] in complex analysis states that a contour integral remains constant under deformation of the contour that does not cross any poles or branch cuts.) For this contour, the residue is instead given by the following.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_2.gif\" alt=\"\" width=\"182\" height=\"31\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_3.gif\" alt=\"\" width=\"7\" height=\"13\" /></p>\n<p>If we choose <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_36.gif\" alt=\"\" width=\"25\" height=\"12\" /> instead, the integral is zero. Here is an explicit computation for fixed <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_37.gif\" alt=\"\" width=\"26\" height=\"12\" />.</p>\n<h4>Case 1</h4>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_3.gif\" alt=\"\" width=\"286\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_4.gif\" alt=\"\" width=\"241\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_4.gif\" alt=\"\" width=\"126\" height=\"33\" /></p>\n<p>The zero values have a simple explanation in terms of contour integration: since the pole is now shifted to the lower half-plane, the contour does not enclose any poles, which by Cauchy<span class=\"special-character CloseCurlyQuote\">’</span>s integral theorem guarantees that the integral is zero.</p>\n<h4>Case 2</h4>\n<p>This is a good place to introduce the numerical contour integration scheme. As a simple example, we can use a rectangular contour.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_5.gif\" alt=\"\" width=\"580\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_6.gif\" alt=\"\" width=\"213\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_5.gif\" alt=\"\" width=\"117\" height=\"13\" /></p>\n<h4>Case 3</h4>\n<p>For any <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_38.gif\" alt=\"\" width=\"26\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_39.gif\" alt=\"\" width=\"26\" height=\"12\" />, this calculation gives the correct answer, as expected from direct calculation using residues or textbook pen-and-paper calculations (see e.g. [<a href=\"#Mukhanov-Winitzki\">3</a>]). Varying <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_40.gif\" alt=\"\" width=\"6\" height=\"12\" /> does not change the integral, as a consequence of the deformation theorem. In particular, other contours also work, such as, for example, a triangular contour.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_7.gif\" alt=\"\" width=\"488\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_8.gif\" alt=\"\" width=\"163\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_6.gif\" alt=\"\" width=\"79\" height=\"13\" /></p>\n<h4>Case 4</h4>\n<p>For completeness, let us show that in this simple case the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_41.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription (which is commonly used in physics) can also be done. We add the condition <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_42.gif\" alt=\"\" width=\"26\" height=\"12\" />.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_9.gif\" alt=\"\" width=\"501\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_10.gif\" alt=\"\" width=\"53\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_7.gif\" alt=\"\" width=\"48\" height=\"14\" /></p>\n<p>The final result involves <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_43.gif\" alt=\"\" width=\"17\" height=\"12\" />, which tends to 1 as <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_44.gif\" alt=\"\" width=\"37\" height=\"14\" />. Therefore, in this simple example, all the methods yield good results. It is straightforward to show that many common textbook examples (see e.g. [<a href=\"#Mukhanov-Winitzki\">3</a>]) can be performed in this way.</p>\n<h4>Case 5</h4>\n<p>Finally, our main goal is to show that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_45.gif\" alt=\"\" width=\"72\" height=\"14\" /> can also perform the task reliably. First do the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_46.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_11.gif\" alt=\"\" width=\"525\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_12.gif\" alt=\"\" width=\"86\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_8.gif\" alt=\"\" width=\"302\" height=\"15\" /></p>\n<p>Here we see the first instance where the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_47.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription starts to fail: when performed numerically, the most basic setting does not work, and increasing the working precision does not help much.</p>\n<p>Remark: The <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_48.gif\" alt=\"\" width=\"36\" height=\"13\" /> command silences all error messages and is used for readability. In practice, in order to discover the issues and possibly infer the sources of problems, it is useful to not use <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_49.gif\" alt=\"\" width=\"36\" height=\"13\" /> on a first try.</p>\n<h4>Case 6: Numerical Contour Integration</h4>\n<p>Now do the contour integral using a triangular contour.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_13.gif\" alt=\"\" width=\"502\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_14.gif\" alt=\"\" width=\"170\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_9.gif\" alt=\"\" width=\"278\" height=\"18\" /></p>\n<p>The contour integration works as is without further modification. The size of the contour does not matter, as long as it is not so small that it leads to numerical instabilities associated with small numbers.</p>\n<p>We refer to the numerical computation using <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_50.gif\" alt=\"\" width=\"72\" height=\"14\" /> that involves contour deformation in the complex plane as numerical contour integration. We will see recurring examples where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_51.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescriptions, albeit simplest to implement, almost never work when needed in spite of optimizing various settings. Thus numerical contour integration is a highly competitive technique to use.</p>\n<h3>Example 2: Two-Dimensional Integral on <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_52b.gif\" alt=\"\" width=\"19\" height=\"19\" /> over a Distribution</h3>\n<p>(Remark: Some of the discussion here was briefly outlined in [<a href=\"#Tjoa\">4</a>, <a href=\"#Tjoa-Mann\">5</a>], which is based on what this article contains.)</p>\n<p>The main example we consider in this article involves the integral over a distribution or bi-distribution of the form</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_4.gif\" alt=\"\" width=\"404\" height=\"44\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(4)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_53.gif\" alt=\"\" width=\"32\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_54.gif\" alt=\"\" width=\"28\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_55.gif\" alt=\"\" width=\"25\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_56.gif\" alt=\"\" width=\"50\" height=\"12\" /> is a distribution or bi-distribution given by</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_5.gif\" alt=\"\" width=\"301\" height=\"41\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(5)</td>\n</tr>\n</tbody>\n</table>\n<p>In physics, more specifically quantum field theory, this distribution is the two-point vacuum correlation function (also called the two-point Wightman function) of a massless scalar field in (<img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_57.gif\" alt=\"\" width=\"24\" height=\"12\" />)-dimensional Minkowski space [<a href=\"#Birrell-Davies\">6</a>].</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_6.gif\" alt=\"\" width=\"246\" height=\"26\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(6)</td>\n</tr>\n</tbody>\n</table>\n<p>The arguments of the two-point function are the coordinates of two spacetime events <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_58.gif\" alt=\"\" width=\"25\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_59.gif\" alt=\"\" width=\"32\" height=\"12\" />, where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_60.gif\" alt=\"\" width=\"59\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_61.gif\" alt=\"\" width=\"68\" height=\"12\" /> in Cartesian coordinates and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_62.gif\" alt=\"\" width=\"5\" height=\"12\" />. The integral <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_63.gif\" alt=\"\" width=\"43\" height=\"12\" /> is evaluated at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_64.gif\" alt=\"\" width=\"29\" height=\"12\" /> and is thus independent of the spatial coordinates. The <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_65.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription tells us that the Wightman function is a distribution or bi-distribution [<a href=\"#Birrell-Davies\">6</a>].</p>\n<p>Our task is to evaluate the integral <img style=\"vertical-align: middle;\" title=\"J_1(Omega,sigma)\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_1.gif\" alt=\"J_1(Omega,sigma)\" width=\"43\" height=\"12\" /> in (<a href=\"#Eq:4\">4</a>). This is a two-dimensional complex integral over <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_66.gif\" alt=\"\" width=\"4\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_67.gif\" alt=\"\" width=\"8\" height=\"12\" /> with a continuum of poles at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_68.gif\" alt=\"\" width=\"48\" height=\"12\" /> for any fixed <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_69.gif\" alt=\"\" width=\"25\" height=\"12\" />. In the literature, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_70.gif\" alt=\"\" width=\"43\" height=\"12\" /> gives the transition probability (divided by a small coupling constant <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_71.gif\" alt=\"\" width=\"12\" height=\"15\" />) of an Unruh<span class=\"special-character Dash\">–</span>DeWitt (UDW) detector consisting of a two-level quantum system (qubit) with energy gap <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_72.gif\" alt=\"\" width=\"9\" height=\"12\" /> interacting with the massless scalar field for a finite duration prescribed by the Gaussian function with timescale set by <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_73.gif\" alt=\"\" width=\"8\" height=\"12\" /> (see e.g. [<a href=\"#Smith\">7</a>] and references therein). The Gaussian functions in the integrand ensure that the interaction between the detector and the quantum field <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_74.gif\" alt=\"\" width=\"7\" height=\"12\" /> is adiabatically switched on and off smoothly; that is, the Fourier transform of the Wightman function has polynomial tails and is strongly suppressed by the exponential tails of the Fourier transform of the Gaussians. This guarantees that there is no spurious divergence in the transition probability due to switching on the detector very sharply or suddenly, such as with a switching function with discontinuity at an endpoint, like a rectangular function, which is unphysical. An analogy is switching on a lightbulb: in realistic scenarios the current in the circuit does not simply increase from zero to a constant value instantaneously, but rather smoothly over some short time interval.</p>\n<p>The example in equation (<a href=\"#Eq:4\">4</a>) is important for three reasons.</p>\n<p>1. It is one of the simplest examples in quantum field theory; many other examples in physics involve distributions that take similar and sometimes more complicated forms (e.g. different power laws <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_75.gif\" alt=\"\" width=\"60\" height=\"12\" /> where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_76.gif\" alt=\"\" width=\"26\" height=\"12\" /> or <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_77.gif\" alt=\"\" width=\"75\" height=\"15\" /> for some function <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_78.gif\" alt=\"\" width=\"7\" height=\"12\" />).</p>\n<p>2. It is one of the simplest examples of a two-dimensional integral with a continuum of poles, thus going beyond standard textbook examples (e.g. in [<a href=\"#Mukhanov-Winitzki\">3</a>] all the examples are one dimensional).</p>\n<p>3. Despite its somewhat complicated appearance, it admits a closed-form expression [<a href=\"#Smith\">7</a>].</p>\n<h4>Benchmark Value for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_79.gif\" alt=\"\" width=\"12\" height=\"14\" /></h4>\n<p>In [<a href=\"#Smith\">7</a>] it is shown that the exact closed-form expression is given by</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_7.gif\" alt=\"\" width=\"282\" height=\"37\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(7)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_80.gif\" alt=\"\" width=\"33\" height=\"12\" /> is the complementary error function. We want to show that numerically this result can be obtained in a satisfactory way. For this purpose, let us focus on a particular numerical value by setting <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_81.gif\" alt=\"\" width=\"39\" height=\"12\" />, so that</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_8.gif\" alt=\"\" width=\"154\" height=\"18\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(8)</td>\n</tr>\n</tbody>\n</table>\n<p>We can then use this value as a benchmark for our methods.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_15.gif\" alt=\"\" width=\"347\" height=\"32\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_16.gif\" alt=\"\" width=\"100\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_10.gif\" alt=\"\" width=\"72\" height=\"13\" /></p>\n<h4>Direct <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_82.gif\" alt=\"\" width=\"13\" height=\"16\" /> Integration</h4>\n<p>Direct <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_83.gif\" alt=\"\" width=\"11\" height=\"12\" /> integration for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_84.gif\" alt=\"\" width=\"11\" height=\"12\" /> is given by the following command.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_17.gif\" alt=\"\" width=\"580\" height=\"84\" /></p>\n<p>The most modest settings yield poor results.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_18.gif\" alt=\"\" width=\"555\" height=\"59\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_11.gif\" alt=\"\" width=\"242\" height=\"70\" /></p>\n<p>Clearly, although the real parts are all positive (hence physically at least sensible for a transition probability), the results are very different from the benchmark value. The third value is wrong because the probabilities should be real (hence numerically the imaginary part should be much closer to zero).</p>\n<p>Increasing <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_85.gif\" alt=\"\" width=\"86\" height=\"13\" /> as a first remedy does not help much, if at all.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_19.gif\" alt=\"\" width=\"555\" height=\"59\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_12.gif\" alt=\"\" width=\"243\" height=\"62\" /></p>\n<h4>Restricting the Domain</h4>\n<p>Restricting the integration domain to (<img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_86.gif\" alt=\"\" width=\"25\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_87.gif\" alt=\"\" width=\"16\" height=\"12\" />), where the Gaussian is strongly supported, improves the result, but not enough. (The negligible part of the integral associated to Gaussian tails was ignored.) To see that the behavior scales badly with <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_88.gif\" alt=\"\" width=\"5\" height=\"12\" />, let us choose a particular setting.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_20.gif\" alt=\"\" width=\"555\" height=\"59\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_13.gif\" alt=\"\" width=\"263\" height=\"106\" /></p>\n<p>The first two entries, while not accurate enough, are again at least physically valid results because the imaginary part is negligible and hence can represent transition probabilities. In contrast, the last three values have negative real parts and are thus invalid by default.</p>\n<p>We leave it to the reader to verify that other possible settings, such as increasing <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_89.gif\" alt=\"\" width=\"115\" height=\"14\" /> or <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_90.gif\" alt=\"\" width=\"86\" height=\"14\" />, do not help, nor does changing the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_91.gif\" alt=\"\" width=\"43\" height=\"13\" /> setting from <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_92.gif\" alt=\"\" width=\"101\" height=\"14\" /> to another. There may be some combination of settings that makes this integration work, but if they exist then they are for our purposes not worth the time. We will in fact show that the exact same setting that yields the bad results above does work with numerical contour integration.</p>\n<p>A possible reason for these issues is that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_93.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription changes the asymptotic behavior at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_94.gif\" alt=\"\" width=\"52\" height=\"12\" />. Numerically, we are evaluating the integral from <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_95.gif\" alt=\"\" width=\"59\" height=\"12\" /> to <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_96.gif\" alt=\"\" width=\"50\" height=\"12\" />, so <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_97.gif\" alt=\"\" width=\"72\" height=\"14\" /> has to deal with points at infinity that are shifted with a very small imaginary component.</p>\n<h4>Numerical Contour Integration</h4>\n<p>Here <img style=\"vertical-align: middle;\" title=\"J_1\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_3.gif\" alt=\"J_1\" width=\"11\" height=\"12\" /> is transformed into a numerical contour integral, <img style=\"vertical-align: middle;\" title=\"J_3\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_5.gif\" alt=\"J_3\" width=\"11\" height=\"12\" />. In contrast to the previous subsection, the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_98.gif\" alt=\"\" width=\"5\" height=\"12\" />-regulator now serves as a contour deformation near a reasonably shaped contour. Hence the asymptotic behavior of the integral is not altered by varying <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_99.gif\" alt=\"\" width=\"5\" height=\"12\" />.</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_9.gif\" alt=\"\" width=\"380\" height=\"46\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(9)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_100.gif\" alt=\"\" width=\"19\" height=\"12\" /> is a contour along the real line but deformed around the poles of the Wightman function. Here we have <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_101.gif\" alt=\"\" width=\"25\" height=\"12\" /> in the Wightman function because we have converted the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_102.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription into an instruction to perform contour integration, so the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_103.gif\" alt=\"\" width=\"5\" height=\"12\" /> is now part of the definition of the contour <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_104.gif\" alt=\"\" width=\"6\" height=\"12\" />.</p>\n<p>Here is the contour <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_105.gif\" alt=\"\" width=\"19\" height=\"12\" />, where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_106.gif\" alt=\"\" width=\"26\" height=\"12\" /> is the location of the continuum of poles for every fixed <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_107.gif\" alt=\"\" width=\"4\" height=\"12\" />.</p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_14.gif\" alt=\"\" width=\"360\" height=\"152\" /></p>\n<p>Since many contours work, let us first choose a particularly simple one: a rectangular deformation near the poles. If we integrate over <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_108.gif\" alt=\"\" width=\"8\" height=\"12\" /> first, then the continuum of poles is located in the complex plane at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_109.gif\" alt=\"\" width=\"26\" height=\"12\" />. Therefore, the contour <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_110.gif\" alt=\"\" width=\"6\" height=\"12\" /> should be deformed to the upper complex plane.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_21.gif\" alt=\"\" width=\"560\" height=\"100\" /></p>\n<p>Based on the previous subsection, we see that using <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_111.gif\" alt=\"\" width=\"50\" height=\"12\" /> yields a better answer, since more than 99.99% of the area of the Gaussian in the integrand is contained in the interval <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_112.gif\" alt=\"\" width=\"56\" height=\"12\" />. We will not set <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_113.gif\" alt=\"\" width=\"44\" height=\"12\" /> in what follows. Consequently, the parts of the contour from <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_114.gif\" alt=\"\" width=\"19\" height=\"12\" /> to <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_115.gif\" alt=\"\" width=\"25\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_116.gif\" alt=\"\" width=\"16\" height=\"12\" /> to <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_117.gif\" alt=\"\" width=\"10\" height=\"12\" /> have been truncated and do not yield significant error. This gives the following results.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_22.gif\" alt=\"\" width=\"563\" height=\"44\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_15.gif\" alt=\"\" width=\"242\" height=\"80\" /></p>\n<p>This result may look undesirable, but the first value is numerically the same as the benchmark value up to very small imaginary part. This suggests that in the neighborhood of <img style=\"vertical-align: middle;\" title=\"epsilon approx 10\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_7.gif\" alt=\"epsilon approx 10\" width=\"31\" height=\"12\" /> there is a good range that we can use to get a numerically accurate result; we will show that the result is invariant under smooth deformation of the contour. For example, if we zoom in between <img style=\"vertical-align: middle;\" title=\"epsilon approx 10^1\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_9.gif\" alt=\"epsilon approx 10^1\" width=\"37\" height=\"15\" /> and <img style=\"vertical-align: middle;\" title=\"epsilon approx 10^2\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_11.gif\" alt=\"epsilon approx 10^2\" width=\"37\" height=\"15\" />, we get the following results.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_23.gif\" alt=\"\" width=\"536\" height=\"44\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_16.gif\" alt=\"\" width=\"227\" height=\"168\" /></p>\n<p>That the results are unchanged as we vary <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_118.gif\" alt=\"\" width=\"5\" height=\"12\" /> (only the negligible error changes a little) is what we expect from the deformation theorem in complex analysis, since the deformation does not cross any singularities. This invariance under contour deformation is very useful because it is one of the consistency checks we can do (or perhaps need to do) in the absence of exact closed-form expressions and other cross-validation. Direct <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_119.gif\" alt=\"\" width=\"10\" height=\"12\" /> integration does not allow this, because every <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_120.gif\" alt=\"\" width=\"5\" height=\"12\" /> yields different values (because the asymptotics are also shifted by <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_121.gif\" alt=\"\" width=\"10\" height=\"12\" />). Furthermore, numerical contour integration is also remarkably fast.</p>\n<h4>A Different Contour</h4>\n<p>Here is a different contour. The width is fixed but the height toward the imaginary axis varies.</p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_17b.gif\" alt=\"\" width=\"360\" height=\"194\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_24.gif\" alt=\"\" width=\"560\" height=\"84\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_25.gif\" alt=\"\" width=\"563\" height=\"44\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_18.gif\" alt=\"\" width=\"263\" height=\"122\" /></p>\n<p>This choice of contour highlights that while contour integration is much more powerful than the direct <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_122.gif\" alt=\"\" width=\"10\" height=\"12\" /> integration method, one should avoid numerical issues associated with values of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_123.gif\" alt=\"\" width=\"5\" height=\"12\" /> that are either too large or too small; sometimes different contours yield different stability. Nonetheless, the main takeaway is that we have found that there is a large enough range of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_124.gif\" alt=\"\" width=\"5\" height=\"12\" /> for which the contour can be varied but still yields the correct value (in this case, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_125.gif\" alt=\"\" width=\"61\" height=\"15\" />). In this range, we can vary <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_126.gif\" alt=\"\" width=\"5\" height=\"12\" /> and the answer is invariant. The correct range of <img style=\"vertical-align: middle;\" title=\"epsilon\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_13.gif\" alt=\"epsilon\" width=\"5\" height=\"12\" /> that provides reliable results must however be found empirically and depends strongly on the integrand. For completeness, we show the results for zooming into the range of <img style=\"vertical-align: middle;\" title=\"epsilon\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Image_15.gif\" alt=\"epsilon\" width=\"5\" height=\"12\" /> (except that this time we need this to be <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_127.gif\" alt=\"\" width=\"58\" height=\"12\" />).</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_26.gif\" alt=\"\" width=\"579\" height=\"58\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_19.gif\" alt=\"\" width=\"235\" height=\"188\" /></p>\n<p>A significant advantage of numerical contour integration over direct <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_128.gif\" alt=\"\" width=\"10\" height=\"12\" /> integration is that it allows for robust consistency check: if we can find a range for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_129.gif\" alt=\"\" width=\"5\" height=\"12\" /> in which the integral is constant (up to small numerical errors like a small imaginary part), then the integral is likely to be correct. This is an extremely important necessary condition, especially when a closed-form expression is not available. Of course, if there are other ways to check the correctness of the value (as in this example where we know the exact closed-form expression or if there are physical arguments to back it up), we should always also perform these other checks.</p>\n<h3>Example 3: Two-Dimensional Integral over a Distribution Containing the Heaviside Step Function</h3>\n<p>Next, we consider a more complicated integral,</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_10.gif\" alt=\"\" width=\"580\" height=\"44\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(10)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_130.gif\" alt=\"\" width=\"32\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_131.gif\" alt=\"\" width=\"28\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_132.gif\" alt=\"\" width=\"25\" height=\"12\" />, <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_133.gif\" alt=\"\" width=\"18\" height=\"12\" /> is the Heaviside step function and the two-point Wightman function <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_134.gif\" alt=\"\" width=\"77\" height=\"12\" /> is given in equation (<a href=\"#Eq:5\">5</a>). This integral differs conceptually from Example 2 in two respects:</p>\n<p>(1) the additional Heaviside step function in the integrand</p>\n<p>(2) we also allow for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_135.gif\" alt=\"\" width=\"29\" height=\"12\" /> and changed the sign on the phase</p>\n<p>The Heaviside step function appearing in the integrand naturally arises in physics calculations where a Dyson series expansion is involved (i.e. where the notion of time ordering is necessary). In particular, this occurs in various time-dependent perturbation theory calculations within quantum mechanics and quantum field theory. The specific integral in (<a href=\"#Eq:10\">10</a>) appears as part of the calculation of the nonlocal part of the joint two-detector density matrix of two qubits interacting with a massless scalar field in the so-called entanglement harvesting protocol [<a href=\"#Smith\">7</a>, <a href=\"#Steeg-Menicucci\">8</a>].</p>\n<p>Perhaps somewhat surprisingly, this integral admits a closed-form solution [<a href=\"#Smith\">7</a>], given by</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_11.gif\" alt=\"\" width=\"284\" height=\"45\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(11)</td>\n</tr>\n</tbody>\n</table>\n<p>where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_136.gif\" alt=\"\" width=\"60\" height=\"14\" />. As before, we can assume that the coordinate system is aligned so that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_137.gif\" alt=\"\" width=\"156\" height=\"12\" />.</p>\n<h4>Benchmark Value for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_138.gif\" alt=\"\" width=\"15\" height=\"14\" /></h4>\n<p>For benchmarking, assume <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_139.gif\" alt=\"\" width=\"39\" height=\"12\" /> and set <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_140.gif\" alt=\"\" width=\"29\" height=\"12\" />. This gives</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_12.gif\" alt=\"\" width=\"286\" height=\"15\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(12)</td>\n</tr>\n</tbody>\n</table>\n<p>Here is the calculation.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_27.gif\" alt=\"\" width=\"402\" height=\"37\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_28.gif\" alt=\"\" width=\"86\" height=\"13\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_20.gif\" alt=\"\" width=\"161\" height=\"13\" /></p>\n<p>This is an alternative if one prefers arbitrary <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_141.gif\" alt=\"\" width=\"8\" height=\"12\" /> in the expression.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_29.gif\" alt=\"\" width=\"111\" height=\"18\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_21.gif\" alt=\"\" width=\"161\" height=\"13\" /></p>\n<p>This number is complex, so we no longer have the benefit of verifying our numerical calculation by requiring that the imaginary part be small (which we used in Example <a href=\"Example:2\">2</a>).</p>\n<p>Let us now evaluate <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_142.gif\" alt=\"\" width=\"46\" height=\"12\" /> numerically. We will not bother with the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_143.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription anymore because it does not work; this is not surprising since the Heaviside step function only complicates the integral compared to Example <a href=\"Example:2\">2</a>. However, we will evaluate this integral in two ways, both using numerical contour integration, with the two methods differing in how they handle the Heaviside step function.</p>\n<h4>Absorbing the Heaviside Function into the Upper Limit</h4>\n<p>We rewrite the integral <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_144.gif\" alt=\"\" width=\"14\" height=\"12\" /> as:</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_13.gif\" alt=\"\" width=\"580\" height=\"68\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(13)</td>\n</tr>\n</tbody>\n</table>\n<p>By suitable relabeling, the two integrals are equal (this property is used in [<a href=\"#Smith\">7</a>, <a href=\"#Steeg-Menicucci\">8</a>]), but we will not need this fact, since in more general situations the two integrals are different. (See e.g. [<a href=\"#Tjoa-Mann\">5</a>, <a href=\"#Gallock-Yoshimura\">9</a>], where the upper limits differ slightly by a <span class=\"special-character OpenCurlyDoubleQuote\">“</span>relative redshift<span class=\"special-character CloseCurlyDoubleQuote\">”</span> factor.) Although equation (<a href=\"#Eq:13\">13</a>) is written in the notation of an <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_145.gif\" alt=\"\" width=\"10\" height=\"12\" /> prescription, this is merely a shorthand for performing the numerical contour integration, since we already know that direct <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_146.gif\" alt=\"\" width=\"10\" height=\"12\" /> integration does not work.</p>\n<p>Pick a rectangular contour and set it so that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_147.gif\" alt=\"\" width=\"156\" height=\"12\" />. For this choice, the two integrals have a continuum of poles at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_148.gif\" alt=\"\" width=\"45\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_149.gif\" alt=\"\" width=\"45\" height=\"12\" />, respectively. The contour will be chosen so that it does not cross any poles as <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_150.gif\" alt=\"\" width=\"5\" height=\"12\" /> varies.</p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_22b.gif\" alt=\"\" width=\"360\" height=\"194\" /></p>\n<p>We can then write the following integral command.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_30.gif\" alt=\"\" width=\"580\" height=\"155\" /></p>\n<p>The most modest settings yield good results.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_31.gif\" alt=\"\" width=\"580\" height=\"44\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_23.gif\" alt=\"\" width=\"240\" height=\"112\" /></p>\n<p>The contour parameter <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_151.gif\" alt=\"\" width=\"5\" height=\"12\" /> is good in the range <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_152.gif\" alt=\"\" width=\"45\" height=\"18\" /> and starts to deviate at around <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_153.gif\" alt=\"\" width=\"24\" height=\"15\" />. Remarkably, we can compute this result very well despite the extra complications, with nearly no additional settings beyond <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_154.gif\" alt=\"\" width=\"110\" height=\"13\" />.</p>\n<h4>Approximate Heaviside Step Function</h4>\n<p>The integral in equation (<a href=\"#Eq:9\">9</a>) is actually written in a more useful form than the upper limit form in equation (<a href=\"#Eq:12\">12</a>), in the sense that it accommodates a more general scenario where the two-point functions may not be simple functions of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_155.gif\" alt=\"\" width=\"4\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_156.gif\" alt=\"\" width=\"8\" height=\"12\" /><em>.</em> In general, the poles of the Wightman functions for the problem at hand can be located at <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_157.gif\" alt=\"\" width=\"41\" height=\"12\" />, where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_158.gif\" alt=\"\" width=\"7\" height=\"12\" /> is some function that does not have a simple inverse. In such a situation, the upper limit of the integrals is not simply <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_159.gif\" alt=\"\" width=\"4\" height=\"12\" /> or <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_160.gif\" alt=\"\" width=\"8\" height=\"12\" /> and may have to be worked out numerically.</p>\n<p>More specifically, in the context of quantum field theory in curved spacetimes, the Wightman function in equation (<a href=\"#Eq:5\">5</a>) is given in flat spacetime in terms of the Minkowski coordinates, and the integrals we computed thus far correspond to two Unruh<span class=\"special-character Dash\">–</span>DeWitt (UDW) detectors separated by proper distance <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_161.gif\" alt=\"\" width=\"7\" height=\"12\" />, both of which are at rest relative to this coordinate system. When the detectors are in motion, we have to replace <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_162.gif\" alt=\"\" width=\"24\" height=\"12\" /> with <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_163.gif\" alt=\"\" width=\"49\" height=\"12\" />, where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_164.gif\" alt=\"\" width=\"4\" height=\"12\" /> is Minkowski coordinate time and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_165.gif\" alt=\"\" width=\"6\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_166.gif\" alt=\"\" width=\"7\" height=\"12\" /> are the proper times of each detector, which take the roles of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_167.gif\" alt=\"\" width=\"4\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_168.gif\" alt=\"\" width=\"8\" height=\"12\" /> in the previous sections. Similarly, we have to replace <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_169.gif\" alt=\"\" width=\"27\" height=\"12\" /> with <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_170.gif\" alt=\"\" width=\"53\" height=\"12\" />, where now <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_171.gif\" alt=\"\" width=\"6\" height=\"12\" /> takes the role of Minkowski spatial coordinates. In this case, in general it is not true that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_172.gif\" alt=\"\" width=\"6\" height=\"12\" /> is a simple function of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_173.gif\" alt=\"\" width=\"7\" height=\"12\" />, so it may not always be possible to find an upper limit version similar to equation (<a href=\"#Eq:12\">12</a>). The static detectors (at rest relative to Minkowski coordinates) correspond to the special case where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_174.gif\" alt=\"\" width=\"88\" height=\"12\" />, which can then be rewritten as <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_175.gif\" alt=\"\" width=\"24\" height=\"12\" />. This complexity occurs more generally when the spacetime is not flat, such as when we consider two-dimensional truncation of Schwarzschild spacetime [<a href=\"#Tjoa-Mann\">5</a>].</p>\n<p>For this reason, it is useful to try to integrate equation (<a href=\"#Eq:10\">10</a>) using the Heaviside step function directly. Since the built-in function <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_176.gif\" alt=\"\" width=\"101\" height=\"13\" /> is not defined for complex numbers, we approximate it with a smooth function. For example, the Heaviside step function is a limit of a logistic function:</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_14.gif\" alt=\"\" width=\"201\" height=\"34\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(14)</td>\n</tr>\n</tbody>\n</table>\n<p>provided that we define <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_177.gif\" alt=\"\" width=\"42\" height=\"23\" />. We can thus define an approximate Heaviside step function for any fixed <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_178.gif\" alt=\"\" width=\"26\" height=\"12\" /> by</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_15.gif\" alt=\"\" width=\"140\" height=\"34\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(15)</td>\n</tr>\n</tbody>\n</table>\n<p>Any other function used in computing a cumulative probability distribution would work.</p>\n<p>Our integral <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_179.gif\" alt=\"\" width=\"14\" height=\"12\" /> now becomes</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_16.gif\" alt=\"\" width=\"560\" height=\"45\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(16)</td>\n</tr>\n</tbody>\n</table>\n<p>again with the rectangular contour of Figure 2. The task now is to manually find <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_180.gif\" alt=\"\" width=\"6\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_181.gif\" alt=\"\" width=\"5\" height=\"12\" /> that yield good results by trial and error. Again we set <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_182.gif\" alt=\"\" width=\"156\" height=\"12\" /> so that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_183.gif\" alt=\"\" width=\"60\" height=\"14\" />.</p>\n<p>We define <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_184.gif\" alt=\"\" width=\"7\" height=\"13\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_185.gif\" alt=\"\" width=\"14\" height=\"13\" />.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_32.gif\" alt=\"\" width=\"191\" height=\"31\" /></p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_33.gif\" alt=\"\" width=\"580\" height=\"155\" /></p>\n<p>The results are promising, since there is a range of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_186.gif\" alt=\"\" width=\"5\" height=\"12\" /> that gives a result very close to the benchmark <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_187.gif\" alt=\"\" width=\"156\" height=\"12\" />, but we can do better.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_34.gif\" alt=\"\" width=\"580\" height=\"44\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_24.gif\" alt=\"\" width=\"253\" height=\"112\" /></p>\n<p>The key is to set <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_188.gif\" alt=\"\" width=\"37\" height=\"15\" /> so that <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_189.gif\" alt=\"\" width=\"50\" height=\"12\" />. For example, for <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_190.gif\" alt=\"\" width=\"26\" height=\"12\" />, a good choice of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_191.gif\" alt=\"\" width=\"5\" height=\"12\" /> is 1/5 but not 1 or 1/12. The only difference in the next command from the last is in the fourth argument of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_192.gif\" alt=\"\" width=\"14\" height=\"13\" />, where <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_193.gif\" alt=\"\" width=\"7\" height=\"13\" /> is <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_194.gif\" alt=\"\" width=\"17\" height=\"12\" /> instead of 5. The results are slightly better.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_35.gif\" alt=\"\" width=\"580\" height=\"44\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_25.gif\" alt=\"\" width=\"260\" height=\"112\" /></p>\n<p>We can study this relationship better for a smaller set of values of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_195.gif\" alt=\"\" width=\"6\" height=\"12\" /> and judge the quality.</p>\n<p class=\"input\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Input_36.gif\" alt=\"\" width=\"580\" height=\"58\" /></p>\n<p class=\"output\"><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Output_26.gif\" alt=\"\" width=\"200\" height=\"142\" /></p>\n<p>Thus we have obtained a good range of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_186.gif\" alt=\"\" width=\"5\" height=\"12\" /> where the deformation theorem clearly works. We need to work with <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_196.gif\" alt=\"\" width=\"33\" height=\"12\" /> because the smooth approximation of the Heaviside step functions introduces infinitely many new poles in the complex plane, since <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_197.gif\" alt=\"\" width=\"23\" height=\"12\" /> has (countably) infinitely many poles along the imaginary axis. This can be easily seen by rewriting <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_198.gif\" alt=\"\" width=\"10\" height=\"12\" /> as:</p>\n<table class=\"DisplayFormulaNumbered\">\n<tbody>\n<tr>\n<td><img src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_DisplayFormulaNumbered_17.gif\" alt=\"\" width=\"222\" height=\"39\" /></td>\n<td class=\"DisplayFormulaNumberedLabel\">(17)</td>\n</tr>\n</tbody>\n</table>\n<p>Therefore the choice of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_199.gif\" alt=\"\" width=\"6\" height=\"12\" /> must depend on <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_200.gif\" alt=\"\" width=\"5\" height=\"12\" /> so that the contour does not cross extra poles, making the integral gain spurious contributions. Nonetheless, finding the right <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_201.gif\" alt=\"\" width=\"6\" height=\"12\" /> that works is an empirical process, especially when the Wightman function is very complicated. Our examples thus far are simple enough that they can be easily cross-validated and evaluated without much effort.</p>\n<h3>Further Applications</h3>\n<p>The above examples have been used by the author to calculate the density matrix elements of Unruh<span class=\"special-character Dash\">–</span>DeWitt detectors interacting with massless scalar fields for various background spacetimes, where the calculations require time-dependent perturbation theory involving Dyson series expansions. Starting from the calculations in [<a href=\"#Tjoa\">4</a>] where a primitive version was first used to study entanglement harvesting in two-dimensional spacetimes with accelerating mirror (see the Appendix in [<a href=\"#Tjoa\">4</a>]), the technique was subsequently improved (using a full rectangular contour that is not close to the poles) for the entanglement harvesting problem in Schwarzschild and collapsing shell spacetimes [<a href=\"#Tjoa-Mann\">5</a>]. In [<a href=\"#Tjoa-Mann\">5</a>], the derivative-coupling functions (strictly speaking they are not Wightman functions but the proper time derivatives of the Wightman functions) are so complicated that it is somewhat surprising the upper-limit technique outlined above worked very well across large parameter spaces. The author has verified that the approximation of the Heaviside step function works well for calculations in [<a href=\"#Tjoa-Mann\">5</a>], although with the caveat: when the derivative-coupling Wightman functions can be expressed as a sum of distinct terms, the part of the derivative Wightman function that contains <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_202.gif\" alt=\"\" width=\"27\" height=\"12\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_203.gif\" alt=\"\" width=\"33\" height=\"12\" /> requires relatively small <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_204.gif\" alt=\"\" width=\"6\" height=\"12\" /> but the part that contains <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_205.gif\" alt=\"\" width=\"25\" height=\"12\" /> or <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_206.gif\" alt=\"\" width=\"31\" height=\"12\" /> may need very large <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_207.gif\" alt=\"\" width=\"44\" height=\"15\" />. This highlights the need for empirically testing the choice of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_208.gif\" alt=\"\" width=\"6\" height=\"12\" /> before proceeding with physical calculations.</p>\n<p>We extend the results of [<a href=\"#Tjoa-Mann\">5</a>] for harvesting of correlations by two quantum-mechanical detectors interacting with a quantum field in [<a href=\"#Gallock-Yoshimura\">9</a>], where we consider more complicated detector trajectories. In this context, the authors verified that the upper-limit form analogous to equation (<a href=\"#Eq:12\">12</a>) proved numerically unstable in physically relevant regimes, thus making indispensable the approximate Heaviside step functions as a way to calculate the nonlocal correlation term in entanglement harvesting contexts. In that setting, the calculation of the nonlocal term involves an integral similar to <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_209.gif\" alt=\"\" width=\"14\" height=\"12\" /> in equation (<a href=\"#Eq:10\">10</a>, but with much more complicated numerical calculations than in [<a href=\"#Tjoa-Mann\">5</a>]; in particular the upper limits are not simply affine functions of <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_210.gif\" alt=\"\" width=\"6\" height=\"12\" /> or <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_211.gif\" alt=\"\" width=\"9\" height=\"12\" />. We will explain the technicalities specific to the problem at hand when invoking the techniques outlined in [<a href=\"#Gallock-Yoshimura\">9</a>].</p>\n<p>In quantum field theory in generic spacetimes (flat or curved), there are many situations of computing integrals over distributions. Our techniques should be general enough to use in such contexts, where correlation functions take a form similar to Wightman functions. For example, we have verified that our techniques work for computing field commutators [<a href=\"#Tjoa-Mann\">5</a>] and in (<img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_212.gif\" alt=\"\" width=\"24\" height=\"12\" />)-dimensional rotating BTZ black holes [<a href=\"#Robbins-Henderson-Mann\">10</a>, <a href=\"#Henderson-Hennigar\">11</a>]. We are also able to reproduce the computations of transition rates as done for example in [<a href=\"#Louko-Satz\">12</a>] (also see Appendix of [<a href=\"#Tjoa\">4</a>]), which are fundamentally simpler because they are one-dimensional integrals over the Wightman functions.</p>\n<h3>Conclusion</h3>\n<p>In this article we have presented a straightforward implementation of contour integration using the <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_213.gif\" alt=\"\" width=\"65\" height=\"14\" /> and <img style=\"vertical-align: middle;\" src=\"https://content.wolfram.com/uploads/sites/19/2021/07/Tjoa_Math_214.gif\" alt=\"\" width=\"72\" height=\"14\" /> commands, taking advantage of powerful results in complex analysis. The goal is to provide a systematic example-based implementation of contour integration that does not require any user-defined functions and only requires setting options. We provide explicit examples of how this can be used when integrating analytically and numerically some commonly used distributions, such as Wightman functions in quantum field theory. We also provide efficient approximation schemes to compute quantities involving time-ordering operations where Heaviside step functions are required. Our examples are geared toward research in relativistic quantum information, where finite-dimensional quantum systems interact with a quantum field on a possible curved background spacetime. We believe our implementation will be useful for calculations involving various Green<span class=\"special-character CloseCurlyQuote\">’</span>s functions, propagators, integral kernels and so on for both students and researchers in fields requiring numerical evaluations of integrals over distributions without resorting to unnecessary or excessive approximation schemes.</p>\n<h3>Acknowledgments</h3>\n<p>The author thanks Kensuke Gallock-Yoshimura for help in testing the numerical schemes proposed here in [<a href=\"#Gallock-Yoshimura\">9</a>], and Nicholas Funai for reading through the draft and providing useful feedback. The author acknowledges support from the Mike-Ophelia Lazaridis Fellowship from the Institute for Quantum Computing (IQC), University of Waterloo, Canada. The author also would like to thank both the reviewer and editor for very useful and clarifying comments and recommendations.</p>\n<h3>References</h3>\n<table class=\"ReferenceTable\">\n<tbody>\n<tr>\n<td class=\"Reference\"><a name=\"Howie\"></a>[1]</td>\n<td>J. M. Howie, <em>Complex Analysis</em>, London: Springer Science & Business Media, 2003.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Brown-Churchill\"></a>[2]</td>\n<td>J. W. Brown and R. V. Churchill, <em>Complex Variables and Applications</em>, 8th ed., New York: McGraw-Hill Education, 2009.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Mukhanov-Winitzki\"></a>[3]</td>\n<td>V. Mukhanov and S. Winitzki, <em>Introduction to Quantum Effects in Gravity</em>, New York: Cambridge University Press, 2007.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Tjoa\"></a>[4]</td>\n<td>E. Tjoa. <em><span class=\"special-character OpenCurlyDoubleQuote\">“</span></em>Aspects of Quantum Field Theory with Boundary Conditions,<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <em>UWSpace</em>, 2019. <a href=\"http://hdl.handle.net/10012/14843\" target=\"_blank\">hdl.handle.net/10012/14843</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Tjoa-Mann\"></a>[5]</td>\n<td>E. Tjoa and R. B. Mann, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Harvesting Correlations in Schwarzschild and Collapsing Shell Spacetimes,<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <em>Journal of High Energy Physics</em>, <strong>08</strong>(155), 2020. <a href=\"https://doi.org/10.1007/JHEP08(2020)155\" target=\"_blank\">doi.org:10.1007/JHEP08(2020)155</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Birrell-Davies\"></a>[6]</td>\n<td>N. D. Birrell and P. C. W. Davies, <em>Quantum Fields in Curved Space</em>, Cambridge: Cambridge University Press, 1982.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Smith\"></a>[7]</td>\n<td>A. R. H. Smith. <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Detectors, Reference Frames, and Time,<span class=\"special-character CloseCurlyDoubleQuote\">”</span><em> UWSpace</em>, 2017. <a href=\"http://hdl.handle.net/10012/12618\" target=\"_blank\">hdl.handle.net/10012/12618</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Steeg-Menicucci\"></a>[8]</td>\n<td>G. Ver Steeg and N. C. Menicucci, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Entangling Power of an Expanding Universe,<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <em>Physical Review D</em>, <strong>79</strong>(4), 2009 044027. <a href=\"https://doi.org/10.1103/PhysRevD.79.044027\" target=\"_blank\">doi.org:10.1103/PhysRevD.79.044027</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Gallock-Yoshimura\"></a>[9]</td>\n<td>K. Gallock-Yoshimura, E. Tjoa and R. B. Mann, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Harvesting Entanglement with Detectors Freely Falling into a Black Hole.<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <a href=\"https://arxiv.org/abs/2102.09573\" target=\"_blank\">arxiv.org/abs/2102.09573</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Robbins-Henderson-Mann\"></a>[10]</td>\n<td>M. P. G. Robbins, L. J. Henderson and R. B. Mann, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Entanglement Amplification from Rotating Black Holes.<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <a href=\"https://arxiv.org/abs/2010.14517\" target=\"_blank\">arxiv.org/abs/2010.14517</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Henderson-Hennigar\"></a>[11]</td>\n<td>L. J. Henderson, R. A. Hennigar, R. B. Mann, A. R. H. Smith and J. Zhang, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Harvesting Entanglement from the Black Hole Vacuum,<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <em>Classical and Quantum Gravity</em>, <strong>35</strong>(21) 21LT02, 2018. <a href=\"https://doi.org/10.1088/1361-6382/aae27e\" target=\"_blank\">doi.org/10.1088/1361-6382/aae27e</a>.</td>\n</tr>\n<tr>\n<td class=\"Reference\"><a name=\"Louko-Satz\"></a>[12]</td>\n<td>J. Louko and A. Satz, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Transition Rate of the Unruh<span class=\"special-character Dash\">–</span>DeWitt Detector in Curved Spacetime,<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <em>Classical and Quantum Gravity</em>, <strong>25</strong>(5) 055012, 2008.<br />\n<a href=\"https://doi.org/10.1088/0264-9381/25/5/055012\" target=\"_blank\">doi.org/10.1088/0264-9381/25/5/055012</a>.</td>\n</tr>\n<tr>\n<td id=\"1099737697\" class=\"DOIReference\" colspan=\"2\"><a name=\"1099737697\"></a>Erickson Tjoa, <span class=\"special-character OpenCurlyDoubleQuote\">“</span>Numerical Contour Integration,<span class=\"special-character CloseCurlyDoubleQuote\">”</span> <em>The Mathematica Journal</em>, 2021. <a href=\"https://doi.org/10.3888/tmj.23-3\">doi.org/10.3888/tmj.23<span class=\"special-character Dash\">–</span>3</a>.</td>\n</tr>\n</tbody>\n</table>\n<h3 class=\"SectionAboutAuthor\">About the Author</h3>\n<p class=\"TextAboutAuthor\">Erickson Tjoa was born in Jakarta, Indonesia. He moved to Singapore at the age of 15 and studied physics and mathematics as a double major at Nanyang Technological University from 2013-2017. He then completed an MSc at the University of Waterloo, where he is currently a second-year PhD student in relativistic quantum information.</p>\n<p class=\"TextAboutAuthor\"><strong>Erickson Tjoa<br />\n</strong><em>Department of Physics and Astronomy<br />\nInstitute for Quantum Computing (IQC)<br />\nUniversity of Waterloo, ON, Canada<br />\n200 University Avenue West<br />\nWaterloo, ON, Canada N2L 3G1</em><br />\n<em><a href=\"mailto:e2tjoa@uwaterloo.ca\">e2tjoa@uwaterloo.ca</a></em></p>\n</div>\n</div>\n",
  "wfw:commentRss": "https://www.mathematica-journal.com/2021/07/16/numerical-contour-integration/feed/",
  "slash:comments": 0
}