{
  "title": "Machine learning for facial recognition",
  "link": "",
  "published": "2015-01-21T17:12:00-08:00",
  "updated": "2015-01-21T17:12:00-08:00",
  "author": {
    "name": "Damien RJ"
  },
  "id": "tag:efavdb.com,2015-01-21:/machine-learning-for-facial-recognition-3",
  "summary": "<p>A guest post, contributed by Damien Ramunno-Johnson (<a href=\"https://www.linkedin.com/profile/view?id=60223336&amp;authType=NAME_SEARCH&amp;authToken=LOV_&amp;locale=en_US&amp;trk=tyah2&amp;trkInfo=tarId%3A1420748440448%2Ctas%3Adamien%2Cidx%3A1-1-1\">LinkedIn</a>, <a href=\"https://efavdb.github.io/pages/authors.html\">bio-sketch</a>)</p>\n<h4><strong>Introduction</strong></h4>\n<p>The ability to identify faces is a skill that people develop very early in life and can apply almost effortlessly. One reason for this is that our brains are very well adapted for pattern recognition. In contrast, facial recognition can …</p>",
  "content": "<p>A guest post, contributed by Damien Ramunno-Johnson (<a href=\"https://www.linkedin.com/profile/view?id=60223336&amp;authType=NAME_SEARCH&amp;authToken=LOV_&amp;locale=en_US&amp;trk=tyah2&amp;trkInfo=tarId%3A1420748440448%2Ctas%3Adamien%2Cidx%3A1-1-1\">LinkedIn</a>, <a href=\"https://efavdb.github.io/pages/authors.html\">bio-sketch</a>)</p>\n<h4><strong>Introduction</strong></h4>\n<p>The ability to identify faces is a skill that people develop very early in life and can apply almost effortlessly. One reason for this is that our brains are very well adapted for pattern recognition. In contrast, facial recognition can be a somewhat difficult problem for computers. Today, given a full frontal image of a face, computer facial recognition software works well. However, problems can arise given large camera angles, poor lighting, or exaggerated facial expressions: Computers have a ways to go before they catch up with us in this&nbsp;arena.</p>\n<p>Although facial recognition algorithms remain imperfect, the methods that exist now are already quite useful and are being applied by many different companies. Two examples, first up Facebook: When you upload pictures to their website, it will now automatically suggest names for the people in your photos. This application is well-suited for machine learning for two reasons. First, every tagged photo already uploaded to the site provides labeled examples on which to train an algorithm, and second, people often post full face images in decent lighting. A second example is provided by Google&#8217;s Android phone <span class=\"caps\">OS</span>, which has a face unlock mode. To get this to work, you first have to train your phone by taking images of your face in different lighting conditions and from different angles. After training, the phone can attempt to recognize you. This is another cool application that also often works&nbsp;well.</p>\n<p>In this post, we&#8217;re going to develop our own basic facial learning algorithm. We&#8217;ll find that it is actually pretty straightforward to set one up that is reasonably accurate. Our post follows and expands upon the tutorial found <a href=\"http://scikit-learn.org/stable/auto_examples/applications/face_recognition.html\">here</a>.</p>\n<h4><strong>Loading packages and&nbsp;data</strong></h4>\n<div class=\"highlight\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"kn\">import</span> <span class=\"n\">print_function</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">time</span> <span class=\"kn\">import</span> <span class=\"n\">time</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"kn\">as</span> <span class=\"nn\">plt</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.cross_validation</span> <span class=\"kn\">import</span> <span class=\"n\">train_test_split</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.datasets</span> <span class=\"kn\">import</span> <span class=\"n\">fetch_lfw_people</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.grid_search</span> <span class=\"kn\">import</span> <span class=\"n\">GridSearchCV</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.metrics</span> <span class=\"kn\">import</span> <span class=\"n\">classification_report</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.metrics</span> <span class=\"kn\">import</span> <span class=\"n\">confusion_matrix</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.decomposition</span> <span class=\"kn\">import</span> <span class=\"n\">RandomizedPCA</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn.svm</span> <span class=\"kn\">import</span> <span class=\"n\">SVC</span>\n<span class=\"kn\">import</span> <span class=\"nn\">pandas</span> <span class=\"kn\">as</span> <span class=\"nn\">pd</span>\n<span class=\"o\">%</span><span class=\"n\">matplotlib</span> <span class=\"n\">inline</span>\n</pre></div>\n\n\n<p>The sklearn function <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.datasets.fetch_lfw_people.html\">fetch_lfw_people</a>, imported above, will download the data that we need, if not already present in the faces folder. The dataset we are downloading consists of a set of preprocessed images from <a href=\"http://vis-www.cs.umass.edu/lfw/\">Labeled Faces in the Wild (<span class=\"caps\">LFW</span>)</a>, a database designed for studying unconstrained face recognition. The data set contains more than 13,000 images of faces collected from the web, each labeled with the name of the person pictured. 1680 of the people pictured have two or more distinct photos in the data&nbsp;set.</p>\n<p>In our analysis here, we will impose two&nbsp;conditions.</p>\n<ol>\n<li>First, we will only consider folks that have a minimum of 70 pictures in the data&nbsp;set.</li>\n<li>We will resize the images so that they each have a 0.4 aspect&nbsp;ratio.</li>\n</ol>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">print(&#39;Loading Data&#39;)</span>\n<span class=\"err\">people = fetch_lfw_people(</span>\n<span class=\"err\">&#39;./faces&#39;, min_faces_per_person=70, resize=0.4)</span>\n<span class=\"err\">print(&#39;Done!&#39;)</span>\n<span class=\"err\">&amp;gt;&amp;gt;</span>\n<span class=\"err\">Loading Data</span>\n<span class=\"err\">Done!</span>\n</pre></div>\n\n\n<p>The object <strong>people</strong> contains the following&nbsp;data.</p>\n<ol>\n<li>people.data: a numpy array with the shape(n_samples, h*w), each row corresponds to a unravelled&nbsp;face.</li>\n<li>people.images: a numpy array with the shape(n_samples, h, w), where each row corresponds to a face. The remaining indices here contain gray-scale values for the pixels of each&nbsp;image.</li>\n<li>people.target: a numpy array with the shape(n_samples), where each row is the label for the&nbsp;face.</li>\n<li>people.target_name: a numpy array with the shape(n_labels), where each row is the name for the&nbsp;label.</li>\n</ol>\n<p>For the algorithm we will be using, we don&#8217;t need the relative position data, so we will use the unraveled&nbsp;people.data.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"p\">#</span><span class=\"nn\">Find</span> <span class=\"nt\">out</span> <span class=\"nt\">how</span> <span class=\"nt\">many</span> <span class=\"nt\">faces</span> <span class=\"nt\">we</span> <span class=\"nt\">have</span><span class=\"o\">,</span> <span class=\"nt\">and</span>\n<span class=\"p\">#</span><span class=\"nn\">the</span> <span class=\"nt\">size</span> <span class=\"nt\">of</span> <span class=\"nt\">each</span> <span class=\"nt\">picture</span> <span class=\"nt\">from</span><span class=\"o\">.</span>\n<span class=\"nt\">n_samples</span><span class=\"o\">,</span> <span class=\"nt\">h</span><span class=\"o\">,</span> <span class=\"nt\">w</span> <span class=\"o\">=</span> <span class=\"nt\">people</span><span class=\"p\">.</span><span class=\"nc\">images</span><span class=\"p\">.</span><span class=\"nc\">shape</span>\n\n<span class=\"nt\">X</span> <span class=\"o\">=</span> <span class=\"nt\">people</span><span class=\"p\">.</span><span class=\"nc\">data</span>\n<span class=\"nt\">n_features</span> <span class=\"o\">=</span> <span class=\"nt\">X</span><span class=\"p\">.</span><span class=\"nc\">shape</span><span class=\"cp\">[</span><span class=\"mi\">1</span><span class=\"cp\">]</span>\n\n<span class=\"nt\">y</span> <span class=\"o\">=</span> <span class=\"nt\">people</span><span class=\"p\">.</span><span class=\"nc\">target</span>\n<span class=\"nt\">target_names</span> <span class=\"o\">=</span> <span class=\"nt\">people</span><span class=\"p\">.</span><span class=\"nc\">target_names</span>\n<span class=\"nt\">n_classes</span> <span class=\"o\">=</span> <span class=\"nt\">target_names</span><span class=\"p\">.</span><span class=\"nc\">shape</span><span class=\"cp\">[</span><span class=\"mi\">0</span><span class=\"cp\">]</span>\n\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">Total</span> <span class=\"nt\">dataset</span> <span class=\"nt\">size</span><span class=\"o\">:&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;)</span>\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">n_images</span><span class=\"o\">:</span> <span class=\"o\">%</span><span class=\"nt\">d</span><span class=\"o\">&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span> <span class=\"o\">%</span> <span class=\"nt\">n_samples</span><span class=\"o\">)</span>\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">n_features</span><span class=\"o\">:</span> <span class=\"o\">%</span><span class=\"nt\">d</span><span class=\"o\">&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span> <span class=\"o\">%</span> <span class=\"nt\">n_features</span><span class=\"o\">)</span>\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">n_classes</span><span class=\"o\">:</span> <span class=\"o\">%</span><span class=\"nt\">d</span><span class=\"o\">&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span> <span class=\"o\">%</span> <span class=\"nt\">n_classes</span><span class=\"o\">)</span>\n<span class=\"o\">&amp;</span><span class=\"nt\">gt</span><span class=\"o\">;&amp;</span><span class=\"nt\">gt</span><span class=\"o\">;</span>\n<span class=\"nt\">Total</span> <span class=\"nt\">dataset</span> <span class=\"nt\">size</span><span class=\"o\">:</span>\n<span class=\"nt\">n_images</span><span class=\"o\">:</span> <span class=\"nt\">1288</span>\n<span class=\"nt\">n_features</span><span class=\"o\">:</span> <span class=\"nt\">1850</span>\n<span class=\"nt\">n_classes</span><span class=\"o\">:</span> <span class=\"nt\">7</span>\n</pre></div>\n\n\n<p>Looking above we see that our dataset currently has 1288 images. Each image has 1850 pixels, or features. We also have 7 classes, meaning images of 7 different&nbsp;people.</p>\n<h4><strong>Data segmentation and dimensional&nbsp;reduction</strong></h4>\n<p>At this point we need to segment our data. We are going to use <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.cross_validation.train_test_split.html\">train_test_split</a>, which will take care of splitting our data into random training and testing data sets. Next, we note that we have a lot of features and that there are advantages to having fewer: First, the computational cost is reduced. Second, having fewer features reduces the data’s dimension which can also reduce the complexity of the model and help avoid overfitting. Instead of dropping individual pixels outright, we will carry out a dimensional reduction via a Principle Component Analysis <a href=\"http://en.wikipedia.org/wiki/Principal_component_analysis\"><span class=\"caps\">PCA</span></a>. <span class=\"caps\">PCA</span> works by attempting to represent the variance in the training data with as few dimensions as possible. So instead of dropping features, as we did in our <a href=\"http://efavdb.github.io/machine-learning-with-wearable-sensors\">wearable sensor example</a> analysis, here we will compress features together, and then use only the most important feature combinations. When this is done to images, the features returned by <span class=\"caps\">PCA</span> are commonly called eigenfaces (some examples are given&nbsp;below).</p>\n<p>The function we are going to use to carry out our <span class=\"caps\">PCA</span> is <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.RandomizedPCA.html\">RandomizedPCA</a>. We&#8217;ll keep the top 150 eigenfaces, and we&#8217;ll also whiten the data &#8212; ie normalize our new, principal component feature set. The goal of whitening is to make the input less redundant. Whitening is performed by rotating into the coordinate space of the principal components, dividing each dimension by square root of variance in that direction (giving the feature unit variance), and then rotating back to pixel&nbsp;space.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"o\">#</span> <span class=\"n\">split</span> <span class=\"k\">into</span> <span class=\"n\">a</span> <span class=\"n\">training</span> <span class=\"k\">and</span> <span class=\"n\">testing</span> <span class=\"k\">set</span>\n<span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">X_test</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">,</span> <span class=\"n\">y_test</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span>\n<span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">25</span><span class=\"p\">)</span>\n\n<span class=\"o\">#</span> <span class=\"n\">Compute</span> <span class=\"n\">the</span> <span class=\"n\">PCA</span> <span class=\"p\">(</span><span class=\"n\">eigenfaces</span><span class=\"p\">)</span> <span class=\"k\">on</span> <span class=\"n\">the</span> <span class=\"n\">face</span> <span class=\"n\">dataset</span>\n<span class=\"n\">n_components</span> <span class=\"o\">=</span> <span class=\"mi\">150</span>\n\n<span class=\"n\">pca</span> <span class=\"o\">=</span> <span class=\"n\">RandomizedPCA</span><span class=\"p\">(</span>\n<span class=\"n\">n_components</span><span class=\"o\">=</span><span class=\"n\">n_components</span><span class=\"p\">,</span> <span class=\"n\">whiten</span><span class=\"o\">=</span><span class=\"k\">True</span><span class=\"p\">).</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">)</span>\n\n<span class=\"n\">eigenfaces</span> <span class=\"o\">=</span> <span class=\"n\">pca</span><span class=\"p\">.</span><span class=\"n\">components_</span><span class=\"p\">.</span><span class=\"n\">reshape</span><span class=\"p\">((</span><span class=\"n\">n_components</span><span class=\"p\">,</span> <span class=\"n\">h</span><span class=\"p\">,</span> <span class=\"n\">w</span><span class=\"p\">))</span>\n<span class=\"n\">X_train_pca</span> <span class=\"o\">=</span> <span class=\"n\">pca</span><span class=\"p\">.</span><span class=\"k\">transform</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<h4><strong>Visualizing the&nbsp;eigenfaces</strong></h4>\n<p>Let&#8217;s now take a moment to examine the dataset&#8217;s principal eigenfaces: the set of images that we will project each example onto to obtain independent features. To do that we will use the following helper function to make life easier &#8212; visual&nbsp;follows.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">#</span><span class=\"w\"> </span><span class=\"n\">A</span><span class=\"w\"> </span><span class=\"n\">helper</span><span class=\"w\"> </span><span class=\"k\">function</span><span class=\"w\"> </span><span class=\"k\">to</span><span class=\"w\"> </span><span class=\"n\">make</span><span class=\"w\"> </span><span class=\"n\">plots</span><span class=\"w\"> </span><span class=\"k\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">faces</span><span class=\"w\"></span>\n<span class=\"n\">def</span><span class=\"w\"> </span><span class=\"n\">plot_gallery</span><span class=\"p\">(</span><span class=\"n\">images</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">titles</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n_row</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n_col</span><span class=\"o\">=</span><span class=\"mi\">4</span><span class=\"p\">)</span><span class=\"err\">:</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">figure</span><span class=\"p\">(</span><span class=\"n\">figsize</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"mf\">1.8</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">n_col</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mf\">2.4</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">n_row</span><span class=\"p\">))</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">subplots_adjust</span><span class=\"p\">(</span><span class=\"n\">bottom</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nf\">left</span><span class=\"o\">=</span><span class=\"mf\">.01</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nf\">right</span><span class=\"o\">=</span><span class=\"mf\">.99</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"k\">top</span><span class=\"o\">=</span><span class=\"mf\">.90</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">hspace</span><span class=\"o\">=</span><span class=\"mf\">.35</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"ow\">in</span><span class=\"w\"> </span><span class=\"k\">range</span><span class=\"p\">(</span><span class=\"n\">n_row</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">n_col</span><span class=\"p\">)</span><span class=\"err\">:</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">subplot</span><span class=\"p\">(</span><span class=\"n\">n_row</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">n_col</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">imshow</span><span class=\"p\">(</span><span class=\"n\">images</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">.</span><span class=\"n\">reshape</span><span class=\"p\">((</span><span class=\"n\">h</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"p\">)),</span><span class=\"w\"> </span><span class=\"n\">cmap</span><span class=\"o\">=</span><span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">cm</span><span class=\"p\">.</span><span class=\"n\">gray</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"n\">titles</span><span class=\"o\">[</span><span class=\"n\">i</span><span class=\"o\">]</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">size</span><span class=\"o\">=</span><span class=\"mi\">12</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">xticks</span><span class=\"p\">(())</span><span class=\"w\"></span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">yticks</span><span class=\"p\">(())</span><span class=\"w\"></span>\n\n<span class=\"err\">#</span><span class=\"w\"> </span><span class=\"n\">Plot</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">gallery</span><span class=\"w\"> </span><span class=\"k\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">most</span><span class=\"w\"> </span><span class=\"n\">significative</span><span class=\"w\"> </span><span class=\"n\">eigenfaces</span><span class=\"w\"></span>\n<span class=\"n\">eigenface_titles</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\"></span>\n<span class=\"n\">&amp;quot;eigenface %d&amp;quot; % i for i in range(eigenfaces.shape[0</span><span class=\"o\">]</span><span class=\"p\">)</span><span class=\"err\">]</span><span class=\"w\"></span>\n\n<span class=\"n\">plot_gallery</span><span class=\"p\">(</span><span class=\"n\">eigenfaces</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">eigenface_titles</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"p\">)</span><span class=\"w\"></span>\n\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">show</span><span class=\"p\">()</span><span class=\"w\"></span>\n</pre></div>\n\n\n<p><a href=\"https://efavdb.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-21-at-12.36.09-PM.png\"><img alt=\"Screen Shot 2015-01-21 at 12.36.09 PM\" src=\"https://efavdb.com/wp-content/uploads/2015/01/Screen-Shot-2015-01-21-at-12.36.09-PM.png\"></a></p>\n<h4><strong>Training a&nbsp;model</strong></h4>\n<p>Now that we have reduced the dimensionality of the data it is time to go ahead and train a model. I am going to use the same <span class=\"caps\">SVM</span> and GridSearchCV method I explained in my previous <a href=\"http://efavdb.github.io/machine-learning-with-wearable-sensors\">post</a>. However, instead of using a linear kernel, as we did last time, I&#8217;ll use instead a <a href=\"http://scikit-learn.org/stable/auto_examples/svm/plot_rbf_parameters.html\">radial basis function (<span class=\"caps\">RBF</span>)</a> kernel. The <span class=\"caps\">RBF</span> kernel is a good choice here since we&#8217;d like to have non-linear decision boundaries &#8212; in general, it&#8217;s a reasonable idea to try this out whenever the number of training examples outnumbers the number of features characterizing those examples. The parameter C here acts as a regularization term: Small C values give you smooth decision boundaries, while large C values give complicated boundaries that attempt to fit/accommodate all training data. The gamma parameter defines how far the influence of a single point example extends (the width of the <span class=\"caps\">RBF</span>&nbsp;kernel).</p>\n<div class=\"highlight\"><pre><span></span><span class=\"p\">#</span><span class=\"nn\">Train</span> <span class=\"nt\">a</span> <span class=\"nt\">SVM</span> <span class=\"nt\">classification</span> <span class=\"nt\">model</span>\n\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">Fitting</span> <span class=\"nt\">the</span> <span class=\"nt\">classifier</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">training</span> <span class=\"nt\">set</span><span class=\"o\">&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;)</span>\n<span class=\"nt\">t0</span> <span class=\"o\">=</span> <span class=\"nt\">time</span><span class=\"o\">()</span>\n<span class=\"nt\">param_grid</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"err\">&#39;C&#39;:</span> <span class=\"cp\">[</span><span class=\"mi\">1</span><span class=\"nx\">e3</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"nx\">e3</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"nx\">e4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"nx\">e4</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"nx\">e5</span><span class=\"cp\">]</span><span class=\"err\">,</span>\n<span class=\"err\">&#39;gamma&#39;:</span> <span class=\"cp\">[</span><span class=\"mf\">0.0001</span><span class=\"p\">,</span> <span class=\"mf\">0.0005</span><span class=\"p\">,</span> <span class=\"mf\">0.001</span><span class=\"p\">,</span> <span class=\"mf\">0.005</span><span class=\"p\">,</span> <span class=\"mf\">0.01</span><span class=\"p\">,</span> <span class=\"mf\">0.1</span><span class=\"cp\">]</span><span class=\"err\">,</span> <span class=\"p\">}</span>\n\n<span class=\"nt\">clf</span> <span class=\"o\">=</span> <span class=\"nt\">GridSearchCV</span><span class=\"o\">(</span>\n<span class=\"nt\">SVC</span><span class=\"o\">(</span><span class=\"nt\">kernel</span><span class=\"o\">=</span><span class=\"s1\">&#39;rbf&#39;</span><span class=\"o\">,</span> <span class=\"nt\">class_weight</span><span class=\"o\">=</span><span class=\"s1\">&#39;auto&#39;</span><span class=\"o\">),</span> <span class=\"nt\">param_grid</span><span class=\"o\">)</span>\n<span class=\"nt\">clf</span> <span class=\"o\">=</span> <span class=\"nt\">clf</span><span class=\"p\">.</span><span class=\"nc\">fit</span><span class=\"o\">(</span><span class=\"nt\">X_train_pca</span><span class=\"o\">,</span> <span class=\"nt\">y_train</span><span class=\"o\">)</span>\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">done</span> <span class=\"nt\">in</span> <span class=\"o\">%</span><span class=\"nt\">0</span><span class=\"p\">.</span><span class=\"nc\">3fs</span><span class=\"o\">&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span> <span class=\"o\">%</span> <span class=\"o\">(</span><span class=\"nt\">time</span><span class=\"o\">()</span> <span class=\"nt\">-</span> <span class=\"nt\">t0</span><span class=\"o\">))</span>\n<span class=\"nt\">print</span><span class=\"o\">(&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;</span><span class=\"nt\">Best</span> <span class=\"nt\">estimator</span> <span class=\"nt\">found</span> <span class=\"nt\">by</span> <span class=\"nt\">grid</span> <span class=\"nt\">search</span><span class=\"o\">:&amp;</span><span class=\"nt\">quot</span><span class=\"o\">;)</span>\n<span class=\"nt\">print</span><span class=\"o\">(</span><span class=\"nt\">clf</span><span class=\"p\">.</span><span class=\"nc\">best_estimator_</span><span class=\"o\">)</span>\n\n<span class=\"o\">&amp;</span><span class=\"nt\">gt</span><span class=\"o\">;&amp;</span><span class=\"nt\">gt</span><span class=\"o\">;</span>\n<span class=\"nt\">Fitting</span> <span class=\"nt\">the</span> <span class=\"nt\">classifier</span> <span class=\"nt\">to</span> <span class=\"nt\">the</span> <span class=\"nt\">training</span> <span class=\"nt\">set</span>\n<span class=\"nt\">done</span> <span class=\"nt\">in</span> <span class=\"nt\">16</span><span class=\"p\">.</span><span class=\"nc\">056s</span>\n<span class=\"nt\">Best</span> <span class=\"nt\">estimator</span> <span class=\"nt\">found</span> <span class=\"nt\">by</span> <span class=\"nt\">grid</span> <span class=\"nt\">search</span><span class=\"o\">:</span>\n<span class=\"nt\">SVC</span><span class=\"o\">(</span><span class=\"nt\">C</span><span class=\"o\">=</span><span class=\"nt\">1000</span><span class=\"p\">.</span><span class=\"nc\">0</span><span class=\"o\">,</span> <span class=\"nt\">cache_size</span><span class=\"o\">=</span><span class=\"nt\">200</span><span class=\"o\">,</span> <span class=\"nt\">class_weight</span><span class=\"o\">=</span><span class=\"s1\">&#39;auto&#39;</span><span class=\"o\">,</span> <span class=\"nt\">coef0</span><span class=\"o\">=</span><span class=\"nt\">0</span><span class=\"p\">.</span><span class=\"nc\">0</span><span class=\"o\">,</span>\n<span class=\"nt\">degree</span><span class=\"o\">=</span><span class=\"nt\">3</span><span class=\"o\">,</span> <span class=\"nt\">gamma</span><span class=\"o\">=</span><span class=\"nt\">0</span><span class=\"p\">.</span><span class=\"nc\">001</span><span class=\"o\">,</span> <span class=\"nt\">kernel</span><span class=\"o\">=</span><span class=\"s1\">&#39;rbf&#39;</span><span class=\"o\">,</span> <span class=\"nt\">max_iter</span><span class=\"o\">=</span><span class=\"nt\">-1</span><span class=\"o\">,</span>\n<span class=\"nt\">probability</span><span class=\"o\">=</span><span class=\"nt\">False</span><span class=\"o\">,</span> <span class=\"nt\">random_state</span><span class=\"o\">=</span><span class=\"nt\">None</span><span class=\"o\">,</span> <span class=\"nt\">shrinking</span><span class=\"o\">=</span><span class=\"nt\">True</span><span class=\"o\">,</span>\n<span class=\"nt\">tol</span><span class=\"o\">=</span><span class=\"nt\">0</span><span class=\"p\">.</span><span class=\"nc\">001</span><span class=\"o\">,</span> <span class=\"nt\">verbose</span><span class=\"o\">=</span><span class=\"nt\">False</span><span class=\"o\">)</span>\n</pre></div>\n\n\n<h4><strong>Model&nbsp;validation</strong></h4>\n<p>That&#8217;s it for training! Next we&#8217;ll validate our model on the testing data set. Below, we first use our <span class=\"caps\">PCA</span> model to transform the testing data into our current feature space. Then, we apply our model to make predictions on this set. To get a feel for how well the model is doing, we print a <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html\">classification_report</a> and a <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html\">confusion matrix</a>.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"o\">#</span><span class=\"n\">Quantitative</span> <span class=\"n\">evaluation</span> <span class=\"k\">of</span> <span class=\"n\">the</span> <span class=\"n\">model</span> <span class=\"n\">quality</span> <span class=\"k\">on</span> <span class=\"n\">the</span> <span class=\"n\">test</span> <span class=\"k\">set</span>\n<span class=\"o\">#</span><span class=\"n\">Validate</span> <span class=\"n\">the</span> <span class=\"k\">data</span>\n<span class=\"n\">X_test_pca</span> <span class=\"o\">=</span> <span class=\"n\">pca</span><span class=\"p\">.</span><span class=\"k\">transform</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test_pca</span><span class=\"p\">)</span>\n\n<span class=\"n\">print</span><span class=\"p\">(</span><span class=\"n\">classification_report</span><span class=\"p\">(</span>\n<span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">,</span> <span class=\"n\">target_names</span><span class=\"o\">=</span><span class=\"n\">target_names</span><span class=\"p\">))</span>\n\n<span class=\"n\">print</span><span class=\"p\">(</span><span class=\"s1\">&#39;Confusion Matrix&#39;</span><span class=\"p\">)</span>\n<span class=\"o\">#</span><span class=\"n\">Make</span> <span class=\"n\">a</span> <span class=\"k\">data</span> <span class=\"n\">frame</span> <span class=\"n\">so</span> <span class=\"n\">we</span> <span class=\"n\">can</span> <span class=\"n\">have</span> <span class=\"k\">some</span> <span class=\"n\">nice</span> <span class=\"n\">labels</span>\n<span class=\"n\">cm</span> <span class=\"o\">=</span> <span class=\"n\">confusion_matrix</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"o\">=</span><span class=\"n\">range</span><span class=\"p\">(</span><span class=\"n\">n_classes</span><span class=\"p\">))</span>\n<span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"p\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">(</span><span class=\"n\">cm</span><span class=\"p\">,</span> <span class=\"n\">columns</span> <span class=\"o\">=</span> <span class=\"n\">target_names</span><span class=\"p\">,</span> <span class=\"k\">index</span> <span class=\"o\">=</span> <span class=\"n\">target_names</span><span class=\"p\">)</span>\n<span class=\"n\">print</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">)</span>\n\n<span class=\"o\">&amp;</span><span class=\"n\">gt</span><span class=\"p\">;</span><span class=\"o\">&amp;</span><span class=\"n\">gt</span><span class=\"p\">;</span>\n<span class=\"k\">precision</span> <span class=\"n\">recall</span> <span class=\"n\">f1</span><span class=\"o\">-</span><span class=\"n\">score</span> <span class=\"n\">support</span>\n\n<span class=\"n\">Ariel</span> <span class=\"n\">Sharon</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">81</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">85</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">83</span> <span class=\"mi\">20</span>\n<span class=\"n\">Colin</span> <span class=\"n\">Powell</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">82</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">78</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">80</span> <span class=\"mi\">54</span>\n<span class=\"n\">Donald</span> <span class=\"n\">Rumsfeld</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">78</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">67</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">72</span> <span class=\"mi\">27</span>\n<span class=\"n\">George</span> <span class=\"n\">W</span> <span class=\"n\">Bush</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">87</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">95</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">91</span> <span class=\"mi\">139</span>\n<span class=\"n\">Gerhard</span> <span class=\"n\">Schroeder</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">86</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">73</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">79</span> <span class=\"mi\">26</span>\n<span class=\"n\">Hugo</span> <span class=\"n\">Chavez</span> <span class=\"mi\">1</span><span class=\"p\">.</span><span class=\"mi\">00</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">75</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">86</span> <span class=\"mi\">20</span>\n<span class=\"n\">Tony</span> <span class=\"n\">Blair</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">84</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">89</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">86</span> <span class=\"mi\">36</span>\n\n<span class=\"k\">avg</span> <span class=\"o\">/</span> <span class=\"n\">total</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">85</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">85</span> <span class=\"mi\">0</span><span class=\"p\">.</span><span class=\"mi\">85</span> <span class=\"mi\">322</span>\n\n<span class=\"n\">Confusion</span> <span class=\"n\">Matrix</span>\n<span class=\"n\">Ariel</span> <span class=\"n\">Sharon</span> <span class=\"n\">Colin</span> <span class=\"n\">Powell</span> <span class=\"n\">Donald</span> <span class=\"n\">Rumsfeld</span> <span class=\"n\">George</span> <span class=\"n\">W</span> <span class=\"n\">Bush</span> <span class=\"err\">\\</span>\n<span class=\"n\">Ariel</span> <span class=\"n\">Sharon</span> <span class=\"mi\">17</span> <span class=\"mi\">3</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span>\n<span class=\"n\">Colin</span> <span class=\"n\">Powell</span> <span class=\"mi\">1</span> <span class=\"mi\">42</span> <span class=\"mi\">1</span> <span class=\"mi\">7</span>\n<span class=\"n\">Donald</span> <span class=\"n\">Rumsfeld</span> <span class=\"mi\">3</span> <span class=\"mi\">1</span> <span class=\"mi\">18</span> <span class=\"mi\">3</span>\n<span class=\"n\">George</span> <span class=\"n\">W</span> <span class=\"n\">Bush</span> <span class=\"mi\">0</span> <span class=\"mi\">3</span> <span class=\"mi\">3</span> <span class=\"mi\">132</span>\n<span class=\"n\">Gerhard</span> <span class=\"n\">Schroeder</span> <span class=\"mi\">0</span> <span class=\"mi\">1</span> <span class=\"mi\">1</span> <span class=\"mi\">3</span>\n<span class=\"n\">Hugo</span> <span class=\"n\">Chavez</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">4</span>\n<span class=\"n\">Tony</span> <span class=\"n\">Blair</span> <span class=\"mi\">0</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"mi\">3</span>\n\n<span class=\"n\">Gerhard</span> <span class=\"n\">Schroeder</span> <span class=\"n\">Hugo</span> <span class=\"n\">Chavez</span> <span class=\"n\">Tony</span> <span class=\"n\">Blair</span>\n<span class=\"n\">Ariel</span> <span class=\"n\">Sharon</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span>\n<span class=\"n\">Colin</span> <span class=\"n\">Powell</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"mi\">2</span>\n<span class=\"n\">Donald</span> <span class=\"n\">Rumsfeld</span> <span class=\"mi\">1</span> <span class=\"mi\">0</span> <span class=\"mi\">1</span>\n<span class=\"n\">George</span> <span class=\"n\">W</span> <span class=\"n\">Bush</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">1</span>\n<span class=\"n\">Gerhard</span> <span class=\"n\">Schroeder</span> <span class=\"mi\">19</span> <span class=\"mi\">0</span> <span class=\"mi\">2</span>\n<span class=\"n\">Hugo</span> <span class=\"n\">Chavez</span> <span class=\"mi\">1</span> <span class=\"mi\">15</span> <span class=\"mi\">0</span>\n<span class=\"n\">Tony</span> <span class=\"n\">Blair</span> <span class=\"mi\">0</span> <span class=\"mi\">0</span> <span class=\"mi\">32</span>\n</pre></div>\n\n\n<p>As a quick reminder, lets define what the terms above&nbsp;are:</p>\n<ol>\n<li>precision is the ratio Tp / (Tp + Fp) where Tp is the number of true positives and Fp the number of false&nbsp;positives.</li>\n<li>recall is the ration of Tp / (Tp + Fn) where Fn is the number of false&nbsp;negatives.</li>\n<li>f1-score is (precision * recall) / (precision +&nbsp;recall)</li>\n<li>support is the total number of occurrences of each&nbsp;face.</li>\n</ol>\n<p>In our second table here, we have printed a confusion matrix, which provides a nice summary visualization of our results: Each row is the actual class, and the columns are the predicted class. For example, in row 1 there are 17 correct identifications of Arial Sharon, and 5 wrong ones. Using our previously defined helper plotting function, we show some examples of predicted vs true names below. Our simple algorithm&#8217;s accuracy is imperfect, yet&nbsp;satisfying!</p>\n<div class=\"highlight\"><pre><span></span><span class=\"n\">#Plot</span><span class=\"w\"> </span><span class=\"n\">predictions</span><span class=\"w\"> </span><span class=\"k\">on</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"n\">portion</span><span class=\"w\"> </span><span class=\"k\">of</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">test</span><span class=\"w\"> </span><span class=\"k\">set</span><span class=\"w\"></span>\n<span class=\"n\">def</span><span class=\"w\"> </span><span class=\"n\">title</span><span class=\"p\">(</span><span class=\"n\">y_pred</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y_test</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">target_names</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"p\">)</span><span class=\"err\">:</span><span class=\"w\"></span>\n<span class=\"n\">pred_name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">target_names</span><span class=\"o\">[</span><span class=\"n\">y_pred[i</span><span class=\"o\">]</span><span class=\"err\">]</span><span class=\"p\">.</span><span class=\"n\">rsplit</span><span class=\"p\">(</span><span class=\"s1\">&#39; &#39;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">[</span><span class=\"n\">-1</span><span class=\"o\">]</span><span class=\"w\"></span>\n<span class=\"n\">true_name</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">target_names</span><span class=\"o\">[</span><span class=\"n\">y_test[i</span><span class=\"o\">]</span><span class=\"err\">]</span><span class=\"p\">.</span><span class=\"n\">rsplit</span><span class=\"p\">(</span><span class=\"s1\">&#39; &#39;</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"p\">)</span><span class=\"o\">[</span><span class=\"n\">-1</span><span class=\"o\">]</span><span class=\"w\"></span>\n<span class=\"k\">return</span><span class=\"w\"> </span><span class=\"s1\">&#39;predicted: %s\\ntrue: %s&#39;</span><span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">pred_name</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">true_name</span><span class=\"p\">)</span><span class=\"w\"></span>\n\n<span class=\"n\">prediction_titles</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"o\">[</span><span class=\"n\">title(y_pred, y_test, target_names, i)</span>\n<span class=\"n\">for i in range(y_pred.shape[0</span><span class=\"o\">]</span><span class=\"p\">)</span><span class=\"err\">]</span><span class=\"w\"></span>\n\n<span class=\"n\">plot_gallery</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">prediction_titles</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">h</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">w</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"p\">)</span><span class=\"w\"></span>\n</pre></div>\n\n\n<p><a href=\"https://efavdb.com/wp-content/uploads/2015/01/download.png\"><img alt=\"download\" src=\"https://efavdb.com/wp-content/uploads/2015/01/download.png\"></a></p>\n<h4><strong>Discussion</strong></h4>\n<p>85% average accuracy shows that <span class=\"caps\">PCA</span> (Eigenface analysis) can provide accurate face recognition results, given just a modest amount of training data. There are pros and cons to eigenfaces&nbsp;however:</p>\n<ul>\n<li>Pros<ol>\n<li>Training can be&nbsp;automated.</li>\n<li>Once the the eigenfaces are calculated, face recognition can be performed in real&nbsp;time.</li>\n<li>Eigenfaces can handle large&nbsp;databases.</li>\n</ol>\n</li>\n<li>Cons<ol>\n<li>Sensitive to lighting&nbsp;conditions.</li>\n<li>Expression changes are not handled&nbsp;well.</li>\n<li>Has trouble when the face angle&nbsp;changes.</li>\n<li>Difficult to interpret eigenfaces: Eg, one can&#8217;t easily read off from these eye separation distance,&nbsp;etc.</li>\n</ol>\n</li>\n</ul>\n<p>There are more advanced facial recognition methods that take advantage of features special to faces. One example is provided by the <a href=\"http://en.wikipedia.org/wiki/Active_appearance_model\">Active Appearance Model (<span class=\"caps\">AAM</span>)</a>, which finds facial features (nose, mouth, etc.), and then identifies relationships between these to carry out identifications. Whatever the approach, the overall methodology is the same for all facial recognition&nbsp;algorithms:</p>\n<ol>\n<li>Take a labeled set of&nbsp;faces.</li>\n<li>Extract features from those faces using some method of choice (eg&nbsp;eigenfaces).</li>\n<li>Train a machine learning model on those&nbsp;features.</li>\n<li>Extract features from a new face, and predict the&nbsp;identity.</li>\n</ol>\n<p>The story doesn&#8217;t end with finding faces in photos. Facial recognition is just a subset of machine vision, which is currently being applied widely in industry. For example, Intel and other semiconductor manufactures use machine vision to detect defects in the chips being produced &#8212; one application where by-hand (human) analysis is not possible and computers have the upper&nbsp;hand.</p>",
  "category": [
    "",
    ""
  ]
}