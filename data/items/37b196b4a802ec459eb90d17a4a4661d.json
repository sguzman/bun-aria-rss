{
  "title": "Migrations &#8211; or how to fix technical debt",
  "link": "https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/",
  "comments": "https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/#respond",
  "dc:creator": "Peadar Coyle",
  "pubDate": "Fri, 05 Jun 2020 20:37:23 +0000",
  "category": [
    "python",
    "Technology",
    "infrastructure",
    "management",
    "migrations",
    "software development"
  ],
  "guid": "https://peadarcoyle.com/?p=2349",
  "description": "My company www.aflorithmic.ai recently went through some migrations. There were a few from the easy &#8211; moving from python anywhere to AWS Elastic Beanstalk, to the more involved &#8211; a big refactoring that involved moving ejecting from Expo. However, I think the lessons apply. &#160; Firstly, I’m not an expert. I’ve been involved in migrations&#8230; <a href=\"https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/\" class=\"more-link\">Continue reading <span class=\"screen-reader-text\">Migrations &#8211; or how to fix technical debt</span></a>",
  "content:encoded": "<p><span style=\"font-weight: 400;\">My company </span><a href=\"http://www.aflorithmic.ai\"><span style=\"font-weight: 400;\">www.aflorithmic.ai</span></a><span style=\"font-weight: 400;\"> recently went through some migrations. There were a few from the easy &#8211; moving from python anywhere to AWS Elastic Beanstalk, to the more involved &#8211; a big refactoring that involved moving ejecting from Expo. However, I think the lessons apply.</span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\">Firstly, I’m not an expert. I’ve been involved in migrations over my career. And I’ve always found them stressful. </span><span style=\"font-weight: 400;\">I think that’s because a migration often involves existing stakeholders, and the fact is that sometimes migrations fail. </span></p>\n<p>&nbsp;</p>\n<p><b>Why do we need migrations?</b></p>\n<p><img data-attachment-id=\"2352\" data-permalink=\"https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/screenshot-2020-05-15-22-28-48/\" data-orig-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?fit=1250%2C602&ssl=1\" data-orig-size=\"1250,602\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"Screenshot 2020-05-15 22.28.48\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?fit=300%2C144&ssl=1\" data-large-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?fit=730%2C351&ssl=1\" decoding=\"async\" loading=\"lazy\" class=\"alignnone size-full wp-image-2352\" src=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?resize=730%2C352&#038;ssl=1\" alt=\"Screenshot 2020-05-15 22.28.48\" width=\"730\" height=\"352\" srcset=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?w=1250&ssl=1 1250w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?resize=300%2C144&ssl=1 300w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?resize=1024%2C493&ssl=1 1024w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?resize=768%2C370&ssl=1 768w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?resize=900%2C433&ssl=1 900w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.48.png?resize=260%2C125&ssl=1 260w\" sizes=\"(max-width: 730px) 100vw, 730px\" data-recalc-dims=\"1\" /></p>\n<p><span style=\"font-weight: 400;\">Everyone who’s worked with code knows this. And sometimes that’s a point of embarrassment. In a hackathon, you can create an app in 3 hours, but it can take you weeks to add a new feature to an existing app or system. A lot of that is just one of those facts of life which is entropy increases, and things just get more complicated. So the reason it can take weeks to add a feature, is that you need to respect the existing users. </span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\">Technical debt is an inevitable thing that happens to a code base with time. Not to mention the maintenance cost of an existing codebase. </span></p>\n<p><span style=\"font-weight: 400;\">One thing that’s controversial about migrations is that they’re not easy. They are a way to get technical leverage. You invest now and slow down in the hope of payment in the future. There are other fixes that Engineers and Engineering managers will bring in. These include monitoring tools and code-reviews. </span></p>\n<p><span style=\"font-weight: 400;\">I’m the co-founder of a startup. I’ve seen my engineering team grow from 3 people to 10 in the past 15 months. So I’ve inevitably seen bringing in more communication and things like code-review. These suggestions are good, but they run out. </span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\"><strong>Migrations are the only mechanism to effectively manage technical debt as your company and code grows. If you don&#8217;t get effective at software and system migrations, you&#8217;ll end up languishing in technical debt</strong>.</span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\">One thing I’ve learned in my career is that most tools can only survive about one order of magnitude of growth. If your company grows you’ll have to run migrations, otherwise you’ll have over engineered your earlier systems. </span></p>\n<p>&nbsp;</p>\n<p><b>Productivity and migrations</b></p>\n<p><span style=\"font-weight: 400;\"> </span></p>\n<p><span style=\"font-weight: 400;\">This diagram explains how migrations help with technical debt</span></p>\n<p><img data-attachment-id=\"2351\" data-permalink=\"https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/screenshot-2020-05-15-22-28-56/\" data-orig-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?fit=1274%2C636&ssl=1\" data-orig-size=\"1274,636\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"Screenshot 2020-05-15 22.28.56\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?fit=300%2C150&ssl=1\" data-large-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?fit=730%2C364&ssl=1\" decoding=\"async\" loading=\"lazy\" class=\"alignnone size-full wp-image-2351\" src=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?resize=730%2C364&#038;ssl=1\" alt=\"Screenshot 2020-05-15 22.28.56\" width=\"730\" height=\"364\" srcset=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?w=1274&ssl=1 1274w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?resize=300%2C150&ssl=1 300w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?resize=1024%2C511&ssl=1 1024w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?resize=768%2C383&ssl=1 768w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?resize=900%2C449&ssl=1 900w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.28.56.png?resize=260%2C130&ssl=1 260w\" sizes=\"(max-width: 730px) 100vw, 730px\" data-recalc-dims=\"1\" /></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\">That’s one scenario. What happens if a migration fails? You might think that&#8217;s a strange question. However, <a href=\"https://www.zdnet.com/article/technology-migrations-are-more-painful-and-cloud-isnt-making-them-any-easier/\">migrations</a> do fail. </span><span style=\"font-weight: 400;\">Sometimes you’ll move to a new ecosystem, and it just doesn’t work. </span><span style=\"font-weight: 400;\">Well, you can get a situation where a codebase has like no further productivity. If this happens you’re in a lot of trouble but this does happen. </span></p>\n<p>It looks like this.</p>\n<p><img data-attachment-id=\"2350\" data-permalink=\"https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/screenshot-2020-05-15-22-29-02/\" data-orig-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?fit=1398%2C604&ssl=1\" data-orig-size=\"1398,604\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"Screenshot 2020-05-15 22.29.02\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?fit=300%2C130&ssl=1\" data-large-file=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?fit=730%2C315&ssl=1\" decoding=\"async\" loading=\"lazy\" class=\"alignnone size-full wp-image-2350\" src=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?resize=730%2C315&#038;ssl=1\" alt=\"Screenshot 2020-05-15 22.29.02\" width=\"730\" height=\"315\" srcset=\"https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?w=1398&ssl=1 1398w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?resize=300%2C130&ssl=1 300w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?resize=1024%2C442&ssl=1 1024w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?resize=768%2C332&ssl=1 768w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?resize=900%2C389&ssl=1 900w, https://i0.wp.com/peadarcoyle.com/wp-content/uploads/2020/05/Screenshot-2020-05-15-22.29.02.png?resize=260%2C112&ssl=1 260w\" sizes=\"(max-width: 730px) 100vw, 730px\" data-recalc-dims=\"1\" /></p>\n<p>&nbsp;</p>\n<p><b>Migrations as strategic bets</b></p>\n<p><span style=\"font-weight: 400;\">Firstly it’s worth pointing out that any migration is a </span><b>strategic bet </b><span style=\"font-weight: 400;\">for your company. Often you’ll know a migration is coming because you keep pushing it back. This may be because the tool is running out of use (Python 2.7 to Python 3+ is one example) or you may have functionality that you can’t provide with your current tools (certain database migrations). You may hit the limits of a particular framework (<a href=\"http://www.expo.io\">Expo</a>, <a href=\"https://rubyonrails.org/\">Ruby on Rails</a>). It is the nature of a strategic bet that sometimes they fail. One more point is that you can only handle so many migrations at once. Your organization has a limited number of them they can do in a year. </span></p>\n<p>&nbsp;</p>\n<p><b>A framework for migrations</b></p>\n<p>&nbsp;</p>\n<ul>\n<li><b>Derisk</b></li>\n</ul>\n<p>&nbsp;</p>\n<ul>\n<li><b>Prototype (one easy, then hard)</b></li>\n</ul>\n<ul>\n<li>Finish</li>\n</ul>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p>&nbsp;</p>\n<p><b>Derisk</b></p>\n<p><span style=\"font-weight: 400;\">The first step is to de-risk the migration. A good way to do this is to write a design document. It’s important to both show this to your detractors and your supporters. This whole process of writing a document and having people discuss it is super important for creating a </span><b>shared understanding </b><span style=\"font-weight: 400;\">and also having an outline of what’s the tradeoffs in a particular design. </span><i><span style=\"font-weight: 400;\">All architecture is compromise</span></i><span style=\"font-weight: 400;\">. </span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\">Also, remember that <strong>each team bets on a migration</strong>. We’ve all as engineers heard horror stories of companies stuck between databases or a never-ending project that couldn’t be handled. </span></p>\n<p><span style=\"font-weight: 400;\">It’s also worth asking ‘is this worth doing’ and ‘is it worth doing now’. For example it’s very easy to end up with not-invented-here syndrome. These concerns should all be in your design document. And this is one of the strengths of the <a href=\"https://medium.com/@IndianaStyle/amazon-press-release-how-to-55d61188ecdd\">Amazon press release method</a>. </span></p>\n<p><b>Prototype</b></p>\n<p><span style=\"font-weight: 400;\">The first part is to prototype one easy migration and the one hard. It can also be a good idea to invest in tooling at this point. For example, if you can automate 90% of a migration and build tooling for that it’s super powerful. And this can make you get time on your side. </span></p>\n<p><span style=\"font-weight: 400;\">Another good idea is to think of a migration as a product. So spend time on the tooling, and explaining it to the wider team. When I was at Amazon we used to get ‘product updates’ even for infrastructure projects or migrations. This helped a lot because we got visibility of what was happening. And also there was a focus on customer value. </span></p>\n<p><b>Finish</b></p>\n<p><span style=\"font-weight: 400;\">The last part of a migration is to get people to stop using the old legacy system that you’ve deprecated. This can take a long time. </span></p>\n<p><span style=\"font-weight: 400;\">You can use tooling to your advantage here by adding something to your linter. Or generating self-service tooling or documentation. In our case, because we’re a small team we focused a lot on documentation. </span></p>\n<p>&nbsp;</p>\n<p><span style=\"font-weight: 400;\">The last 5% is hard. The last moving to a new system, the nitty gritty and the expectations that you have which are ‘why doesn’t it work like the last system’ are hard to manage. Sometimes you just need to put in the work though and deliver. Pushing through friction is a big part of leadership. </span></p>\n<p><span style=\"font-weight: 400;\">When you finish the migration you need to celebrate. It’s important that you reward finishing and delivering not just starting the project. I’ve seen organizations that reward those who pitch projects at the expense of those who deliver. This is bad, especially because you incur significant technical debt. </span></p>\n",
  "wfw:commentRss": "https://peadarcoyle.com/2020/06/05/migrations-or-how-to-fix-technical-debt/feed/",
  "slash:comments": 0,
  "post-id": 2349
}