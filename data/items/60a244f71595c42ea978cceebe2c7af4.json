{
  "title": "Getting started with Pandas",
  "link": "",
  "published": "2015-10-05T12:00:00-07:00",
  "updated": "2015-10-05T12:00:00-07:00",
  "author": {
    "name": "Damien RJ"
  },
  "id": "tag:efavdb.com,2015-10-05:/pandas-tips-and-tricks",
  "summary": "<p>We have made use of Python&#8217;s Pandas package in a variety of posts on the site. These have showcased some of Pandas&#8217; abilities including the&nbsp;following:</p>\n<ul>\n<li>DataFrames for data manipulation with built in&nbsp;indexing</li>\n<li>Handling of missing&nbsp;data</li>\n<li>Data&nbsp;alignment</li>\n<li>Melting/stacking and Pivoting/unstacking data&nbsp;sets</li>\n<li>Groupby feature …</li></ul>",
  "content": "<p>We have made use of Python&#8217;s Pandas package in a variety of posts on the site. These have showcased some of Pandas&#8217; abilities including the&nbsp;following:</p>\n<ul>\n<li>DataFrames for data manipulation with built in&nbsp;indexing</li>\n<li>Handling of missing&nbsp;data</li>\n<li>Data&nbsp;alignment</li>\n<li>Melting/stacking and Pivoting/unstacking data&nbsp;sets</li>\n<li>Groupby feature allowing split -&gt; apply -&gt; combine operations on data&nbsp;sets</li>\n<li>Data merging and&nbsp;joining</li>\n</ul>\n<p>Pandas is also a high performance library, with much of its code written in Cython or C. Unfortunately, Pandas can have a bit of a steep learning curve &#8212; In this post, I&#8217;ll cover some introductory tips and tricks to help one get started with this excellent&nbsp;package.</p>\n<p>Notes:</p>\n<ul>\n<li>This post was partially inspired by Tom Augspurger&#8217;s Pandas <a href=\"https://github.com/tomaugspurger/pydataseattle\">tutorial</a>, which has a <a href=\"https://www.youtube.com/watch?v=otCriSKVV_8\">youtube video</a> that can be viewed along side it. We also suggest some other excellent resource materials &#8212; where relevant &#8212;&nbsp;below.</li>\n<li>The notebook we use below can be downloaded from our <a href=\"https://github.com/EFavDB/Pandas\">github page</a>. Feel free to grab it and follow&nbsp;along.</li>\n</ul>\n<h3>Jupyter (Formally IPython) notebook&nbsp;tips</h3>\n<p>All the exercises I will be referring to here were carried out using IPython notebooks. To start off, here&#8217;s a few quick tips on notebook navigation that can help make life easier:  First, the notebook has two modes, command and edit. If you are in edit mode you have the cursor in one of the cells (boxes) where you can enter code or text.  To enter command mode press the <strong>Esc</strong> key and the cursor will disappear, but the cell will still be highlighted.  In command mode you have a variety of keyboard shortcuts, and you can see all of them if you press <strong>h</strong>. <strong>a</strong> and <strong>b </strong>will make new empty cells below and above the current cell.  <strong>j </strong>/ <strong>k</strong> will navigate through the notebook. <strong>Shift + Enter</strong> will execute the current cell and move to the next one, while <strong>Ctrl + Enter</strong> will execute the cell but does not move to the next cell. This is nice if you are still tweaking the code in that&nbsp;cell.</p>\n<h3>Pandas is built on top of&nbsp;NumPy</h3>\n<p>To understand Pandas, you gotta understand NumPy, as Pandas is built on top of it. Here, we cover some of its NumPy&#8217;s basic&nbsp;properties.</p>\n<p><strong>Ndarray</strong>: ndarrays are central to NumPy, and are homogeneous N-dimensional arrays of fixed-size. NumPy also provides fast methods for the ndarrary that are written in C, often making use of vectorized operations such as element wise addition and multiplication. These methods provide a major resource for code speedup, and Pandas takes full advantage of them where possible. In addition to the fast methods, ndarray also requires less memory than a python list because python lists are an array of pointers to Python objects &#8212; this is what allows lists to hold mixed data types.  This overhead combined with the overhead of the Python objects vs a numpy object can add up quickly. The variabilities in data type also makes it difficult to implement efficient C-loops because every iteration would need to make a call to Python to check the data type. This leads us to the next&nbsp;point.</p>\n<p><strong>Data types</strong>: As mentioned earlier, unlike Python&#8217;s list object, NumPy arrays can only contain one data type at a time.  Giving up mixed data types allows us to achieve much better performance through efficient C-loops.  One important thing to note is that missing values (NaN) will cast integer or boolean arrays to&nbsp;floats.</p>\n<p>[caption id=&#8221;&#8221; align=&#8221;aligncenter&#8221; width=&#8221;526&#8221;]<a href=\"http://docs.scipy.org/doc/numpy/_images/dtype-hierarchy.png\"><img alt=\"\" src=\"http://docs.scipy.org/doc/numpy/_images/dtype-hierarchy.png\"></a> Graph showing data types in&nbsp;NumPy[/caption]</p>\n<p><strong>Broadcasting:</strong> Broadcasting describes how NumPy treats arrays with different shapes. Essentially the smaller array is “broadcast” across the larger array so that they have compatible shapes. This makes it possible to have vectorized array operations, enabling the use of C instead of Python for the looping. Broadcasting also prevents needless copies of data from being created by making a new array with repeating copies.  The simplest broadcasting example occurs when combining an array with a scaler. This is something Pandas uses for efficiency and ease of&nbsp;use.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">a = np.array([1.0, 2.0, 3.0])</span>\n<span class=\"err\">b = 2.0</span>\n<span class=\"err\">a * b</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">&gt;&gt;&gt; array([ 2., 4., 6.])</span>\n</pre></div>\n\n\n<p>When operating on two arrays, their shapes are compared starting with the trailing dimensions. Two dimensions are compatible&nbsp;when:</p>\n<ol>\n<li>they are equal,&nbsp;or</li>\n<li>one of them is&nbsp;1</li>\n</ol>\n<!-- -->\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">a      (3d array):  15 x 3 x 5</span>\n<span class=\"err\">b      (2d array):       3 x 1</span>\n<span class=\"err\">a*b (3d array):     15 x 3 x 5</span>\n</pre></div>\n\n\n<p>For those interested, I recommend Jake Vanderplas&#8217;s <a href=\"https://www.youtube.com/watch?v=EEUXKG97YRw\">talk</a> for learning more about how one can reduce loop usage in your own code using&nbsp;NumPy.</p>\n<h3>Pandas Data&nbsp;Structures</h3>\n<p><strong>Series</strong>\nWe now move to the Pandas-specific data types. First up are Series, which are one-dimensional labeled arrays. Unlike ndarrays, these are capable of holding mixed data types. The cells of the series are labeled via the series <strong>Index</strong>. We will discuss indices more in a bit. The general method of creating a series is as&nbsp;follows.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">s = Series(data, index=index)</span>\n<span class=\"err\">pd.Series([1,2,3,4], index=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;])</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">&gt;&gt;&gt;</span>\n<span class=\"err\"> a 1</span>\n<span class=\"err\"> b 2</span>\n<span class=\"err\"> c 3</span>\n<span class=\"err\"> d 4</span>\n<span class=\"err\"> dtype: int64</span>\n</pre></div>\n\n\n<p><strong>DataFrame</strong></p>\n<p>As we have seen in other posts on the site, the DataFrame is the main attraction for Pandas. It is a 2-dimensional labeled data structure with columns of potentially different types. You can think of it like a spreadsheet or <span class=\"caps\">SQL</span> table, or a dict of Series objects. Like Series, DataFrame accepts many different kinds of input. One way of making a DataFrame is using a dictionary as&nbsp;input.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"err\">{</span><span class=\"s1\">&#39;one&#39;</span> <span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">.,</span> <span class=\"mi\">2</span><span class=\"p\">.,</span> <span class=\"mi\">3</span><span class=\"p\">.,</span> <span class=\"mi\">4</span><span class=\"p\">.],</span>\n<span class=\"s1\">&#39;two&#39;</span> <span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">.,</span> <span class=\"mi\">3</span><span class=\"p\">.,</span> <span class=\"mi\">2</span><span class=\"p\">.,</span> <span class=\"mi\">1</span><span class=\"p\">.],</span>\n<span class=\"s1\">&#39;good&#39;</span> <span class=\"p\">:[</span><span class=\"k\">True</span><span class=\"p\">,</span> <span class=\"k\">False</span><span class=\"p\">,</span> <span class=\"k\">False</span><span class=\"p\">,</span> <span class=\"k\">True</span><span class=\"p\">]</span><span class=\"err\">}</span>\n\n<span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"p\">.</span><span class=\"n\">DataFrame</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"k\">index</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;a&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;b&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;c&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;d&#39;</span><span class=\"p\">])</span>\n</pre></div>\n\n\n<p>Running the code in a notebook will output a nicely formatted&nbsp;table.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>good</th>\n<th>one</th>\n<th>two</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>1</td>\n<td>4</td>\n</tr>\n<tr>\n<td>b</td>\n<td><span class=\"caps\">FALSE</span></td>\n<td>2</td>\n<td>3</td>\n</tr>\n<tr>\n<td>c</td>\n<td><span class=\"caps\">FALSE</span></td>\n<td>3</td>\n<td>2</td>\n</tr>\n<tr>\n<td>d</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>4</td>\n<td>1</td>\n</tr>\n</tbody>\n</table>\n<p><strong>&nbsp;Index</strong></p>\n<p>The index in Pandas provides axis labeling information for pandas objects &#8212; it can serve many purposes. First, an index can provide metadata, potentially important for analysis, visualization, and so on. Second, it can enable automatic data alignment when preforming operations on multiple DataFrames or Series. Third, it can allow easy access to subsets of the&nbsp;data.</p>\n<p><strong>Selection</strong></p>\n<p>A huge improvement over numpy arrays is labeled indexing. We can select subsets by column, row, or both. To select columns use&nbsp;[].</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df[&#39;good&#39;]</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">&gt;&gt;&gt;</span>\n<span class=\"err\"> a True</span>\n<span class=\"err\"> b False</span>\n<span class=\"err\"> c False</span>\n<span class=\"err\"> d True</span>\n<span class=\"err\"> Name: good, dtype: bool</span>\n</pre></div>\n\n\n<p>As we can see here, Pandas will reduce dimensions when possible which is why the output above is a Series instead of a DataFrame &#8212; if you wish to force the returned result to be a DataFrame, you must supply a list of arguments, eg <code>df[['good']]</code>. You can also select individual columns with the dot (.) operator, for example <code>df.good</code> will give the same result. However, when using this approach, the column name selected must not have any spaces or special characters, nor can it conflict with any DataFrame methods. In order to add a column to a DataFrame, we&nbsp;write,</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df[&#39;A&#39;] = [1, 2, 3]</span>\n</pre></div>\n\n\n<p>You can also select multiple columns using a column name&nbsp;list.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df[[&#39;good&#39;, &#39;two&#39;]]</span>\n</pre></div>\n\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th>good</th>\n<th>two</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>4</td>\n</tr>\n<tr>\n<td>b</td>\n<td><span class=\"caps\">FALSE</span></td>\n<td>3</td>\n</tr>\n<tr>\n<td>c</td>\n<td><span class=\"caps\">FALSE</span></td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<p>For row selection, use <code>.loc[row_lables, column_labels]</code> for label-based indexing and use <code>.iloc[row_positions, column_positions]</code> for ordinal/positional&nbsp;selection.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df.loc[[&#39;a&#39;, &#39;d&#39;]]</span>\n</pre></div>\n\n\n<table>\n<thead>\n<tr>\n<th>good</th>\n<th>one</th>\n<th>two</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>1</td>\n</tr>\n<tr>\n<td>d</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>4</td>\n</tr>\n<tr>\n<td><br /></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df.loc[&#39;a&#39;:&#39;b&#39;]</span>\n</pre></div>\n\n\n<table>\n<thead>\n<tr>\n<th>good</th>\n<th>one</th>\n<th>two</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>1</td>\n</tr>\n<tr>\n<td>b</td>\n<td><span class=\"caps\">FALSE</span></td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<p>Notice that the slice is <strong>inclusive</strong>: It includes both the start and end index &#8212; unlike normal python&nbsp;indexing.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df.iloc[0:2]</span>\n</pre></div>\n\n\n<table>\n<thead>\n<tr>\n<th>good</th>\n<th>one</th>\n<th>two</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>a</td>\n<td><span class=\"caps\">TRUE</span></td>\n<td>1</td>\n</tr>\n<tr>\n<td>b</td>\n<td><span class=\"caps\">FALSE</span></td>\n<td>2</td>\n</tr>\n</tbody>\n</table>\n<p><br /></p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df.loc[&#39;b&#39;, &#39;good&#39;]</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">&gt;&gt;&gt; False</span>\n</pre></div>\n\n\n<h3>Reading files into&nbsp;Pandas</h3>\n<p>At this point, we require a larger data set in order to demonstrate other Pandas capabilities.  For that purpose, I decided to use unemployment data from (<a href=\"http://data.bls.gov/\">http://data.bls.gov/</a>).  The data file is available in our Github repository along with the notebook that generated the examples above. I saved the data as a csv file. To read into the notebook, we&#8217;ll make use of Pandas&#8217; read_csv method &#8212; a fast, simple method for directly reading csv files into a&nbsp;DataFrame.</p>\n<p>After reading in the data, we see that each row corresponds to one unemployment measurement with a different column for each time point. The first column has a numeric id, so the first thing to do is to replace those with human readable strings.  Next, we see that we have incomplete data for Jan 2000, so we drop that column.  Setting the inplace flag to true here causes the modified DataFrame to replace the original &#8212; in this way, we avoid having to copy the&nbsp;original.</p>\n<p>Next, we assign our IDs to the DataFrame index using <code>set_index</code>, and then drop the column since it is no longer needed.  Lastly we transpose the table so that each row corresponds to a different time point and the columns to the separate&nbsp;measures.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"p\">.</span><span class=\"n\">read_csv</span><span class=\"p\">(</span><span class=\"s1\">&#39;data.csv&#39;</span><span class=\"p\">)</span>\n\n<span class=\"n\">df</span><span class=\"p\">[</span><span class=\"s1\">&#39;Series ID&#39;</span><span class=\"p\">]</span><span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;Labor force&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Participation rate&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;Rate&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;Rate - 16-19 yrs&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;Rate - 20+ yrs (Men)&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;Rate - 20+ yrs (Women)&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;Rate - White&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;Rate - Black or African American&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;Rate - Asian&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;Rate - Hispanic or Latino&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;No High School Diploma&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;High School Graduates&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;Some College or Associate Degree&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;Bachelor degree and higher&#39;</span><span class=\"p\">,</span><span class=\"s1\">&#39;Under 5 Weeks&#39;</span><span class=\"p\">,</span>\n<span class=\"s1\">&#39;5-14 Weeks&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;15 Weeks &amp; over&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;27 Weeks &amp; over&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">df</span><span class=\"p\">.</span><span class=\"k\">drop</span><span class=\"p\">(</span><span class=\"s1\">&#39;Jan 2000&#39;</span><span class=\"p\">,</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">inplace</span><span class=\"o\">=</span><span class=\"k\">True</span><span class=\"p\">)</span>\n<span class=\"n\">df</span><span class=\"p\">.</span><span class=\"n\">set_index</span><span class=\"p\">(</span><span class=\"n\">df</span><span class=\"p\">[</span><span class=\"s1\">&#39;Series ID&#39;</span><span class=\"p\">],</span> <span class=\"n\">inplace</span><span class=\"o\">=</span><span class=\"k\">True</span><span class=\"p\">)</span>\n<span class=\"n\">df</span><span class=\"p\">.</span><span class=\"k\">drop</span><span class=\"p\">(</span><span class=\"s1\">&#39;Series ID&#39;</span><span class=\"p\">,</span> <span class=\"n\">axis</span><span class=\"o\">=</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">inplace</span><span class=\"o\">=</span><span class=\"k\">True</span><span class=\"p\">)</span>\n<span class=\"n\">df</span> <span class=\"o\">=</span> <span class=\"n\">df</span><span class=\"p\">.</span><span class=\"n\">transpose</span><span class=\"p\">().</span><span class=\"n\">convert_objects</span><span class=\"p\">(</span><span class=\"n\">convert_numeric</span><span class=\"o\">=</span><span class=\"k\">True</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>With these steps, we take the original&nbsp;table:</p>\n<table>\n<thead>\n<tr>\n<th>Series <span class=\"caps\">ID</span></th>\n<th>Jan 2000</th>\n<th>Feb 2000</th>\n<th>Mar 2000</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><span class=\"caps\">LNS11000000</span></td>\n<td>142267(1)</td>\n<td>142456</td>\n<td>142434</td>\n</tr>\n<tr>\n<td><span class=\"caps\">LNS11300000</span></td>\n<td>67.3</td>\n<td>67.3</td>\n<td>67.3</td>\n</tr>\n<tr>\n<td><span class=\"caps\">LNS14000000</span></td>\n<td>4</td>\n<td>4.1</td>\n<td>4</td>\n</tr>\n<tr>\n<td><span class=\"caps\">LNS14000012</span></td>\n<td>12.7</td>\n<td>13.8</td>\n<td>13.3</td>\n</tr>\n<tr>\n<td><span class=\"caps\">LNS14000025</span></td>\n<td>3.3</td>\n<td>3.5</td>\n<td>3.2</td>\n</tr>\n</tbody>\n</table>\n<p>to</p>\n<table>\n<thead>\n<tr>\n<th>Series <span class=\"caps\">ID</span></th>\n<th>Labor force</th>\n<th>Part. rate</th>\n<th>Rate</th>\n<th>Rate – 16-19 yrs</th>\n<th>Rate – 20+ yrs (Men)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Feb 2000</td>\n<td>142456</td>\n<td>67.3</td>\n<td>4.1</td>\n<td>13.8</td>\n<td>3.5</td>\n</tr>\n<tr>\n<td>Mar 2000</td>\n<td>142434</td>\n<td>67.3</td>\n<td>4</td>\n<td>13.3</td>\n<td>3.2</td>\n</tr>\n<tr>\n<td>Apr 2000</td>\n<td>142751</td>\n<td>67.3</td>\n<td>3.8</td>\n<td>12.6</td>\n<td>3.1</td>\n</tr>\n<tr>\n<td>May 2000</td>\n<td>142388</td>\n<td>67.1</td>\n<td>4</td>\n<td>12.8</td>\n<td>3.3</td>\n</tr>\n<tr>\n<td>Jun 2000</td>\n<td>142591</td>\n<td>67.1</td>\n<td>4</td>\n<td>12.3</td>\n<td>3.2</td>\n</tr>\n</tbody>\n</table>\n<h3>Working with the&nbsp;data</h3>\n<p>Now that we have the data in a nicely formatted within DataFrame, we can easily visualize it using the Pandas plot method. For example, to plot the general unemployment rate, we&nbsp;write</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df[&#39;Rate&#39;].plot()</span>\n<span class=\"err\">plt.ylabel(&#39;Unemployment Rate (%)&#39;)</span>\n</pre></div>\n\n\n<p><a href=\"https://efavdb.com/wp-content/uploads/2015/07/fig1.png\"><img alt=\"fig1\" src=\"https://efavdb.com/wp-content/uploads/2015/07/fig1.png\"></a> Similarly, the following plots unemployment for each of the available different levels of&nbsp;education.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df[[&#39;Rate&#39;, &#39;No High School Diploma&#39;, &#39;Bachelor degree and higher&#39;]].plot()</span>\n<span class=\"err\">plt.ylabel(&#39;Unemployment Rate (%)&#39;)</span>\n</pre></div>\n\n\n<p><a href=\"https://efavdb.com/wp-content/uploads/2015/07/fig2.png\"><img alt=\"fig2\" src=\"https://efavdb.com/wp-content/uploads/2015/07/fig2.png\"></a>\nInterestingly, these unemployment rates seem to evolve in a similar manner. Notice that both the green and the red curves seem to have doubled during the recent&nbsp;slow-down.</p>\n<h3>GroupBy</h3>\n<p>You can also used Pandas GroupBy functionality to do analysis on subsets of the data.  For this example we <a href=\"http://pandas.pydata.org/pandas-docs/stable/groupby.html\">GroupBy</a> year, and then make a plot showing the mean unemployment per year. GroupBy allows one to easily split the data, apply a function to each group, and then combine the results. It is a very useful&nbsp;feature!</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">df[&#39;Year&#39;]=(df.index.to_datetime()).year</span>\n<span class=\"err\">years = df.groupby(&#39;Year&#39;)</span>\n<span class=\"err\">years[&#39;Rate&#39;].mean().plot(kind=&#39;bar&#39;)</span>\n</pre></div>\n\n\n<h3><a href=\"https://efavdb.com/wp-content/uploads/2015/07/fig3.png\"><img alt=\"fig3\" src=\"https://efavdb.com/wp-content/uploads/2015/07/fig3.png\"></a></h3>\n<p>There are some functions like mean, and describe that can be run directly on a grouped&nbsp;object.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">years.get_group(2005)[&#39;Rate&#39;].describe()</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">&gt;&gt;&gt;</span>\n<span class=\"err\"> count 12.000000</span>\n<span class=\"err\"> mean 5.083333</span>\n<span class=\"err\"> std 0.158592</span>\n<span class=\"err\"> min 4.900000</span>\n<span class=\"err\"> 25% 5.000000</span>\n<span class=\"err\"> 50% 5.000000</span>\n<span class=\"err\"> 75% 5.200000</span>\n<span class=\"err\"> max 5.400000</span>\n<span class=\"err\"> Name: Rate, dtype: float64</span>\n</pre></div>\n\n\n<p>It is possible to apply any function to the grouped function using <a href=\"http://pandas.pydata.org/pandas-docs/stable/groupby.html#aggregation\">agg()</a>.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">years[&#39;Rate&#39;].agg([np.mean, np.std, max, min])</span>\n</pre></div>\n\n\n<table>\n<thead>\n<tr>\n<th></th>\n<th>mean</th>\n<th>std</th>\n<th>max</th>\n<th>min</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Year</td>\n<td></td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n<tr>\n<td>2000</td>\n<td>3.963636</td>\n<td>0.092442</td>\n<td>4.1</td>\n<td>3.8</td>\n</tr>\n<tr>\n<td>2001</td>\n<td>4.741667</td>\n<td>0.528219</td>\n<td>5.7</td>\n<td>4.2</td>\n</tr>\n<tr>\n<td>2002</td>\n<td>5.783333</td>\n<td>0.102986</td>\n<td>6</td>\n<td>5.7</td>\n</tr>\n<tr>\n<td>2003</td>\n<td>5.991667</td>\n<td>0.178164</td>\n<td>6.3</td>\n<td>5.7</td>\n</tr>\n<tr>\n<td>2004</td>\n<td>5.541667</td>\n<td>0.131137</td>\n<td>5.8</td>\n<td>5.4</td>\n</tr>\n<tr>\n<td>2005</td>\n<td>5.083333</td>\n<td>0.158592</td>\n<td>5.4</td>\n<td>4.9</td>\n</tr>\n<tr>\n<td>2006</td>\n<td>4.608333</td>\n<td>0.131137</td>\n<td>4.8</td>\n<td>4.4</td>\n</tr>\n<tr>\n<td>2007</td>\n<td>4.616667</td>\n<td>0.164225</td>\n<td>5</td>\n<td>4.4</td>\n</tr>\n<tr>\n<td>2008</td>\n<td>5.8</td>\n<td>0.780443</td>\n<td>7.3</td>\n<td>4.9</td>\n</tr>\n<tr>\n<td>2009</td>\n<td>9.283333</td>\n<td>0.696528</td>\n<td>10</td>\n<td>7.8</td>\n</tr>\n<tr>\n<td>2010</td>\n<td>9.608333</td>\n<td>0.219331</td>\n<td>9.9</td>\n<td>9.3</td>\n</tr>\n<tr>\n<td>2011</td>\n<td>8.941667</td>\n<td>0.206522</td>\n<td>9.2</td>\n<td>8.5</td>\n</tr>\n<tr>\n<td>2012</td>\n<td>8.066667</td>\n<td>0.214617</td>\n<td>8.3</td>\n<td>7.7</td>\n</tr>\n<tr>\n<td>2013</td>\n<td>7.366667</td>\n<td>0.342008</td>\n<td>8</td>\n<td>6.7</td>\n</tr>\n<tr>\n<td>2014</td>\n<td>6.15</td>\n<td>0.360555</td>\n<td>6.7</td>\n<td>5.6</td>\n</tr>\n<tr>\n<td>2015</td>\n<td>5.4125</td>\n<td>0.180772</td>\n<td>5.7</td>\n<td>5.1</td>\n</tr>\n</tbody>\n</table>\n<h3>Boolean&nbsp;Indexing</h3>\n<p>Another common operation is the use of boolean vectors to filter data. This allows one to easily select subsets of data. It also provides a quick method for counting &#8212; this works because True and False are represented as 1 and 0, respectively, when&nbsp;adding.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">sum(df[&#39;Rate&#39;] &gt; 7)</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">&gt;&gt;&gt; 59</span>\n</pre></div>\n\n\n<h3>String&nbsp;Methods</h3>\n<p>Pandas has very useful string methods which can be access via <code>str.</code> This makes it easy to look for patterns in the text, do filtering, replacements, and so on. I have a couple of examples below but I highly recommend taking a look at the documentation page for many <a href=\"http://pandas.pydata.org/pandas-docs/stable/text.html\">examples</a>.</p>\n<div class=\"highlight\"><pre><span></span><span class=\"err\">s = pd.Series([&#39;Dog&#39;, &#39;Bat&#39;, &#39;Coon&#39;, &#39;cAke&#39;, &#39;bAnk&#39;, &#39;CABA&#39;, &#39;dog&#39;, &#39;cat&#39;])</span>\n<span class=\"err\">s[s.str.contains(&#39;B&#39;)]</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">1 Bat</span>\n<span class=\"err\">5 CABA</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">s.str.replace(&#39;dog|cat&#39;, &#39;nope &#39;, case=False)</span>\n</pre></div>\n\n\n<div class=\"highlight\"><pre><span></span><span class=\"err\">0 nope</span>\n<span class=\"err\">1 Bat</span>\n<span class=\"err\">2 Coon</span>\n<span class=\"err\">3 cAke</span>\n<span class=\"err\">4 bAnk</span>\n<span class=\"err\">5 CABA</span>\n<span class=\"err\">6 nope</span>\n<span class=\"err\">7 nope</span>\n</pre></div>\n\n\n<h3></h3>\n<h3>Wrap&nbsp;Up</h3>\n<p>Pandas is a very useful library that I highly recommend. Although it can have a bit of a steep learning curve, it&#8217;s actually pretty easy to pick up once you get started. Give it a shot, and you won&#8217;t regret&nbsp;it!</p>\n<p><a href=\"https://github.com/EFavDB/Pandas\" title=\"GitHub Repo\"><img alt=\"Open GitHub Repo\" src=\"https://efavdb.com/wp-content/uploads/2015/03/GitHub_Logo.png\"></a></p>",
  "category": [
    "",
    "",
    "",
    ""
  ]
}