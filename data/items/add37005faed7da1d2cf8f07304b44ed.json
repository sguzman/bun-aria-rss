{
  "title": "Blaze Datasets",
  "link": "",
  "updated": "2014-11-19T00:00:00+00:00",
  "id": "https://mrocklin.github.io/blog/work/2014/11/19/Blaze-Datasets",
  "content": "<p><em>This work is supported by <a href=\"http://continuum.io\">Continuum Analytics</a>\nand the <a href=\"http://www.darpa.mil/program/XDATA\">XDATA Grant</a>\nas part of the <a href=\"http://blaze.pydata.org\">Blaze Project</a></em></p>\n\n<p><strong>tl;dr</strong> Blaze aids exploration by supporting full databases and\ncollections of datasets.</p>\n\n<p>This post was composed using Blaze version 0.6.6.  You can follow along with\nthe following <a href=\"http://conda.pydata.org/\">conda</a> command.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>conda install -c blaze blaze=0.6.6\n</code></pre></div></div>\n\n<p>When we encounter new data we need to explore broadly to find what exists\nbefore we can meaningfully perform analyses.  The tools for this task are often\noverlooked.</p>\n\n<p>This post outlines how Blaze explores collections and hierarchies of datasets,\ncases where one entity like a database or file or directory might hold\nmany tables or arrays.  We use examples from HDF5 files and SQL databases.\nBlaze understands how the underlying libraries work so that you don’t have to.</p>\n\n<h2 id=\"motivating-problem---intuitive-hdf5-file-navigation\">Motivating problem - Intuitive HDF5 File Navigation</h2>\n\n<p>For example, if we want to understand the contents of <a href=\"http://mirador.gsfc.nasa.gov/cgi-bin/mirador/granlist.pl?page=1&amp;location=(-90,-180),(90,180)&amp;dataSet=OMAERO&amp;version=003&amp;allversion=003&amp;startTime=2014-11-05T00:00:01Z&amp;endTime=2014-11-05T23:59:59Z&amp;keyword=OMAERO&amp;longname=OMI/Aura%20Multi-wavelength%20Aerosol%20Optical%20Depth%20and%20Single%20Scattering%20Albedo%201-orbit%20L2%20Swath%2013x24%20km&amp;CGISESSID=958493efa9d8a96c5ba2d0b4d69c986d&amp;prodpg=http://mirador.gsfc.nasa.gov/collections/OMAERO__003.shtml\">this set of HDF5\nfiles</a>\nencoding meteorological data then we need to navigate a hierarchy of\narrays.  This is common among HDF5 files.</p>\n\n<p>Typically we navigate these files in Python with <code class=\"language-plaintext highlighter-rouge\">h5py</code> or <code class=\"language-plaintext highlighter-rouge\">pytables</code>.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"kn\">import</span> <span class=\"nn\">h5py</span>\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"n\">h5py</span><span class=\"p\">.</span><span class=\"n\">File</span><span class=\"p\">(</span><span class=\"s\">'OMI-Aura_L2-OMAERO_2014m1105t2304-o54838_v003-2014m1106t215558.he5'</span><span class=\"p\">)</span></code></pre>\n</figure>\n\n<p>HDF5 files organize datasets with an internal file system.  The <code class=\"language-plaintext highlighter-rouge\">h5py</code> library\naccesses this internal file system through successive calls to <code class=\"language-plaintext highlighter-rouge\">.keys()</code> and\nitem access.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">.</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'HDFEOS'</span><span class=\"p\">,</span> <span class=\"s\">'HDFEOS INFORMATION'</span><span class=\"p\">]</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS'</span><span class=\"p\">].</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'ADDITIONAL'</span><span class=\"p\">,</span> <span class=\"s\">'SWATHS'</span><span class=\"p\">]</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS/SWATHS'</span><span class=\"p\">].</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'ColumnAmountAerosol'</span><span class=\"p\">]</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS/SWATHS/ColumnAmountAerosol'</span><span class=\"p\">].</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'Data Fields'</span><span class=\"p\">,</span> <span class=\"s\">'Geolocation Fields'</span><span class=\"p\">]</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS/SWATHS/ColumnAmountAerosol/Data Fields'</span><span class=\"p\">].</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'AerosolIndexUV'</span><span class=\"p\">,</span>\n <span class=\"s\">'AerosolIndexVIS'</span><span class=\"p\">,</span>\n <span class=\"s\">'AerosolModelMW'</span><span class=\"p\">,</span>\n <span class=\"s\">'AerosolModelsPassedThreshold'</span><span class=\"p\">,</span>\n <span class=\"s\">'AerosolOpticalThicknessMW'</span><span class=\"p\">,</span>\n <span class=\"p\">...</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS/SWATHS/ColumnAmountAerosol/Data Fields/TerrainPressure'</span><span class=\"p\">]</span>\n<span class=\"o\">&lt;</span><span class=\"n\">HDF5</span> <span class=\"n\">dataset</span> <span class=\"s\">\"TerrainPressure\"</span><span class=\"p\">:</span> <span class=\"n\">shape</span> <span class=\"p\">(</span><span class=\"mi\">1643</span><span class=\"p\">,</span> <span class=\"mi\">60</span><span class=\"p\">),</span> <span class=\"nb\">type</span> <span class=\"s\">\"&lt;i2\"</span><span class=\"o\">&gt;</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS/SWATHS/ColumnAmountAerosol/Data Fields/TerrainPressure'</span><span class=\"p\">][:]</span>\n<span class=\"n\">array</span><span class=\"p\">([[</span><span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">...,</span>\n       <span class=\"p\">[</span><span class=\"mi\">1010</span><span class=\"p\">,</span>  <span class=\"mi\">992</span><span class=\"p\">,</span>  <span class=\"mi\">986</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span> <span class=\"mi\">999</span><span class=\"p\">,</span>  <span class=\"mi\">983</span><span class=\"p\">,</span>  <span class=\"mi\">988</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"mi\">1006</span><span class=\"p\">,</span>  <span class=\"mi\">983</span><span class=\"p\">,</span>  <span class=\"mi\">993</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">]],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">int16</span><span class=\"p\">)</span></code></pre>\n</figure>\n\n<p>This interaction between programmer and interpreter feels like a long and\nawkward conversation.</p>\n\n<p>Blaze improves the exploration user experience by treating the entire HDF5 file\nas a single Blaze variable.  This allows users to both explore and compute on\nlarger collections of data in the same workflow.  This isn’t specific to HDF5\nbut works anywhere many datasets are bundled together.</p>\n\n<h2 id=\"exploring-a-sql-database\">Exploring a SQL Database</h2>\n\n<p>For example, a SQL database can be viewed as a collection of tables.  Blaze\nmakes it easy to to access a single table in a database using a string URI\nspecifying both the database and the table name.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">iris</span> <span class=\"o\">=</span> <span class=\"n\">Data</span><span class=\"p\">(</span><span class=\"s\">'sqlite:////my.db::iris'</span><span class=\"p\">)</span>  <span class=\"c1\"># protocol://database::table-name\n</span><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">iris</span>\n    <span class=\"n\">sepal_length</span>  <span class=\"n\">sepal_width</span>  <span class=\"n\">petal_length</span>  <span class=\"n\">petal_width</span>      <span class=\"n\">species</span>\n<span class=\"mi\">0</span>            <span class=\"mf\">5.1</span>          <span class=\"mf\">3.5</span>           <span class=\"mf\">1.4</span>          <span class=\"mf\">0.2</span>  <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">setosa</span>\n<span class=\"mi\">1</span>            <span class=\"mf\">4.9</span>          <span class=\"mf\">3.0</span>           <span class=\"mf\">1.4</span>          <span class=\"mf\">0.2</span>  <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">setosa</span>\n<span class=\"mi\">2</span>            <span class=\"mf\">4.7</span>          <span class=\"mf\">3.2</span>           <span class=\"mf\">1.3</span>          <span class=\"mf\">0.2</span>  <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">setosa</span>\n<span class=\"mi\">3</span>            <span class=\"mf\">4.6</span>          <span class=\"mf\">3.1</span>           <span class=\"mf\">1.5</span>          <span class=\"mf\">0.2</span>  <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">setosa</span>\n<span class=\"mi\">4</span>            <span class=\"mf\">5.0</span>          <span class=\"mf\">3.6</span>           <span class=\"mf\">1.4</span>          <span class=\"mf\">0.2</span>  <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">setosa</span>\n<span class=\"p\">...</span></code></pre>\n</figure>\n\n<p>This only works if we know what table we want ahead of time.  The approach\nabove assumes that the user is <em>already familiar with their data</em>.  To resolve\nthis problem we omit the table name and access the database as a variable\ninstead.  We use the same interface to access the entire database as we would\na specific table.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">db</span> <span class=\"o\">=</span> <span class=\"n\">Data</span><span class=\"p\">(</span><span class=\"s\">'sqlite:////my.db'</span><span class=\"p\">)</span>  <span class=\"c1\"># protocol://database\n</span><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">db</span>\n<span class=\"n\">Data</span><span class=\"p\">:</span>       <span class=\"n\">Engine</span><span class=\"p\">(</span><span class=\"n\">sqlite</span><span class=\"p\">:</span><span class=\"o\">////</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">mrocklin</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">blaze</span><span class=\"o\">/</span><span class=\"n\">blaze</span><span class=\"o\">/</span><span class=\"n\">examples</span><span class=\"o\">/</span><span class=\"n\">data</span><span class=\"o\">/</span><span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">db</span><span class=\"p\">)</span>\n<span class=\"n\">DataShape</span><span class=\"p\">:</span>  <span class=\"p\">{</span>\n  <span class=\"n\">iris</span><span class=\"p\">:</span> <span class=\"n\">var</span> <span class=\"o\">*</span> <span class=\"p\">{</span>\n    <span class=\"n\">sepal_length</span><span class=\"p\">:</span> <span class=\"err\">?</span><span class=\"n\">float64</span><span class=\"p\">,</span>\n    <span class=\"n\">sepal_width</span><span class=\"p\">:</span> <span class=\"err\">?</span><span class=\"n\">float64</span><span class=\"p\">,</span>\n    <span class=\"n\">petal_length</span><span class=\"p\">:</span> <span class=\"err\">?</span><span class=\"n\">float64</span><span class=\"p\">,</span>\n    <span class=\"n\">petal_width</span><span class=\"p\">:</span> <span class=\"err\">?</span><span class=\"n\">float64</span><span class=\"p\">,</span>\n    <span class=\"n\">species</span><span class=\"p\">:</span> <span class=\"err\">?</span><span class=\"n\">string</span>\n  <span class=\"p\">...</span></code></pre>\n</figure>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">db</code> expression points to a SQLAlchemy engine.  We print the engine\nalongside a truncated datashape showing the metadata of the tables in that\ndatabase.  Note that the datashape maps table names to datashapes of those\ntables, in this case a variable length collection of records with fields for\nmeasurements of flowers.</p>\n\n<p>Blaze isn’t doing any work of the grunt work here, SQLAlchemy is.\n<a href=\"http://www.sqlalchemy.org/\">SQLAlchemy</a> is a mature Python library that\ninteracts with a wide variety of SQL databases.  It provides both database\nreflection (as we see above) along with general querying (as we see below).\nBlaze provides a convenient front-end.</p>\n\n<p>We seamlessly transition from exploration to computation.  We query for the\nshortest and longest sepal per species.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">by</span><span class=\"p\">(</span><span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">species</span><span class=\"p\">,</span> <span class=\"n\">shortest</span><span class=\"o\">=</span><span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">sepal_length</span><span class=\"p\">.</span><span class=\"nb\">min</span><span class=\"p\">(),</span>\n<span class=\"p\">...</span>                      <span class=\"n\">longest</span><span class=\"o\">=</span><span class=\"n\">db</span><span class=\"p\">.</span><span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">sepal_length</span><span class=\"p\">.</span><span class=\"nb\">max</span><span class=\"p\">())</span>\n           <span class=\"n\">species</span>  <span class=\"n\">longest</span>  <span class=\"n\">shortest</span>\n<span class=\"mi\">0</span>      <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">setosa</span>      <span class=\"mf\">5.8</span>       <span class=\"mf\">4.3</span>\n<span class=\"mi\">1</span>  <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">versicolor</span>      <span class=\"mf\">7.0</span>       <span class=\"mf\">4.9</span>\n<span class=\"mi\">2</span>   <span class=\"n\">Iris</span><span class=\"o\">-</span><span class=\"n\">virginica</span>      <span class=\"mf\">7.9</span>       <span class=\"mf\">4.9</span></code></pre>\n</figure>\n\n<p>Blaze doesn’t pull data into local memory, instead it generates SQLAlchemy\nwhich generates SQL which executes on the foreign database.  The (much smaller)\nresult is pulled back into memory and rendered nicely using Pandas.</p>\n\n<h2 id=\"a-larger-database\">A Larger Database</h2>\n\n<p>Improved metadata discovery on SQL databases overlaps with the excellent work\ndone by <a href=\"https://yhathq.com/\">yhat</a> on\n<a href=\"http://blog.yhathq.com/posts/introducing-db-py.html\">db.py</a>.  We steal their\nexample, the Lahman Baseball statistics database, as an example of a richer\ndatabase with a greater variety of tables.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">lahman</span> <span class=\"o\">=</span> <span class=\"n\">Data</span><span class=\"p\">(</span><span class=\"s\">'sqlite:///baseball-archive-2012.sqlite'</span><span class=\"p\">)</span>\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">dshape</span>  <span class=\"c1\"># ask for the entire datashape\n</span><span class=\"n\">dshape</span><span class=\"p\">(</span><span class=\"s\">\"\"\"{\n  battingpost: var * {\n    yearID: ?int32,\n    round: ?string,\n    playerID: ?string,\n    teamID: ?string,\n    lgID: ?string,\n    G: ?int32,\n    AB: ?int32,\n    R: ?int32,\n    H: ?int32,\n    2B: ?int32,\n    3B: ?int32,\n    HR: ?int32,\n    RBI: ?int32,\n    SB: ?int32,\n    CS: ?int32,\n    BB: ?int32,\n    SO: ?int32,\n    IBB: ?int32,\n    HBP: ?int32,\n    SH: ?int32,\n    SF: ?int32,\n    GIDP: ?int32\n    },\n  awardsmanagers: var * {\n    managerID: ?string,\n    awardID: ?string,\n    yearID: ?int32,\n    lgID: ?string,\n    tie: ?string,\n    notes: ?string\n    },\n  hofold: var * {\n    hofID: ?string,\n    yearid: ?int32,\n    votedBy: ?string,\n    ballots: ?int32,\n    votes: ?int32,\n    inducted: ?string,\n    category: ?string\n    },\n  salaries: var * {\n    yearID: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    playerID: ?string,\n    salary: ?float64\n    },\n  pitchingpost: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    round: ?string,\n    teamID: ?string,\n    lgID: ?string,\n    W: ?int32,\n    L: ?int32,\n    G: ?int32,\n    GS: ?int32,\n    CG: ?int32,\n    SHO: ?int32,\n    SV: ?int32,\n    IPouts: ?int32,\n    H: ?int32,\n    ER: ?int32,\n    HR: ?int32,\n    BB: ?int32,\n    SO: ?int32,\n    BAOpp: ?float64,\n    ERA: ?float64,\n    IBB: ?int32,\n    WP: ?int32,\n    HBP: ?int32,\n    BK: ?int32,\n    BFP: ?int32,\n    GF: ?int32,\n    R: ?int32,\n    SH: ?int32,\n    SF: ?int32,\n    GIDP: ?int32\n    },\n  managers: var * {\n    managerID: ?string,\n    yearID: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    inseason: ?int32,\n    G: ?int32,\n    W: ?int32,\n    L: ?int32,\n    rank: ?int32,\n    plyrMgr: ?string\n    },\n  teams: var * {\n    yearID: ?int32,\n    lgID: ?string,\n    teamID: ?string,\n    franchID: ?string,\n    divID: ?string,\n    Rank: ?int32,\n    G: ?int32,\n    Ghome: ?int32,\n    W: ?int32,\n    L: ?int32,\n    DivWin: ?string,\n    WCWin: ?string,\n    LgWin: ?string,\n    WSWin: ?string,\n    R: ?int32,\n    AB: ?int32,\n    H: ?int32,\n    2B: ?int32,\n    3B: ?int32,\n    HR: ?int32,\n    BB: ?int32,\n    SO: ?int32,\n    SB: ?int32,\n    CS: ?int32,\n    HBP: ?int32,\n    SF: ?int32,\n    RA: ?int32,\n    ER: ?int32,\n    ERA: ?float64,\n    CG: ?int32,\n    SHO: ?int32,\n    SV: ?int32,\n    IPouts: ?int32,\n    HA: ?int32,\n    HRA: ?int32,\n    BBA: ?int32,\n    SOA: ?int32,\n    E: ?int32,\n    DP: ?int32,\n    FP: ?float64,\n    name: ?string,\n    park: ?string,\n    attendance: ?int32,\n    BPF: ?int32,\n    PPF: ?int32,\n    teamIDBR: ?string,\n    teamIDlahman45: ?string,\n    teamIDretro: ?string\n    },\n  teamshalf: var * {\n    yearID: ?int32,\n    lgID: ?string,\n    teamID: ?string,\n    Half: ?string,\n    divID: ?string,\n    DivWin: ?string,\n    Rank: ?int32,\n    G: ?int32,\n    W: ?int32,\n    L: ?int32\n    },\n  fieldingpost: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    round: ?string,\n    POS: ?string,\n    G: ?int32,\n    GS: ?int32,\n    InnOuts: ?int32,\n    PO: ?int32,\n    A: ?int32,\n    E: ?int32,\n    DP: ?int32,\n    TP: ?int32,\n    PB: ?int32,\n    SB: ?int32,\n    CS: ?int32\n    },\n  master: var * {\n    lahmanID: ?int32,\n    playerID: ?string,\n    managerID: ?string,\n    hofID: ?string,\n    birthYear: ?int32,\n    birthMonth: ?int32,\n    birthDay: ?int32,\n    birthCountry: ?string,\n    birthState: ?string,\n    birthCity: ?string,\n    deathYear: ?int32,\n    deathMonth: ?int32,\n    deathDay: ?int32,\n    deathCountry: ?string,\n    deathState: ?string,\n    deathCity: ?string,\n    nameFirst: ?string,\n    nameLast: ?string,\n    nameNote: ?string,\n    nameGiven: ?string,\n    nameNick: ?string,\n    weight: ?int32,\n    height: ?float64,\n    bats: ?string,\n    throws: ?string,\n    debut: ?string,\n    finalGame: ?string,\n    college: ?string,\n    lahman40ID: ?string,\n    lahman45ID: ?string,\n    retroID: ?string,\n    holtzID: ?string,\n    bbrefID: ?string\n    },\n  fieldingof: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    stint: ?int32,\n    Glf: ?int32,\n    Gcf: ?int32,\n    Grf: ?int32\n    },\n  pitching: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    stint: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    W: ?int32,\n    L: ?int32,\n    G: ?int32,\n    GS: ?int32,\n    CG: ?int32,\n    SHO: ?int32,\n    SV: ?int32,\n    IPouts: ?int32,\n    H: ?int32,\n    ER: ?int32,\n    HR: ?int32,\n    BB: ?int32,\n    SO: ?int32,\n    BAOpp: ?float64,\n    ERA: ?float64,\n    IBB: ?int32,\n    WP: ?int32,\n    HBP: ?int32,\n    BK: ?int32,\n    BFP: ?int32,\n    GF: ?int32,\n    R: ?int32,\n    SH: ?int32,\n    SF: ?int32,\n    GIDP: ?int32\n    },\n  managershalf: var * {\n    managerID: ?string,\n    yearID: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    inseason: ?int32,\n    half: ?int32,\n    G: ?int32,\n    W: ?int32,\n    L: ?int32,\n    rank: ?int32\n    },\n  appearances: var * {\n    yearID: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    playerID: ?string,\n    G_all: ?int32,\n    G_batting: ?int32,\n    G_defense: ?int32,\n    G_p: ?int32,\n    G_c: ?int32,\n    G_1b: ?int32,\n    G_2b: ?int32,\n    G_3b: ?int32,\n    G_ss: ?int32,\n    G_lf: ?int32,\n    G_cf: ?int32,\n    G_rf: ?int32,\n    G_of: ?int32,\n    G_dh: ?int32,\n    G_ph: ?int32,\n    G_pr: ?int32\n    },\n  halloffame: var * {\n    hofID: ?string,\n    yearid: ?int32,\n    votedBy: ?string,\n    ballots: ?int32,\n    needed: ?int32,\n    votes: ?int32,\n    inducted: ?string,\n    category: ?string\n    },\n  awardsplayers: var * {\n    playerID: ?string,\n    awardID: ?string,\n    yearID: ?int32,\n    lgID: ?string,\n    tie: ?string,\n    notes: ?string\n    },\n  schoolsplayers: var * {\n    playerID: ?string,\n    schoolID: ?string,\n    yearMin: ?int32,\n    yearMax: ?int32\n    },\n  schools: var * {\n    schoolID: ?string,\n    schoolName: ?string,\n    schoolCity: ?string,\n    schoolState: ?string,\n    schoolNick: ?string\n    },\n  teamsfranchises: var * {\n    franchID: ?string,\n    franchName: ?string,\n    active: ?string,\n    NAassoc: ?string\n    },\n  allstarfull: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    gameNum: ?int32,\n    gameID: ?string,\n    teamID: ?string,\n    lgID: ?string,\n    GP: ?int32,\n    startingPos: ?int32\n    },\n  tmp_batting: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    stint: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    G: ?int32,\n    G_batting: ?int32,\n    AB: ?int32,\n    R: ?int32,\n    H: ?int32,\n    2B: ?int32,\n    3B: ?int32,\n    HR: ?int32,\n    RBI: ?int32,\n    SB: ?int32,\n    CS: ?int32,\n    BB: ?int32,\n    SO: ?int32,\n    IBB: ?int32,\n    HBP: ?int32,\n    SH: ?int32,\n    SF: ?int32,\n    GIDP: ?int32,\n    G_old: ?int32\n    },\n  seriespost: var * {\n    yearID: ?int32,\n    round: ?string,\n    teamIDwinner: ?string,\n    lgIDwinner: ?string,\n    teamIDloser: ?string,\n    lgIDloser: ?string,\n    wins: ?int32,\n    losses: ?int32,\n    ties: ?int32\n    },\n  awardssharemanagers: var * {\n    awardID: ?string,\n    yearID: ?int32,\n    lgID: ?string,\n    managerID: ?string,\n    pointsWon: ?int32,\n    pointsMax: ?int32,\n    votesFirst: ?int32\n    },\n  awardsshareplayers: var * {\n    awardID: ?string,\n    yearID: ?int32,\n    lgID: ?string,\n    playerID: ?string,\n    pointsWon: ?float64,\n    pointsMax: ?int32,\n    votesFirst: ?float64\n    },\n  fielding: var * {\n    playerID: ?string,\n    yearID: ?int32,\n    stint: ?int32,\n    teamID: ?string,\n    lgID: ?string,\n    POS: ?string,\n    G: ?int32,\n    GS: ?int32,\n    InnOuts: ?int32,\n    PO: ?int32,\n    A: ?int32,\n    E: ?int32,\n    DP: ?int32,\n    PB: ?int32,\n    WP: ?int32,\n    SB: ?int32,\n    CS: ?int32,\n    ZR: ?float64\n    }\n  }\"\"\"</span><span class=\"p\">)</span></code></pre>\n</figure>\n\n<p>Seeing at once all the tables in the database, all the columns in those tables,\nand all the types of those columns provides a clear and comprehensive overview\nof our data.  We represent this information as a\n<a href=\"http://datashape.pydata.org/\">datashape</a>, a type system covers everything from\nnumpy arrays to SQL databases and Spark collections.</p>\n\n<p>We use standard Blaze expressions to navigate more deeply.  Things like\nauto-complete work fine.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"o\">&lt;</span><span class=\"n\">tab</span><span class=\"o\">&gt;</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">allstarfull</span>          <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">fieldingpost</span>         <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">pitchingpost</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">appearances</span>          <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">fields</span>               <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">relabel</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">awardsmanagers</span>       <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">halloffame</span>           <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">salaries</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">awardsplayers</span>        <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">hofold</span>               <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">schema</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">awardssharemanagers</span>  <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">isidentical</span>          <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">schools</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">awardsshareplayers</span>   <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">like</span>                 <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">schoolsplayers</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">battingpost</span>          <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">managers</span>             <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">seriespost</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">data</span>                 <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">managershalf</span>         <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">teams</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">dshape</span>               <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"nb\">map</span>                  <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">teamsfranchises</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">fielding</span>             <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">master</span>               <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">teamshalf</span>\n<span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">fieldingof</span>           <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">pitching</span>             <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">tmp_batting</span></code></pre>\n</figure>\n\n<p>And we finish by a fun multi-table computation, joining two tables on year,\nteam, and league and then computing the average salary by team name and year</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">joined</span> <span class=\"o\">=</span> <span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">teams</span><span class=\"p\">,</span> <span class=\"n\">lahman</span><span class=\"p\">.</span><span class=\"n\">salaries</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"s\">'yearID'</span><span class=\"p\">,</span> <span class=\"s\">'teamID'</span><span class=\"p\">,</span> <span class=\"s\">'lgID'</span><span class=\"p\">])</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">by</span><span class=\"p\">(</span><span class=\"n\">joined</span><span class=\"p\">[[</span><span class=\"s\">'name'</span><span class=\"p\">,</span> <span class=\"s\">'yearID'</span><span class=\"p\">]],</span> <span class=\"n\">average_salary</span><span class=\"o\">=</span><span class=\"n\">joined</span><span class=\"p\">.</span><span class=\"n\">salary</span><span class=\"p\">.</span><span class=\"n\">mean</span><span class=\"p\">())</span>\n                    <span class=\"n\">name</span>  <span class=\"n\">yearID</span>  <span class=\"n\">average_salary</span>\n<span class=\"mi\">0</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">1997</span>  <span class=\"mf\">1004370.064516</span>\n<span class=\"mi\">1</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">1998</span>  <span class=\"mf\">1214147.058824</span>\n<span class=\"mi\">2</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">1999</span>  <span class=\"mf\">1384704.150000</span>\n<span class=\"mi\">3</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">2000</span>  <span class=\"mf\">1715472.233333</span>\n<span class=\"mi\">4</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">2001</span>  <span class=\"mf\">1584505.566667</span>\n<span class=\"mi\">5</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">2002</span>  <span class=\"mf\">2204345.250000</span>\n<span class=\"mi\">6</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">2003</span>  <span class=\"mf\">2927098.777778</span>\n<span class=\"mi\">7</span>         <span class=\"n\">Anaheim</span> <span class=\"n\">Angels</span>    <span class=\"mi\">2004</span>  <span class=\"mf\">3723506.185185</span>\n<span class=\"mi\">8</span>   <span class=\"n\">Arizona</span> <span class=\"n\">Diamondbacks</span>    <span class=\"mi\">1998</span>   <span class=\"mf\">898527.777778</span>\n<span class=\"mi\">9</span>   <span class=\"n\">Arizona</span> <span class=\"n\">Diamondbacks</span>    <span class=\"mi\">1999</span>  <span class=\"mf\">2020705.852941</span>\n<span class=\"p\">...</span></code></pre>\n</figure>\n\n<p>Looks good, we compute and store to CSV file with <code class=\"language-plaintext highlighter-rouge\">into</code></p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">into</span><span class=\"p\">(</span><span class=\"s\">'salaries.csv'</span><span class=\"p\">,</span>\n<span class=\"p\">...</span>      <span class=\"n\">by</span><span class=\"p\">(</span><span class=\"n\">j</span><span class=\"p\">[[</span><span class=\"s\">'name'</span><span class=\"p\">,</span> <span class=\"s\">'yearID'</span><span class=\"p\">]],</span> <span class=\"n\">total_salary</span><span class=\"o\">=</span><span class=\"n\">j</span><span class=\"p\">.</span><span class=\"n\">salary</span><span class=\"p\">.</span><span class=\"n\">mean</span><span class=\"p\">()))</span></code></pre>\n</figure>\n\n<p>(Final result here: <a href=\"https://mrocklin.github.io/blog/storage/salaries.csv\">salaries.csv</a>)</p>\n\n<h2 id=\"beyond-sql\">Beyond SQL</h2>\n\n<p>SQL isn’t unique, many systems hold collections or hierarchies of datasets.\nBlaze supports navigation over Mongo databases, <a href=\"http://blaze.pydata.org/docs/latest/server.html\">Blaze\nservers</a>, HDF5 files, or even\njust dictionaries of pandas DataFrames or CSV files.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s\">'accounts 1'</span><span class=\"p\">:</span> <span class=\"n\">CSV</span><span class=\"p\">(</span><span class=\"s\">'accounts_1.csv'</span><span class=\"p\">),</span>\n<span class=\"p\">...</span>      <span class=\"s\">'accounts 2'</span><span class=\"p\">:</span> <span class=\"n\">CSV</span><span class=\"p\">(</span><span class=\"s\">'accounts_2.csv'</span><span class=\"p\">)}</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">accounts</span> <span class=\"o\">=</span> <span class=\"n\">Data</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">)</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">accounts</span><span class=\"p\">.</span><span class=\"n\">dshape</span>\n<span class=\"n\">dshape</span><span class=\"p\">(</span><span class=\"s\">\"\"\"{\n  accounts 1: var * {id: ?int64, name: string, amount: ?int64},\n  accounts 2: var * {id: ?int64, name: string, amount: ?int64}\n  }\"\"\"</span><span class=\"p\">)</span></code></pre>\n</figure>\n\n<p>None of this behavior was special-cased in Blaze.  The same mechanisms\nthat select a table from a SQL database select a column from a Pandas\nDataFrame.</p>\n\n<h2 id=\"finish-with-hdf5-example\">Finish with HDF5 example</h2>\n\n<p>To conclude we revisit our motivating problem, HDF5 file navigation.</p>\n\n<h3 id=\"raw-h5py\">Raw H5Py</h3>\n\n<p>Recall that we previously had a long back-and-forth conversation with the\nPython interpreter.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"kn\">import</span> <span class=\"nn\">h5py</span>\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"n\">h5py</span><span class=\"p\">.</span><span class=\"n\">File</span><span class=\"p\">(</span><span class=\"s\">'OMI-Aura_L2-OMAERO_2014m1105t2304-o54838_v003-2014m1106t215558.he5'</span><span class=\"p\">)</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">.</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'HDFEOS'</span><span class=\"p\">,</span> <span class=\"s\">'HDFEOS INFORMATION'</span><span class=\"p\">]</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">f</span><span class=\"p\">[</span><span class=\"s\">'/HDFEOS'</span><span class=\"p\">].</span><span class=\"n\">keys</span><span class=\"p\">()</span>\n<span class=\"p\">[</span><span class=\"s\">'ADDITIONAL'</span><span class=\"p\">,</span> <span class=\"s\">'SWATHS'</span><span class=\"p\">]</span>\n<span class=\"p\">...</span></code></pre>\n</figure>\n\n<h3 id=\"h5py-with-blaze-expressions\">H5Py with Blaze expressions</h3>\n\n<p>With Blaze we get a quick high-level overview and an API that is shared with\ncountless other systems.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"kn\">from</span> <span class=\"nn\">blaze</span> <span class=\"kn\">import</span> <span class=\"n\">Data</span>\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"n\">Data</span><span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">)</span>  <span class=\"c1\"># Wrap h5py file with Blaze interactive expression\n</span><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span>\n<span class=\"n\">Data</span><span class=\"p\">:</span>       <span class=\"o\">&lt;</span><span class=\"n\">HDF5</span> <span class=\"nb\">file</span> <span class=\"s\">\"OMI-Aura_L2-OMAERO_2014m1105t2304-o54838_v003-2014m1106t215558.he5\"</span> <span class=\"p\">(</span><span class=\"n\">mode</span> <span class=\"n\">r</span><span class=\"o\">+</span><span class=\"p\">)</span><span class=\"o\">&gt;</span>\n<span class=\"n\">DataShape</span><span class=\"p\">:</span>  <span class=\"p\">{</span>\n  <span class=\"n\">HDFEOS</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n    <span class=\"n\">ADDITIONAL</span><span class=\"p\">:</span> <span class=\"p\">{</span><span class=\"n\">FILE_ATTRIBUTES</span><span class=\"p\">:</span> <span class=\"p\">{}},</span>\n    <span class=\"n\">SWATHS</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"n\">ColumnAmountAerosol</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n        <span class=\"n\">Data</span> <span class=\"n\">Fields</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n          <span class=\"n\">AerosolIndexUV</span><span class=\"p\">:</span> <span class=\"mi\">1643</span> <span class=\"o\">*</span> <span class=\"mi\">60</span> <span class=\"o\">*</span> <span class=\"n\">int16</span><span class=\"p\">,</span>\n  <span class=\"p\">...</span></code></pre>\n</figure>\n\n<p>By default we see the data and a truncated datashape.</p>\n\n<p>We ask for the datashape explicitly to see the full picture.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">dshape</span>\n<span class=\"n\">dshape</span><span class=\"p\">(</span><span class=\"s\">\"\"\"{\n  HDFEOS: {\n    ADDITIONAL: {FILE_ATTRIBUTES: {}},\n    SWATHS: {\n      ColumnAmountAerosol: {\n        Data Fields: {\n          AerosolIndexUV: 1643 * 60 * int16,\n          AerosolIndexVIS: 1643 * 60 * int16,\n          AerosolModelMW: 1643 * 60 * uint16,\n          AerosolModelsPassedThreshold: 1643 * 60 * 10 * uint16,\n          AerosolOpticalThicknessMW: 1643 * 60 * 14 * int16,\n          AerosolOpticalThicknessMWPrecision: 1643 * 60 * int16,\n          AerosolOpticalThicknessNUV: 1643 * 60 * 2 * int16,\n          AerosolOpticalThicknessPassedThreshold: 1643 * 60 * 10 * 9 * int16,\n          AerosolOpticalThicknessPassedThresholdMean: 1643 * 60 * 9 * int16,\n          AerosolOpticalThicknessPassedThresholdStd: 1643 * 60 * 9 * int16,\n          CloudFlags: 1643 * 60 * uint8,\n          CloudPressure: 1643 * 60 * int16,\n          EffectiveCloudFraction: 1643 * 60 * int8,\n          InstrumentConfigurationId: 1643 * uint8,\n          MeasurementQualityFlags: 1643 * uint8,\n          NumberOfModelsPassedThreshold: 1643 * 60 * uint8,\n          ProcessingQualityFlagsMW: 1643 * 60 * uint16,\n          ProcessingQualityFlagsNUV: 1643 * 60 * uint16,\n          RootMeanSquareErrorOfFitPassedThreshold: 1643 * 60 * 10 * int16,\n          SingleScatteringAlbedoMW: 1643 * 60 * 14 * int16,\n          SingleScatteringAlbedoMWPrecision: 1643 * 60 * int16,\n          SingleScatteringAlbedoNUV: 1643 * 60 * 2 * int16,\n          SingleScatteringAlbedoPassedThreshold: 1643 * 60 * 10 * 9 * int16,\n          SingleScatteringAlbedoPassedThresholdMean: 1643 * 60 * 9 * int16,\n          SingleScatteringAlbedoPassedThresholdStd: 1643 * 60 * 9 * int16,\n          SmallPixelRadiancePointerUV: 1643 * 2 * int16,\n          SmallPixelRadiancePointerVIS: 1643 * 2 * int16,\n          SmallPixelRadianceUV: 6783 * 60 * float32,\n          SmallPixelRadianceVIS: 6786 * 60 * float32,\n          SmallPixelWavelengthUV: 6783 * 60 * uint16,\n          SmallPixelWavelengthVIS: 6786 * 60 * uint16,\n          TerrainPressure: 1643 * 60 * int16,\n          TerrainReflectivity: 1643 * 60 * 9 * int16,\n          XTrackQualityFlags: 1643 * 60 * uint8\n          },\n        Geolocation Fields: {\n          GroundPixelQualityFlags: 1643 * 60 * uint16,\n          Latitude: 1643 * 60 * float32,\n          Longitude: 1643 * 60 * float32,\n          OrbitPhase: 1643 * float32,\n          SolarAzimuthAngle: 1643 * 60 * float32,\n          SolarZenithAngle: 1643 * 60 * float32,\n          SpacecraftAltitude: 1643 * float32,\n          SpacecraftLatitude: 1643 * float32,\n          SpacecraftLongitude: 1643 * float32,\n          TerrainHeight: 1643 * 60 * int16,\n          Time: 1643 * float64,\n          ViewingAzimuthAngle: 1643 * 60 * float32,\n          ViewingZenithAngle: 1643 * 60 * float32\n          }\n        }\n      }\n    },\n  HDFEOS INFORMATION: {\n    ArchiveMetadata.0: string[65535, 'A'],\n    CoreMetadata.0: string[65535, 'A'],\n    StructMetadata.0: string[32000, 'A']\n    }\n  }\"\"\"</span><span class=\"p\">)</span></code></pre>\n</figure>\n\n<p>When we see metadata for everything in this dataset all at once the full\nstructure  becomes apparent.  We have two collections of arrays, all shaped\n<code class=\"language-plaintext highlighter-rouge\">(1643, 60)</code>; the collection in <code class=\"language-plaintext highlighter-rouge\">Data Fields</code> holds what appear to be weather\nmeasurements while the collection in <code class=\"language-plaintext highlighter-rouge\">Geolocation Fields</code> holds coordinate\ninformation.</p>\n\n<p>Moreover we can quickly navigate this structure to compute relevant information.</p>\n\n<figure class=\"highlight\">\n  <pre><code class=\"language-python\" data-lang=\"python\"><span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">HDFEOS</span><span class=\"p\">.</span><span class=\"n\">SWATHS</span><span class=\"p\">.</span><span class=\"n\">ColumnAmountAerosol</span><span class=\"p\">.</span><span class=\"n\">Geolocation_Fields</span><span class=\"p\">.</span><span class=\"n\">Latitude</span>\n<span class=\"n\">array</span><span class=\"p\">([[</span><span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"o\">-</span><span class=\"mf\">61.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">60.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">60.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"o\">-</span><span class=\"mf\">61.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">60.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">60.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">67.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">68.</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"o\">-</span><span class=\"mf\">61.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">61.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">60.</span><span class=\"p\">],</span>\n       <span class=\"p\">...,</span>\n       <span class=\"p\">[</span> <span class=\"mf\">69.</span><span class=\"p\">,</span>  <span class=\"mf\">70.</span><span class=\"p\">,</span>  <span class=\"mf\">71.</span><span class=\"p\">,</span> <span class=\"p\">...,</span>  <span class=\"mf\">85.</span><span class=\"p\">,</span>  <span class=\"mf\">84.</span><span class=\"p\">,</span>  <span class=\"mf\">84.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span> <span class=\"mf\">69.</span><span class=\"p\">,</span>  <span class=\"mf\">70.</span><span class=\"p\">,</span>  <span class=\"mf\">71.</span><span class=\"p\">,</span> <span class=\"p\">...,</span>  <span class=\"mf\">85.</span><span class=\"p\">,</span>  <span class=\"mf\">85.</span><span class=\"p\">,</span>  <span class=\"mf\">84.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span> <span class=\"mf\">69.</span><span class=\"p\">,</span>  <span class=\"mf\">70.</span><span class=\"p\">,</span>  <span class=\"mf\">71.</span><span class=\"p\">,</span> <span class=\"p\">...,</span>  <span class=\"mf\">85.</span><span class=\"p\">,</span>  <span class=\"mf\">85.</span><span class=\"p\">,</span>  <span class=\"mf\">84.</span><span class=\"p\">]],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">float32</span><span class=\"p\">)</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">HDFEOS</span><span class=\"p\">.</span><span class=\"n\">SWATHS</span><span class=\"p\">.</span><span class=\"n\">ColumnAmountAerosol</span><span class=\"p\">.</span><span class=\"n\">Geolocation_Fields</span><span class=\"p\">.</span><span class=\"n\">Longitude</span>\n<span class=\"n\">array</span><span class=\"p\">([[</span>  <span class=\"mf\">46.</span><span class=\"p\">,</span>   <span class=\"mf\">43.</span><span class=\"p\">,</span>   <span class=\"mf\">40.</span><span class=\"p\">,</span> <span class=\"p\">...,</span>   <span class=\"o\">-</span><span class=\"mf\">3.</span><span class=\"p\">,</span>   <span class=\"o\">-</span><span class=\"mf\">5.</span><span class=\"p\">,</span>   <span class=\"o\">-</span><span class=\"mf\">7.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">46.</span><span class=\"p\">,</span>   <span class=\"mf\">43.</span><span class=\"p\">,</span>   <span class=\"mf\">40.</span><span class=\"p\">,</span> <span class=\"p\">...,</span>   <span class=\"o\">-</span><span class=\"mf\">3.</span><span class=\"p\">,</span>   <span class=\"o\">-</span><span class=\"mf\">5.</span><span class=\"p\">,</span>   <span class=\"o\">-</span><span class=\"mf\">7.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span>  <span class=\"mf\">46.</span><span class=\"p\">,</span>   <span class=\"mf\">43.</span><span class=\"p\">,</span>   <span class=\"mf\">40.</span><span class=\"p\">,</span> <span class=\"p\">...,</span>   <span class=\"o\">-</span><span class=\"mf\">4.</span><span class=\"p\">,</span>   <span class=\"o\">-</span><span class=\"mf\">5.</span><span class=\"p\">,</span>   <span class=\"o\">-</span><span class=\"mf\">7.</span><span class=\"p\">],</span>\n       <span class=\"p\">...,</span>\n       <span class=\"p\">[</span> <span class=\"mf\">123.</span><span class=\"p\">,</span>  <span class=\"mf\">124.</span><span class=\"p\">,</span>  <span class=\"mf\">124.</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"o\">-</span><span class=\"mf\">141.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">131.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">121.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span> <span class=\"mf\">123.</span><span class=\"p\">,</span>  <span class=\"mf\">124.</span><span class=\"p\">,</span>  <span class=\"mf\">124.</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"o\">-</span><span class=\"mf\">141.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">130.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">120.</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span> <span class=\"mf\">123.</span><span class=\"p\">,</span>  <span class=\"mf\">123.</span><span class=\"p\">,</span>  <span class=\"mf\">124.</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"o\">-</span><span class=\"mf\">140.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">130.</span><span class=\"p\">,</span> <span class=\"o\">-</span><span class=\"mf\">119.</span><span class=\"p\">]],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">float32</span><span class=\"p\">)</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">HDFEOS</span><span class=\"p\">.</span><span class=\"n\">SWATHS</span><span class=\"p\">.</span><span class=\"n\">ColumnAmountAerosol</span><span class=\"p\">.</span><span class=\"n\">Data_Fields</span><span class=\"p\">.</span><span class=\"n\">TerrainPressure</span>\n<span class=\"n\">array</span><span class=\"p\">([[</span><span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">...,</span>\n       <span class=\"p\">[</span><span class=\"mi\">1010</span><span class=\"p\">,</span>  <span class=\"mi\">992</span><span class=\"p\">,</span>  <span class=\"mi\">986</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span> <span class=\"mi\">999</span><span class=\"p\">,</span>  <span class=\"mi\">983</span><span class=\"p\">,</span>  <span class=\"mi\">988</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">],</span>\n       <span class=\"p\">[</span><span class=\"mi\">1006</span><span class=\"p\">,</span>  <span class=\"mi\">983</span><span class=\"p\">,</span>  <span class=\"mi\">993</span><span class=\"p\">,</span> <span class=\"p\">...,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">,</span> <span class=\"mi\">1013</span><span class=\"p\">]],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">int16</span><span class=\"p\">)</span>\n\n<span class=\"o\">&gt;&gt;&gt;</span> <span class=\"n\">d</span><span class=\"p\">.</span><span class=\"n\">HDFEOS</span><span class=\"p\">.</span><span class=\"n\">SWATHS</span><span class=\"p\">.</span><span class=\"n\">ColumnAmountAerosol</span><span class=\"p\">.</span><span class=\"n\">Data_Fields</span><span class=\"p\">.</span><span class=\"n\">TerrainPressure</span><span class=\"p\">.</span><span class=\"nb\">min</span><span class=\"p\">()</span>\n<span class=\"mi\">620</span></code></pre>\n</figure>\n\n<h2 id=\"final-thoughts\">Final Thoughts</h2>\n\n<p><em>Often the greatest challenge is finding what you already have.</em></p>\n\n<p>Discovery and exploration are just as important as computation.  By extending\nthe Blaze’s expression system to hierarchies of datasets we create a smooth\nuser experience from first introductions to data all the way to analytic\nqueries and saving results.</p>\n\n<p>This work was easy.  The pluggable architecture of Blaze made it surprisingly\nsimple to extend the Blaze model from tables and arrays to collections of\ntables and arrays.  We wrote about <a href=\"https://github.com/ContinuumIO/blaze/pull/825\">40 significant lines of\ncode</a> for each supported\nbackend.</p>"
}