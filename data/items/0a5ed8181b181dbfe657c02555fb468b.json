{
  "title": "Package Paths in R",
  "link": "https://www.quintuitive.com/2018/03/31/package-paths-r/",
  "comments": "https://www.quintuitive.com/2018/03/31/package-paths-r/#respond",
  "dc:creator": "quintuitive",
  "pubDate": "Sat, 31 Mar 2018 19:39:53 +0000",
  "category": [
    "Programming",
    "R",
    "Uncategorized",
    "R packages",
    "R_LIBS",
    "R_LIBS_SITE",
    "R_LIBS_USER"
  ],
  "guid": "http://www.quintuitive.com/?p=3276",
  "description": "<p>Recently, while working on the Azure Data Lake R extension, I had to figure out a good way to create a zip file containing a package together with all its dependencies. This came down to understanding where does R store and search for packages. Despite the documentation, it did require additional reading and experimentation. First, [&#8230;]</p>\n<p>The post <a rel=\"nofollow\" href=\"https://www.quintuitive.com/2018/03/31/package-paths-r/\">Package Paths in R</a> appeared first on <a rel=\"nofollow\" href=\"https://www.quintuitive.com\">Quintuitive</a>.</p>\n",
  "content:encoded": "<p>Recently, while working on the <a href=\"https://docs.microsoft.com/en-us/azure/data-lake-analytics/data-lake-analytics-u-sql-r-extensions\">Azure Data Lake R extension</a>, I had to figure out a good way to create a zip file containing a package together with all its dependencies. This came down to understanding where does R store and search for packages. Despite the documentation, it did require additional reading and experimentation.</p>\n<p><span id=\"more-3276\"></span></p>\n<p>First, the accompanying video:</p>\n<p><iframe class='youtube-player' type='text/html' width='640' height='360' src='https://www.youtube.com/embed/9o7D_hFTMLc?version=3&#038;rel=1&#038;fs=1&#038;autohide=2&#038;showsearch=0&#038;showinfo=1&#038;iv_load_policy=1&#038;wmode=transparent' allowfullscreen='true' style='border:0;'></iframe></p>\n<p>Before getting into package search paths, let&#8217;s first figure out how does an R package look in the file system:</p>\n<p><a href=\"http://www.quintuitive.com/wp-content/uploads/2018/03/rsite.png\"><img loading=\"lazy\" src=\"http://www.quintuitive.com/wp-content/uploads/2018/03/rsite.png\" alt=\"\" width=\"171\" height=\"118\" class=\"aligncenter size-full wp-image-3298\" /></a></p>\n<p>An R package is a folder somewhere in the file system. Above <i>quantmod</i>, <i>TTR</i>, <i>xts</i> and <i>zoo</i> are all folders each containing the corresponding package. For these packages to be found by R, the <i>rsite</i> folder (its absolute path, for instance <i>c:/users/ivannp/rsite</i>) needs to be added to R&#8217;s search path.</p>\n<p>R&#8217;s package search path is reported by the <a href=\"https://stat.ethz.ch/R-manual/R-devel/library/base/html/libPaths.html\">.libPaths() function</a> (invoked without arguments). The result is a vector of strings, each representing a path containing packages. When the user requests a package to be loaded (via <i>require</i> or via <i>library</i>), R searches for the package in each path of the list, starting with the first. If the package is found, it is loaded and the search finishes. Thus, it is important to understand how the vector of paths is build.</p>\n<p>The last element of the path is R&#8217;s distribution <i>library</i> path. On Windows this could be:</p>\n<pre class=\"brush: plain; title: ; notranslate\">\nC:/Program Files/R/R-3.4.2/library\n</pre>\n<p>This path cannot be removed. Calling <i>.libPaths(&#8221;)</i> (with an empty string) will remove all other entries but the library sub-directory of the distribution.</p>\n<p>There are three environment variables which control the content of the path vector:</p>\n<ul>\n<li><b>R_LIBS</b></li>\n<li><b>R_LIBS_USER</b></li>\n<li><b>R_LIBS_SITE</b></li>\n</ul>\n<p>The content of these environment variables is added to the package search path in the order listed. First <b>R_LIBS</b>, then <b>R_LIBS_USER</b> and finally <b>R_LIBS_SITE</b>.</p>\n<p>If none of the three environment variables is defined, R will append a default path to the search list. This path is platform dependent. On Windows it is something like:</p>\n<pre class=\"brush: plain; title: ; notranslate\">\nC:/Users/user/Documents/R/win-library/3.4\n</pre>\n<p>To avoid depending on this behavior, I typically have <b>R_LIBS_USER</b> set. On Windows, make sure that the path doesn&#8217;t end with slash (&#8216;/&#8217; or &#8216;\\&#8217;). According to <a href=\"https://stat.ethz.ch/R-manual/R-devel/library/base/html/libPaths.html\">.libPaths() documentation</a>, paths ending on a slash are invalid, and R silently ignores them.</p>\n<p>Will all this knowledge, the solution to the original problem &#8211; how to create a zip containing a package together with all its dependencies, is clear:</p>\n<pre class=\"brush: r; title: ; notranslate\">\n.libPaths('') # Cleanup any additional paths the user might have\ndir.create('packages') # Create the directory\n.libPaths('packages') # To add packages to the R search folders\ninstall.packages('ggplot2') # Install all\nzip('packages.zip', 'packages') # Create the zip\n</pre>\n<p>The above script create <i>packages.zip</i> containing <i>ggplot2</i> and all its dependencies. A local folder <i>packages</i> is used in the process. That&#8217;s assuming there are no additional packages in R&#8217;s root installation.</p>\n<p>The post <a rel=\"nofollow\" href=\"https://www.quintuitive.com/2018/03/31/package-paths-r/\">Package Paths in R</a> appeared first on <a rel=\"nofollow\" href=\"https://www.quintuitive.com\">Quintuitive</a>.</p>\n",
  "wfw:commentRss": "https://www.quintuitive.com/2018/03/31/package-paths-r/feed/",
  "slash:comments": 0,
  "post-id": 3276
}