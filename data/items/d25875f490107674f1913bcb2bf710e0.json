{
  "title": "Quickly Create Dummy Variables in a Data Frame",
  "description": "<p>On Quora, a question was asked about how to fix the error of the <a title=\"Error in Random Forest 32 levels categorical variable\" href=\"https://www.quora.com/Random-Forests/How-can-I-fix-the-error-in-the-package-randomForest\" target=\"_blank\">randomForest package in R not being able to handle more than 32 levels in a categorical variable</a>. Seeing as how I‚Äôve seen this question asked on Kaggle forums, StackOverflow and elsewhere, here‚Äôs the answer: code your own <em>dummy variables</em> instead of relying on Factors!</p>",
  "pubDate": "Thu, 02 Jan 2014 13:58:51 +0000",
  "link": "http://randyzwitch.com/creating-dummy-variables-data-frame-r/",
  "guid": "http://randyzwitch.com/creating-dummy-variables-data-frame-r/",
  "content": "<p>On Quora, a question was asked about how to fix the error of the <a title=\"Error in Random Forest 32 levels categorical variable\" href=\"https://www.quora.com/Random-Forests/How-can-I-fix-the-error-in-the-package-randomForest\" target=\"_blank\">randomForest package in R not being able to handle more than 32 levels in a categorical variable</a>. Seeing as how I‚Äôve seen this question asked on Kaggle forums, StackOverflow and elsewhere, here‚Äôs the answer: code your own <em>dummy variables</em> instead of relying on Factors!</p>\n\n<h2 id=\"code-snippet\">Code snippet</h2>\n\n<figure class=\"highlight\"><pre><code class=\"language-r\" data-lang=\"r\"><table class=\"rouge-table\"><tbody><tr><td class=\"gutter gl\"><pre class=\"lineno\">1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n</pre></td><td class=\"code\"><pre><span class=\"c1\">#Generate example dataframe with character column</span><span class=\"w\">\n</span><span class=\"n\">example</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">as.data.frame</span><span class=\"p\">(</span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s2\">\"A\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"A\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"B\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"F\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"C\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"G\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"C\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"D\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"E\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"F\"</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"nf\">names</span><span class=\"p\">(</span><span class=\"n\">example</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s2\">\"strcol\"</span><span class=\"w\">\n\n</span><span class=\"c1\">#For every unique value in the string column, create a new 1/0 column</span><span class=\"w\">\n</span><span class=\"c1\">#This is what Factors do \"under-the-hood\" automatically when passed to function requiring numeric data</span><span class=\"w\">\n</span><span class=\"k\">for</span><span class=\"p\">(</span><span class=\"n\">level</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">example</span><span class=\"o\">$</span><span class=\"n\">strcol</span><span class=\"p\">)){</span><span class=\"w\">\n  </span><span class=\"n\">example</span><span class=\"p\">[</span><span class=\"n\">paste</span><span class=\"p\">(</span><span class=\"s2\">\"dummy\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">level</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sep</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"_\"</span><span class=\"p\">)]</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">ifelse</span><span class=\"p\">(</span><span class=\"n\">example</span><span class=\"o\">$</span><span class=\"n\">strcol</span><span class=\"w\"> </span><span class=\"o\">==</span><span class=\"w\"> </span><span class=\"n\">level</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"m\">0</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"n\">view</span><span class=\"w\"> </span><span class=\"n\">raw</span>\n</pre></td></tr></tbody></table></code></pre></figure>\n\n<p>As the code above shows, it‚Äôs trivial to generate your own 1/0 columns of data instead of relying on Factors. There are two things to keep in mind when creating your own dummy variables:</p>\n\n<ol>\n  <li>The problem you are trying to solve</li>\n  <li>How much RAM you have available</li>\n</ol>\n\n<p>While it may make sense to generate dummy variables for Customer State (~50 for the United States), if you were to use the code above on City Name, you‚Äôd likely either run out of RAM or find out that there are too many levels to be useful. Of course, with any qualitative statement such as ‚Äútoo many levels to be useful‚Äù, oftentimes the only way to definitively know is to try it! Just make sure you save your work before running this code, just in case you run out of RAM. Or, use someone else‚Äôs computer for testing üòâ</p>\n\n<p>Edit 1/2/14: John Myles White brought up a good point via Twitter about RAM usage:</p>\n\n<blockquote class=\"twitter-tweet\" data-conversation=\"none\" data-cards=\"hidden\" data-partner=\"tweetdeck\">\n  <p>\n    <a href=\"https://twitter.com/randyzwitch\">@randyzwitch</a> If you're running out of RAM with dummy variables, you probably want to use a sparse matrix instead of a data.frame.\n  </p>\n\n  <p>\n    ‚Äî John Myles White (@johnmyleswhite) <a href=\"https://twitter.com/johnmyleswhite/statuses/418821463563829248\">January 2, 2014</a>\n  </p>\n</blockquote>"
}