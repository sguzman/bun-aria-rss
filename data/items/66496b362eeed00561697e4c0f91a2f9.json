{
  "id": "tag:blogger.com,1999:blog-5825758052688213474.post-4927176678689606760",
  "published": "2016-09-30T09:06:00.000-07:00",
  "updated": "2018-08-31T22:08:14.116-07:00",
  "title": "Statistics for Google Sheets",
  "content": "<i style=\"font-size: x-large;\"><b>Editor's note:&nbsp;</b></i><i style=\"font-size: x-large;\">The Google Sheets add-on described in this blog post is no longer supported externally by Google.</i><br /><br />By STEVEN L. SCOTT<br /><br /><i>Big data is new and exciting, but there are still lots of small data problems in the world. Many people who are just becoming aware that they need to work with data are finding that they lack the tools to do so. The statistics app for Google Sheets hopes to change that.</i><br /><i><br /></i><i><b>Editor's note:</b> We've mostly portrayed data science as statistical methods and analysis approaches based on big data. But some of our readers have perfectly validly pointed out that this may be too narrow a view. While big data remains a focus of this blog, there are exciting innovations happening in other areas as well. Steve's post is an excellent example of this, and we are thrilled to see him contribute this month's article.</i><br /><i></i><br /><br /><div><h2>Introduction</h2></div><div><div>Statistics for Google Sheets is an add-on for Google Sheets that brings elementary statistical analysis tools to spreadsheet users. The app focuses on material commonly taught in introductory statistics and regression courses, with the intent that students who have taken these courses should be able to carry out the analyses that they learned when they move on to jobs in the work force.</div><div><br /></div><div>Frequent readers of this blog probably don’t think of themselves as spreadsheet users, and may be wondering why anyone would want to carry out data analysis in a spreadsheet environment. After all, working with data in spreadsheets involves serious limitations, with scale being an obvious one. Google sheets is currently limited to 2 million cells, which is too small to hold a modern medium-to-large size data set. A spreadsheet-based app can’t (and shouldn’t!) hope to replace R, SAS, or similar packages designed by and for statistics experts.</div><div><br /></div><div>Yet while the rise of “big data” problems has not reduced the number of “small data” problems in the world, the rise of “data science” has put data on the radar of many non-specialists. These are users who may have had (or may be taking) an introductory statistics course in college, but who have chosen to pursue skills other than data science. Spreadsheets are a natural choice for this audience both because spreadsheets are ubiquitous and because they provide an intuitive way to visually inspect the raw data.</div><div><br /></div><div>The goal of the Statistics app is to “democratize data science” by putting elementary statistics capabilities in the hands of anyone with a Google account. Because the app is merely an add-on to Google sheets, its learning curve is considerably gentler than that of an entirely separate software package. Because it runs in the browser it imposes no additional installation or maintenance requirements, which can be helpful for IT administrators as well as analysts and students. It is easy to underestimate the amount of work involved for an IT department to support individual software packages, which can make it hard for a young analyst in a medium to large sized corporation to gain access to statistical software, even a free system like R. Because most employees do not have administrator privileges on their computers, many of the ideas taught in elementary statistics courses go unimplemented in the workplace for lack of software.<br /><img height=\"1\" src=\"https://lh4.googleusercontent.com/WAp3SZL9ZXqXSQO6wLZuVoJTT0zBvQXpvkv9yKOiuuZ7cv_Yiyy_udyRuZVJCtBrTHwKNvN5423ZrVbwUtnfi_glwC4YGo5StyWe9Sij4THrCZpGjZN_bJX1Xnwh7IzQDwnWOmVw\" style=\"border: none; font-family: arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" /></div></div><div><br /></div><div><br /></div><div><h2>Example: Stock Market Returns</h2></div><div><div>To see the app in action, open this data set showing <a href=\"https://docs.google.com/spreadsheets/d/1y0exLBlBqk3g4929etIxv2Bnc4jc_fuplukmvRSR19Q/edit?usp=sharing\" target=\"_blank\">S&amp;P500 stock market returns</a> in Google Sheets. This document is shared with the Internet, so make a personal copy that you can edit by selecting <i>File → Make a copy</i> from the menu. If you don’t already have the <a href=\"https://sites.google.com/site/statisticsforspreadsheets/\" target=\"_blank\">Statistics app</a> installed, select <i>Add-ons → Get add-ons</i> and search for the app named <i>Statistics</i>.<br /><br />Of course, we’re not providing investment advice, and each person would need to evaluate the results for themselves. What we’re going to do is work through how the app might be used.&nbsp;</div><div><br /></div><div>One of the variables in the data (column H) is named <i>Return</i>. It shows the percentage change relative to the previous day’s closing value. A related variable (in column J) is <i>UpDay?</i>, which indicates whether <i>Return &gt; 0</i>. We can explore the values in these two columns by selecting <i>Add-ons → Statistics → Describe data</i> and entering these two variables in the Variables section of the right hand configuration pane (using Ctrl+Click or Cmd+Click to select several values). Notice that <i>UpDay?</i> is automatically treated as a factor because its values (the words “Up” and “Down”) are non-numeric.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6596-da21-981a-b8627b1840c8\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"191\" src=\"https://lh3.googleusercontent.com/FvEXKiNFD5fTw2HAQPKqNEtstXB9dVK3er-HrgjkGHvNfIgeTx6bdXeCFtCTDYaQABzxoCw_GO4eHkm5FidqBdWxGf8Uqu1P1L3K6exNNnNFOsx9uSpfAGh5v0S6IkiDGmSDN9h5\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"624\" /></span></span></div><div><br /></div><div><div>Clicking the Create button at the bottom of the right hand pane creates a new sheet named \"Univariate 1\" filled with numerical and graphical summaries describing the data. Notice that the summaries are different for numeric and factor data. The histogram of <i>Return</i> appears nearly symmetric, but the histogram of <i>UpDay?</i> shows that there have been slightly more up days than down. We also see a third category named “missing”. Both <i>Return</i> and <i>UpDay?</i> were constructed from raw data in columns A-G using spreadsheet formulas, which are exposed in the spreadsheet’s formula bar when you click on the data in these columns. In particular, Return is the percent change from the previous day, so the formula for the very first day (the last row in the data set) returns an error, because there is no previous day to compare against. The app considers the cell containing the error to be missing data.</div></div><div><br /></div><div><span style=\"clear: left; float: left; font-family: &quot;arial&quot;; font-size: 14.6667px; margin-bottom: 1em; margin-right: 1em; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"295\" src=\"https://lh5.googleusercontent.com/lEZzet8yi2gEkXPp_J836QDS_Zm4Xc8F3kct0rEJf8ySQbhyUwc3KIw9gxenw4xJAn5GQSnpYCvyQmcoUKnTtLd2apLxd70dSSJH1fxHamVydFzEjIM9jzsyQmCLr6YX2qssvWlH\" style=\"border: none; transform: rotate(0rad);\" width=\"293\" />  </span><span id=\"docs-internal-guid-e10de34f-6597-0212-db10-46d11adc93ef\"></span><img height=\"282\" src=\"https://lh4.googleusercontent.com/R-LEcSMdMvpeKNJ7Fn9deARMy5CqiHSu_f57AmGtXYSeAPhO41oJg2vNadMUjJa92X7B_xd_QunNOm1ym2aCW9BUEJiV5H5iS3Uhd94FUSWEem9ylYWaBggA9cjL9hCYWtC3Yiek\" style=\"border: none; font-family: Arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" width=\"285\" /></div><div><br /></div><div><br /></div><div><br /></div><div><div>The summaries of <i>Return</i> simply omit the missing observation (although the presence of missing data is reported on the “N missing” line, below the plots), but the factor variable <i>UpDay?</i> counts the missing value as a separate category. We can manually exclude the missing values from the analysis by adding the variable <i>Use?</i> (found in column L) as a filter. A filter is a variable filled with TRUE and FALSE values. Setting a filter instructs the app to use the rows where the filter is TRUE, and to omit the rows where it is FALSE. We have set the last two entries in <i>Use?</i> to FALSE because we will soon care about the variables <i>LagReturn</i> and <i>LagUpDay?</i> which give the values of Return and <i>UpDay?</i> on the preceding day. Each of these introduces an additional missing observation, which we also wish to exclude.</div><div><br /></div><div>Repeating the analysis after setting the filter (and clicking <i>Create</i> again) produces a summary of <i>Return</i> that is essentially unchanged, but the missing category is no longer present in the histogram for <i>UpDay?</i>.</div></div><div><br /></div><div><span style=\"clear: left; float: left; font-family: &quot;arial&quot;; font-size: 14.6667px; margin-bottom: 1em; margin-right: 1em; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"320\" src=\"https://lh5.googleusercontent.com/lEZzet8yi2gEkXPp_J836QDS_Zm4Xc8F3kct0rEJf8ySQbhyUwc3KIw9gxenw4xJAn5GQSnpYCvyQmcoUKnTtLd2apLxd70dSSJH1fxHamVydFzEjIM9jzsyQmCLr6YX2qssvWlH\" style=\"border: none; transform: rotate(0rad);\" width=\"317\" />  </span><span id=\"docs-internal-guid-e10de34f-6597-5275-bfd1-6283f3963a68\"></span><img height=\"320\" src=\"https://lh5.googleusercontent.com/3aRcL3Lcqv40H9RfG_5WSIaqowjYTfWSN72oEL7Vckp7mom3ucyYG4GlNq45-6u51Ki5T7C2JY4no1mQT3lCmtAaycmRR-BB7iu38PjAEhIKopLzdlHJwXYR1ANMHYhVA-WijnGL\" style=\"border: none; font-family: Arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" width=\"304\" /></div><div><br /></div><div><br /></div><div><div>Beneath the graphs are numerical summaries. The mean daily return is zero to 3 decimal places, but clicking on the cell containing this number shows the mean to full precision. The standard deviation of daily returns is 1.3%. There have been 2230 up days and 1970 down days. Other charts include a normal quantile plot for judging whether returns are normally distributed (they have fatter tails than normal), and Pareto and pie charts for judging the relative proportion of up days.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6597-8cce-0a01-cf5a8abf55fe\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"109\" src=\"https://lh5.googleusercontent.com/4_ggkyBGiBFqTlI-O50-9tV_F_E7SnnrnuUJflJXO-bwBbJckiuWjS3pTfUbzewyLrWhJjSqBUSYobmL9kq5e9H6M4FxYSmjDjDSAa4pEzny5GcnSY64a1Dp6WyVOgqjyVM83gjG\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"190\" />  </span></span><img height=\"244\" src=\"https://lh6.googleusercontent.com/dHBfpBnxh6SCeAWOAgLHtjQBQVaGzU1hB_akCO2oPCiUHpie4X-w5Bi-6Q0MNmh6FKbq3PYmYPWctI8ZvBXCcaeTiApyJO-7gPVbJNkfBSqbJXxdkklOUgyeqlcwEF_GxK_mlS_n\" style=\"border: none; font-family: Arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" width=\"197\" />&nbsp;&nbsp;<img height=\"67\" src=\"https://lh6.googleusercontent.com/N9ml5-kzp2R9YnkjboA5BDkoY5ECbtGd2l-XQqeSmVMv8ZcXeV0VhCfGl3u0UsAnXq-6-FVDtXzY5IGMpop-1labWL3nYgqUK8eRrQCuv1AERdlvYiAajI3H7rzUVzJmD7pZX-oH\" style=\"border: none; font-family: Arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" width=\"209\" /></div><div><br /></div><div><br /></div><div><div>Things get more interesting when we look for factors that potentially explain stock market returns. If we click the “By” button in the right hand pane we can see how the distribution of returns (and up/down days) varies with the return value the previous day (<i>LagReturn</i>), or whether the previous day was up (<i>LagUpDay?</i>). Let's choose the latter first.</div><div><br /></div><div>The boxplot below compares the distributions of returns on days following up and down days. The plot shows that the two days with the highest returns (which are substantially higher than other returns) occurred on days following down days.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6597-d14e-8ca1-65fb7edccd98\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"235\" src=\"https://lh5.googleusercontent.com/NKdZWrdQ5gZR-akWj3RBqd9dKbK-kQ567trzouRnlcGJQvtOEps34Br2ZaPEzRzQ9sye_pUHcckU02F1wkEw4v2TRp21J6LB5y45iW8ZkwfrotzecUvM5P8PvCm6jCfSMgOeHlid\" style=\"border: none; transform: rotate(0rad);\" width=\"528\" /></span></span></div><div><br /></div><div><div>Setting the Date variable as a label (using the <i>Labels</i> button in the right hand pane) allows us to click on the individual dots and find that both extreme points took place in October of 2008, during the financial crisis when the markets were extra volatile and prone to wild swings. On these two days the S&amp;P 500 increased by more than 10% in a single day. The extreme losses on the left side of the plot also took place in October 2008, which was a bad month for the markets overall. If we wanted to, we could set some of these extreme observations aside in future analyses by setting their values to FALSE in the filter variable.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6598-1035-4862-7db5268a03d7\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"231\" src=\"https://lh4.googleusercontent.com/nJhz9ra_59p3JMbC9UGddxfFhxkhdc8DquLbmeHWERBzGOkpj2U_ZARtox6TWpVYfYwS5ANczOMUmwadAYjqjs0XhRRvJx9uYPjo9MZlBXdkXhX68GqmjhHnNgDQ8wLe_1Cr31py\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"522\" /></span></span></div><div><br /></div><div><div>If you look closely at the boxplots you can see that returns following down days have slightly greater variation than returns following up days. The boundaries of the box are wider, and the stems extending from the box are slightly longer. The means and standard deviations of the two groups bear out the impression we obtained from the plots.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6598-4206-a4ba-871d10a49192\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"97\" src=\"https://lh3.googleusercontent.com/pdORM8vagsfEFuPgVWTgs9d92ztZrVxN0-D5R6U0zwx6bBZsT5z9u5P-85rPpqQeVP0f3u1X_vK1w2XuArACBCy1uyKySRFif6P0V9ix8c-I_AouFP70D1qDOrlg2L5kMVLJ4Dj6\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"411\" /></span></span></div><div><br /></div><div><div>The mosaic plot for the relationship between consecutive up and down days shows a slight effect - following a down day, the probability of a down day is slightly lower than when following an up day. To see if this effect is statistically significant we can look at the chi-square test below the plot. The chi-square value of 18.026 is too large to be observed by chance with 1 degree of freedom, so it is probably safe to conclude that the distribution following up days really is different than the distribution following down days.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6598-67ec-a83f-696f228fd7f8\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"289\" src=\"https://lh6.googleusercontent.com/kCBZmYPq6ea9bqJJUpUSkmWjDKcZ6YAxFSquD862ElLE-L3WeUqzrwGZvEXvIiPt9pLKO8eKydSbtQx7BHlI7_iNcStBe6ObZnqnFPZRZCez5tsejnF7dKd519n31IQ6IsDA2KsT\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"370\" />  </span></span><img height=\"54\" src=\"https://lh6.googleusercontent.com/rusfwpEC023sHa-IjwOWyjWTLBc3sTY-iVoZweBifXDb6gbdfjQBzh-wLBKISM-l6aPCJVgM3l8Kzo-_vuRoTStL0pOwOLIDgFkc334bkKO_ZNgDNy-IJhp0TIuqHsXi4tPiRy3B\" style=\"border: none; font-family: Arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" width=\"219\" /></div><div><br /></div><div><div>Now change the variable in the “By” section of the configuration pane from <i>LagUpDay?</i> to <i>LagReturn</i>. Doing so allows us to look at how predictable daily returns are as a function of the previous day’s return. The scatterplot describing this relationship shows very little pattern, but there is a clearly negative slope to the trend line. Looking below this plot we see there is a small $R^2$ of .006, but the p-value for the slope of the regression line is highly significant with p &lt; .0001. This is very strong evidence of a very small (but nonzero) effect. In other words, there is a real trend towards self correction in the market but it is not very strong.</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6598-9dc6-f9de-836d987943c2\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"346\" src=\"https://lh4.googleusercontent.com/WAp3SZL9ZXqXSQO6wLZuVoJTT0zBvQXpvkv9yKOiuuZ7cv_Yiyy_udyRuZVJCtBrTHwKNvN5423ZrVbwUtnfi_glwC4YGo5StyWe9Sij4THrCZpGjZN_bJX1Xnwh7IzQDwnWOmVw\" style=\"border: none; transform: rotate(0rad);\" width=\"413\" /> </span></span></div><div><span id=\"docs-internal-guid-e10de34f-6598-ae64-6b83-af488bafe115\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"233\" src=\"https://lh5.googleusercontent.com/o-CgBhRYKGsvKkOyn6fDv26Yb7XrQDIZrtSN26do9T7CrsSTtiQEoo--LBUzmTbZc7H2gb1ntpWoTkJpe13cYM7Ax-z9cIGkbAK1Z7pwnR6-631dU29bKx8LuBv4SF7oJq4vJr5c\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"409\" /></span></span></div><div><br /></div><div><div>Finally, you can use logistic regression to see how a previous day’s return affects the probability of the next day’s return being positive. Here again we see a deviance $R^2$ of only 0.002, but the p-value for the logistic regression coefficient is .0013, which fits with our previous conclusion about strong evidence of a small effect.&nbsp;</div></div><div><br /></div><div><span id=\"docs-internal-guid-e10de34f-6598-d2ec-db52-0e7f8bcd2097\"><span style=\"font-family: &quot;arial&quot;; font-size: 14.6667px; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"219\" src=\"https://lh3.googleusercontent.com/4hUuOb-hT24zPH3Ef8AybOzrgn-T-EJ8hPvr6zRX-ttWA01MJJG99ey_K81Pajv-ujcCmlFm_lrnZd8mUtltXoRlL8WY-_LUu-y5LG9HyxKsM2LNIJwNosKCapajGR5ldlYpYjBV\" style=\"-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);\" width=\"423\" /></span></span></div><div><br /></div><div><div>The weakness is evident when we look at the model fit plot, which plots the proportion of up days vs the average estimated probability of an up day in 10 equal-sample-size buckets, and the ROC curve, which is very nearly a straight line.</div></div><div><br /></div><div><span style=\"clear: left; float: left; font-family: &quot;arial&quot;; font-size: 14.6667px; margin-bottom: 1em; margin-right: 1em; vertical-align: baseline; white-space: pre-wrap;\"><img height=\"318\" src=\"https://lh5.googleusercontent.com/-ih0lMAmmD_ajGz6uQkc8jfV5nWXOvPrSh9P3suTGICfFFKyMlLokizGrpwtOw0_Hx-DgRtqsb2HsPbe-0ZH4TACCmWuxrCG2LqZ4De0N3IUMRGcNbhKZI1hjRcxus5_mluz1b5E\" style=\"border: none; transform: rotate(0rad);\" width=\"320\" />  </span><span id=\"docs-internal-guid-e10de34f-6599-149a-b844-8221e1903384\"></span><img height=\"293\" src=\"https://lh6.googleusercontent.com/40yzbG94zsQMk5_Ux3cA8Q5sYoPmDFfIDxR_M8zfScaEzDVYwIHMsBXm0XHM6QF9Q0pjB8-MMdmsOLMA_j9HKI3RdCCSCDIu9QlAGYqDdy7Xn2BBM6dWcKwhNDb3Z79mFYC5WI1g\" style=\"border: none; font-family: Arial; font-size: 14.6667px; transform: rotate(0rad); white-space: pre-wrap;\" width=\"290\" /></div><div><br /></div><div><br /></div><h2>Where to go from here?</h2><div><div>Statistics for Google Sheets gives analysts and students the tools to conduct elementary statistical analyses in a familiar spreadsheet environment. Keep in mind that everything shown above was based on one menu selection: <i>Add-ons → Statistics → Describe Data</i>. More sophisticated tools for linear and logistic regression are available on the other (<i>Regression</i>) menu selection. Taken together with native spreadsheet functions for elementary data management, probability, and hypothesis testing the app currently provides all the tools needed for a 1-2 semester introductory statistics course, in a format that students can take with them when they become analysts.</div><div><br /></div><div>We hope to add more capabilities to the app in the future. We’d like to scale the tool to handle bigger data (possibly handling data sources from outside the spreadsheet), improve coverage in the help system (to better educate the public), build in more elaborate modeling capabilities (methods for handling time series are an obvious choice), and provide more advanced statistical methods (e.g. Bayes and machine learning tools). With increased familiarity these tools can become more broadly understood and more broadly used.</div></div><div><br /></div>",
  "link": [
    "",
    "",
    "",
    "",
    ""
  ],
  "author": {
    "name": "Kay Brodersen",
    "uri": "http://www.blogger.com/profile/15877220456041691465",
    "email": "noreply@blogger.com",
    "gd:image": ""
  },
  "media:thumbnail": "",
  "thr:total": 7
}