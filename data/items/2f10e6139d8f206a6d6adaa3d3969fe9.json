{
  "id": "tag:blogger.com,1999:blog-8474926331452026626.post-2594486859371625986",
  "published": "2022-10-20T09:58:00.010-07:00",
  "updated": "2022-10-21T09:42:42.455-07:00",
  "category": [
    "",
    "",
    ""
  ],
  "title": "MUSIQ: Assessing Image Aesthetic and Technical Quality with Multi-scale Transformers",
  "content": "<span class=\"byline-author\">Posted by Junjie Ke, Senior Software Engineer, and Feng Yang, Senior Staff Software Engineer, Google Research</span><img src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCIbYQlkOE0n8G7IFh_Uo4KhEafpAKdpnx9swpUA06IV4kFaqN2bTjd22zaSmhVUDmzpFOAqTH73AQNtXvffeaW3UZwlI54w427v7dsDsI8_8UQEvY198hGgTCu9f0upoDn33AYsq0fqUbwu12rwb9_FVzrSTTHNewaiJyMIpEDzMURKzFdzpZOubazQ/s637/MUSIQ.png\" style=\"display: none;\" /><p>Understanding the aesthetic and technical quality of images is important for providing a better user visual experience. <a href=\"https://en.wikipedia.org/wiki/Image_quality\">Image quality assessment</a> (IQA) uses models to build a bridge between an image and a user's subjective perception of its quality. In the deep learning era, many IQA approaches, such as <a href=\"https://ai.googleblog.com/2022/08/uvq-measuring-youtubes-perceptual-video.html\">NIMA</a>, have achieved success by leveraging the power of <a href=\"https://en.wikipedia.org/wiki/Convolutional_neural_network\">convolutional neural networks</a> (CNNs). However, CNN-based IQA models are often constrained by the fixed-size input requirement in batch training, i.e.,<em> </em>the input images need to be resized or cropped to a fixed size shape. This preprocessing is problematic for IQA because images can have very different aspect ratios and resolutions. Resizing and cropping can impact image composition or introduce distortions, thus changing the quality of the image.  </p><a name='more'></a><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8GOrjNuB2EyMjRI_LdmmVBHWSR1DCD06iyBk-8p870oUgMOYeybTiuHEFFn5POZHEhNxc9oqPiAgbzqJWM9a809dVxhmnuJFmtYfdrR8y6AKBBK3W0WRz7mCIQda12i8QMCOO2NtF0tJUBihIbMZI7hFehuprkRfGI_3l2ToVbSyeKoz8-r69yTrjeA/s1999/image1.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"511\" data-original-width=\"1999\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8GOrjNuB2EyMjRI_LdmmVBHWSR1DCD06iyBk-8p870oUgMOYeybTiuHEFFn5POZHEhNxc9oqPiAgbzqJWM9a809dVxhmnuJFmtYfdrR8y6AKBBK3W0WRz7mCIQda12i8QMCOO2NtF0tJUBihIbMZI7hFehuprkRfGI_3l2ToVbSyeKoz8-r69yTrjeA/s16000/image1.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">In CNN-based models, images need to be resized or cropped to a fixed shape for batch training. However, such preprocessing can alter the image aspect ratio and composition, thus impacting image quality. <a href=\"https://www.flickr.com/photos/ddebold/3052189192\">Original image</a> used under <a href=\"https://creativecommons.org/licenses/by/2.0/\">CC BY 2.0 license</a>.</td></tr></tbody></table><p>In “<a href=\"https://openaccess.thecvf.com/content/ICCV2021/papers/Ke_MUSIQ_Multi-Scale_Image_Quality_Transformer_ICCV_2021_paper.pdf\">MUSIQ: Multi-scale Image Quality Transformer</a>”, published at <a href=\"https://iccv2021.thecvf.com/home\">ICCV 2021</a>, we propose a patch-based multi-scale image quality <a href=\"https://ai.googleblog.com/2017/08/transformer-novel-neural-network.html\">transformer</a> (MUSIQ) to bypass the CNN constraints on fixed input size and predict the image quality effectively on native-resolution images. The MUSIQ model supports the processing of full-size image inputs with varying aspect ratios and resolutions and allows multi-scale feature extraction to capture image quality at different granularities. To support positional encoding in the multi-scale representation, we propose a novel hash-based 2D spatial embedding combined with an embedding that captures the image scaling. We apply MUSIQ on four large-scale IQA datasets, demonstrating consistent state-of-the-art results across three technical quality datasets (<a href=\"https://baidut.github.io/PaQ-2-PiQ/\">PaQ-2-PiQ</a>, <a href=\"http://database.mmsp-kn.de/koniq-10k-database.html\">KonIQ-10k</a>, and <a href=\"https://github.com/h4nwei/SPAQ\">SPAQ</a>) and comparable performance to that of state-of-the-art models on the aesthetic quality dataset <a href=\"http://refbase.cvc.uab.es/files/MMP2012a.pdf\">AVA</a>. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCIbYQlkOE0n8G7IFh_Uo4KhEafpAKdpnx9swpUA06IV4kFaqN2bTjd22zaSmhVUDmzpFOAqTH73AQNtXvffeaW3UZwlI54w427v7dsDsI8_8UQEvY198hGgTCu9f0upoDn33AYsq0fqUbwu12rwb9_FVzrSTTHNewaiJyMIpEDzMURKzFdzpZOubazQ/s637/MUSIQ.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"530\" data-original-width=\"637\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiCIbYQlkOE0n8G7IFh_Uo4KhEafpAKdpnx9swpUA06IV4kFaqN2bTjd22zaSmhVUDmzpFOAqTH73AQNtXvffeaW3UZwlI54w427v7dsDsI8_8UQEvY198hGgTCu9f0upoDn33AYsq0fqUbwu12rwb9_FVzrSTTHNewaiJyMIpEDzMURKzFdzpZOubazQ/s16000/MUSIQ.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">The patch-based MUSIQ model can process the full-size image and extract multi-scale features, which better aligns with a person’s typical visual response.</td></tr></tbody></table><p>In the following figure, we show a sample of images, their MUSIQ score, and their mean opinion score (MOS) from multiple human raters in the brackets. The range of the score is from 0 to 100, with 100 being the highest perceived quality. As we can see from the figure, MUSIQ predicts high scores for images with high aesthetic quality and high technical quality, and it predicts low scores for images that are not aesthetically pleasing (low aesthetic quality) or that contain visible distortions (low technical quality). </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody>  <tr>    <td rowspan=\"2\" style=\"text-align: left;\">High quality</td>    <td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgiztsZ31x6DTJz03BbHk3jlNbqutJWQIvbSInQYJuAQaMxVynSMlcaKzdRFOvR_6bWp1UujU-Rzx8qffWIArNT1hyTHrk136OkGF1XXPW2HYwNNVwNZrqaxZJDB-ScT9G1hD7xns8BYHxPFC0OORytBsPSAcvs5KH0S6YEkqp0N1TN6d6IR-y6VHTdqg/s1024/image10.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1024\" height=\"150\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgiztsZ31x6DTJz03BbHk3jlNbqutJWQIvbSInQYJuAQaMxVynSMlcaKzdRFOvR_6bWp1UujU-Rzx8qffWIArNT1hyTHrk136OkGF1XXPW2HYwNNVwNZrqaxZJDB-ScT9G1hD7xns8BYHxPFC0OORytBsPSAcvs5KH0S6YEkqp0N1TN6d6IR-y6VHTdqg/w200-h150/image10.png\" width=\"200\" /></a></td>    <td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgr0DKaAoO6qTrJo3hXP8UM3D4AB8gQeNI22Q2QphBVGgn-5v84tjhH3ZWTlGtlUoPdlcx54dM93Qi04MuN7eBbj9WlT8Qxy6B2Us4kcn_53FH28MnTtGCzMPhjCVGIgXRL8ZEMeO-7iue7sNEGxBtgx2bI-eKDQAondM8Dfjb1FaybFgUQji4UU9-0vQ/s1024/image9.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1024\" height=\"150\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgr0DKaAoO6qTrJo3hXP8UM3D4AB8gQeNI22Q2QphBVGgn-5v84tjhH3ZWTlGtlUoPdlcx54dM93Qi04MuN7eBbj9WlT8Qxy6B2Us4kcn_53FH28MnTtGCzMPhjCVGIgXRL8ZEMeO-7iue7sNEGxBtgx2bI-eKDQAondM8Dfjb1FaybFgUQji4UU9-0vQ/w200-h150/image9.png\" width=\"200\" /></a></td>  </tr>  <tr>    <td style=\"font-size: small; text-align: center;\">76.10 [74.36]</td>    <td style=\"font-size: small; text-align: center;\">69.29 [70.92]</td>  </tr>  <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>  <tr>    <td rowspan=\"2\" style=\"text-align: left;\">Low aesthetics quality</td>    <td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgAmXa-tOH5bOTKSqfUq0vPszEMxbCsC3dHhclyFaTwx5hvkBhc6uZzwRLcVDCPmP5KXN0PVt0hvIKrgpAaw1Qd1ujuBFL-gBAmM4BZJQ5fR3K-_ItIiUKz-UgEOAPMBeTEVbEQkKx8Zm8KKQjaGHWIE6LIXSQMM6tfGur89uUU7O8HURJF9QfYWU3h6Q/s1024/image5.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1024\" height=\"150\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgAmXa-tOH5bOTKSqfUq0vPszEMxbCsC3dHhclyFaTwx5hvkBhc6uZzwRLcVDCPmP5KXN0PVt0hvIKrgpAaw1Qd1ujuBFL-gBAmM4BZJQ5fR3K-_ItIiUKz-UgEOAPMBeTEVbEQkKx8Zm8KKQjaGHWIE6LIXSQMM6tfGur89uUU7O8HURJF9QfYWU3h6Q/w200-h150/image5.png\" width=\"200\" /></a></td>    <td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0-h8-32jlpKIrqt_HYtFEUX8PwZgmd1ig1_yUUpIRQOruypWk_AdywrmMPeISTGTxHfSy4WZy5xwQBCT6EweDT5jC4I9_48R2Aqs-x3-JvQM1lSPxmDfvjo6V8MuZjI3tAU4R9onsJQDSk4BoTSOeziNMN5A0N9trpq2PllpP3GiVW2pBQKyCb4kDqw/s1024/image11.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1024\" height=\"150\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh0-h8-32jlpKIrqt_HYtFEUX8PwZgmd1ig1_yUUpIRQOruypWk_AdywrmMPeISTGTxHfSy4WZy5xwQBCT6EweDT5jC4I9_48R2Aqs-x3-JvQM1lSPxmDfvjo6V8MuZjI3tAU4R9onsJQDSk4BoTSOeziNMN5A0N9trpq2PllpP3GiVW2pBQKyCb4kDqw/w200-h150/image11.png\" width=\"200\" /></a></td>  </tr>  <tr>    <td style=\"font-size: small; text-align: center;\">55.37 [53.18]</td>    <td style=\"font-size: small; text-align: center;\">32.50 [35.47]</td>  </tr>  <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>  <tr>    <td rowspan=\"2\" style=\"text-align: left;\">Low technical quality</td>    <td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiwCvrl2K6kVpYBy7SWwmTFfg7Xv09im0bnS_UYHF05O7IQTlFg5kktUF-LYCfklepbSKncood20CB6UroQhE8hpV_7xm1EKhKElTD5EOIOx8gL1psXQbdTsTe1HE43YBzBfhjMCDBe2NI7eq8fKrXJrw36QwmwoUQueQQp2IIVqWuWGKsBdi8ET57e5g/s1024/image2.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1024\" height=\"150\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiwCvrl2K6kVpYBy7SWwmTFfg7Xv09im0bnS_UYHF05O7IQTlFg5kktUF-LYCfklepbSKncood20CB6UroQhE8hpV_7xm1EKhKElTD5EOIOx8gL1psXQbdTsTe1HE43YBzBfhjMCDBe2NI7eq8fKrXJrw36QwmwoUQueQQp2IIVqWuWGKsBdi8ET57e5g/w200-h150/image2.png\" width=\"200\" /></a></td>    <td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh--6ooAFsWYmPRh9OlTO9mA8GE0yGoy_e-mIAe2MT1XVuFMNABUw3XE6npSoyfe0pN4QXEl4GHxs_RzBx-E8EK5ge3QUBi2ZLRrNjEsevYoIRQSLPmiJkR80GT1glU-DB7xwxrU7zAMfDXnNt7_-6fLNaKI_qfxn1foBdx8ZRMv_PeJDiTZbZ1DYp6Ow/s1024/image12.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"768\" data-original-width=\"1024\" height=\"150\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh--6ooAFsWYmPRh9OlTO9mA8GE0yGoy_e-mIAe2MT1XVuFMNABUw3XE6npSoyfe0pN4QXEl4GHxs_RzBx-E8EK5ge3QUBi2ZLRrNjEsevYoIRQSLPmiJkR80GT1glU-DB7xwxrU7zAMfDXnNt7_-6fLNaKI_qfxn1foBdx8ZRMv_PeJDiTZbZ1DYp6Ow/w200-h150/image12.png\" width=\"200\" /></a></td>  </tr>  <tr>    <td style=\"font-size: small; text-align: center;\">14.93 [14.38]</td>    <td style=\"font-size: small; text-align: center;\">15.24 [11.86]</td>  </tr></tbody></table><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody>  <tr><td class=\"tr-caption\" style=\"text-align: center;\">Predicted MUSIQ score (and ground truth) on images from the <a href=\"http://database.mmsp-kn.de/koniq-10k-database.html\">KonIQ-10k</a> dataset. <b>Top: </b>MUSIQ predicts high scores for high quality images. <b>Middle: </b>MUSIQ predicts low scores for images with low aesthetic quality, such as images with poor composition or lighting. <b>Bottom: </b>MUSIQ predicts low scores for images with low technical quality, such as images with visible distortion artifacts (e.g., blurry, noisy).</td></tr>  </tbody></table><h2>The Multi-scale Image Quality Transformer</h2><p>MUSIQ tackles the challenge of learning IQA on full-size images. Unlike CNN-models that are often constrained to fixed resolution, MUSIQ can handle inputs with arbitrary aspect ratios and resolutions. </p><p>To accomplish this, we first make a multi-scale representation of the input image, containing the native resolution image and its resized variants. To preserve the image composition, we maintain its aspect ratio during resizing. After obtaining the pyramid of images, we then partition the images at different scales into fixed-size patches that are fed into the model.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBa-dfw5Y5O_KldCjZw3c6XM2u96fM4Tr5CV21fpE2fzS-tibqIzRKb834UySVwXeoxu2Yn4RfQM40M8YJPpWWJOIiIwdnnH8RoXJB82RIESYNFYEACv2r1YCKyghVtl9WLW4qFrVKDzyvr25oQGhcfKiIC31Csf0izXpCFpQ2f0Ym2W-LRe4-KKs7vA/s1344/image3.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"708\" data-original-width=\"1344\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhBa-dfw5Y5O_KldCjZw3c6XM2u96fM4Tr5CV21fpE2fzS-tibqIzRKb834UySVwXeoxu2Yn4RfQM40M8YJPpWWJOIiIwdnnH8RoXJB82RIESYNFYEACv2r1YCKyghVtl9WLW4qFrVKDzyvr25oQGhcfKiIC31Csf0izXpCFpQ2f0Ym2W-LRe4-KKs7vA/s16000/image3.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">Illustration of the multi-scale image representation in MUSIQ.</td></tr></tbody></table><p>Since patches are from images of varying resolutions, we need to effectively encode the multi-aspect-ratio multi-scale input into a sequence of tokens, capturing both the pixel, spatial, and scale information. To achieve this, we design three encoding components in MUSIQ, including: 1) a patch encoding module to encode patches extracted from the multi-scale representation; 2) a novel hash-based spatial embedding module to encode the 2D spatial position for each patch; and 3) a learnable scale embedding to encode different scales. In this way, we can effectively encode the multi-scale input as a sequence of tokens, serving as the input to the Transformer encoder. </p><p>To predict the final image quality score, we use the standard approach of prepending an additional learnable “<a href=\"https://aclanthology.org/N19-1423/\">classification token</a>” (CLS). The CLS token state at the output of the Transformer encoder serves as the final image representation. We then add a fully connected layer on top to predict the IQS. The figure below provides an overview of the MUSIQ model. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhbR9OlJ3OqPoS9WsMVVIu4QQJBsM6ylGupmX0KKpQ0NulLa3IlH1u7hGwDY_EMZemhiC6nSE-5LQJeCRXDleG_Ko5NyAeRzoXqBBElywfhq1QoL8AXHTUTKnuVf_JjgR2phf-BOxEWR98Yx2_dRRbCJ8NIC3Z1mjfDPeYAu-vM7iHT6iSUZZyJvsm0jg/s1999/image7.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"1158\" data-original-width=\"1999\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhbR9OlJ3OqPoS9WsMVVIu4QQJBsM6ylGupmX0KKpQ0NulLa3IlH1u7hGwDY_EMZemhiC6nSE-5LQJeCRXDleG_Ko5NyAeRzoXqBBElywfhq1QoL8AXHTUTKnuVf_JjgR2phf-BOxEWR98Yx2_dRRbCJ8NIC3Z1mjfDPeYAu-vM7iHT6iSUZZyJvsm0jg/s16000/image7.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">Overview of MUSIQ. The multi-scale multi-resolution input will be encoded by three components: the scale embedding (SCE), the hash-based 2D spatial embedding (HSE), and the multi-scale patch embedding (MPE).</td></tr></tbody></table><p>Since MUSIQ only changes the input encoding, it is compatible with any Transformer variants. To demonstrate the effectiveness of the proposed method, in our experiments we use the classic Transformer with a relatively lightweight setting so that the model size is comparable to <a href=\"https://openaccess.thecvf.com/content_cvpr_2016/papers/He_Deep_Residual_Learning_CVPR_2016_paper.pdf\">ResNet-50</a>. </p><div style=\"line-height:40%;\">    <br></div><h2>Benchmark and Evaluation</h2><p>To evaluate MUSIQ, we run experiments on multiple large-scale IQA datasets. On each dataset, we report the <a href=\"https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient\">Spearman’s rank correlation coefficient</a> (SRCC) and <a href=\"https://en.wikipedia.org/wiki/Pearson_correlation_coefficient\">Pearson linear correlation coefficient</a> (PLCC) between our model prediction and the human evaluators’ mean opinion score. SRCC and PLCC are correlation metrics ranging from -1 to 1. Higher PLCC and SRCC means better alignment between model prediction and human evaluation. The graph below shows that MUSIQ outperforms other methods on <a href=\"https://baidut.github.io/PaQ-2-PiQ/\">PaQ-2-PiQ</a>, <a href=\"http://database.mmsp-kn.de/koniq-10k-database.html\">KonIQ-10k</a>, and <a href=\"https://github.com/h4nwei/SPAQ\">SPAQ</a>.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz8OWuZJCzDHkEJo8ezsscPcFNDKcp0cWulefa4S2P0P9UiH4BglcOfak5zdnUckxGTaiF5yI85vC1JIH4ZBLQN4UEp-4CK5RJJIoX2hXM97oQ6F1KH3tpdDa773RB8kT45UePSuiNHX6OxEr9lRLwYU8ROuHsVMHkMDYjQE7kHiXp6hmWG4gL02h2sg/s1192/image4.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"906\" data-original-width=\"1192\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhz8OWuZJCzDHkEJo8ezsscPcFNDKcp0cWulefa4S2P0P9UiH4BglcOfak5zdnUckxGTaiF5yI85vC1JIH4ZBLQN4UEp-4CK5RJJIoX2hXM97oQ6F1KH3tpdDa773RB8kT45UePSuiNHX6OxEr9lRLwYU8ROuHsVMHkMDYjQE7kHiXp6hmWG4gL02h2sg/s16000/image4.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">Performance comparison of MUSIQ and previous state-of-the-art (SOTA) methods on four large-scale IQA datasets. On each dataset we compare the Spearman’s rank correlation coefficient (SRCC) and Pearson linear correlation coefficient (PLCC) of model prediction and ground truth.</td></tr></tbody></table><p>Notably, the <a href=\"https://baidut.github.io/PaQ-2-PiQ/\">PaQ-2-PiQ</a> test set is entirely composed of large pictures having at least one dimension exceeding 640 pixels. This is very challenging for traditional deep learning approaches, which require resizing. MUSIQ can outperform previous methods by a large margin on the full-size test set, which verifies its robustness and effectiveness. </p><p>It is also worth mentioning that previous CNN-based methods often required sampling as many as 20 crops for each image during testing. This kind of multi-crop ensemble is a way to mitigate the fixed shape constraint in the CNN models. But since each crop is only a sub-view of the whole image, the ensemble is still an approximate approach. Moreover, CNN-based methods both add additional inference cost for every crop and, because they sample different crops, they can introduce randomness in the result. In contrast, because MUSIQ takes the full-size image as input, it can directly learn the best aggregation of information across the full image and it only needs to run the inference once. </p><p>To further verify that the MUSIQ model captures different information at different scales, we visualize the attention weights on each image at different scales.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_NxfcTrlUG2pHSP4KwPJnfykJuon-5yBH4irHlfDMv0lGYmGLK6VUnbXnUS2phWcnJ4QabsiNt_fV_AlJYJ3bGOPEPNFZjnxpPaxrjATVBj-PC-aIzr1rk5UcV5GsZgw7Mv85PPJdJYJJ3T1t9HqW22s1dPjitfaBLmZ2X124GOA91lP2PE-xWdJ4wg/s637/Attention.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"498\" data-original-width=\"637\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_NxfcTrlUG2pHSP4KwPJnfykJuon-5yBH4irHlfDMv0lGYmGLK6VUnbXnUS2phWcnJ4QabsiNt_fV_AlJYJ3bGOPEPNFZjnxpPaxrjATVBj-PC-aIzr1rk5UcV5GsZgw7Mv85PPJdJYJJ3T1t9HqW22s1dPjitfaBLmZ2X124GOA91lP2PE-xWdJ4wg/s16000/Attention.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">Attention visualization from the output tokens to the multi-scale representation, including the original resolution image and two proportionally resized images. Brighter areas indicate higher attention, which means that those areas are more important for the model output. Images for illustration are taken from the <a href=\"http://refbase.cvc.uab.es/files/MMP2012a.pdf\">AVA</a> dataset.</td></tr></tbody></table><p>We observe that MUSIQ tends to focus on more detailed areas in the full, high-resolution images and on more global areas on the resized ones. For example, for the flower photo above, the model’s attention on the original image is focusing on the pedal details, and the attention shifts to the buds at lower resolutions. This shows that the model learns to capture image quality at different granularities. </p><div style=\"line-height:40%;\">    <br></div><h2>Conclusion</h2><p>We propose a multi-scale image quality transformer (MUSIQ), which can handle full-size image input with varying resolutions and aspect ratios. By transforming the input image to a multi-scale representation with both global and local views, the model can capture the image quality at different granularities. Although MUSIQ is designed for IQA, it can be applied to other scenarios where task labels are sensitive to image resolution and aspect ratio. The MUSIQ model and checkpoints are available at our <a href=\"https://github.com/google-research/google-research/tree/master/musiq\">GitHub repository</a>.<br /></p><div style=\"line-height:40%;\">    <br></div><h2>Acknowledgements</h2><p><em>This work is made possible through a collaboration spanning several teams across Google. We’d like to acknowledge contributions from Qifei Wang, Yilin Wang and Peyman Milanfar.</em></p>",
  "link": [
    "",
    "",
    "",
    "",
    ""
  ],
  "author": {
    "name": "Google AI",
    "uri": "http://www.blogger.com/profile/12098626514775266161",
    "email": "noreply@blogger.com",
    "gd:image": ""
  },
  "media:thumbnail": "",
  "thr:total": 0
}