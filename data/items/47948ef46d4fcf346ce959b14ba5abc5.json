{
  "title": "U.S. Open Data &#8212; Gathering and Understanding the Data from 2018 Shinnecock",
  "link": "https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/",
  "comments": "https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/#respond",
  "dc:creator": "Jack Schultz",
  "pubDate": "Fri, 15 Jun 2018 19:49:02 +0000",
  "category": [
    "Analysis",
    "General",
    "Machine Learning",
    "Python",
    "golf",
    "JSON",
    "matplotlib",
    "us open"
  ],
  "guid": "http://bigishdata.com/?p=1028",
  "description": "After losing in a playoff to make it out of the local qualifying for the 2018 US Open at Shinnecock, I&#8217;m stuck at my apartment watching everyone struggle, wondering how much I&#8217;d be struggling if I was there myself. Besides on &#8230; <a href=\"https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/\">Continue reading <span class=\"meta-nav\">&#8594;</span></a>",
  "content:encoded": "<p>After losing in a playoff to make it out of the local qualifying for the 2018 US Open at Shinnecock, I&#8217;m stuck at my apartment watching everyone struggle, wondering how much I&#8217;d be struggling if I was there myself.</p>\n<p>Besides on TV, <a href=\"http://www.usopen.com/course.html\">the US Open website</a> offers some other way to follow what players are doing. As shown here, they very generously give us information on everyone&#8217;s shots on different holes. We&#8217;re able to see where people hit the ball, on which shot, and what their resulting score was on the hole. For example, why in the world did Tony Finau, the currently second ranked longest hitter on tour, hit it short off the first tee, leave himself 230 yards to the hole where he makes bogey?</p>\n<div data-shortcode=\"caption\" id=\"attachment_1045\" style=\"width: 499px\" class=\"wp-caption alignnone\"><a href=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png\"><img loading=\"lazy\" aria-describedby=\"caption-attachment-1045\" data-attachment-id=\"1045\" data-permalink=\"https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/screen-shot-2018-06-15-at-2-12-03-pm/\" data-orig-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png\" data-orig-size=\"2600,1286\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"tony-finau-hole-1-tee\" data-image-description=\"\" data-image-caption=\"<p>Why didn&#8217;t Tony rip D?</p>\n\" data-medium-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=300\" data-large-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=584\" class=\" wp-image-1045\" src=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=489&#038;h=241\" alt=\"\" width=\"489\" height=\"241\" srcset=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=487&h=241 487w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=974&h=482 974w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=150&h=74 150w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=300&h=148 300w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-2-12-03-pm.png?w=768&h=380 768w\" sizes=\"(max-width: 489px) 100vw, 489px\" /></a><p id=\"caption-attachment-1045\" class=\"wp-caption-text\">Why didn&#8217;t Tony rip D?</p></div>\n<p>One of the cool things these images show is the groupings of all the shots on a hole, like the tee shots here. And when I see very specific and interactive data like we have here, I know it comes from somewhere that I&#8217;m able to see myself. So I figured I should grab that data and do some cluster analysis on different holes to see if there are certain spots that players like to hit it.</p>\n<p>Here, I&#8217;ll go through the data we have, what the values and the numbers mean, and also the code I wrote to eat up the data and display the graphs. Once I have this part going, I&#8217;ll be able to perform further analysis to most things that come to mind.</p>\n<p>Any questions, comments, concerns, trash talking, get in touch: <a href=\"https://twitter.com/jack_schultz\">twitter</a>, <a href=\"https://bigishdata.com/contact/\">contact</a>.</p>\n<h3>Current Posts</h3>\n<p><a href=\"https://bigishdata.com/2018/06/19/using-clustering-algorithms-to-analyze-golf-shots-from-the-u-s-open/\"><strong>Using Clustering Algorithms to Analyze Golf Shots</strong></a></p>\n<h3>Finding the data</h3>\n<p>First step was to search for where the data for the hole insights page was coming from. As always, open the dev tools, click on the network tab, and find what&#8217;s getting called with a pretty name.</p>\n<div data-shortcode=\"caption\" id=\"attachment_1039\" style=\"width: 427px\" class=\"wp-caption alignnone\"><a href=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png\"><img loading=\"lazy\" aria-describedby=\"caption-attachment-1039\" data-attachment-id=\"1039\" data-permalink=\"https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/screen-shot-2018-06-15-at-12-55-52-pm/\" data-orig-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png\" data-orig-size=\"1910,812\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"json\" data-image-description=\"\" data-image-caption=\"<p>Alert!</p>\n\" data-medium-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=300\" data-large-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=584\" class=\" wp-image-1039\" src=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=417&#038;h=178\" alt=\"\" width=\"417\" height=\"178\" srcset=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=417&h=178 417w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=834&h=356 834w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=150&h=64 150w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=300&h=128 300w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-12-55-52-pm.png?w=768&h=327 768w\" sizes=\"(max-width: 417px) 100vw, 417px\" /></a><p id=\"caption-attachment-1039\" class=\"wp-caption-text\">Alert!</p></div>\n<p>The file itself is quite dense and has all the information, which is really cool! It has IDs for all the players, all the shots they have on the hole, which include the starting distance from the flag and the ending distance to the flag.</p>\n<p>First off, we&#8217;re given a list of Ps, meaning an array of player information, like this:</p>\n<pre>...\n{u'FN': u'Justin', u'ID': u'33448', u'IsA': False, u'LN': u'Thomas', u'Nat': u'USA', u'SN': u'THOMAS'},\n{u'FN': u'Dustin', u'ID': u'30925', u'IsA': False, u'LN': u'Johnson', u'Nat': u'USA',u'SN': u'JOHNSON D'}\n{u'FN': u'Tiger', u'ID': u'08793', u'IsA': False, u'LN': u'Woods', u'Nat': u'USA', u'SN': u'WOODS'}\n...</pre>\n<p>It looks like we have first name, player&#8217;s ID, whether or not they&#8217;re an amateur, last name, nationality, scoreboard name. The important part of this information is the ID, where we&#8217;ll be able to match players to shots.</p>\n<p>Next, we&#8217;re given a few stats on the hole for the day:</p>\n<p><span id=\"more-1028\"></span></p>\n<pre>[{u'Avg': u'4.558',\nu'Bir': 20,\nu'Bog': 43,\nu'DBg': 28,\nu'Eag': 0,\nu'Fg': {u'X': 1417011.593, u'Y': 268520.819},\nu'HPs': [....],\nu'HY': 418,\nu'ID': 10,\nu'Par': 4,\nu'Prs': 65,\nu'Rnk': u'4',\nu'Te': {u'X': 1415802.808, u'Y': 268819.161}}]</pre>\n<p>Which match up nicely with what we&#8217;re shown on the image</p>\n<div data-shortcode=\"caption\" id=\"attachment_1041\" style=\"width: 263px\" class=\"wp-caption aligncenter\"><a href=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png\"><img loading=\"lazy\" aria-describedby=\"caption-attachment-1041\" data-attachment-id=\"1041\" data-permalink=\"https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/screen-shot-2018-06-15-at-1-55-56-pm/\" data-orig-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png\" data-orig-size=\"608,880\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"Hole stats\" data-image-description=\"\" data-image-caption=\"<p>Birdies, Pars, and Bogeys, oh my</p>\n\" data-medium-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=207\" data-large-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=584\" class=\" wp-image-1041\" src=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=253&#038;h=367\" alt=\"\" width=\"253\" height=\"367\" srcset=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=253&h=367 253w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=506&h=732 506w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=104&h=150 104w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-55-56-pm.png?w=207&h=300 207w\" sizes=\"(max-width: 253px) 100vw, 253px\" /></a><p id=\"caption-attachment-1041\" class=\"wp-caption-text\">Birdies, Pars, and Bogeys, oh my</p></div>\n<p><strong>Shots</strong></p>\n<p>See that <code>HP</code> tag above? That&#8217;s where the information on the shots players have hit are stored. Each shot in the JSON is listed like the following, which is Tiger&#8217;s tee shot on number 10.</p>\n<pre>{u'DTP': 5937.3, u'Dis': 9047.1, u'IsIn': False, u'No': 1, u'X': 1416521.955, u'Y': 268593.013, u'ZID': 20}</pre>\n<p>Going through acronyms again, we have distance to pin, distance of shot itself, is the shot in the hole, X coordinate, Y coordinate, ZID which I don&#8217;t know what that means.</p>\n<p>The first step for me was to go through and make sure I understand what those coordinates mean. To do this, I took a little time to try to match up the X and Y coordinates of the shot ending points, and where they tell us the flag is located.</p>\n<p>In order to calculate the distance of the tee shot, or rather, the location of the flag, we&#8217;re going to do some math using the Pythagorean Theorem!</p>\n<pre>import math\ndtp = 5937.3 #distance to pin after shot\n\nfgx = 1417011.593 # flag's x position\nfgy = 268520.819  # flag's y position\ntsx = 1416521.955 # tee shot's x position\ntsy = 268593.013  # tee shot's y position\ndist = math.hypot(fgy - tsy, fgx - tsx)\nprint dist / 3.0\nprint dtp / 36.0\n\n>>> import math\n>>> dtp = 5937.3 #distance to pin after shot\n>>>\n>>> fgx = 1417011.593 # flag's x position\n>>> fgy = 268520.819 # flag's y position\n>>> tsx = 1416521.955 # tee shot's x position\n>>> tsy = 268593.013 # tee shot's y position\n>>> dist = math.hypot(fgy - tsy, fgx - tsx)\n>>> print dist / 3.0 # apparently dist is in feet\n164.977218858\n>>> print dtp / 36.0 # and then the dtp is in inches. Why? I dunno\n164.925</pre>\n<p>Neato, the math checks out. In terms of clustering though, it doesn&#8217;t make much of a difference other than knowing that we have correct data.</p>\n<h3>Cleaning and formatting</h3>\n<p>I keep saying that the main part of data work is gathering and formatting and cleaning the data before throwing the variables into a function that&#8217;s already been written. And that&#8217;s the case here too. The goal is to have an array of [x, y] coordinates for the result of the tee shot.</p>\n<pre>with open('1_10.json') as f:\n  data = json.load(f)\n\nfg = data['Rs'][0]['Hs'][0]['Fg']\nprint fg # {u'Y': 268520.819, u'X': 1417011.593}\nfgx = fg['X']\nfgy = fg['Y']\n\nlocs = []\nhps = data['Rs'][0]['Hs'][0]['HPs']\nfor hp in hps:\n  sk = hp['Sks'][1]\n  print sk # {u'No': 2, u'ZID': 1, u'X': 1417095.696, u'Y': 268519.862, u'IsIn': False, u'DTP': 1008.3, u'Dis': 3592.9}\n  skx = sk['X']\n  sky = sk['Y']\n  diff_x = fgx - skx\n  diff_x = skx - fgx\n  diff_y = fgy - sky\n  locs.append([diff_y, diff_x])\n\nprint np.array(locs)\n'''\n[[ -3.167 -214.564]\n[ -25.146 -247.396]\n[ -37.92 -252.717]\n[ -33.195 -281.108]\n[ -71.133 -464.982]\n....\n[ -49.785 -318.032]\n[-218.516 -416.785]\n[ -2.429 -210.111]\n[ -18.842 -234.01 ]\n[ -43.724 -351.278]\n[ -61.787 -361.844]]\n'''</pre>\n<p>Clean looking code, and gets us the differences we&#8217;re looking for.</p>\n<h3>Scikit-Learn Cluster Algorithms</h3>\n<p>I&#8217;ll go a little further than only understanding the data, and also show the code that I use to find the clusters of the data.</p>\n<p>To do this, we take that <code>locs</code> array and throw it into the sklearn algorithms.</p>\n<pre>from sklearn import cluster\n\nnum_clusters = 4\n\n## DB Scan\ncore_samples, dbs_labels = cluster.dbscan(locs, eps=50)\n\n##K Means\ncentroid, km_labels, inertia = cluster.k_means(locs, n_clusters=num_clusters)\n\n## Aglomerative Clustering\nac = cluster.AgglomerativeClustering(n_clusters=num_clusters).fit(locs)\nac_labels = ac.labels_\n\n## Affinity Propagation\nap = cluster.AffinityPropagation(preference=-45000).fit(locs)\nap_labels = ap.labels_\n\n## Birch\nbirch = cluster.Birch(n_clusters=num_clusters).fit(locs)\nbirch_labels = birch.labels_\n\n## Spectral Clustering\nspectral = cluster.SpectralClustering(n_clusters=num_clusters, eigen_solver='arpack', affinity=\"nearest_neighbors\").fit(locs)\ns_labels = spectral.labels_</pre>\n<p>Now that&#8217;s super easy. The resulting <code>x_label</code> variables are arrays of the same length as the <code>locs</code> variable, meaning 156 since there are 156 players. The number at each location in the array is what group the shot belongs to. So for example, if we&#8217;re using the K Means algorithm with 3 groupings, the array has values of 0, 1, and 2, like the following:</p>\n<pre>>>> print km_labels\n[1 1 1 1 0 1 1 1 1 1 1 1 1 1 2 2 0 1 1 1 1 2 0 1 2 1 1 1 1 2 0 1 1 1 1 1 2\n1 1 1 1 2 1 1 0 2 2 1 0 2 0 1 1 1 1 1 1 0 1 2 1 1 1 1 2 1 0 0 1 2 0 1 1 0\n1 1 0 1 1 1 1 2 2 1 1 1 1 2 1 0 1 1 1 1 1 1 1 0 1 1 2 1 2 1 1 1 1 1 1 1 1\n1 1 1 0 2 2 1 1 1 1 0 1 1 2 2 1 0 2 1 0 1 0 2 2 2 1 1 2 1 1 1 1 1 1 1 1 2\n2 1 1 2 1 1 1 1]</pre>\n<h3>Graph time</h3>\n<p>The code that I&#8217;ll use to show the resulting clusters is the following.</p>\n<pre>num_found_clusters = set(plotting_labels) #plotting labels is any one of the x_labels variables above\n\ncolors = cycle('bgrcmykbgrcmyk')\nfor k, color in zip(num_found_clusters, colors):\n  class_members = plotting_labels == k\n\n  group_locs = [x for x, y in zip(locs, class_members) if y]\n\n  xs = [val[0] for val in group_locs]\n  ys = [val[1] for val in group_locs]\n\n  plt.plot(xs, ys, color + 'o') #dotted points, which is where the 'o' comes in\n\nplt.show()</pre>\n<p>I&#8217;m going to hide the cluster results until part two which will have the pretty pictures, but now I&#8217;ll show a graph that just lists the points.</p>\n<p>To do this, all I&#8217;m going to do is set <code>num_clusters = 1</code> and <code>plotting_labels = km_labels</code>, then it&#8217;ll spit out a graph with no heading, no x or y labels, and a bunch of blue dotted dots.</p>\n<div data-shortcode=\"caption\" id=\"attachment_1037\" style=\"width: 388px\" class=\"wp-caption aligncenter\"><a href=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png\"><img loading=\"lazy\" aria-describedby=\"caption-attachment-1037\" data-attachment-id=\"1037\" data-permalink=\"https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/screen-shot-2018-06-15-at-1-29-44-pm/\" data-orig-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png\" data-orig-size=\"1278,956\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"Blue dotted dots\" data-image-description=\"\" data-image-caption=\"<p>Blue dotted dots</p>\n\" data-medium-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=300\" data-large-file=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=584\" class=\" wp-image-1037\" src=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=378&#038;h=282\" alt=\"\" width=\"378\" height=\"282\" srcset=\"https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=378&h=282 378w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=754&h=564 754w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=150&h=112 150w, https://bigishdata.files.wordpress.com/2018/06/screen-shot-2018-06-15-at-1-29-44-pm.png?w=300&h=224 300w\" sizes=\"(max-width: 378px) 100vw, 378px\" /></a><p id=\"caption-attachment-1037\" class=\"wp-caption-text\">Blue dotted dots</p></div>\n<p>Do you see some clusters?? I do, and now we want to see how those algorithms above find them. Look for more posts to come using this data.</p>\n",
  "wfw:commentRss": "https://bigishdata.com/2018/06/15/us-open-clustering-part-1-gathering-and-understanding-the-data/feed/",
  "slash:comments": 0,
  "media:content": [
    {
      "media:title": "jackschultz23"
    },
    "",
    "",
    "",
    ""
  ]
}