{
  "id": "tag:blogger.com,1999:blog-15045980.post-2097440038165971468",
  "published": "2019-07-08T11:17:00.002-07:00",
  "updated": "2019-07-10T16:37:26.961-07:00",
  "title": "Truth 1.0: Fluent Assertions for Java and Android Tests",
  "content": "By&nbsp;Chris Povirk, Java Core Libraries<br /><br /><i>(originally posted to the <a href=\"https://opensource.googleblog.com/2019/07/truth-10-fluent-assertions-for-java-and.html\">Google Open Source Blog</a>)</i><br /><br />Software testing is importantâ€”and sometimes frustrating. The frustration can come from working on innately hard domains, like concurrency, but too often it comes from a thousand small cuts:<br /><div><br /></div><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #e0e0e0; vertical-align: top; width: 607px;\"><pre style=\"background-color: #e0e0e0; border: 0px; color: black; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">assertEquals(\"<span style=\"color: #0f9d58;\">Message has been sent</span>\", getString(notification, EXTRA_BIG_TEXT));<br />assertTrue(<br />    getString(notification, EXTRA_TEXT)<br />        .contains(<span style=\"color: #0f9d58;\">\"Kurt Kluever &lt;kak@google.com&gt;\"</span>));</span></pre></td></tr></tbody></table></div><br /><br />The two assertions above test <i>almost</i> the same thing, but they are structured differently. The difference in <i>structure</i> makes it hard to identify the difference in <i>what's being tested</i>.<br /><div><br /></div><div><div>A better way to structure these assertions is to use a <a href=\"https://en.wikipedia.org/wiki/Fluent_interface\">fluent API</a>:</div></div><div><br /></div><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #e0e0e0; vertical-align: top; width: 607px;\"><pre style=\"background-color: #e0e0e0; border: 0px; color: black; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">assertThat(getString(notification, EXTRA_BIG_TEXT))<br />    .isEqualTo(<span style=\"color: #0f9d58;\">\"Message has been sent\"</span>);<br />assertThat(getString(notification, EXTRA_TEXT))<br />    .contains(<span style=\"color: #0f9d58;\">\"Kurt Kluever &lt;kak@google.com&gt;\"</span>);</span></pre></td></tr></tbody></table></div><br /><br />A fluent API naturally leads to other advantages:<br /><ul><li>IDE autocompletion can suggest assertions that fit the value under test, including rich operations like <span style=\"color: #0f9d58; font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">containsExactly(permission.SEND_SMS, permission.READ_SMS)</span>.</li><li>Failure messages can include the value under test and the expected result. Contrast this with the <span style=\"color: #0f9d58; font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">assertTrue</span> call above, which lacks a failure message entirely.</li></ul><div>Google's fluent assertion library for Java and Android is <a href=\"https://truth.dev/\">Truth</a>. We're happy to announce that we've released <a href=\"https://github.com/google/truth/releases/tag/release_1_0\">Truth 1.0</a>, which stabilizes our API after years of fine-tuning.<br /><br /><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://1.bp.blogspot.com/-NcR5HB_0vqg/XRzbaysmsyI/AAAAAAAAAV8/4xl4AEl6_yIKYnH1_ZLNHsa8dSaxizDmQCLcBGAs/s1600/image1.png\" imageanchor=\"1\" style=\"margin-left: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"661\" data-original-width=\"813\" height=\"520\" src=\"https://1.bp.blogspot.com/-NcR5HB_0vqg/XRzbaysmsyI/AAAAAAAAAV8/4xl4AEl6_yIKYnH1_ZLNHsa8dSaxizDmQCLcBGAs/s640/image1.png\" width=\"640\" /></a></div><br /><br />Truth started in 2011 as a Googler's personal open source project. Later, it was donated back to Google and cultivated by the Java Core Libraries team, the people who bring you <a href=\"https://github.com/google/guava\">Guava</a>.<br /><div><br /></div><div><div>You might already be familiar with assertion libraries like <a href=\"https://github.com/hamcrest/JavaHamcrest\">Hamcrest</a> and <a href=\"https://joel-costigliola.github.io/assertj/\">AssertJ</a>, which provide similar features. We've designed Truth to have a simpler API and more readable failure messages. For example, here's a failure message from AssertJ:</div></div><div><br /></div></div><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #e0e0e0; vertical-align: top; width: 607px;\"><pre style=\"background-color: #e0e0e0; border: 0px; color: black; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">java.lang.AssertionError:<br />Expecting:<br />  &lt;[year: 2019<br />month: 7<br />day: 15<br />]&gt;<br />to contain exactly in any order:<br />  &lt;[year: 2019<br />month: 6<br />day: 30<br />]&gt;<br />elements not found:<br />  &lt;[year: 2019<br />month: 6<br />day: 30<br />]&gt;<br />and elements not expected:<br />  &lt;[year: 2019<br />month: 7<br />day: 15<br />]&gt;</span></pre></td></tr></tbody></table></div><div style=\"overflow-x: auto;\"><br /><br />And here's the equivalent message from Truth:<br /><div><br /></div></div><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #e0e0e0; vertical-align: top; width: 607px;\"><pre style=\"background-color: #e0e0e0; border: 0px; color: black; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">value of:<br />    iterable.onlyElement()<br />expected:<br />    year: 2019<br />    month: 6<br />    day: 30<br /><br />but was:<br />    year: 2019<br />    month: 7<br />    day: 15<br /></span></pre></td></tr></tbody></table></div><div style=\"overflow-x: auto;\"><br /><br /></div><div style=\"overflow-x: auto;\"><div style=\"overflow-x: auto;\">For more details, read our <a href=\"https://truth.dev/comparison\">comparison of the libraries</a>, and <a href=\"https://truth.dev/#how-to-use-truth\">try Truth</a> for yourself.</div><div><br /></div><div>Also, if you're developing for Android, try <a href=\"https://developer.android.com/training/testing/fundamentals#assertions\">AndroidX Test</a>. It includes Truth <a href=\"https://truth.dev/extension\">extensions</a> that make assertions even easier to write and failure messages even clearer:</div><div><br /></div><div><br /></div></div><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #e0e0e0; vertical-align: top; width: 607px;\"><pre style=\"background-color: #e0e0e0; border: 0px; color: black; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">assertThat(notification).extras().<span style=\"color: #9c27b0;\">string</span>(EXTRA_BIG_TEXT)<br />    .isEqualTo(<span style=\"color: #0f9d58;\">\"Message has been sent\"</span>);<br />assertThat(notification).extras().<span style=\"color: #9c27b0;\">string</span>(EXTRA_TEXT)<br />    .contains(<span style=\"color: #0f9d58;\">\"Kurt Kluever &lt;kak@google.com&gt;\"</span>);</span></pre></td></tr></tbody></table></div><div style=\"overflow-x: auto;\"><br /></div><div style=\"overflow-x: auto;\"><br />Coming soon: Kotlin users of Truth can look forward to <a href=\"https://github.com/google/truth/issues/572\">Kotlin-specific</a> <a href=\"https://github.com/google/truth/issues/536\">enhancements</a>.</div><div style=\"overflow-x: auto;\"><br /></div>",
  "link": [
    "",
    "",
    "",
    "",
    ""
  ],
  "author": {
    "name": "Google Testing Bloggers",
    "uri": "http://www.blogger.com/profile/03153388556673050910",
    "email": "noreply@blogger.com",
    "gd:image": ""
  },
  "media:thumbnail": "",
  "thr:total": 0
}