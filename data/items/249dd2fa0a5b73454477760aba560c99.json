{
  "title": "Physics-based proof of the duality theorem for linear programs",
  "link": "",
  "published": "2021-02-14T09:24:00-08:00",
  "updated": "2021-02-14T09:24:00-08:00",
  "author": {
    "name": "Jonathan Landy"
  },
  "id": "tag:efavdb.com,2021-02-14:/duality",
  "summary": "<p>Textbook proofs of the duality theorem often apply abstract arguments that\noffer little tangible insight into the relationship between a linear program\nand its dual. Here, we map the general linear program onto a simple mechanics\nproblem. In this context, the significance of the theorem is relatively&nbsp;clear.</p>\n<h4>The general …</h4>",
  "content": "<p>Textbook proofs of the duality theorem often apply abstract arguments that\noffer little tangible insight into the relationship between a linear program\nand its dual. Here, we map the general linear program onto a simple mechanics\nproblem. In this context, the significance of the theorem is relatively&nbsp;clear.</p>\n<h4>The general linear program and its&nbsp;dual</h4>\n<p>The goal of a linear program is to optimize a linear objective function subject\nto some linear constraints.  By introducing slack and other auxiliary\nvariables, the general linear program can be expressed as&nbsp;[1]\n</p>\n<div class=\"math\">\\begin{eqnarray}  \\tag{1} \\label{primal}\n\\text{max}_{\\textbf{x} \\in \\mathbb{R}_n}  \\textbf{c}^T \\cdot \\textbf{x},\n\\text{subject to: } A \\cdot \\textbf{x} \\leq  \\textbf{b}.\n\\end{eqnarray}</div>\n<p>Here, the optimization is over <span class=\"math\">\\(\\textbf{x} \\in \\mathbb{R}_n\\)</span>, <span class=\"math\">\\(A\\)</span> is a given <span class=\"math\">\\(m\n\\times n\\)</span> real matrix, <span class=\"math\">\\(\\textbf{b}\\)</span> and <span class=\"math\">\\(\\textbf{c}\\)</span> are given real vectors,\nand the inequality holds component-wise.  Any <span class=\"math\">\\(\\textbf{x}\\)</span> that satisfies the\ninequality constraints above is called a <em>feasible solution</em> to\n(\\ref{primal}) and if a point can be found with finite components that\noptimizes the objective it is called an <em>optimal solution</em>.  Associated\nwith (\\ref{primal}) is the dual linear&nbsp;program,\n</p>\n<div class=\"math\">\\begin{eqnarray} \\label{dual} \\tag{2}\n\\text{min}_{\\textbf{w} \\in \\mathbb{R}_m} \\textbf{b}^T \\cdot \\textbf{w} ,\n\\text{subject to: } A^T \\cdot \\textbf{w} = \\textbf{c}, \\textbf{w} \\geq\n\\textbf{0}.  \\end{eqnarray}</div>\n<p>\nThe optimization here is over <span class=\"math\">\\(\\textbf{w} \\in \\mathbb{R}_m\\)</span>, and <span class=\"math\">\\(A\\)</span>,\n<span class=\"math\">\\(\\textbf{b}\\)</span>, and <span class=\"math\">\\(\\textbf{c}\\)</span> are the same variables present in\n(\\ref{primal}).  In this post, we apply some simple ideas from classical\nmechanics to prove the following theorem, one of the central results connecting\nthe two linear programs&nbsp;above:</p>\n<h5>Duality&nbsp;theorem</h5>\n<p>If  (\\ref{primal}) has an optimal solution at <span class=\"math\">\\(\\textbf{x}^*\\)</span>, then (\\ref{dual})\nwill also have an optimal solution at some point <span class=\"math\">\\(\\textbf{w}^*\\)</span>, and these\npoints&nbsp;satisfy\n</p>\n<div class=\"math\">\\begin{eqnarray}\\label{strong_law} \\tag{3}\n\\textbf{c}^T \\cdot \\textbf{x}^*= \\textbf{b}^T \\cdot \\textbf{w}^*.\n\\end{eqnarray}</div>\n<p>\nThat is, the optimal objectives of (\\ref{primal}) and (\\ref{dual})&nbsp;agree.</p>\n<h5><em>Proof:</em></h5>\n<p>To begin we assume that  <span class=\"math\">\\(\\textbf{x}^*\\)</span>  is an optimal solution to\n(\\ref{primal}).  We also assume for simplicity that (i) we have chosen a\ncoordinate system so that <span class=\"math\">\\(\\textbf{x} =  \\textbf{0}\\)</span> is a feasible solution of\n(\\ref{primal}) and that (ii) each row <span class=\"math\">\\(\\hat{\\textbf{A}}_i\\)</span> of <span class=\"math\">\\(A\\)</span> has been\nnormalized to unit&nbsp;length. </p>\n<p>Next, we introduce a physical system relevant to (\\ref{primal}) and\n(\\ref{dual}):  We consider a mobile point particle that interacts with a set of\n<span class=\"math\">\\(m\\)</span> fixed walls, all sitting in <span class=\"math\">\\(\\mathbb{R}_n\\)</span>.   The particle&#8217;s coordinate\n<span class=\"math\">\\(\\textbf{x}_p\\)</span> is initially set to <span class=\"math\">\\(\\textbf{x}_p = \\textbf{0}\\)</span>.  The fixed\n<span class=\"math\">\\(i\\)</span>-th wall sits at those points <span class=\"math\">\\(\\textbf{x}\\)</span> that satisfy <span class=\"math\">\\(\\hat{\\textbf{A}}_i\n\\cdot \\textbf{x} = b_i\\)</span>.   We take the force on the particle from wall <span class=\"math\">\\(i\\)</span> to\nhave two parts:  (i) a constant, long range force, <span class=\"math\">\\(w_i \\hat{\\textbf{A}}_i\\)</span>,\nnormal to the wall, and (ii)  a  &#8220;hard core&#8221; force, <span class=\"math\">\\(-n_i(\\textbf{x}_p)\n\\hat{\\textbf{A}}_i\\)</span>, also normal to the wall.  The hard core force makes the\nwall impenetrable to the particle, but otherwise allows the particle to move\nfreely:   Its magnitude is zero when the particle does not touch the wall, but\non contact it scales up to whatever value is needed to prevent the particle\nfrom passing through&nbsp;it.</p>\n<p>To relate the physical system to our linear programs, we&#8217;ll require\n<span class=\"math\">\\(\\textbf{x}_p\\)</span> to be a feasible solution to (\\ref{primal}) and the vector of\nlong range force magnitudes <span class=\"math\">\\(\\textbf{w}\\)</span> to be a feasible solution to\n(\\ref{dual}).  A point <span class=\"math\">\\(\\textbf{x}_p\\)</span> is a feasible solution to (\\ref{primal})\nif and only if the particle is within the interior space bounded by the set of\nwalls.  Further, the equality constraint of (\\ref{dual}) is equivalent to the\ncondition that all feasible <span class=\"math\">\\(\\textbf{w}\\)</span> result in a total long range force\nacting on the particle of <span class=\"math\">\\(\\sum_i  w_i \\hat{\\textbf{A}}_i = \\textbf{c}\\)</span>.   The\nnon-negativity condition on feasible <span class=\"math\">\\(\\textbf{w}\\)</span> vectors in (\\ref{dual})\nfurther requires that the long range forces each be either attractive or zero.\nA simple example of the sort of physical system we&#8217;ve described here is shown\nin Fig.&nbsp;1a.</p>\n<hr>\n<p><figure class=\"image\">\n  <img src=\"images/duality.png\">\n</figure>\n<b>Fig. 1:</b> An example system:  (a) A particle at <span class=\"math\">\\(\\textbf{x}_p=\\textbf{0}\\)</span>\ninteracts with three walls.  The total long range force on the particle is\n<span class=\"math\">\\(\\sum_i w_i \\hat{\\textbf{A}}_i = \\textbf{c}\\)</span>. (b) The particle sits at its long\nrange potential minimum, <span class=\"math\">\\(\\textbf{x}^*\\)</span>, with walls <span class=\"math\">\\(2\\)</span> and <span class=\"math\">\\(3\\)</span> <span class=\"dquo\">&#8220;</span>binding&#8221;.\nThe hard core normal forces from these walls must point inward and sum to\n<span class=\"math\">\\(-\\textbf{c}\\)</span> &#8212; otherwise, there would be a net force on the particle, and it\nwould continue to move, but that won&#8217;t happen once it sits at its potential\nminimum.  Wall <span class=\"math\">\\(1\\)</span> is not binding and is now a distance <span class=\"math\">\\(d_1(\\textbf{x}^*)\\)</span>\naway from the particle.  This results in a positive difference between the dual\nand primal objectives (\\ref{gap}), unless we can find a feasible <span class=\"math\">\\(\\textbf{w}\\)</span>\nfor which <span class=\"math\">\\(w_1=0\\)</span>.  Setting <span class=\"math\">\\(\\textbf{w}^* = \\textbf{n}(\\textbf{x}^*)\\)</span> &#8212;  the\nvector of hard-core normal force magnitudes at <span class=\"math\">\\(\\textbf{x}^*\\)</span> &#8212; provides such\na solution.  This is non-negative, zero for non-binding walls, and results in a\ntotal long range force of <span class=\"math\">\\(\\textbf{c}\\)</span> &#8212; a consequence of the point above that\nthe particle must remain at rest at its potential minimum.  This choice for\n<span class=\"math\">\\(\\textbf{w}\\)</span> optimizes (\\ref{dual}) and gives an objective matching that of\n(\\ref{primal}) at\n<span class=\"math\">\\(\\textbf{x}^*\\)</span>.</p>\n<hr>\n<p>When we assert the conditions above, the potential associated with the long\nrange forces in our physical system ends up being related to the objective\nfunctions of (\\ref{primal}) and (\\ref{dual}).  Up to a constant, the potential\nof a force <span class=\"math\">\\(\\textbf{f}(\\textbf{x})\\)</span> is defined to be&nbsp;[2] \n</p>\n<div class=\"math\">\\begin{eqnarray}\\label{potential} \\tag{4}\nU(\\textbf{x}) \\equiv -\\int \\textbf{f}(\\textbf{x}) \\cdot d\\textbf{x}\n\\end{eqnarray}</div>\n<p>\nIn our case, the long range force between the wall <span class=\"math\">\\(i\\)</span> and the particle is a\nconstant and normal to the wall.  Its potential is therefore&nbsp;simply\n</p>\n<div class=\"math\">\\begin{eqnarray}\\label{potential_i} \\tag{5}\nU_i(\\textbf{x}_p) = w_i d_i(\\textbf{x}_p),\n\\end{eqnarray}</div>\n<p>\nwhere \n</p>\n<div class=\"math\">\\begin{eqnarray}\\label{perp_distance} \\tag{6}\nd_{i}(\\textbf{x}_p)  \\equiv b_i - \\hat{\\textbf{A}}_i \\cdot \\textbf{x}_p.\n\\end{eqnarray}</div>\n<p>\n This is the perpendicular distance between the particle and the wall <span class=\"math\">\\(i\\)</span>.  The\nphysical significance of (\\ref{potential_i}) is that it is the total energy it\ntakes to separate the particle from wall <span class=\"math\">\\(i\\)</span> by a distance <span class=\"math\">\\(d_i\\)</span>, working\nagainst the attractive force <span class=\"math\">\\(w_i\\)</span>.  Notice that if we plug\n(\\ref{perp_distance}) into (\\ref{potential_i}), the total long range potential\nat <span class=\"math\">\\(\\textbf{x}_p\\)</span> can be written&nbsp;as\n</p>\n<div class=\"math\">\\begin{eqnarray}\\nonumber\n\\sum_i w_i d_i(\\textbf{x}_p)&amp;=&amp; \\sum_i w_i  \\left (b_i - \\hat{\\textbf{A}}_i\n\\cdot \\textbf{x}_p  \\right) \n\\\\ &amp;=&amp; \\textbf{w}^T \\cdot \\textbf{b} - \\textbf{c} \\cdot \\textbf{x}_p. \\tag{7}\n \\label{potential_as_objective_difference}\n\\end{eqnarray}</div>\n<p>\nHere, we have used one of the feasibility conditions on <span class=\"math\">\\(\\textbf{w}\\)</span> to get the\nlast line.   The right side of (\\ref{potential_as_objective_difference}) is the\ndifference between the dual and primal objectives.  This will be minimized at\nthe feasible point <span class=\"math\">\\(\\textbf{x}_p\\)</span> that maximizes <span class=\"math\">\\(\\textbf{c}\\cdot \\textbf{x}_p\\)</span>\n&#8212; the primal objective &#8212; and at that feasible <span class=\"math\">\\(\\textbf{w}\\)</span> that minimizes\n<span class=\"math\">\\(\\textbf{w}^T \\cdot \\textbf{b}\\)</span> &#8212; the dual objective.  In other words, we see\nthat both our programs independently contribute to the common goal of\nminimizing the particle&#8217;s long range potential,\n(\\ref{potential_as_objective_difference}), subject to our system&#8217;s&nbsp;constraints.</p>\n<p>The last preperatory remark we must make relates to the fact that we have\nassumed that <span class=\"math\">\\(\\textbf{x}^*\\)</span> is an optimal solution to (\\ref{primal}) &#8212; i.e.,\nit is a point that is as far &#8220;down&#8221; in the <span class=\"math\">\\(\\textbf{c}\\)</span> direction as possible\nwithin the feasible set.  This must mean that <span class=\"math\">\\(\\textbf{x}^*\\)</span> sits somewhere at\nthe boundary of the primal feasible set, with some of the constraints of\n(\\ref{primal}) binding &#8212; i.e., satisfied as equalities.  Further, if we place\nand release the particle gently at <span class=\"math\">\\(\\textbf{x}^*\\)</span>, it must stay at rest as it\ncan fall no further &#8212; just as a particle acted on by gravity stays at rest\nwhen it is placed in the bottom of a bucket. To stay at rest, there must be no\nnet force on the particle, which means that the hard core normal forces <span class=\"math\">\\(-n_i\n\\hat{\\textbf{A}}_i\\)</span> from the binding walls at <span class=\"math\">\\(\\textbf{x}^*\\)</span>  must sum to\nexactly <span class=\"math\">\\(-\\textbf{c}\\)</span>, fully countering the constant long range force.   The\nset of forces acting on the particle at <span class=\"math\">\\(\\textbf{x}^*\\)</span> is illustrated Fig. 1b\nfor our simple&nbsp;example.</p>\n<p>To complete the argument, we note that the long range potential at\n<span class=\"math\">\\(\\textbf{x}^*\\)</span> is given from (\\ref{potential_as_objective_difference})&nbsp;by\n</p>\n<div class=\"math\">\\begin{eqnarray} \\label{gap} \\tag{8} \n\\sum_i w_i d_i(\\textbf{x}^*) &amp;=&amp; \\textbf{w}^T \\cdot \\textbf{b} - \\textbf{c}\n\\cdot \\textbf{x}^*.\n\\end{eqnarray}</div>\n<p>\nThis is non-negative because  <span class=\"math\">\\(\\textbf{w} \\geq \\textbf{0}\\)</span> and\n<span class=\"math\">\\(d_i(\\textbf{x}^*) &gt;0\\)</span> for each non-binding wall.   It follows that the dual\nobjective is always bounded from below by the optimal primal objective.\nFurther, the gap between the two &#8212; the left side of (\\ref{gap}) &#8212; can only be\nzero if the long range interaction strengths are zero for each non-binding wall\nat <span class=\"math\">\\(\\textbf{x}^*\\)</span> &#8212; i.e., if the particle is not actually attracted to the\nwalls that are not binding at <span class=\"math\">\\(\\textbf{x}^*\\)</span>.   The vector\n<span class=\"math\">\\(\\textbf{n}(\\textbf{x}^*)\\)</span> of hard core normal force magnitudes at\n<span class=\"math\">\\(\\textbf{x}^*\\)</span> provides such a solution for <span class=\"math\">\\(\\textbf{w}\\)</span>:  This is a feasible\n<span class=\"math\">\\(\\textbf{w}\\)</span>  because it is non-negative and results in normal forces that sum\nto <span class=\"math\">\\(\\textbf{c}\\)</span>.  Further, it is non-zero only for the binding constraints.  It\nfollows that <span class=\"math\">\\(\\textbf{w}^* = \\textbf{n}(\\textbf{x}^*)\\)</span> gives an optimal\nsolution to the dual, at which point its objective matches that of the optimal\nprimal solution.  This argument is summarized in the caption to Fig.&nbsp;1.</p>\n<h4>References</h4>\n<p>[1] Matousek, J., and Ga ̈rtner, B. Understanding and using linear programming.\nSpringer&nbsp;(2007)</p>\n<p>[2] Marion, Jerry B. Classical dynamics of particles and systems. Academic\nPress,&nbsp;(2013).</p>\n<script type=\"text/javascript\">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {\n    var align = \"center\",\n        indent = \"0em\",\n        linebreak = \"false\";\n\n    if (false) {\n        align = (screen.width < 768) ? \"left\" : align;\n        indent = (screen.width < 768) ? \"0em\" : indent;\n        linebreak = (screen.width < 768) ? 'true' : linebreak;\n    }\n\n    var mathjaxscript = document.createElement('script');\n    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';\n    mathjaxscript.type = 'text/javascript';\n    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';\n\n    var configscript = document.createElement('script');\n    configscript.type = 'text/x-mathjax-config';\n    configscript[(window.opera ? \"innerHTML\" : \"text\")] =\n        \"MathJax.Hub.Config({\" +\n        \"    config: ['MMLorHTML.js'],\" +\n        \"    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } },\" +\n        \"    jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" +\n        \"    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" +\n        \"    displayAlign: '\"+ align +\"',\" +\n        \"    displayIndent: '\"+ indent +\"',\" +\n        \"    showMathMenu: true,\" +\n        \"    messageStyle: 'normal',\" +\n        \"    tex2jax: { \" +\n        \"        inlineMath: [ ['\\\\\\\\(','\\\\\\\\)'] ], \" +\n        \"        displayMath: [ ['$$','$$'] ],\" +\n        \"        processEscapes: true,\" +\n        \"        preview: 'TeX',\" +\n        \"    }, \" +\n        \"    'HTML-CSS': { \" +\n        \"        availableFonts: ['STIX', 'TeX'],\" +\n        \"        preferredFont: 'STIX',\" +\n        \"        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} },\" +\n        \"        linebreaks: { automatic: \"+ linebreak +\", width: '90% container' },\" +\n        \"    }, \" +\n        \"}); \" +\n        \"if ('default' !== 'default') {\" +\n            \"MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {\" +\n                \"var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;\" +\n                \"VARIANT['normal'].fonts.unshift('MathJax_default');\" +\n                \"VARIANT['bold'].fonts.unshift('MathJax_default-bold');\" +\n                \"VARIANT['italic'].fonts.unshift('MathJax_default-italic');\" +\n                \"VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');\" +\n            \"});\" +\n            \"MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {\" +\n                \"var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;\" +\n                \"VARIANT['normal'].fonts.unshift('MathJax_default');\" +\n                \"VARIANT['bold'].fonts.unshift('MathJax_default-bold');\" +\n                \"VARIANT['italic'].fonts.unshift('MathJax_default-italic');\" +\n                \"VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');\" +\n            \"});\" +\n        \"}\";\n\n    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);\n    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);\n}\n</script>",
  "category": ""
}