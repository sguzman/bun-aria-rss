{
  "id": "tag:blogger.com,1999:blog-8474926331452026626.post-1486873953874941813",
  "published": "2022-09-08T10:43:00.001-07:00",
  "updated": "2022-10-21T06:31:24.866-07:00",
  "category": [
    "",
    "",
    ""
  ],
  "title": "A Multi-Axis Approach for Vision Transformer and MLP Models",
  "content": "<span class=\"byline-author\">Posted by Zhengzhong Tu and Yinxiao Li, Software Engineers, Google Research</span> <p><a href=\"https://en.wikipedia.org/wiki/Convolutional_neural_network\">Convolutional neural networks</a> have been the dominant machine learning architecture for computer vision since the introduction of <a href=\"https://proceedings.neurips.cc/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf\">AlexNet</a> in 2012. Recently, inspired by the evolution of <a href=\"https://proceedings.neurips.cc/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf\">Transformers</a> in <a href=\"https://en.wikipedia.org/wiki/Natural_language_processing\">natural language processing</a>, <a href=\"https://en.wikipedia.org/wiki/Attention_(machine_learning)\">attention</a> mechanisms have been prominently incorporated into vision models. These attention methods boost some parts of the input data while minimizing other parts so that the network can focus on small but important parts of the data. The <a href=\"https://ai.googleblog.com/2020/12/transformers-for-image-recognition-at.html\">Vision Transformer</a> (ViT) has created a new landscape of model designs for computer vision that is completely free of convolution. ViT regards image patches as a sequence of words, and applies a Transformer encoder on top. When trained on <a href=\"https://ai.googleblog.com/2020/05/open-sourcing-bit-exploring-large-scale.html\">sufficiently large datasets</a>, ViT demonstrates compelling performance on image recognition.  </p><a name='more'></a><p>While convolutions and attention are both sufficient for good performance, neither of them are necessary. For example, <a href=\"https://arxiv.org/pdf/2105.01601.pdf\">MLP-Mixer</a> adopts a simple <a href=\"https://en.wikipedia.org/wiki/Multilayer_perceptron\">multi-layer perceptron</a> (MLP) to mix image patches across all the spatial locations, resulting in an all-MLP architecture. It is a competitive alternative to existing state-of-the-art vision models in terms of the trade-off between accuracy and computation required for training and inference. However, both ViT and the MLP models struggle to scale to higher input resolution because the computational complexity increases quadratically with respect to the image size.  </p><p>Today we present a new multi-axis approach that is simple and effective, improves on the original ViT and MLP models, can better adapt to high-resolution, dense prediction tasks, and can naturally adapt to different input sizes with high flexibility and low complexity. Based on this approach, we have built two backbone models for high-level and low-level vision tasks. We describe the first in “<a href=\"https://arxiv.org/pdf/2204.01697.pdf\">MaxViT: Multi-Axis Vision Transformer</a>”, to be presented in <a href=\"https://eccv2022.ecva.net/\">ECCV 2022</a>, and show it significantly improves the state of the art for high-level tasks, such as image classification, object detection, segmentation, quality assessment, and generation. The second, presented in “<a href=\"https://openaccess.thecvf.com/content/CVPR2022/papers/Tu_MAXIM_Multi-Axis_MLP_for_Image_Processing_CVPR_2022_paper.pdf\">MAXIM: Multi-Axis MLP for Image Processing</a>” at <a href=\"https://cvpr2022.thecvf.com/\">CVPR 2022</a>, is based on a <a href=\"https://link.springer.com/content/pdf/10.1007/978-3-319-24574-4_28.pdf\">UNet</a>-like architecture and achieves competitive performance on low-level imaging tasks including denoising, deblurring, dehazing, deraining, and low-light enhancement. To facilitate further research on efficient Transformer and MLP models, we have open-sourced the code and models for both <a href=\"https://github.com/google-research/maxvit\">MaxViT</a> and <a href=\"https://github.com/google-research/maxim\">MAXIM</a>.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTOeCdzkEPhjPrjeWU0UfHqbdz-5_ZR_BC_H7MWebdU_ZIrVQUFOqJzkEsOWY0GJSJO7H3UkmoqbQPlbpnFZa-1R8Fk72ZbFY8c_cRpHLS-d8qD7AIV-WQVMJ7k8R7b_UbR4Uwmax4w-gWwHWMwvWZ_e-Lwho9VG-V0kcxtxM3DqBH8DfSO10X1NewRg/s640/image2.gif\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"360\" data-original-width=\"640\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTOeCdzkEPhjPrjeWU0UfHqbdz-5_ZR_BC_H7MWebdU_ZIrVQUFOqJzkEsOWY0GJSJO7H3UkmoqbQPlbpnFZa-1R8Fk72ZbFY8c_cRpHLS-d8qD7AIV-WQVMJ7k8R7b_UbR4Uwmax4w-gWwHWMwvWZ_e-Lwho9VG-V0kcxtxM3DqBH8DfSO10X1NewRg/s16000/image2.gif\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">A demo of image deblurring using MAXIM frame by frame.</td></tr></tbody></table><p><b>Overview</b><br />Our new approach is based on multi-axis attention, which decomposes the full-size attention (each pixel attends to all the pixels) used in ViT into two sparse forms — local and (sparse) global. As shown in the figure below, the multi-axis attention contains a sequential stack of block attention and grid attention. The block attention works within non-overlapping windows (small patches in intermediate feature maps) to capture local patterns, while the grid attention works on a sparsely sampled uniform grid for long-range (global) interactions. The window sizes of grid and block attentions can be fully controlled as hyperparameters to ensure a linear computational complexity to the input size.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy3hoIJicaOPinAtGT3d7EKKf5gH_T16QFe-MR0TbIMAtwiKHOUFSX_jcwTF3CqXLOqTFy_MY5N7yQIBrr7rfbVM78NdCFEs-Wk49P3zO48BmLpM7OucY7HSPl7io9-JWIIj-oulNKttjkbSAyoawEeDDSSlnS-MYtEyWc23K_EDrzbdmnfEs4aP7amw/s999/image4.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"237\" data-original-width=\"999\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgy3hoIJicaOPinAtGT3d7EKKf5gH_T16QFe-MR0TbIMAtwiKHOUFSX_jcwTF3CqXLOqTFy_MY5N7yQIBrr7rfbVM78NdCFEs-Wk49P3zO48BmLpM7OucY7HSPl7io9-JWIIj-oulNKttjkbSAyoawEeDDSSlnS-MYtEyWc23K_EDrzbdmnfEs4aP7amw/s16000/image4.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">The proposed multi-axis attention conducts blocked local and dilated global attention sequentially followed by a <a href=\"https://en.wikipedia.org/wiki/Feedforward_neural_network\">FFN</a>, with only a linear complexity. The pixels in the same colors are attended together.</td></tr></tbody></table><p>Such low-complexity attention can significantly improve its wide applicability to many vision tasks, especially for high-resolution visual predictions, demonstrating greater generality than the original attention used in ViT. We build two backbone instantiations out of this multi-axis attention approach – MaxViT and MAXIM, for high-level and low-level tasks, respectively. </p><p><b>MaxViT</b><br />In MaxViT, we first build a single MaxViT block (shown below) by concatenating MBConv (proposed by <a href=\"https://ai.googleblog.com/2019/05/efficientnet-improving-accuracy-and.html\">EfficientNet</a>, <a href=\"https://arxiv.org/pdf/2104.00298.pdf\">V2</a>) with the multi-axis attention. This single block can encode local and global visual information regardless of input resolution. We then simply stack repeated blocks composed of attention and convolutions in a hierarchical architecture (similar to <a href=\"https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/He_Deep_Residual_Learning_CVPR_2016_paper.pdf\">ResNet</a>, <a href=\"https://arxiv.org/pdf/2106.04803.pdf\">CoAtNet</a>), yielding our homogenous MaxViT architecture. Notably, MaxViT is distinguished from previous hierarchical approaches as it can “see” globally throughout the entire network, even in earlier, high-resolution stages, demonstrating stronger model capacity on various tasks.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRJZAcZ1K5REHwhtTptulU2I2DO9x7p-0RJnEQcmEpSN8gSprcxz8ieHM5yKxZ3U1YlO_23UW5rRfhZKmN6NWB94XafW3X25nrOtCxfZOVaIK0dsnwxuMXAuDOJFGSAw52wqy0_2l5gCDMS-ZFBmGoSzpEXPPxF4uSEMlTyuDBGxQtKRXvQIrU8U4UXQ/s1818/image6.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"806\" data-original-width=\"1818\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhRJZAcZ1K5REHwhtTptulU2I2DO9x7p-0RJnEQcmEpSN8gSprcxz8ieHM5yKxZ3U1YlO_23UW5rRfhZKmN6NWB94XafW3X25nrOtCxfZOVaIK0dsnwxuMXAuDOJFGSAw52wqy0_2l5gCDMS-ZFBmGoSzpEXPPxF4uSEMlTyuDBGxQtKRXvQIrU8U4UXQ/s16000/image6.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">The meta-architecture of MaxViT.</td></tr></tbody></table><p><b>MAXIM</b><br />Our second backbone, <a href=\"https://arxiv.org/pdf/2201.02973.pdf\">MAXIM</a>, is a generic <a href=\"https://link.springer.com/content/pdf/10.1007/978-3-319-24574-4_28.pdf\">UNet</a>-like architecture tailored for low-level image-to-image prediction tasks. MAXIM explores parallel designs of the local and global approaches using the <a href=\"https://arxiv.org/pdf/2105.08050.pdf\">gated multi-layer perceptron</a> (gMLP) network (patching-mixing MLP with a <a href=\"http://proceedings.mlr.press/v70/dauphin17a/dauphin17a.pdf\">gating mechanism</a>). Another contribution of MAXIM is the cross-gating block that can be used to apply interactions between two different input signals. This block can serve as an efficient alternative to the <a href=\"https://arxiv.org/abs/1706.03762\">cross-attention</a> module as it only employs the cheap gated MLP operators to interact with various inputs without relying on the computationally heavy cross-attention. Moreover, all the proposed components including the gated MLP and cross-gating blocks in MAXIM enjoy linear complexity to image size, making it even more efficient when processing high-resolution pictures. </p><p><b>Results</b><br />We demonstrate the effectiveness of MaxViT on a broad range of vision tasks. On image classification, MaxViT achieves state-of-the-art results under various settings: with only <a href=\"https://www.image-net.org/\">ImageNet-1K</a> training, MaxViT attains 86.5% top-1 accuracy; with <a href=\"https://www.image-net.org/\">ImageNet-21K</a> (14M images, 21k classes) pre-training, MaxViT achieves 88.7% top-1 accuracy; and with <a href=\"https://arxiv.org/abs/1707.02968\">JFT</a> (300M images, 18k classes) pre-training, our largest model MaxViT-XL achieves a high accuracy of 89.5% with 475M parameters.  </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEio_MxdnD_XsqJ1JU-OssjoNkLHGzShDwwT6g1udUkR7vhLXAv17qwiUIRSGmNwWThGzYNqONyNtG_rjAqjhqHInK1ea4cqZy8BYMAHrMNRGBZEsZCQUcFPMxuOnNcHx1fBrXMMIOSQtpZzEEMC0oe6iS62VLJTu2lxrE5f4X2WcViYbZINYqQ7mTx2Pg/s818/image5.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"635\" data-original-width=\"818\" height=\"310\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEio_MxdnD_XsqJ1JU-OssjoNkLHGzShDwwT6g1udUkR7vhLXAv17qwiUIRSGmNwWThGzYNqONyNtG_rjAqjhqHInK1ea4cqZy8BYMAHrMNRGBZEsZCQUcFPMxuOnNcHx1fBrXMMIOSQtpZzEEMC0oe6iS62VLJTu2lxrE5f4X2WcViYbZINYqQ7mTx2Pg/w400-h310/image5.png\" width=\"400\" /></a></td></tr>  <tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheIg7kEQNDd0Bq87HjzZbAIgssxBHZlF2SX3muy4DdwMeHKRRzeCRmCgjfGQMSJJkOophDmFBroj1RC9I_eT_x5VFdRpjAga73GknJu7XrQ9E0ptxiHrtonSZeWjmmElUHWCNKQuahKIYLykWqKhkab5gRJ7rpN-lVw_PeoemfNd04Z4LnoNY95xxMhw/s820/image1.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"633\" data-original-width=\"820\" height=\"309\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEheIg7kEQNDd0Bq87HjzZbAIgssxBHZlF2SX3muy4DdwMeHKRRzeCRmCgjfGQMSJJkOophDmFBroj1RC9I_eT_x5VFdRpjAga73GknJu7XrQ9E0ptxiHrtonSZeWjmmElUHWCNKQuahKIYLykWqKhkab5gRJ7rpN-lVw_PeoemfNd04Z4LnoNY95xxMhw/w400-h309/image1.png\" width=\"400\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">Performance comparison of MaxViT with state-of-the-art models on ImageNet-1K. <b>Top</b>: Accuracy vs. FLOPs performance scaling with 224x224 image resolution. <b>Bottom</b>: Accuracy vs. parameters scaling curve under ImageNet-1K fine-tuning setting.</td></tr></tbody></table><p>For downstream tasks, MaxViT as a backbone delivers favorable performance on a broad spectrum of tasks. For object detection and segmentation on the <a href=\"https://cocodataset.org/#home\">COCO</a> dataset, the MaxViT backbone achieves 53.4 <a href=\"https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)\">AP</a>, outperforming other base-level models while requiring only about 60% the computational cost. For image aesthetics assessment, the MaxViT model advances the state-of-the-art <a href=\"https://openaccess.thecvf.com/content/ICCV2021/papers/Ke_MUSIQ_Multi-Scale_Image_Quality_Transformer_ICCV_2021_paper.pdf\">MUSIQ</a> model by 3.5% in terms of linear correlation with human opinion scores. The standalone MaxViT building block also demonstrates effective performance on image generation, achieving better <a href=\"https://en.wikipedia.org/wiki/Fr%C3%A9chet_inception_distance\">FID</a> and <a href=\"https://en.wikipedia.org/wiki/Inception_score\">IS</a> scores on the ImageNet-1K unconditional generation task with a significantly lower number of parameters than the state-of-the-art model, <a href=\"https://arxiv.org/pdf/2106.07631.pdf\">HiT</a>. </p><p>The UNet-like MAXIM backbone, customized for image processing tasks, has also demonstrated state-of-the-art results on 15 out of 20 tested datasets, including denoising, deblurring, deraining, dehazing, and low-light enhancement, while requiring fewer or comparable number of parameters and FLOPs than competitive models. Images restored by MAXIM show more recovered details with less visual artifacts. </p><table align=\"center\" cellpadding=\"0\" cellspacing=\"0\" class=\"tr-caption-container\" style=\"margin-left: auto; margin-right: auto;\"><tbody><tr><td style=\"text-align: center;\"><a href=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjx2dIN8Tp5n9s40k-HGnI8_KNygWKnT_0O8lCJ-Sc39PPFiix1fUMBTVgb_8avoiIyX71Ox6L-cIj0ZejxbWGv5xmtpCkb4NtuPfLULLddW3WBYVReXc5Q341zFZQS2EaTSGQI-NmCTAIgY1wLKWXDOPtU-x1E77xwWjLMFseFhQMPnennECauuTyZog/s1292/image3.png\" style=\"margin-left: auto; margin-right: auto;\"><img border=\"0\" data-original-height=\"630\" data-original-width=\"1292\" src=\"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjx2dIN8Tp5n9s40k-HGnI8_KNygWKnT_0O8lCJ-Sc39PPFiix1fUMBTVgb_8avoiIyX71Ox6L-cIj0ZejxbWGv5xmtpCkb4NtuPfLULLddW3WBYVReXc5Q341zFZQS2EaTSGQI-NmCTAIgY1wLKWXDOPtU-x1E77xwWjLMFseFhQMPnennECauuTyZog/s16000/image3.png\" /></a></td></tr><tr><td class=\"tr-caption\" style=\"text-align: center;\">Visual results of MAXIM for image deblurring, deraining, and low-light enhancement.</td></tr></tbody></table><p><b>Summary</b><br />Recent works in the last two or so years have shown that ConvNets and Vision Transformers can achieve similar performance. Our work presents a unified design that takes advantage of the best of both worlds — efficient convolution and sparse attention — and demonstrates that a model built on top, namely MaxViT, can achieve state-of-the-art performance on a variety of vision tasks. More importantly, MaxViT scales well to very large data sizes. We also show that an alternative multi-axis design using MLP operators, MAXIM, achieves state-of-the-art performance on a broad range of low-level vision tasks.  </p><p>Even though we present our models in the context of vision tasks, the proposed multi-axis approach can easily extend to language modeling to capture both local and global dependencies in linear time. Motivated by the work here, we expect that it is worthwhile to study other forms of sparse attention in higher-dimensional or multimodal signals such as videos, point clouds, and vision-language models. </p><p>We have open-sourced the code and models of <a href=\"https://github.com/google-research/maxim\">MAXIM</a> and <a href=\"https://github.com/google-research/maxvit\">MaxViT</a> to facilitate future research on efficient attention and MLP models. </p><p><b>Acknowledgments</b><br /><em>We would like to thank our co-authors: Hossein Talebi, Han Zhang, Feng Yang, Peyman Milanfar, and Alan Bovik. We would also like to acknowledge the valuable discussion and support from Xianzhi Du, Long Zhao, Wuyang Chen, Hanxiao Liu, Zihang Dai, Anurag Arnab, Sungjoon Choi, Junjie Ke, Mauricio Delbracio, Irene Zhu, Innfarn Yoo, Huiwen Chang, and Ce Liu.</em></p>",
  "link": [
    "",
    "",
    "",
    "",
    ""
  ],
  "author": {
    "name": "Google AI",
    "uri": "http://www.blogger.com/profile/12098626514775266161",
    "email": "noreply@blogger.com",
    "gd:image": ""
  },
  "media:thumbnail": "",
  "thr:total": 0
}