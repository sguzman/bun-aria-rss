{
  "title": "Visualizing economic data with pretty worldmaps",
  "link": "https://datascienceplus.com/visualizing-economic-data-with-pretty-worldmaps/",
  "comments": "https://datascienceplus.com/visualizing-economic-data-with-pretty-worldmaps/#respond",
  "dc:creator": "Fabian Scheler",
  "pubDate": "Tue, 22 Mar 2022 18:56:14 +0000",
  "category": [
    "Visualizing Data",
    "Data Visualisation",
    "Maps",
    "Tips & Tricks"
  ],
  "guid": "https://datascienceplus.com/?p=32081",
  "description": "<div style=\"border-top: 1px solid; font-size: 14px;text-align: center; border-bottom: 1px solid; padding: 5px 2px;\"><a href=\"https://datascienceplus.com/posting-from-r-markdown-to-datascienceplus/\">Are you interested in guest posting? Publish at DataScience+  via your RStudio editor.</a></div><h2>Category</h2><ul><li><a href=\"https://datascienceplus.com/category/visualizing-data/\" rel=\"bookmark\" title=\"Permanent Link toVisualizing Data\">Visualizing Data</a></li></ul><h2>Tags</h2><ul><li><a href=\"https://datascienceplus.com/tag/data-visualisation/\" rel=\"bookmark\" title=\"Permanent Link toData Visualisation\">Data Visualisation</a></li><li><a href=\"https://datascienceplus.com/tag/maps/\" rel=\"bookmark\" title=\"Permanent Link toMaps\">Maps</a></li><li><a href=\"https://datascienceplus.com/tag/rstats/\" rel=\"bookmark\" title=\"Permanent Link toR Programming\">R Programming</a></li><li><a href=\"https://datascienceplus.com/tag/tips-tricks/\" rel=\"bookmark\" title=\"Permanent Link toTips & Tricks\">Tips & Tricks</a></li></ul>Choropleths are a nice tool for the visualization of geographic data and with R and Python, their creation can be pretty effortless, especially when clean data is readily available. Fortunately, a lot of economic datasets can be loaded from the World Bank Open Data platform. Nevertheless, making the visualization look nice can be a bit [&#8230;]<strong><p>Related Post</p></strong><ul><li><a href=\"https://datascienceplus.com/real-plug-and-play-supervised-learning-automl-using-r-and-lares/\" rel=\"bookmark\" title=\"Permanent Link toReal Plug-and-Play Supervised Learning AutoML using R and lares\">Real Plug-and-Play Supervised Learning AutoML using R and lares</a></li><li><a href=\"https://datascienceplus.com/how-to-visualize-complex-sets-intersections-with-python/\" rel=\"bookmark\" title=\"Permanent Link toHow to visualize complex sets intersections with Python?\">How to visualize complex sets intersections with Python?</a></li><li><a href=\"https://datascienceplus.com/how-to-analyses-a-single-variable-using-graphs-in-r/\" rel=\"bookmark\" title=\"Permanent Link toHow to Analyze a Single Variable using Graphs in R?\">How to Analyze a Single Variable using Graphs in R?</a></li><li><a href=\"https://datascienceplus.com/map-visualization-of-covid19-across-world/\" rel=\"bookmark\" title=\"Permanent Link toMap Visualization of COVID-19 Across the World with R\">Map Visualization of COVID-19 Across the World with R</a></li><li><a href=\"https://datascienceplus.com/find-insights-with-ranked-cross-correlations/\" rel=\"bookmark\" title=\"Permanent Link toFind Insights with Ranked Cross-Correlations\">Find Insights with Ranked Cross-Correlations</a></li></ul>",
  "content:encoded": "<div style=\"border-top: 1px solid; font-size: 14px;text-align: center; border-bottom: 1px solid; padding: 5px 2px;\"><a href=\"https://datascienceplus.com/posting-from-r-markdown-to-datascienceplus/\">Are you interested in guest posting? Publish at DataScience+  via your RStudio editor.</a></div><h2>Category</h2><ul><li><a href=\"https://datascienceplus.com/category/visualizing-data/\" rel=\"bookmark\" title=\"Permanent Link toVisualizing Data\">Visualizing Data</a></li></ul><h2>Tags</h2><ul><li><a href=\"https://datascienceplus.com/tag/data-visualisation/\" rel=\"bookmark\" title=\"Permanent Link toData Visualisation\">Data Visualisation</a></li><li><a href=\"https://datascienceplus.com/tag/maps/\" rel=\"bookmark\" title=\"Permanent Link toMaps\">Maps</a></li><li><a href=\"https://datascienceplus.com/tag/rstats/\" rel=\"bookmark\" title=\"Permanent Link toR Programming\">R Programming</a></li><li><a href=\"https://datascienceplus.com/tag/tips-tricks/\" rel=\"bookmark\" title=\"Permanent Link toTips & Tricks\">Tips & Tricks</a></li></ul><p>Choropleths are a nice tool for the visualization of geographic data and with R and Python, their creation can be pretty effortless, especially when clean data is readily available. Fortunately, a lot of economic datasets can be loaded from the World Bank Open Data platform. Nevertheless, making the visualization look nice can be a bit cumbersome. For this reason, I have created a small, integrated function that is handling the data download, adjustment, and visualization all in one. The output can easily be exported as high-quality vector-graphic using ggsave.</p>\n<p><a href=\"https://datascienceplus.com/wp-content/uploads/2022/03/rect6560.png\"><img src=\"https://datascienceplus.com/wp-content/uploads/2022/03/rect6560-490x197.png\" alt=\"\" width=\"490\" height=\"197\" class=\"aligncenter size-medium wp-image-32085\" srcset=\"https://datascienceplus.com/wp-content/uploads/2022/03/rect6560-490x197.png 490w, https://datascienceplus.com/wp-content/uploads/2022/03/rect6560-1024x412.png 1024w, https://datascienceplus.com/wp-content/uploads/2022/03/rect6560-768x309.png 768w, https://datascienceplus.com/wp-content/uploads/2022/03/rect6560-1536x618.png 1536w, https://datascienceplus.com/wp-content/uploads/2022/03/rect6560.png 1693w\" sizes=\"(max-width: 490px) 100vw, 490px\" /></a></p>\n<p>To replicate the example, simply follow these three steps.</p>\n<p>1) Install all required packages</p>\n<pre>\ninstall.packages(\"rnaturalearth\")\ninstall.packages(\"rnaturalearthdata\")  \ninstall.packages(\"WDI\")\ninstall.packages(\"lubridate\")\ninstall.packages(\"dplyr\")  \ninstall.packages(\"ggplot2\")\ninstall.packages(\"RColorBrewer\")\ninstall.packages(\"ggplot2\")\n</pre>\n<p>2) Load the function</p>\n<pre>\n#Download and visualization function\nget_and_plot_wb_data<-function(sel_indicator=\"NY.GDP.PCAP.KD\",\n                               log=\"Yes\",\n                               midpoint=\"Mean\",\n                               color_scheme=\"Straight\",\n                               start_yr = year(Sys.Date())-2,\n                               end_yr = year(Sys.Date()),\n                               legend_pos=\"Bottom\",\n                               charttitle=\"GDP per Capita in US$\",\n                               scale_factor=1)\n{\n#Load required packages\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)  \nlibrary(WDI)\nlibrary(lubridate)\nlibrary(dplyr)  \nlibrary(ggplot2)\nlibrary(RColorBrewer)\nlibrary(ggplot2)\n\n#Create color scheme\ncols_gr<-c(\"#632523\", \"#953735\",  \"#C3D69B\",\"#77933C\", \"#4F6228\")\ncols_gr = colorRampPalette(cols_gr)(5)\n\n#Get all countries and countrycodes\nworld <- ne_countries(scale = \"medium\", returnclass = \"sf\")\nclass(world)\n\n#Load data using the worldbank API\ngdp<-WDI(\n  country = \"all\",\n  indicator = sel_indicator,\n  start = start_yr,\n  end = end_yr,\n  extra = FALSE,\n  cache = NULL,\n  latest = NULL,\n  language = \"en\"\n)\n\nnames(gdp)[1]<-\"iso_a2\"\nnames(gdp)[names(gdp)==sel_indicator]<-\"ret\"\ngdp<-gdp[order(gdp$country,gdp$year),]\nprint(max(gdp$year))\ngdp% group_by(iso_a2) %>% do(tail(., n=1))\n  \n  \nworld<-merge(world,gdp,by=\"iso_a2\",all=F)\n\n#Remove some unnecssary elements\nplain <- theme(\n  panel.background = element_rect(fill = \"white\"),\n)\n\nworld$ret<-round(world$ret/scale_factor,2)\n#Choose appropriate breakpoint\nif(midpoint==\"Median\")\n{\n  midpoint<-median((world$ret),na.rm=T)\n}else{\n  if(midpoint==\"Mean\")\n  {\n    midpoint<-mean((world$ret),na.rm=T)  \n  }else{\n    midpoint<-midpoint\n  }  \n}\n\n#Red to green or green to red\nif(color_scheme==\"Inverted\")\n{\n  col_low<-\"#276419\"\n  col_high<-\"#8E0152\"\n}else{\n  col_low<-\"#8E0152\"\n  col_high<-\"#276419\"\n}\n\n#Plot map with ggplot\n\np9<-\n  ggplot(data = world) +\n  geom_sf(aes(fill = (ret))) +\n  ggtitle(charttitle) +\n  #theme(legend.position = legend_pos,legend.margin=margin(-10,-10,-10,-10),legend.box.margin=margin(-100,800,-50,-50))+\n  plain \n  \n#Use log scale for skewed data\nif(log==\"Yes\")\n{  \n  p9<-p9+  \n    scale_fill_gradient2(\n      trans = \"log\",\n      low = col_low,\n      mid = \"white\",\n      high = col_high,\n      midpoint = log(midpoint),\n      space = \"Lab\",\n      na.value = \"grey50\",\n      guide = \"colourbar\",\n      aesthetics = \"fill\",\n      name=\"\"\n    )\n}else{\n  p9<-p9+  \n    scale_fill_gradient2(\n      low = col_low,\n      mid = \"white\",\n      high = col_high,\n      midpoint = midpoint,\n      space = \"Lab\",\n      na.value = \"grey50\",\n      guide = \"colourbar\",\n      aesthetics = \"fill\",\n      name=\"\"\n    )\n}\n\nres_list<-list(\"dataset\"=world,\"visualization\"=p9)\n\nreturn(res_list)\n\n}\n\n</pre>\n<p>3) Run the function and save the plot</p>\n<pre>\n#Run the function\nres_list<-get_and_plot_wb_data(sel_indicator=\"NY.GDP.PCAP.KD\",midpoint=\"Median\",log=\"Yes\",legend_pos=\"bottom\",charttitle=\"GDP per Capita in US$\",scale_factor=1)\nres_list$visualization\n\n#Export the result\ntarget_folder<-\"C:/your_path/\"\nggsave(file=paste0(target_folder,\"gdp_per_capita.svg\"), plot=res_list$visualization, width=14, height=7)\n\n</pre>\n<strong><p>Related Post</p></strong><ul><li><a href=\"https://datascienceplus.com/real-plug-and-play-supervised-learning-automl-using-r-and-lares/\" rel=\"bookmark\" title=\"Permanent Link toReal Plug-and-Play Supervised Learning AutoML using R and lares\">Real Plug-and-Play Supervised Learning AutoML using R and lares</a></li><li><a href=\"https://datascienceplus.com/how-to-visualize-complex-sets-intersections-with-python/\" rel=\"bookmark\" title=\"Permanent Link toHow to visualize complex sets intersections with Python?\">How to visualize complex sets intersections with Python?</a></li><li><a href=\"https://datascienceplus.com/how-to-analyses-a-single-variable-using-graphs-in-r/\" rel=\"bookmark\" title=\"Permanent Link toHow to Analyze a Single Variable using Graphs in R?\">How to Analyze a Single Variable using Graphs in R?</a></li><li><a href=\"https://datascienceplus.com/map-visualization-of-covid19-across-world/\" rel=\"bookmark\" title=\"Permanent Link toMap Visualization of COVID-19 Across the World with R\">Map Visualization of COVID-19 Across the World with R</a></li><li><a href=\"https://datascienceplus.com/find-insights-with-ranked-cross-correlations/\" rel=\"bookmark\" title=\"Permanent Link toFind Insights with Ranked Cross-Correlations\">Find Insights with Ranked Cross-Correlations</a></li></ul>",
  "wfw:commentRss": "https://datascienceplus.com/visualizing-economic-data-with-pretty-worldmaps/feed/",
  "slash:comments": 0
}