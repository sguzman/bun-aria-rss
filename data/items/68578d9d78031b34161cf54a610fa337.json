{
  "title": "Instructions for Installing &#038; Using R on Amazon EC2",
  "description": "<p>If you’re an R user, you’ve surely heard all the hype around ‘big data’ and how R is commonly used to analyze these volumes of data. One thing that’s often missing from the discussion is HOW to work around issues using big data and R, specifically how to deal with the fact that R stores all its objects in-memory.</p>",
  "pubDate": "Mon, 08 Apr 2013 16:36:07 +0000",
  "link": "http://randyzwitch.com/r-amazon-ec2/",
  "guid": "http://randyzwitch.com/r-amazon-ec2/",
  "content": "<p>If you’re an R user, you’ve surely heard all the hype around ‘big data’ and how R is commonly used to analyze these volumes of data. One thing that’s often missing from the discussion is HOW to work around issues using big data and R, specifically how to deal with the fact that R stores all its objects in-memory.</p>\n\n<p>While you can use packages such as <a title=\"ff package\" href=\"http://cran.r-project.org/web/packages/ff/index.html\" target=\"_blank\">ff</a> and <a title=\"bigmemory\" href=\"http://cran.r-project.org/web/packages/bigmemory/index.html\" target=\"_blank\">bigmemory</a> to overcome the in-memory limits of your local machine, these additional packages do require some re-engineering of your code. Instead, consider using <a title=\"Amazon Web Services\" href=\"http://aws.amazon.com/ec2/\" target=\"_blank\">Amazon EC2</a> to provision the resources you need.  Here are two ways to get started…</p>\n\n<h3 id=\"use-a-pre-made-ami\">Use a Pre-Made AMI</h3>\n\n<p>In the great open-source tradition, there are already R Amazon EC2 AMI images available out there to use. The way I got started was using the pre-built images that <a title=\"RStudio AMI Images\" href=\"http://www.louisaslett.com/RStudio_AMI/\" target=\"_blank\">Louis Aslett</a> provides on his website.  Louis also provides great instructions on learning about EC2, so if you’ve never worked with R in the cloud or a just looking to get up and running fast, his website is a great means to do so.</p>\n\n<h3 id=\"build-your-own-image\">Build Your Own Image</h3>\n\n<p>Alternatively, suppose you want to build your own customized image. For example, say you wanted to build a proof-of-concept ‘big data’ environment, so you want <a title=\"R download at CRAN\" href=\"http://cran.r-project.org/\" target=\"_blank\">R</a>, <a title=\"Python download\" href=\"http://python.org/\" target=\"_blank\">Python</a>, <a title=\"MySQL download\" href=\"http://dev.mysql.com/\" target=\"_blank\">MySQL</a> and <a title=\"MongoDB\" href=\"http://www.mongodb.org/\" target=\"_blank\">MongoDB</a>.  The commands to accomplish this are listed below. Note that I’m assuming you have a <a title=\"AWS FAQ\" href=\"http://aws.amazon.com/ec2/faqs/\" target=\"_blank\">basic understanding of working through the Amazon Web Service Console (AWS)</a>, including being able to get to the ‘Classic Wizard’ for launching an EC2 instance. You also should have a basic understanding of <a title=\"Command Line tutorial\" href=\"http://cli.learncodethehardway.org/book/\" target=\"_blank\">working from the command line</a>.</p>\n\n<h4 id=\"setting-up-amazon-ec2-instance\">Setting Up Amazon EC2 Instance</h4>\n\n<ol>\n  <li>Launch an Ubuntu 12.04.1 LTS 64-bit image. You can use a free “t1.micro” image while building, then provision more resources later once you’re ready for analysis.</li>\n  <li>Accept defaults until you get to Key-Pair tab. The Key-Pair is what allows you to login securely to your Amazon EC2 image without a password. Create and download a Key-Pair if you don’t already have one or choose an existing Key-Pair if you do.</li>\n  <li>When you get to the ‘Security Groups’ tab, create a security group that has the following ports open: <code class=\"language-plaintext highlighter-rouge\">22</code> (SSH), <code class=\"language-plaintext highlighter-rouge\">80</code> (HTTP), <code class=\"language-plaintext highlighter-rouge\">443</code> (HTTPS), <code class=\"language-plaintext highlighter-rouge\">3389</code> (RDP, optional), and <code class=\"language-plaintext highlighter-rouge\">8787</code> (RStudio Server).</li>\n  <li>Work through the rest of the Wizard until your instance is launched.</li>\n</ol>\n\n<h4 id=\"connecting-to-amazon-ec2-instance\">Connecting to Amazon EC2 Instance</h4>\n\n<ol>\n  <li>There are two ways to connect to your EC2 image, both of which can be found by going to the “Actions” tab in the AWS console, then selecting “Connect” from the drop-down. The rest of this tutorial assumes you connect via a stand-alone SSH client (such as Terminal for Mac OSX)</li>\n  <li>Connect to your instance by typing the code provided to you, such as: <code class=\"language-plaintext highlighter-rouge\">ssh -i me-aws.pem ubuntu@ec2-50-19-18-120.compute-1.amazonaws.com</code></li>\n  <li>Be sure that before you submit this code, you either modify the line to put the directory in front of your Key-Pair, or “cd” to the directory where the Key-Pair is located</li>\n  <li>After submitting the connect code, you will get a warning saying that the ‘authenticity can’t be established, do you want to continue?’  Type <code class=\"language-plaintext highlighter-rouge\">yes</code> and hit enter to log in.</li>\n</ol>\n\n<h4 id=\"installing-base-r\">Installing Base R</h4>\n\n<p>Once you are logged in, there are about a dozen commands that need to be submitted. Some commands run quickly, others can take 10-15 minutes to run through the entire installation process. Depending on how quickly each command completes, you may or may not need to type “sudo” in front of each command to have proper access rights for installation. Submit each line one at a time.</p>\n\n<figure class=\"highlight\"><pre><code class=\"language-shell\" data-lang=\"shell\"><table class=\"rouge-table\"><tbody><tr><td class=\"gutter gl\"><pre class=\"lineno\">1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n</pre></td><td class=\"code\"><pre><span class=\"c\">#Create a user, home directory and set password</span>\n<span class=\"nb\">sudo </span>useradd rstudio\n<span class=\"nb\">sudo mkdir</span> /home/rstudio\n<span class=\"nb\">sudo </span>passwd rstudio\n<span class=\"nb\">sudo chmod</span> <span class=\"nt\">-R</span> 0777 /home/rstudio\n\n<span class=\"c\">#Update all files from the default state</span>\n<span class=\"nb\">sudo </span>apt-get update\n<span class=\"nb\">sudo </span>apt-get upgrade\n\n<span class=\"c\">#Add CRAN mirror to custom sources.list file using vi</span>\n<span class=\"nb\">sudo </span>vi /etc/apt/sources.list.d/sources.list\n\n<span class=\"c\">#Add following line (or your favorite CRAN mirror)</span>\ndeb http://lib.stat.cmu.edu/R/CRAN/bin/linux/ubuntu precise/\n\n<span class=\"c\">#Update files to use CRAN mirror</span>\n<span class=\"c\">#Don't worry about error message</span>\n<span class=\"nb\">sudo </span>apt-get update\n\n<span class=\"c\">#Install latest version of R</span>\n<span class=\"c\">#Install without verification</span>\n<span class=\"nb\">sudo </span>apt-get <span class=\"nb\">install </span>r-base\n</pre></td></tr></tbody></table></code></pre></figure>\n\n<p>While not strictly required to run R, I also like to run the following commands to install the Curl and XML packages as well, which are useful if you want to use R to connect to any web data/APIs.</p>\n\n<figure class=\"highlight\"><pre><code class=\"language-shell\" data-lang=\"shell\"><table class=\"rouge-table\"><tbody><tr><td class=\"gutter gl\"><pre class=\"lineno\">1\n2\n3\n</pre></td><td class=\"code\"><pre><span class=\"c\">#Install in order to use RCurl &amp; XML</span>\n<span class=\"nb\">sudo </span>aptitude <span class=\"nb\">install </span>libcurl4-openssl-dev\n<span class=\"nb\">sudo </span>apt-get <span class=\"nb\">install </span>libxml2-dev\n</pre></td></tr></tbody></table></code></pre></figure>\n\n<p>With these commands run, you will now be able to run R from the command line just by typing “R” at the prompt. However, it would be a crime to do all this work and not install RStudio Server, which makes working in R so much easier.</p>\n\n<h4 id=\"installing-rstudio-server\">Installing RStudio Server</h4>\n\n<p>Once you’ve installed the above commands, you can now access RStudio through your local browser. Navigate to the Public DNS of your image on port 8787, similar to:</p>\n\n<p><strong>http://ec2-50-19-18-120.compute-1.amazonaws.com:8787</strong></p>\n\n<p>The <code class=\"language-plaintext highlighter-rouge\">login</code> and <code class=\"language-plaintext highlighter-rouge\">password</code> will be the values you used in the image creation process (I used <code class=\"language-plaintext highlighter-rouge\">rstudio</code> as my username above).</p>\n\n<h4 id=\"installing-mysql-python-and-mongodb\">Installing MySQL, Python, and MongoDB</h4>\n\n<p>If you’ve made it this far, I’m sure you realize that installing additional packages will only take a line or two of code. Even better, Python is installed by default on Linux, so we really only need to install MySQL and MongoDB.</p>\n\n<figure class=\"highlight\"><pre><code class=\"language-shell\" data-lang=\"shell\"><table class=\"rouge-table\"><tbody><tr><td class=\"gutter gl\"><pre class=\"lineno\">1\n2\n3\n4\n5\n6\n</pre></td><td class=\"code\"><pre><span class=\"c\">#Install MySQL\n</span>\n<span class=\"nb\">sudo </span>apt-get <span class=\"nb\">install </span>mysql-common\n<span class=\"nb\">sudo </span>apt-get <span class=\"nb\">install </span>mysql-server\n\n<span class=\"c\">#Install MongoDB\n</span>\n<span class=\"nb\">sudo </span>apt-get <span class=\"nb\">install </span>mongodb\n</pre></td></tr></tbody></table></code></pre></figure>\n\n<h3 id=\"summary\">Summary</h3>\n\n<p>While the steps above can be intimidating if you’ve never used Linux or worked on the command line, but once you get the hang of it, your ability to use R on ‘big data’ (however you define it) will be much improved. For only a few pennies to up to a few dollars per hour, you can use hardware having 16-64GB of RAM or more.</p>\n\n<p>EDIT, 4/9: The code is wrapping weird on some monitors.  <a title=\"Amazon EC2 RStudio commands\" href=\"http://randyzwitch.com/wp-content/uploads/2013/04/amazon-ec2-rstudio.txt\" target=\"_blank\">Click here</a> for the commands in a .txt. file.</p>"
}