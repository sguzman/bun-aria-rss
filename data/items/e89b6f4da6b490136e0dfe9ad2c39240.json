{
  "title": "Model Monitoring with WeightWatcher: Data-Free DEEP LEARNING Diagnostics",
  "link": "https://calculatedcontent.com/2021/08/18/model-monitoring-with-weightwatcher-data-free-deep-learning-diagnostics/",
  "comments": "https://calculatedcontent.com/2021/08/18/model-monitoring-with-weightwatcher-data-free-deep-learning-diagnostics/#comments",
  "dc:creator": "Charles H Martin, PhD",
  "pubDate": "Wed, 18 Aug 2021 15:47:28 +0000",
  "category": "Uncategorized",
  "guid": "http://calculatedcontent.com/?p=14219",
  "description": "Weighwatcher is an open-source Model Monitoring tool that provides Data-Free Diagnostics for production-quality Deep Neural Networks (DNNs). It. can tell &#8230; <a class=\"more-link\" href=\"https://calculatedcontent.com/2021/08/18/model-monitoring-with-weightwatcher-data-free-deep-learning-diagnostics/\">More</a>",
  "content:encoded": "\n<p>Weighwatcher is an open-source Model Monitoring tool that provides Data-Free Diagnostics for production-quality Deep Neural Networks (DNNs). It. can tell you if your model is over-trained or over-parameterized. And it can it tell you which layers are over-trained or under-trained (over-parameterized). And all without needing training or test data.</p>\n\n\n\n<p>Let&#8217;s see how to do this.  First, install the tool.</p>\n\n\n<div class=\"wp-block-syntaxhighlighter-code \"><pre class=\"brush: python; title: ; notranslate\">\npip install weightwatcher\n</pre></div>\n\n\n<p>Second, pick a model and get a basic description of it</p>\n\n\n<div class=\"wp-block-syntaxhighlighter-code \"><pre class=\"brush: python; title: ; notranslate\">\nimport weightwatcher as ww\nwatcher = ww.WeightWatcher(model=my_model)\ndetails = watcher.analyze()\n</pre></div>\n\n\n<p>WeightWatcher produces a pandas dataframe, details, with layer metrics describing your model. In particular, the details dataframe contains layer names, ids, types, and warnings.</p>\n\n\n\n<p>Here is an example, an analysis of the OpenAI GPT model (discussed in our recent <a href=\"https://www.nature.com/articles/s41467-021-24025-8\">Nature paper)</a></p>\n\n\n<div class=\"wp-block-syntaxhighlighter-code \"><pre class=\"brush: python; title: ; notranslate\">\nimport transformers\nfrom transformers import OpenAIGPTModel,GPT2Model\n\ngpt_model = OpenAIGPTModel.from_pretrained('openai-gpt')\ngpt_model.eval();\n\nwatcher = ww.WeightWatcher(model=gpt_model)\ndetails = watcher.analyze()\n</pre></div>\n\n\n<p>The details dataframe now includes a wide range of information, for each layer, including a specific warnings columns</p>\n\n\n<div class=\"wp-block-syntaxhighlighter-code \"><pre class=\"brush: python; title: ; notranslate\">\ndetails&#91;details.warning!=\"\"]&#91;&#91;'layer_id','name','warning']]\n</pre></div>\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large is-resized\"><a href=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png\"><img loading=\"lazy\" data-attachment-id=\"14234\" data-permalink=\"https://calculatedcontent.com/screen-shot-2021-08-17-at-11-41-57-pm/\" data-orig-file=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png\" data-orig-size=\"516,538\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"screen-shot-2021-08-17-at-11.41.57-pm\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png?w=288\" data-large-file=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png?w=516\" src=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png?w=516\" alt=\"\" class=\"wp-image-14234\" width=\"418\" height=\"437\" srcset=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png?w=418 418w, https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png?w=144 144w, https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png?w=288 288w, https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-17-at-11.41.57-pm.png 516w\" sizes=\"(max-width: 418px) 100vw, 418px\" /></a><figcaption>weightwatcher layer warnings for GPT</figcaption></figure></div>\n\n\n\n<p>For comparison, below we show the same details deatframe, but for GPT2.  GPT2 is the same model as GPT, but trained with more and better data,  Being a much better model, GPT2 has far fewer warnings than GPT.</p>\n\n\n\n<div class=\"wp-block-image\"><figure class=\"aligncenter size-large is-resized\"><a href=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png\"><img loading=\"lazy\" data-attachment-id=\"14239\" data-permalink=\"https://calculatedcontent.com/screen-shot-2021-08-18-at-8-24-03-am-1/\" data-orig-file=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png\" data-orig-size=\"506,190\" data-comments-opened=\"1\" data-image-meta=\"{\"aperture\":\"0\",\"credit\":\"\",\"camera\":\"\",\"caption\":\"\",\"created_timestamp\":\"0\",\"copyright\":\"\",\"focal_length\":\"0\",\"iso\":\"0\",\"shutter_speed\":\"0\",\"title\":\"\",\"orientation\":\"0\"}\" data-image-title=\"screen-shot-2021-08-18-at-8.24.03-am-1\" data-image-description=\"\" data-image-caption=\"\" data-medium-file=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png?w=300\" data-large-file=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png?w=506\" src=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png?w=506\" alt=\"\" class=\"wp-image-14239\" width=\"413\" height=\"156\" srcset=\"https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png?w=413 413w, https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png?w=150 150w, https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png?w=300 300w, https://charlesmartin14.files.wordpress.com/2021/08/screen-shot-2021-08-18-at-8.24.03-am-1.png 506w\" sizes=\"(max-width: 413px) 100vw, 413px\" /></a><figcaption>weightwatcher layer warnings for GPT2</figcaption></figure></div>\n\n\n\n<p>That&#8217;s all there is to it.   WeightWatcher provides simple layer metrics for pre-trained Deep Neural Networks, indicating simple warnings for which layers are over-trained and which layers are under-trained.</p>\n\n\n\n<p>Give it a try. We are looking for early adopters needing better, faster, and cheaper AI monitoring. if it is useful to you , please let me know.</p>\n",
  "wfw:commentRss": "https://calculatedcontent.com/2021/08/18/model-monitoring-with-weightwatcher-data-free-deep-learning-diagnostics/feed/",
  "slash:comments": 6,
  "media:thumbnail": "",
  "media:content": [
    {
      "media:title": "screen-shot-2021-08-18-at-8.24.03-am-1"
    },
    {
      "media:title": "charlesmartin14"
    },
    "",
    ""
  ]
}