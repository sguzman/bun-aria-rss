{
  "id": "tag:blogger.com,1999:blog-15045980.post-4941039424603171628",
  "published": "2018-06-11T09:20:00.000-07:00",
  "updated": "2018-12-13T09:47:48.992-08:00",
  "category": [
    "",
    ""
  ],
  "title": "Testing on the Toilet: Keep Tests Focused",
  "content": "<i><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">This article was adapted from a&nbsp;<a href=\"http://googletesting.blogspot.com/2007/01/introducing-testing-on-toilet.html\">Google Testing on the Toilet</a>&nbsp;(TotT) episode. You can download a&nbsp;<a href=\"https://docs.google.com/document/d/1QwLg7uY7vMpWiahru76o0QdCWEeV8pO69FcwX0lCKWA/edit?usp=sharing\" rel=\"nofollow\">printer-friendly version</a>&nbsp;of this TotT episode and post it in your office.</span></i><br /><i><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"><br /></span></i><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">By Ben Yu</span><br /><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"><br /></span><span id=\"docs-internal-guid-7b9c23ee-ef94-09b4-cb1b-89c9a235a8c1\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif; vertical-align: baseline; white-space: pre-wrap;\">What scenario does the following code test?</span></span><br /><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #cfe2f3; vertical-align: top; width: 607px;\"><pre style=\"background-color: #cfe2f3; border: 0px; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"color: black; font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">TEST_F(BankAccountTest, <span style=\"font-weight: bold;\">WithdrawFromAccount</span>) {<br />  Transaction transaction = account_.Deposit(Usd(5));<br />  clock_.AdvanceTime(MIN_TIME_TO_SETTLE);<br />  account_.Settle(transaction);<br /><br /><br />  EXPECT_THAT(<span style=\"font-weight: bold;\">account_.Withdraw</span>(Usd(5)), IsOk());<br />  EXPECT_THAT(<span style=\"font-weight: bold;\">account_.Withdraw</span>(Usd(1)), IsRejected());<br />  account_.SetOverdraftLimit(Usd(1));<br />  EXPECT_THAT(<span style=\"font-weight: bold;\">account_.Withdraw</span>(Usd(1)), IsOk());<br />}</span></pre></td></tr></tbody></table><div dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0pt; margin-top: 10pt;\"><span id=\"docs-internal-guid-78e6ff07-ef9e-e0ec-fbd0-3db93bb4f28f\" style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"><span style=\"background-color: white; color: #333333; vertical-align: baseline; white-space: pre-wrap;\">Translated to English: “</span><span style=\"background-color: white; color: #333333; font-style: italic; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;\">(1)</span><span style=\"background-color: white; color: #333333; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\"> I had $5 and was able to withdraw $5; </span><span style=\"background-color: white; color: #333333; font-style: italic; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;\">(2)</span><span style=\"background-color: white; color: #333333; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\"> then got rejected when overdrawing $1;</span><span style=\"background-color: white; color: #333333; font-style: italic; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;\"> (3)</span><span style=\"background-color: white; color: #333333; font-style: italic; vertical-align: baseline; white-space: pre-wrap;\"> but if I enable overdraft with a $1 limit, I can withdraw $1.”</span><span style=\"background-color: white; color: #333333; vertical-align: baseline; white-space: pre-wrap;\"> If that sounds a little hard to track, it is: </span><span style=\"background-color: white; color: purple; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;\">it is testing three scenarios, not one.</span></span></div><span id=\"docs-internal-guid-78e6ff07-ef9e-e0ec-fbd0-3db93bb4f28f\"></span><br /><div><span id=\"docs-internal-guid-78e6ff07-ef9e-e0ec-fbd0-3db93bb4f28f\"><span style=\"background-color: white; color: #980000; font-size: 13pt; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;\"><br /></span></span></div><span id=\"docs-internal-guid-78e6ff07-ef9e-e0ec-fbd0-3db93bb4f28f\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"></span></span><br /><div><span id=\"docs-internal-guid-78e6ff07-ef9e-e0ec-fbd0-3db93bb4f28f\"><span style=\"background-color: white; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-73fc15db-ef9f-118e-1761-a33020c05953\" style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif; font-weight: normal;\"><span style=\"color: #333333; vertical-align: baseline;\">A better approach is to </span><span style=\"color: purple; font-weight: 700; vertical-align: baseline;\">exercise each scenario in its own test</span><span style=\"color: #333333; vertical-align: baseline;\">:</span></span></span></span></div><span id=\"docs-internal-guid-78e6ff07-ef9e-e0ec-fbd0-3db93bb4f28f\"></span></div><div style=\"overflow-x: auto;\"><table class=\"my-bordered-table\" style=\"width: 613px;\"><tbody><tr><td style=\"background-color: #d9ead3; vertical-align: top; width: 607px;\"><pre style=\"background-color: #d9ead3; border: 0px; color: black; margin: 0px; padding-bottom: 0px; padding-left: 0px; padding-top: 0px;\"><span style=\"font-family: &quot;consolas&quot; , &quot;courier new&quot; , &quot;courier&quot; , monospace;\">TEST_F(BankAccountTest, <span style=\"font-weight: bold;\">CanWithdrawWithinBalance</span>) {<br />  DepositAndSettle(Usd(5));  // Common setup code is extracted into a helper method.<br />  EXPECT_THAT(<span style=\"font-weight: bold;\">account_.Withdraw</span>(Usd(5)), IsOk());<br />}<br />TEST_F(BankAccountTest, <span style=\"font-weight: bold;\">CannotOverdraw</span>) {<br />  DepositAndSettle(Usd(5));<br />  EXPECT_THAT(<span style=\"font-weight: bold;\">account_.Withdraw</span>(Usd(6)), IsRejected());<br />}<br />TEST_F(BankAccountTest, <span style=\"font-weight: bold;\">CanOverdrawUpToOverdraftLimit</span>) {<br />  DepositAndSettle(Usd(5));<br />  account_.SetOverdraftLimit(Usd(1));<br />  EXPECT_THAT(<span style=\"font-weight: bold;\">account_.Withdraw</span>(Usd(6)), IsOk());<br />}</span></pre></td></tr></tbody></table></div><br /><div dir=\"ltr\" style=\"line-height: 1.2; margin-bottom: 0pt; margin-top: 10pt;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"><span style=\"background-color: white; font-style: normal; font-variant: normal; font-weight: 700; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"color: purple;\">Writing tests this way provides many benefits</span></span><span style=\"background-color: transparent; color: black; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">:</span></span></div><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"><span id=\"docs-internal-guid-7d99b1a3-efa1-48fb-89c0-831589ed64ac\"></span></span><br /><ul style=\"margin-bottom: 0pt; margin-top: 0pt;\"><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: -13.5pt; text-decoration: none; vertical-align: baseline; white-space: pre;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">Logic is easier to understand because there is less code to read in each test method.</span></li></ul><ul style=\"margin-bottom: 0pt; margin-top: 0pt;\"><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: -13.5pt; text-decoration: none; vertical-align: baseline; white-space: pre;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">Setup code in each test is simpler because it only needs to serve a single scenario.</span></li></ul><ul style=\"margin-bottom: 0pt; margin-top: 0pt;\"><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: -13.5pt; text-decoration: none; vertical-align: baseline; white-space: pre;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">Side effects of one scenario will not accidentally invalidate or mask a later scenario’s assumptions. </span></li></ul><ul style=\"margin-bottom: 0pt; margin-top: 0pt;\"><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: -13.5pt; text-decoration: none; vertical-align: baseline; white-space: pre;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">If a scenario in one test fails, other scenarios will still run since they are unaffected by the failure.</span></li></ul><ul style=\"margin-bottom: 0pt; margin-top: 0pt;\"><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-style: normal; font-variant: normal; font-weight: 400; list-style-type: disc; margin-left: -13.5pt; text-decoration: none; vertical-align: baseline; white-space: pre;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">Test names clearly describe each scenario, which makes it easier to learn which scenarios exist.</span></li></ul><div><div dir=\"ltr\" style=\"line-height: 1.2; margin-bottom: 0pt; margin-top: 10pt;\"><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\">One sign that you might be testing more than one scenario: after asserting the output of one call to the system under test, the test makes another call to the system under test.</span></span></span></div><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"></span><br /><div><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-ca653e74-efa1-8e8c-1649-9423a50abeef\"></span></span><br /></span><br /><div dir=\"ltr\" style=\"line-height: 1.38; margin-bottom: 0pt; margin-top: 10pt;\"><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-ca653e74-efa1-8e8c-1649-9423a50abeef\"><span style=\"font-family: &quot;times&quot; , &quot;times new roman&quot; , serif;\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; font-weight: 700; vertical-align: baseline;\"><span style=\"color: purple;\">While a scenario for a unit test often consists of a single call to the system under test, its scope can be larger for integration and end-to-end tests</span></span><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline;\">. For example, a test that a web UI can send email might open the inbox, click the </span><span style=\"font-style: italic; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline;\">compose</span><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline;\"> button, write some text, and press the </span><span style=\"font-style: italic; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline;\">send</span><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline;\"> button.</span></span></span></span></span></div><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-ca653e74-efa1-8e8c-1649-9423a50abeef\"></span></span></span><br /><div style=\"font-size: 13pt;\"><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-ca653e74-efa1-8e8c-1649-9423a50abeef\"><span style=\"font-size: 13pt; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline;\"><br /></span></span></span></span></div><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"><span style=\"font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;\"><span id=\"docs-internal-guid-ca653e74-efa1-8e8c-1649-9423a50abeef\"></span></span></span></div><span id=\"docs-internal-guid-b1437967-efa1-7617-055d-4f63e0f47cff\"></span></div><div><span style=\"font-size: 17.3333px; white-space: pre-wrap;\"><br /></span></div>",
  "link": [
    "",
    "",
    "",
    "",
    ""
  ],
  "author": {
    "name": "Google Testing Bloggers",
    "uri": "http://www.blogger.com/profile/03153388556673050910",
    "email": "noreply@blogger.com",
    "gd:image": ""
  },
  "thr:total": 6
}